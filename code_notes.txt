 /humgen/cnp04/sandbox/data/arrayCGH/locus_summarized/raw

grep -P "^.+\t1\t[56]2\d\d\d\t.+" test


grep -Po "^.+\t17\t4[12]\d\d\d\d\d\d\t.+" illumina.locus_summary.merged > ~/17_illumina

illumina.locus_summary.merged


########################## June 29th ##########################
#clean and make binary HGDP data----------------------------------------------------
#first eliminated genotype info from .pedsnp file to make .map file 
###exclude individuals with less than 90% data
###exclude snps with less than 90% genotyping rate
### no maf cutoff was used
./plink --ped /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP.ped --map /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format --out /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP_clean --make-bed --geno 0.1 --mind 0.1

#pull out general inversion region-------------------------------------
40000000-43000000
approx: rs7501777-rs11869026

#trim to correct region and clean 
./plink --map /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP.map --ped /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP.ped --from rs7501777 --to rs11869026 --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean

used --r2 and --blocks





###################################################################################


#####also need to work with array illumina and affy data#########
#working with data from c68 first because edges are more clear
#c68 - A
sure:41786145-41922458
#this is 16 probes on affy
###cluster data by k-means





#c68 - B
sure: 42005959 - 42139861





July 2nd ---
Using HapMap data to try and find good marker SNPS for H1 and H2
All hapmap data for chr17 CEU was put into plink format --> /Users/lindaboettger/Desktop/HMdata_all/HM_plink

#HM3
./plink --map /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd.map --ped /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd.ped --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd


perl -nle 's/  (\w)(\w)\n/  $1 $2\n/g; print;' genotypes_chr17_CEU_r27_nr.b36_fwd.ped > all_new.ped  


July 5th--- fixed problems with map and ped files
./plink --map /Users/lindaboettger/Desktop/HMdata_all/HM_plink/newmap_map2-new.map --ped /Users/lindaboettger/Desktop/HMdata_all/HM_plink/CEU_new3.ped --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd


July 6th -------
using binary files of HapMap data to determine which SNPs can type H1 and H2 (looking at r^2

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd --r2 --out /Users/lindaboettger/Desktop/HMdata_all/HM_plink/linkage


-----> data appears to be all of chr 17, maybe should have taken small portion first!!
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd --from rs6503380 --to rs2611895 --make-bed --out /Users/lindaboettger/Desktop/HMdata_all/CEU_inv
#This takes position 39997600 - 43000484

#looks at haplotype blocks over 1Mb
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv --blocks --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv_block
….. this gave 0 blocks!

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv --blocks --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv_block
---- still not blocks called!
----> this is why Note that only individuals with a non-missing phenotype are included in this analysis.

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv --r2 --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv_r2
> looks like extensive linkage

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv --recode --tab --out /Users/lindaboettger/Desktop/HMdata_all/HM_plink/CEU_inv9

perl -nle 's/-9/0/; print;' CEU_inv9.ped > CEU_inv0.ped

./plink --map /Users/lindaboettger/Desktop/HMdata_all/HM_plink/CEU_inv9.map --ped /Users/lindaboettger/Desktop/HMdata_all/HM_plink/CEU_inv0.ped --make-bed --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv0

now try blocks...
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv0 --blocks --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_inv_block

This gives good stats for haplotype blocks but it accepts .95 r^2, and we really want 1. I'm going to take the region of the haplotype, and filter out all values except for 1… from there I'll extract the snp names and get rid of dups. 
Chr     Start        End           kb	    nSNPs
17     41248753     42220763      972.011    663

r2_1_LD_SNPs.txt contains all the SNPs in the region that have and LD of 1

will all LD values for a set of SNPs versus one specific SNP --- using rs17689471 to compare others

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_invL --r2 --ld-snp rs17689471 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/blockr1

all SNPs in this area with r^2 of 1 with tagging SNPs put in /Users/lindaboettger/Desktop/HMdata_all/Linkage/analysis/Tagging_SNPs.tt


none of the tagging HapMap SNPs were in HGDP!!! using:   /Users/lindaboettger/Desktop/HGDP_typeSNPS/find_matching.pl

will need to look at complete genome sequence to find other snps that are tagging

--- of 21 SNPs from Donnelly paper, 18 are in my Tagging SNPs. 
I don't have --> rs11079718, rs10514879
#rs241039 is one of my tagging SNPs

./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_invL --ld rs241039 rs11079718 --out /Users/lindaboettger/Desktop/HGDP_typeSNPS/oddball1


#also checking strange SNP (rs17563986) that is not 20% freq in europeans
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_invL --ld rs241039 rs17563986 --out /Users/lindaboettger/Desktop/HGDP_typeSNPS/oddball2
…….> r2 is 1 ---> something probably wrong with how it is reported on web

Looking at frequency in population
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_invL --freq --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/MAF
---> the MAF of rs17563986 is 18.52%  

###checking attribute file for plink HGDP data--------------------------------------------------------------
/Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/attribute_ethnicity.txt

./plink --bfile /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean --attrib-indiv /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/attribute_ethnicity.txt Druze --make-bed --out /Users/lindaboettger/Desktop/test
---> this worried well

###looking at only the typing SNPs for HGDP
./plink --bfile /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean --snps rs393152,rs17563599,rs12185268,rs12373139,rs17563986,rs1981997,rs8070723,rs2532269,rs2668692,rs199533 --make-bed --out /Users/lindaboettger/Desktop/HGDP_typeSNPS/typeSNPdata

./plink --bfile /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean --snps rs393152,rs17563599,rs12185268,rs12373139,rs17563986,rs1981997,rs8070723,rs2532269,rs2668692,rs199533 --recode --tab --out /Users/lindaboettger/Desktop/HGDP_typeSNPS/typeSNPdata



# july 15th ----> looking at hapmap3 african populations for possible H2 chromosome--------------------------------------------------------------
#approx: 40000000-43025179
./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK


./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK


used --r2 and --blocks

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK --blocks --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK_blocks
… no blocks cuz not labeled as controls

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.ped --recode --tab --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.ped --recode --tab --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK

… then last two descriptive numbers changed to 1
perl -nle 's/-9/1/; print;' LWK.ped > LWK1.ped

perl -nle 's/-9/1/; print;' MKK.ped > MKK1.ped

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK1.ped --blocks --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK_blocks
---- blocks don't look great

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK1.ped --r2 --ld-snp rs17563599 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK_r2
---- doesn't span very far

#against african tagging SNP
./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK1.ped --r2 --ld-snp rs17563986 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/LWK_r2
------nothing there

##MKK
./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --blocks --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK_blocks
---- blocks don't look great -- longest is 200kb

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --r2 --ld-snp rs17563599 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK_r2
---- doesn't span very far

#this is looking at LD with African tagging SNP
./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --r2 --ld-snp rs17563986 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK_r2

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --r2 --ld-snp rs17563986 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK_r2_all

#check larger region
./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --r2 --ld-snp rs17563986 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 2000 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK_r2



./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --from rs17563986 --to rs17563986 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/rs17563986

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/MKK1.ped --from rs17563986 --to rs1105569 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/rs17563986_2








####also doing smart PCA for Nick on all HGDP data----------------------------------------------------------------------------------------------------------------------------

will use my map/ped files with only correct locations to use with smart PCA

./plink --bfile /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean --recode --tab --out /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean

perl smartpca.perl -i /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean.ped -a /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean.map -b /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean.ped -o /Users/lindaboettger/Desktop/PCA/HGDP.pca -p /Users/lindaboettger/Desktop/PCA/HGDP.plot -l /Users/lindaboettger/Desktop/PCA/HGDP.log -e /Users/lindaboettger/Desktop/PCA/HGDP.eval






##### July 16th

Examining CEU hapmap population to see if H1 does not in fact have the c68 duplication


./plink --bfile /Users/lindaboettger/Desktop/Haplotype_deffs/HMdata_all/HM_plink/CEU_inv --from rs12373139 --to rs12373139 --recode --tab --out /Users/lindaboettger/Desktop/Haplotype_deffs/HMdata_all/HM_plink/CEU_rs17563986



#July 23rd
---> this dataset has 60 individuals
installed VCF tools in Program directory to look at 1000 genomes data. VCF tools does have many useful commands (http://vcftools.sourceforge.net/options.html), but it would be better to convert to plink format

vcftools --vcf /Users/lindaboettger/Desktop/1000genomes/CEU.low_coverage.2010_07.genotypes.vcf --chr 17 --plink --out /Users/lindaboettger/Desktop/1000genomes/CEU
… the names were changed to tgp_CEU.map/ped

These SNP locations are for genome build 36.3 reference assembly


from ---> rs2684631	40866433 to --> rs1378358	42142495

./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU.ped --from rs2684631 --to rs1378358 --recode --tab --out /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion

look for good LD with known H2 SNP

./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.ped --out /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion --make-bed


./plink --bfile /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion  --r2 --ld-snp rs12373139 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/1000genomes/r2_1_rs12373139

again didn't work cuz phenotype unspecified

perl -nle 's/-9/1/; print;' tgp_CEU_inversion.ped > tgp_CEU_inversion_phen.ped

./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion_phen.ped --r2 --ld-snp rs12373139 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/1000genomes/r2_1_rs12373139


perl -nle 's/(NA\d+\tNA\d+\t0\t0)\t0\t-9/$1\t1\t1/; print;' tgp_CEU_inversion.ped > tgp_CEU_inversion_phen.ped


./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion_phen.ped --r2 --ld-window-r2 1 --ld-snp rs12373139 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/1000genomes/r2_1_rs12373139

THIS FILE CONTAINS ALL GOOD TAGGING SNPS FOR H2 FROM 1000 GENOMES: /Users/lindaboettger/Desktop/1000genomes/r2_1_rs12373139

./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion_phen.ped --r2 --ld-window-r2 .93 --ld-snp rs12373139 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/1000genomes/r2_93_rs12373139

---->now need to find minor allele and verify that it is 20%
./plink --map /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion.map --ped /Users/lindaboettger/Desktop/1000genomes/tgp_CEU_inversion_phen.ped --extract /Users/lindaboettger/Desktop/1000genomes/Probe_SNPs.txt --freq --out /Users/lindaboettger/Desktop/1000genomes/tgp_probesnps_freq

--freq stats:
     CHR       Chromosome
     SNP       SNP identifier
     A1        Allele 1 code (minor allele)
     A2        Allele 2 code (major allele)
     MAF       Minor allele frequency
     NCHROBS   Non-missing allele count


still need to:
convert genomic locations from hg18 into hg19 for all SNPs
extract the minor allele from the .frq file and replace the bp in that location with the new allele
create probes out of these and add them to the other probes we have



LIFTOVER
wget http://hgdownload.cse.ucsc.edu/admin/exe/macOSX.i386/liftOver
make excitable: chmod +x liftover
liftOver oldFile map.chain newFile unMapped
liftover probe_positions_bed.bed hg18ToHg19.over.chain hg19_probe_pos unmapped


July 25th
Editing probes

#get rid of - strands
perl -nle 's/^.+-\n//; print;' BaitTiling_newin_tdt > BaitTiling_newinplus_tdt

perl -nle 's/.+\t\-//; print;' BaitTiling_newin_tdt > BaitTiling_newinplus_tdt

perl -ne 's/^\n//; print;' BaitTiling_newinplus4_tdt > BaitTiling_newinplus5_tdt



August 4th------------------------------------------------------------------------------------------------------------------------------
#have chimp hapmap2 snps and want to align them with human hapmap3 SNPs

#get only chr17
grep -Po "\d+\tchr17.+" hapmapAllelesChimp.txt > HapMap2Chimp_Chr17.txt

#get only rsid and SNP call
perl -ne 's/.+(rs\d+).+(\w)$/$1\t$2/; print;' HapMap2Chimp_Chr17.txt > HapMap2Chimp_Chr17_SNPS.txt

#just rsid
perl -ne 's/.+(rs\d+).+/$1/; print;' HapMap2Chimp_Chr17.txt > HapMap2Chimp_Chr17_rsid.txt

/Users/lindaboettger/Desktop/Phased_HM3/H1_H2_allpop_inversion_chimp.fa



perl -ne 'chomp; print;' build_37seq_43-44mb.fa > c_build_37seq_43-44mb.fa



##### August 18th ############
#typing all HM3 individuals

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.ASW.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.ASW.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/ASW

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CEU

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CHD.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CHD.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CHD

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.GIH.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.GIH.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/GIH

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.JPT.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.JPT.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/JPT

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MEX.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MEX.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs8072644 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/MEX -------->THIS DIDN"T WORK with standard last snp, so I used the one before it

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.MKK.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/MKK

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.TSI.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.TSI.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/TSI

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CHB.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CHB.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CHB

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.LWK.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs2317818 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/LWK

./plink --map /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.YRI.qc.poly.map --ped /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.YRI.qc.poly.ped --make-bed --geno 0.1 --mind 0.1 --from rs7501777 --to rs8072644 --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/YRI


###extract only typing SNPS
./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/ASW --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/ASW_tags

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CEU --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/CEU_tags

#####will need to be done separately for lack of snps!!!!!!#####################
./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CHD --snps rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/CHD_tags 

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CHD --snps rs17688002,rs17688068,rs17760577,rs17769490,rs17564619,rs17650063,rs12150506,rs17660907,rs17661428,rs2532269,rs2532257,rs2696490,rs199457 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/CHD_tags 

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/GIH --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/GIH_tags  ###had to remove one

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/JPT --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/JPT_tags

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/MEX --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/MEX_tags

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/MKK --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2696701,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/MKK_tags

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/TSI --snps rs2696425,rs17563986,rs1981997,rs17652449,rs17660464,rs1468241,rs2532234,rs2668628,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/TSI_tags ###removed one

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CHB --snps rs1467969,rs12150506,rs41399444,rs17575683 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/CHB_tags ####only had 4 tagging snps

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/LWK --snps rs418891,rs17563501,rs17563800,rs17334894,rs4074462,rs17689918,rs4327091,rs17660907 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/LWK_tags

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/YRI --snps rs11654001 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/YRI_tags




##################### Going to do LWK with more individuals since found strange H1/H1 with H2-like duplications ##############################

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/LWK --snps rs418891,rs439558,rs393152,rs17687571,rs17688434,rs17688773,rs17563501,rs2902662,rs17563599,rs17563787,rs17563800,rs17563827,rs12150672,rs17334894,rs17426195,rs4074462,rs8072451,rs17689918,rs12373139,rs12373168,rs2082068,rs17649700,rs17564493,rs17564703,rs17564948,rs4327091,rs8070723,rs12150506,rs41384744,rs17660595,rs17660907,rs4383188,rs2532316,rs2141299,rs1881194,rs2532269,rs2696701,rs2532234,rs2469933,rs2668692,rs2463524,rs2668628,rs2696490,rs2957297,rs199439,rs199457,rs199443,rs199535,rs9896243,rs199533 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/LWK_tags_more


###########look at more SNPS for the strange CEU individuals#################
./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CEU --keep /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/strange_CEU.txt --extract /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/my_region/CEU_tag_SNPs.txt --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/tags/CEU_more_strange


####### investigating possible tags for duplication ##############
#rs17585974 and rs2957297 look like good possible tags from the tree data
./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/CEU --snps rs17585974,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/possible_c63tags/CEU_duptag

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/MKK --snps rs17585974,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/possible_c63tags/MKK_duptag

./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/GIH --snps rs17585974,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/possible_c63tags/GIH_duptag


#### september 14th - look at tagging SNPs in ambiguous TSI ###############
./plink --bfile /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/TSI --snps rs17585974,rs2957297 --recode --tab --out /Users/lindaboettger/Desktop/HapMap3/hapmap3_pop/typing/possible_c63tags/TSI_duptag

/Users/lindaboettger/Desktop/qPCR_primers/humref17.txt

perl -ne 's/\n//; print;' /Users/lindaboettger/Desktop/qPCR_primers/humref17.txt > /Users/lindaboettger/Desktop/qPCR_primers/humref17edit.txt

perl -ne 's/\n//; print;' /Users/lindaboettger/Desktop/qPCR_primers/reg1test.txt > /Users/lindaboettger/Desktop/qPCR_primers/reg1testout.txt


###################### Juanuary 6th use Picard to convert bam to fastq ###############
java -jar SamToFastq.jar INPUT=/Users/lindaboettger/McCarroll_Projects/tom_mrna/mRNA-PolyA_Total_2by40_NA12878_merged.bam FASTQ=/Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq


#but these were paired end, so want another file for other end   SECOND_END_FASTQ=File
java -Xms32m -Xmx2G -jar SamToFastq.jar INPUT=/Users/lindaboettger/McCarroll_Projects/tom_mrna/mRNA-PolyA_Total_2by40_NA12878_merged.bam FASTQ=/Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.fasq SECOND_END_FASTQ=/Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.fasq

#for orchestra interactive sub
wget http://www.broadinstitute.org/~nemesh/ALLELIC_IMBALANCE/natural_libraries/bams/mRNA-PolyA_Total_2by40_NA12878_merged.bam -O mRNA-PolyA_Total_2by40_NA12878_merged.bam

java -Xms32m -Xmx16G -jar SamToFastq.jar INPUT=~/mccarroll/mRNA-PolyA_Total_2by40_NA12878_merged.bam FASTQ=~/mccarroll/tom_mrna_NA121878_first.fasq SECOND_END_FASTQ=~/mccarroll/tom_mrna_NA121878_second.fasq

_________ rep to see if fusion mRNA is present --------
#the reads are 40bp and I'm searching for 20bp
grep "TGCTAATAAGGTTTCTGTGT" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #fusion

grep "AACAGATACGTGCTAATAAG" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #regular KIAA1267

grep "ATACGTGCTAATAAG" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #regular KIAA1267 (shorter)

grep "CTTATTAGCACGTAT" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #regular KIAA1267 (shorter R&c) #found some

grep "CTTATTAGCACGTATCTGTT" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #regular KIAA1267 (r&c) # 4 found!!!


grep "ACACAGAAACCTTATTAGCA" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #fusion R&C #not there :(

grep "CAGAAACCTTATTAG" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #fusion R&C - shorter
CAGAAACCTTATTAGCACGTATCTGTTTGTAAATGTCTGT ---> found in mRNA


#none "ACACAGAAACCTTAT" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #fusion R&C #another portion - shorter
        "ACAGAAACCTTATTA"
grep "GTGCCAGAAGCCCAGGAAGC" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq #fusion R&C #another portion - shorter

found in mRNA:
CGGGCGGTGACCTTTTGATGAGGTTTCTGTGTGGATGTCN X wrong


found in mRNA (r&c):
CAGAAACCTTATTAGCACGTATCTGTTTGTAAATGTCTGT
GGTCAGGCACTTCCACACAGAAACCTTTCAGTTTCACCAG X wrong
GAAATCCACACAGAAACCTTACAGCATGGCATCCCCAGTC X wrong
CCCCAAGAACTATCAACCCCTTATTAGCACGTATCTGTTN X wrong
GGGAAGGGCACACAGAAACCTTAGTTCAAAAAGAAACTAN X wrong





###################### determine how far LD extends beyond inversion ################
./plink --bfile /Users/lindaboettger/Desktop/HMdata_all/Linkage/CEU_invL --r2 --ld-snp rs17689471 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/Desktop/HMdata_all/Linkage/blockr1

./plink --map /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --r2 --ld-snp rs17689471 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/test_LDrs17689471

./plink --map /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --r2 --ld-snp rs2696425 --ld-window 9999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/test_LDrs2696425

./plink --map /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --ld rs2696425 rs8079270 --out /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/test_LD


#January 28th##################### BWA ############################################
#defaults to short database file
bwa index /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta

bwa aln -o 0 -k 0 -n 0 -e 0 /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.sai

bwa aln -o 0 -k 0 -n 0 -e 0 /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.sai

#sampe is for paired ends, -n is edit distance
bwa sampe /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.fasq /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.sai /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.fasq /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.sai > tom_mrna_aln.sam

----------------> nothing was found

bwa samse /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.fasq /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.sai > tom_mrna_alnsecond.sam

bwa samse /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.fasq /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.sai > tom_mrna_alnfirst.sam


bwa aln -o 0 -k 0 -n 0 -e 0 /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.sai

bwa samse /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.sai /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.fasta > /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.sam
----------> nothing found

bwa aln /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/test1.sai

#worked******************
bwa sampe KIAA1267_ARL17_fusion_bwa.fasta tom_mrna_NA121878_first.sai tom_mrna_NA121878_second.sai tom_mrna_NA121878_first.fasq tom_mrna_NA121878_second.fasq  > tom_mrna_aln.sam

# this outfile has all reads, but I just want the ones that matched

awk '$3 ~ /fusion/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/fusion_matches.txt

awk ' $4 > 0 ' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/mrna_matches.txt

####################### just look at single end #####################
grep "CTTATTAGCACGTATCTGTT" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_first.fasq 

grep "AACAGATACGTGCTAATAAG" /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878_second.fasq 

--------------> for some reason it can't find the same sequences in the paired end files that it found in the large file. I'm going ot use the large file and find the paired reads later

bwa aln /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.sai

bwa samse /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_ARL17_fusion_bwa.fasta /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.sai /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_NA121878.fasq > /Users/lindaboettger/McCarroll_Projects/tom_mrna/tom_mrna_aln.sam


awk '$3 ~ /fusion/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/fusion_matches.txt
awk '$3 ~ /ARL17_1/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/ARL17_1_matches.txt
awk '$3 ~ /ARL17_2/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/ARL17_2_matches.txt
awk '$3 ~ /ARL171P/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/ARL171P_matches.txt
awk '$3 ~ /KIAA1267_1/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_1_matches.txt
awk '$3 ~ /KIAA1267_2/' tom_mrna_aln.sam > /Users/lindaboettger/McCarroll_Projects/tom_mrna/KIAA1267_2_matches.txt




################# February 12th #################
#looking through HapMap mRNA for signs of H2Dup transcript

grep "GTCATGTACCCCT" 1974_3_1.fastq
grep "AGGGGTACATGAC" 1974_3_1.fastq

look for H1D +control
grep "ACGTGCTAATAAG" 1974_3_1.fastq

grep "CTTATTAGCACG" 1974_3_1.fastq

head -22891206 1974_3_2.fastq|tail -1

head -LINENUMBEER FILENAME|tail -1


grep "CTTATTAGCACG" 1982_8_2.fastq

grep "GTCATGTACCCCT" 1982_8_2.fastq
CCCCCAGTCATGTACCCCTTGCTTGCTTAATTGATCA	!!!!!!!!!!!!!!!!!!! LOC1000505 ---- not right
grep "AGGGGTACATGAC" 1982_8_2.fastq

grep "AGGGGTACATGAC" 2003_7_1.fastq
CAGGGGTACATGACGCTGCTCGGGATCAGCTCTGGTC ……. check other side!!!
ATCCCGAGCAGCGTCATGTACCCCTGAGACGCAGGCC ….. one letter off from norm
CCTGCGTCTCAGGGGTACATGACGCTGCTCGGGATCA

12792642:CAGGGGTACATGACGCTGCTCGGGATCAGCTCTGGTC
15661102:CAGGGGTACATGACGCTGCTCGGGATCCGCCCTGGGC
20816602:CTCAGGGGTACATGACGCTGCTCGGGATCAGCTCTGG
21830850:GGCCTGCGTCTCAGGGGTACATGACGCTGCTCGGGAT
24569402:CCTGCGTCTCAGGGGTACATGACGCTGCTCGGGATCA

head -24569402 2003_7_2.fastq|tail -1

grep -n "AGGGGTACATGAC" 1982_8_2.fastq

11415126
head -11415126 1982_8_2.fastq|tail -1






############ February 19th --- Bob's copy number genotypes ######### Working with .vcf file format #####################
options:
http://vcftools.sourceforge.net/options.html#geno_filter

used to pull out copy number data:
./vcftools --vcf /Users/lindaboettger/Downloads/mapt_regions.genotypes.vcf --extract-FORMAT-info CN

./vcftools --vcf /Users/lindaboettger/Downloads/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CN
./vcftools --vcf /Users/lindaboettger/Downloads/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CNQ
./vcftools --vcf /Users/lindaboettger/Downloads/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CNL



########### Feb 20th --- sorting read pairs on broad server ###############
use LSF
bsub -o fastqsortlog.txt perl fastqSort_lb.pl s_1_1_sequence.txt.gz s_1_2_sequence.txt.gz
bsub -o fastqSort_log.txt -e fastqSort_err.txt perl fastqSort_lb.pl s_1_1_sequence.txt.gz s_1_2_sequence.txt.gz #the "-o" is so that I don't get emailed the log and it goes instead to a text file

bjobs #to see status of run



######################## Feb 21st ############################
-aligning my fastq reads to the hg19 genome
hg19 reads downloaded from http://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes/
each fasta file combined into one

use scp to transfer files between servers
http://www.kb.iu.edu/data/agye.html

#send zip files to Mike
scp -r split_fastq boettger@copper.broadinstitute.org:/seq/mczody/17_inv/capture/seq_rd1/

cat chr1.fa chr2.fa chr3.fa chr4.fa chr5.fa chr6.fa chr7.fa chr8.fa chr9.fa chr10.fa chr11.fa chr12.fa chr13.fa chr14.fa chr15.fa chr16.fa chr17.fa chr18.fa chr19.fa chr20.fa chr21.fa chr22.fa chrM.fa chrX.fa chrY.fa > hg19.fa

############## make sam file from fastq paired end files ##############
bsub bwa index -a bwtsw hg19.fa

bsub perl fastqSplit.pl NA10861_1n1n.sortedpairs.txt NA10861_1.fastq NA10861_2.fastq

bwa aln reference/hg19.fa split_fastq/NA10861_1.fastq > align/NA10861_aln_sa1.sai

bwa aln reference/hg19.fa split_fastq/NA10861_2.fastq > align/NA10861_aln_sa2.sai

bwa sampe reference/hg19.fa align/NA10861_aln_sa1.sai align/NA10861_aln_sa2.sai split_fastq/NA10861_1.fastq split_fastq/NA10861_2.fastq > align/NA10861_aln.sam



bsub perl fastqSplit.pl sorted_fastq/NA10861_1n1n.sortedpairs.txt split_fastq/NA10861_1.fastq split_fastq/NA10861_2.fastq





bwa sampe database.fasta aln_sa1.sai aln_sa2.sai read1.fq read2.fq > aln.sam





# do it to another individual


bwa aln reference/hg19.fa split_fastq/NA12707_1.fastq > align/NA12707_aln_sa1.sai
bwa aln reference/hg19.fa split_fastq/NA12707_2.fastq > align/NA12707_aln_sa2.sai

bwa sampe reference/hg19.fa align/NA12707_aln_sa1.sai align/NA12707_aln_sa2.sai split_fastq/NA12707_1.fastq split_fastq/NA12707_2.fastq > align/NA12707_aln.sam

samtools view -bS NA12707_aln.sam > NA12707_aln.bam

samtools sort NA12707_aln.bam NA12707_aln.sorted
samtools index NA12707_aln.sorted.bam

samtools view -b -o NA12707_region.bam NA12707_aln.sorted.bam chr17:43411014-44884739
samtools sort NA12707_region.bam NA12707_region.sorted
samtools index NA12707_region.sorted.bam



#February 25 --- working with Bob's genotypes to get everyone possible #########

used to pull out copy number data:
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --extract-FORMAT-info CN

./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CN

./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CNQ

./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CNL




############# make regional sam file for all individuals
bsub -Is -q shared_int_2h bash

bwa aln reference/hg19.fa split_fastq/NA21685_1.fastq > align/NA21685_aln_sa1.sai
bwa aln reference/hg19.fa split_fastq/NA21685_2.fastq > align/NA21685_aln_sa2.sai

bwa sampe reference/hg19.fa align/NA21685_aln_sa1.sai align/NA21685_aln_sa2.sai split_fastq/NA21685_1.fastq split_fastq/NA21685_2.fastq > align/NA21685_aln.sam

#change to align directory
samtools view -bS NA21685_aln.sam > NA21685_aln.bam

samtools sort NA21685_aln.bam NA21685_aln.sorted
samtools index NA21685_aln.sorted.bam

samtools view -b -o NA21685_region.bam NA21685_aln.sorted.bam chr17:43411014-44884739
samtools sort NA21685_region.bam region/NA21685_region.sorted

#go into region directory
samtools index NA21685_region.sorted.bam

#### move files to broad ########
scp -r 17q21.31_bam boettger@copper.broadinstitute.org:/humgen/cnp04/sandbox/lboettger/

scp -r reference LMB28@orchestra.med.harvard.edu:/home/lmb28



####################### add program to path##########################
vim .bash_profile
bash profile gets run whenever you run bash. If you change .bash_profile, in order for those changes to take effect you either need to login again or you need to type in the following:

. ~/.bash_profile
~/.*

/opt/samtools/bin$

The first . means: run the file directly after it in the bash shell. To check if your changes to $PATH worked, you need to echo the $PATH environment variable with this command:

echo $PATH

This should show a list of directories that bash will look in when it looks for programs to run. It goes through this list in order from first to last. 

Another note: you have to 'export' the variable for it to become an 'environment variable'. This is usually the last line of the .bash_profile,  it begins "export PATH=…". If this is missing, the environment variable $PATH will not be changed, and your changes to $PATH will not be saved once  .bash_profile is done running (i.e. the changes only were used during the script).

If you want to see hidden files (e.g. files with a . in front) you can use ls -a (a is for all). You can find other flags for ls in man ls. 



####then add directory to path####
####hit "i" to change to insert mode######
# set PATH so it includes user's programs and private bin if it exists
PATH=~/opt/blast2:~/paml43/bin:~/bin:"${PATH}"
PATH=opt/tre/bin:$PATH
export PATH=/opt/blast2:$PATH
~/opt/samtools/bin

#hit escapte ot leave insert mode
#hit ":" then "wq" for write quit to leave vim

########### if doing on own computer and not on server update with 
source ~/.profile



############### 1000 genomes genotypes ##############################
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20100804/ALL.2of4intersection.20100804.genotypes.vcf.gz

#should use tabix to get certain part
ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20100804/README.20100804_merged_snp_set

bsub -Is -q shared_int_2h bash
./tabix -h ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20100804/ALL.2of4intersection.20100804.genotypes.vcf.gz 17:43411014-44884739 > ALL.2of4intersection.20100804.genotypes.vcf

17:43411014-44884739


vcftools --vcf ALL.2of4intersection.20100804.genotypes.vcf --snps universal_hap_tags.txt --recode --out haptag

vcftools --vcf ALL.2of4intersection.20100804.genotypes.vcf --snps universal_hap_tags.txt --plink --out haptag


################### March 1st Pileup of Dec 2009 capture data ##########

samtools pileup -vcf ref.fasta aln.sorted.bam #but I don't want it in vcf format and I only want good SNPs

samtools pileup -vcf reference/hg19.fa align/region/17q21.31_bam/NA10861_region.sorted.bam


samtools mpileup -P ILLUMINA -ugf reference/hg19.fa align/region/17q21.31_bam/*.bam | bcftools view -bcvg
samtools mpileup -P ILLUMINA -ugf reference/hg19.fa align/region/17q21.31_bam/*.bam



########################### March 3rd ##### Realized some individuals missing!!!!!!!!!!!! --- was due to initial filtering back in july!!!!
## finding haplotype of missing trio individuals
./plink --map /Users/lindaboettger/McCarroll_Projects/Haplotype_deffs/HMdata_all/HM_plink/newmap_map2-new.map --ped /Users/lindaboettger/McCarroll_Projects/Haplotype_deffs/HMdata_all/HM_plink/CEU_new3.ped --keep /Users/lindaboettger/Desktop/my.indvs.txt --snps rs17687849,rs12373123,rs17652502,rs2668692 --recode --tab --out /Users/lindaboettger/McCarroll_Projects/Haplotype_deffs/HMdata_all/missing_deffs



############# looking at monogomery exon QTL data  #### March 7 2011 #############################

grep "ENSG00000120071" RNASEQ60_EXPR_10_FILT_INSERT_NORM-CIS1MB.observed.txt  #this is grepping for the KIAA1267 gene exons in the file that contains all associations so that I can see the p-values for all the exons


############################ March 8th ---- starting phasing ####################
location of OMNI genotypes in .vcf:
ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20110217_broad_omni_genotypes/
#this is done on my own computer -- orchestra doesn't have vcftools
#I'm using hg19 / build 37

wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20110217_broad_omni_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf.gz

#bob's c61/c63 genotypes
/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf

./vcftools --vcf mapt_regions.genotypes.vcf --keep indvs.txt --positions positions.txt --extract-FORMAT-info CN

./vcftools --vcf Omni25_genotypes_1212_samples_v2.b37.vcf --chr 17 --plink --out ONMNI_genotypes


#### put plink in path
### show hidden files
defaults write com.apple.finder AppleShowAllFiles TRUE
killall Finder

#put it back to not show
defaults write com.apple.finder AppleShowAllFiles FALSE
killall Finder


./tabix -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20110217_broad_omni_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf.gz 17:43411014-44884739 > omni_inversion.vcf

ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20110217_broad_omni_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf.gz

http://sourceforge.net/projects/vcftools/files/vcftools_v0.1.4a.tar.gz


scp -r reference boettger@copper.broadinstitute.org:/humgen/cnp04/sandbox/lboettger/
scp -r orig_fastq boettger@copper.broadinstitute.org:/humgen/cnp04/sandbox/lboettger/

#### big file but it worked on my computer ###
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 17 --from-bp 43411014 --to-bp 44884739 --plink --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes

######## get only individuals that Bob has copy number info for##########
./plink --map /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes.map --ped /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes.ped --keep /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/bobs_indvs.txt --recode --tab --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindv

####pull out CN from Bob's vcf file#######
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --positions positions.txt --extract-FORMAT-info CN


###use Jim's scripts to remove duplication snps and put in dup markers#####
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs


@author: nemesh


Options:
  -h, --help            show this help message and exit
  --snpGenotypesFile=SNPGENOTYPESFILE
                        (Required) A tped file from plink.
  --famFile=FAMFILE     (Required) A tfam file from plink.
  --cnvGenotypesFile=CNVGENOTYPESFILE
                        (Optional) A file of CNV genotypes.  The format is
                        (NAxxxx are sample IDs)                       CNP
                        CHR    START    END    NA06986    NA06994
                        CNP1    1      10      100        2         1
  --sampleType=SAMPLETYPE
                        (Required) What sort of samples are in the fam file?
                        Needed                       to organize the bgl
                        output file correctly for phasing.  Choices:
                        [trio] [pair] [unrelated]
  --topSet              Take the first part of the samples submitted.  Goes
                        with pctSamples to allow                       one to
                        sample some pct of samples from either the beginning
                        or end of the list of valid samples
                        for analysis. Defaults to False unless selected.  This
                        will have no effect unless pctSamples is set to less
                        than 100 (it's default)
  --pctSamples=PCTSAMPLES
                        Take only part of the samples from the submitted set.
                        Goes with the topset flag to allow one to sample some
                        pct of samples from either the beginning or end of the
                        list of valid samplesfor analysis. Defaults to all
                        samples
  --outFile=OUTFILE     Where to put output results.  Three outputs will be
                        created, .bgl, .sample. and .marker
  --cnvFreqToExcludeSNP=CNVFREQTOEXCLUDE
                        If set, excludes SNPs from beagle input that overlap
                        CNVs above this frequency threshold.
                        Defaults to all SNPs being excluded (0% frequency).
                        Requires cnvGenotypesFile parameter to be set
  --includeCNVGenotypesInOutput
                        If this flag is set, include the CNV genotypes and
                        markers in the beagle input file.
                        Requires cnvGenotypesFile parameter to be set.


################# need fam file from plink and should get rid of c68 copy number region
################ also, will need to somehow put my copy number info in the correct format 

(Optional) A file of CNV genotypes.  The format is
                        (NAxxxx are sample IDs)                       
CNP    CHR    START    END    NA06986    NA06994
CNP1    1      10      100        2         1

######################### make tped / fam files for jim's software ############
plink --file /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindv --recode --transpose --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindvt


###### actually should get rid of c68/complex region first so it doesn't mess up analysis##################
# 41731776-42139847 #hg18
# chr17:44375999-44784664 #hg19

plink --file /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindv --exclude /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/myrange.txt --range --recode --transpose --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindvt 

#get to correct location and source
/fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.tcsh
#run this
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs
jim's code commands:
bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tped --famFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tfam --cnvGenotypesFile=~/bob_1000genomes/cnvgen.txt --sampleType=unrelated --outFile=~/bob_1000genomes/cnpbeagle_in --includeCNVGenotypesInOutput

##### this doesn't work because code isn't robust to two overlapping CNPs. Instead I will run it once for each CNP and then combine the datasets
bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tped --famFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tfam --cnvGenotypesFile=~/bob_1000genomes/cnvgen_CNP1.txt --sampleType=unrelated --outFile=~/bob_1000genomes/cnpbeagle1_in --includeCNVGenotypesInOutput

bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tped --famFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tfam --cnvGenotypesFile=~/bob_1000genomes/cnvgen_CNP2.txt --sampleType=unrelated --outFile=~/bob_1000genomes/cnpbeagle2_in --includeCNVGenotypesInOutput

###CNP1 still doesn't work. I'm guessing this is because it has cn=3 sometimes --- chainging to cn=2
bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tped --famFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tfam --cnvGenotypesFile=~/bob_1000genomes/cnvgen_CNP1_2.txt --sampleType=unrelated --outFile=~/bob_1000genomes/cnpbeagle1_in --includeCNVGenotypesInOutput
###this worked, so can't put CN=3 into input --- is this true for beagle as well???
###see if robust to two overlapping cnvs
bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tped --famFile=~/bob_1000genomes/OMNI_genotypes_bobindvt.tfam --cnvGenotypesFile=~/bob_1000genomes/cnvgen_CNP12_2.txt --sampleType=unrelated --outFile=~/bob_1000genomes/cnpbeagle3_in --includeCNVGenotypesInOutput
###it is - this worked
### will edit in CNP=3 by hand. with CNP=2, it gave each chromosome 1. For CNP=3, I will give one chromosome a 1 and the other a 2
#NA12707 and NA20524 are CN=5 and one of their "1"s was changed to a "2 ### also needed to change marker file

##################### BEAGLE ######################## stored in bioapps folder
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/jim_output/cnpbeagle3edit.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/jim_output/cnpbeagle3_in.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/jim_output/phased_17q21.31.bgl 


################## March 15th --- check confidence in bad phased individuals ##########
vcftools --vcf mapt_regions.genotypes.vcf --remove-filtered LowQual --positions positions.txt --extract-FORMAT-info CNQ
vcftools --vcf mapt_regions.genotypes.vcf --remove-filtered LowQual --positions positions.txt --extract-FORMAT-info CNL

--remove-filtered LowQual ####### this option allows me to remove those with LOD<1.3 (which is below the 95% confidence interval). The LOD is calculated by taking the best - second best likelihood (http://genome.cshlp.org/content/early/2010/07/19/gr.107524.110.full.pdf)

######### March 16 - re-do without below 95% CI, tell beagle which ones are trios, and get rid of asian pops #####################
#done in folder CI_trio_phasing
vcftools --vcf mapt_regions.genotypes.vcf --positions positions.txt --remove exclude_indvs.txt --extract-FORMAT-info CN
vcftools --vcf mapt_regions.genotypes.vcf --remove indvs.txt --positions positions.txt --extract-FORMAT-info CN

vcftools --vcf mapt_regions.genotypes.vcf --remove-indv HG00377 --remove-indv NA11892 --remove-indv NA20521 --remove-indv HG00096 --remove-indv HG00124 --remove-indv HG00156 --remove-indv HG00239 --remove-indv HG01168 --remove-indv HG01495 --remove-indv HG12748 --remove-indv NA19749 --remove-indv NA19786 --remove-indv HG00182 --positions positions.txt --extract-FORMAT-info CN


#separate trios and unrelated into different files
plink --file ONMNI_genotypes --keep bobCIindv.txt --recode --out bob_indv_all_geno #first keep all indvs that bob has
plink --file ONMNI_genotypes --keep bobCIindv.txt --make-bed --out bob_indv_all_geno #first keep all indvs that bob has

#pull out individuals that are in trios and make sure it goes parent, parent, child
plink --file bob_indv_all_geno --exclude myrange.txt --range --keep europeans.txt --recode --transpose --out europeans
plink --file bob_indv_all_geno --exclude myrange.txt --range  --remove asians.txt --recode --transpose --out no_asians

## use jim's program to put in copy number data
source configGAPAnalysisEnvironment.tcsh
source configGAPAnalysisEnvironment.bash

bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/europeans.tped --famFile=~/bob_1000genomes/europeans.tfam --cnvGenotypesFile=~/bob_1000genomes/cnv_gen_CI.txt --sampleType=unrelated --outFile=~/bob_1000genomes/euro_beagle_in --includeCNVGenotypesInOutput

bsub -o ~/bob_1000genomes/out /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=~/bob_1000genomes/no_asians.tped --famFile=~/bob_1000genomes/no_asians.tfam --cnvGenotypesFile=~/bob_1000genomes/cnv_gen_CI.txt --sampleType=unrelated --outFile=~/bob_1000genomes/noasians_beagle_in --includeCNVGenotypesInOutput

#### removed SNPs !!!! they had really bad call rate
rs9892359
SNP17-41421727
SNP17-42185593

### phase both files in beagle
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/euro_beagle_in.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/euro_beagle_in.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/euro_out.bgl 

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/noasians_beagle_in.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/noasians_beagle_in.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/beagle_in/noasians_out.bgl


##### March 18th
# it's strange that the files grouped by continent with poor quality indvs removed seems to be worse

allindvs_edit.bgl ---> this file has only 95% CI indvs. and 3 bad snps are removed

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/all_CI_edit/allindvs_edit.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/all_CI_edit/allindvs_edit.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/CI_trio_phasing/all_CI_edit/all_CI_phased.bgl


#### March 19th ######
Beagle does not add and subtract copy numbers 
The main problem I'm getting is the fact that H1dup is sometimes H1DD which doesn't show up when it is paired with H1ND. I can see H1DD when it is paired with H1D or with H2. In order to understand the haplotypes, I will change the copy numbers to make sense where I know the DD exists (with H1D and with H2). Then I will plot the haplotypes I'm sure about (everything except H1DH1D).
The H1DD_H1D are already changed (NA12707, NA20524)
I am changing HG01113, HG01465.1, NA20765 to DDs in allindvs_DDedit.bgl


java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/out
 
##################### March 20 finishing Mike's probe stuff ###############

cat McCarroll_Projects/nextgen_sequencing/March2011_solution_probes/17q21.31_transcripts.fa | awk '{print $0,"\t" length($0)}' > McCarroll_Projects/nextgen_sequencing/March2011_solution_probes/lengths.txt


############ March 22 using Tim's software to make bait set #############################
/seq/mczody/17_inv/capture
bothx2_break_xcrpt.masked.trf.fa
bothx2_break_xcrpt.masked.trf.sam

cp edit_bothx2_break_xcrpt.masked.trf.fa /humgen/cnp04/sandbox/lboettger/capture
cp edit2_bothx2_break_xcrpt.masked.trf.sam /humgen/cnp04/sandbox/lboettger/capture

#### first need to create sequence dictionary
#located here: /seq/software/picard/current/bin
bsub -N java -Xmx4g -jar CreateSequenceDictionary.jar R=/humgen/cnp04/sandbox/lboettger/capture/edit_bothx2_break_xcrpt.masked.trf.fa O=/seq/mczody/17_inv/capture/edit_bothx2_break_xcrpt.masked.trf.sam

####run tim's bait designer
bsub -N java -Xmx4g -jar ~tfennell/bin/BaitDesigner.jar T=edit2_bothx2_break_xcrpt.masked.trf.sam DESIGN_NAME=chr17_regional_capture R=edit_bothx2_break_xcrpt.masked.trf.fa LEFT_PRIMER=null RIGHT_PRIMER=null BAIT_OFFSET=60 POOL_SIZE=55000 FILL_POOLS=false DESIGN_ON_TARGET_STRAND=true MERGE_NEARBY_TARGETS=false


####### March 23 taking bigger region for phasing (H2 needs more help) ##################
#### taking all of chr17 so can make more adjustments later ###
vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 17 --plink --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/larger_region/ONMNI_genotypes_chr17

######## get only individuals that Bob has copy number info for & the region I want ##########
### new region: 43553711-44868430 ----> this is smaller than what I took before….?
./plink --map /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/larger_region/ONMNI_genotypes_chr17.map --ped /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/larger_region/ONMNI_genotypes_chr17.ped --keep /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/bobs_indvs.txt --from-bp 43411014XXX --to-bp 44884739XXXX --recode --tab --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/larger_region/OMNI_genotypes_bobindv

####pull out CN from Bob's vcf file#######
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/mapt_regions.genotypes.vcf --positions positions.txt --extract-FORMAT-info CN


###use Jim's scripts to remove duplication snps and put in dup markers#####
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs


########################### March 28th switch haplotypes to check if H1/H1d H2ND/H2D is resolved in terms of haplotypes ###################

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/hap_switch_test/switch_test.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/hap_switch_test/switch_test.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/hap_switch_test/out


####run tim's bait designer -- again ###################
bsub -N java -Xmx4g -jar ~tfennell/bin/BaitDesigner.jar T=edit2_bothx2_break_xcrpt.masked.trf.sam DESIGN_NAME=chr17_regional_capture R=edit_bothx2_break_xcrpt.masked.trf.fa LEFT_PRIMER=null RIGHT_PRIMER=null BAIT_OFFSET=60 POOL_SIZE=55000 FILL_POOLS=false DESIGN_ON_TARGET_STRAND=true MERGE_NEARBY_TARGETS=false

#################### April 4th, going through files 2 and 3 from the Montgomery data http://jungle.unige.ch/rnaseq_CEU60/ ##########################
bsub -N wget http://jungle.unige.ch/rnaseq_CEU60/fastq2_E-MTAB-197.tar.gz
tar -xzvf fastq2_E-MTAB-197.tar



########################## April 27th - testing imputation #########################
I'm starting with  DD_edit

### previous command
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.bgl markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/out


###### getting rid of these individuals because look like could be H1ND_H1DD
Potential H1ND_H1DD
HG01134
HG00151
HG01521
NA20534
NA20787

I took them out of out.allindvs_DDedit.bgl.phased and called it reference.bgl.phased

#### wrote script in R that randomly picks 9 individuals and saves there names to an excludecolumns file and makes a file for them without copy numbers
#### can't excludecolumns because will also exclude these from those you're imputing into!!!!!!!!!

#example of 1
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/toimpute/TI_1.bgl phased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/ref/REF_1.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.marker missing=-1 nsamples=10 niterations=15 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/out/out_1.txt

############## Unix loop #########################
for i in {1..100}
do
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/toimpute/TI_${i}.bgl phased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/ref/REF_${i}.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out/out/out_${i}.txt
done

#### This first round produced a 5% error rate. Most of the errors were H1D, where there should not have been. This could be the result of H1ND_H2DD individuals hiding out and seeding H1ND to look like H1D.

### I also want to try to impute all the H2ND to make sure this works
for i in {1..14}
do
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_out_H2ND/imp/imp_${i}.bgl phased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_out_H2ND/ref/ref_${i}.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/DD_edit/allindvs_DDedit.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_out_H2ND/out/out_${i}.txt
done


### all 15 of these work!!!!!!!! We should leave out NA20810 though, since it's strange

These have been removed as well:
oddballs in diploid:
NA19445   "LWK"      "1"       "0"  "0" 
NA19445.1 "LWK"      "1"       "0"  "1" ###  looks like true H1 whole length
NA20807   "TSI"      "2"       "1"  "0" ### end of both haplotypes is H1-like
NA20807.1 "TSI"      "1"       "0"  "0" 
NA20810   "TSI"      "2"       "0"  "0"  ### new problem, starts H2, ends H1-like
NA20810.1 "TSI"      "1"       "0"  "1"  ### looks like true H1 whole length
NA19223   "YRI"      "1"       "0"  "1"  ### looks like true H1 whole length
NA19223.1 "YRI"      "1"       "0"  "0"  ### looks like true H1 whole length

### changing all to diallelic markers to start in order to get genotype probe file… this will also be less confusing for double dups
/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/noDD_oddballs_removed_reference.bgl.phased.txt

##### running this again with diallelic snps to look at genotype probabilities & masking SNPs that are not in Affy 5.0 SNP chips
for i in {1..100}
do
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/toimpute/TI_${i}.bgl phased=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/ref/REF_${i}.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/allindvs_biallelic.marker excludemarkers=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/exclude_notinAffy5.txt missing=-1 out=/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/leave_some_out2/out/out_${i}.txt
done

############# getting AGRE data ###############
use dotkit
use Plink

bsub -N plink --bfile /fg/wgas5/projects/autism/091307/broad.jhu.combined --chr 17 --from-kb 40000 --to-kb 45000 --remove /fg/wgas5/projects/autism/091307/jhu.broad.removesamples.txt --make-bed --out /humgen/cnp04/sandbox/lboettger/autism/autism


plot(power[3,], power[2,], ylab="Percent Correct", xlab = "Percent Individuals")
plot(power[1,], power[3,], ylab="Percent Individuals Passing", xlab = "likelihood cutoff")


plink --bfile /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/autism --recode --tab --exclude /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/excludeSNPs.txt --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/
autism2



######################  convert autism2 plink files (these are in hg19) to beagle format ##########
ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/autism2.ped /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/autism2.map > /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/recomb_association/autism/autism2.bgl

############################# 5/5 impute copy number for agre trios ###############

java -Xmx1000m -jar beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/agre_trios_no0.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/out

LOTS of Mendelian inconsistencies……….. going back to PLINK to get rid of them and start again


##### checking HWE and mendelian errors ############ ---> only working with the 30 SNPs needed to impute
plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/autism/autism --mendel --extract /Users/lindaboettger/McCarroll_Projects/imputation/autism/impute_SNPs.txt --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtest2

plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/autism/autism --missing --extract /Users/lindaboettger/McCarroll_Projects/imputation/autism/impute_SNPs.txt --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtest


########## see what would be excluded 
plink --file mydata --me 0.05 0.1
plink --file mydata --hwe 0.001


plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/autism/autism --hwe 0.001 --me 0.05 0.1 --extract /Users/lindaboettger/McCarroll_Projects/imputation/autism/impute_SNPs.txt --recode --tab --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss

plink --file /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss --hardy --mendel --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/after_filter

########################## will use "autismtoss" ---> make bgl file and then put into trios and remove mendelian inconsistencies ####################
plink --file mydata --me 0.05 0.1 families more than 5% Mendel errors (considering all SNPs) and SNPs with more than 10% Mendel error rate will be excluded  will be disguarded
plink --file mydata --hwe 0.001 p <= 0.001

3 markers to be excluded based on HWE test ( p <= 0.001 )
3 families ( 13 individuals ) removed due to Mendel errors
43 Mendel errors detected in total

#### convert filtered file to .bgl
ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.map > /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.bgl
###### !!!!!!!!!!!!!!!!!! be careful that last two digits are left off bgl file !!!!!!!!!!!!!!!!!!

################ fixed mendelian inconsistencies and filtered for HWE #############

java -Xmx1000m -jar beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/agre_trios_MEND_HWedit.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_output/out_trio

######## genotype probabilities files only for unphased, unrelated data!!!!!!!!!!!!!!! ##########################
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/agre_trios_MEND_HWedit.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_output/out_unrel

######### converting .bgl to .ped to look at the quality of the OMNI dataset #############
./bgl_to_ped [beagle file] [fam file] > out.ped

./bgl_to_ped /Users/lindaboettger/McCarroll_Projects/imputation/OMNI/OMNI_refhaps_intersect.bgl /Users/lindaboettger/McCarroll_Projects/imputation/OMNI/OMNI.fam > /Users/lindaboettger/McCarroll_Projects/imputation/OMNI/OMNI.ped ---> this didn't work


plink --file /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes --hardy --mendel --keep /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/Europeans.txt --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/out


################################ 5/7/11 Doing imputation with all 30 SNPs and then comparing with trios ############################

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/agre_everyone_30SNPs.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_output/out_unrel_30SNPs

####### 5/8/11 All 30 SNPs on trios ####################
04C26615=T 04C26615=T 04C26614=T 04C26614=C 04C26616=C 04C26616=C -------> removed for mendeilan errors 

java -Xmx1000m -jar beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/agre_trios_30SNPs.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_output/out_trios_30SNPs

### get more mendel errors if don't also run with hardy!!!!!!!!!! ##################
plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/autism/autism --mendel --extract /Users/lindaboettger/McCarroll_Projects/imputation/autism/impute_SNPs.txt --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtest2

### full list here:
/Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/mendel_errors_tofix2.txt



######################## look at autism set with all individuals 5/16/11 ########################
use dotkit
use Plink

bsub -N plink --bfile /fg/wgas5/projects/autism/091307/broad.jhu.combined --chr 17 --from-kb 40000 --to-kb 45000 --make-bed --out /humgen/cnp04/sandbox/lboettger/autism/autism_all

######################  convert autism2 plink files (these are in hg19) to beagle format ##########
plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all --extract /Users/lindaboettger/McCarroll_Projects/imputation/autism/impute_SNPs.txt --recode --tab --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all

plink --map /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all.map --ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all.ped --hardy --out /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all_hardy

ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all.ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all.map > /Users/lindaboettger/McCarroll_Projects/imputation/autism/all_indvs/autism_all.bgl


################################ want to check if recombination phenotype is related to homozygosity of genome ( fewer het sites gives less power to detect recomb events  #############
use dotkit
use Plink
bsub -N plink --bfile /fg/wgas5/projects/autism/091307/broad.jhu.combined --het --out /humgen/cnp04/sandbox/lboettger/autism/heterozygosity 


######### get snps in linkage equilibrium ########### ---> other finished before I did this---
bsub -N plink --bfile /fg/wgas5/projects/autism/091307/broad.jhu.combined --indep 50 5 2 --extract --out /humgen/cnp04/sandbox/lboettger/autism/indep_autism

bsub -N plink --bfile /humgen/cnp04/sandbox/lboettger/autism/indep_autism --het --out /humgen/cnp04/sandbox/lboettger/autism/het_indp

############## May 20th got some hapmap 1000 genomes indivs to look at chinese KIAA1267
ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/data/


############ May 24th, chomping file for chinese individual chromosome 17 ##########
from here: ftp://public.genomics.org.cn/BGI/yanhuang/fa/

tr -d '\n' < chr17.fa > nonewline_chr17.fa

grep "CGCCATCGCAGCCAT" chr17.fa > chr16HGDPSNPs

GTGAGAGCGGGCGCCATCGCAGCCATTCAGCACAGAGAGACAGGAAGTCCAGCCTCTCCC
head -693423 chr17.fa|tail -1
GTGAGAGCGGGCGCCATCGCAGCCATTCAGCACAGAGAGACAGGAAGTCCAGCCTCTCCC

Stop Codon:
grep -n "TCATCTGTGAGTCGGGCGCT" chr17.fa
691080:TCTCCCGCTCATCTGTGAGTCGGGCGCTGAGCTGTGGCTGCTGCCACCAGATGCCGACTC

#################### FHS data ######################################

use dotkit
use Plink

bsub -N plink --bfile /fg/fhs_jhs/pipeline/projects/bybatch/markers/gwas/gwas.initial --chr 17 --from-kb 40000 --to-kb 45000 --make-bed --out /humgen/cnp04/sandbox/lboettger/FHS/FHS_initial

bsub -N plink --bfile /fg/fhs_jhs/pipeline/projects/bybatch/bybatch.all.marker --chr 17 --from-kb 40000 --to-kb 45000 --make-bed --out /humgen/cnp04/sandbox/lboettger/FHS/FHS_marker


plink --bfile /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_initial --extract /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_common_SNPs.txt --recode --tab --out /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_impute_SNPs

ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_impute_SNPs_hg18.ped /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_impute_SNPs_hg18.map > /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_hg18.bgl


##################### impute FHS #############

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_fixed.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/FHS_imputation_output/FHS_out

###remove the first line from the input file ###
awk 'FNR>1' myfile1 myfile2

############ impute again with names that start with FH
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_fixed_newnames.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/FHS_imputation_output/FHS_out_nn2


########################### impute into whole FHS dataset with all SNPS ###########
ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_initial.ped /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_initial.map > /Users/lindaboettger/McCarroll_Projects/imputation/FHS/initial_hg19.bgl


java -Xmx2g -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_allsnp.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_initial_hg19forOMNI.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/FHS_imputation_output/FHSallsnps_out ---> too big

java -Xmx2g -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_allsnpsm.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_initial_hg19forOMNIsm.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/FHS_imputation_output/FHSallsnps_out


./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_initial.ped /Users/lindaboettger/McCarroll_Projects/imputation/FHS/FHS_initial.map > /Users/lindaboettger/McCarroll_Projects/imputation/FHS/initial_hg19.bgl

java -Xmx2g -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_allsnpsm.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_refhaps_intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/FHS_initial_hg19forOMNIsm.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/FHS_imputation_output/FHSallsnps_out2
---------------> when a lot of SNPs are included very few duplications are called...



########################### June 9 2011 - getting 1000 genomes snp calls from low coverage data ###################
- I want to have these SNPs for my reference panel and then impute into Affy 5.0
where I got the SNPs: ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20101123/interim_phase1_release/   ----> I put this in my folder at the broad

the region I'm taking (in hg18): 40431219 - 42810669

the region I'm taking (in hg19): 43075693 - 45455670

#### Get my region and convert from vcf to beagle genotype likelihoods
This option requires the VCF file to contain the FORMAT GL tag, which can generally be output by SNP callers such as the GATK"  "The resulting output file (with the suffix '.BEAGLE.GL') contains genotype likelihoods for biallelic sites, and is suitable for input into BEAGLE via the 'like=' argument."


use VCFtools
bsub -N ~/bin/vcftools --vcf ALL.wgs.phase1.projectConsensus.snps.sites.vcf --chr 17 --from-bp 43075693 --to-bp 45455670 --BEAGLE-GL --out tg_geno_like #(I need GL but I have PL)
PL : the phred-scaled genotype likelihoods rounded to the closest integer (and otherwise defined precisely as the GL field) (Integers)

I"m going to replace the PL with GL
bsub -N sed 's/FORMAT=<ID=PL/FORMAT=<ID=GL/' ALL.wgs.phase1.projectConsensus.snps.sites.vcf > ALL.wgs.phase1.projectConsensus.snps.sites.GL.vcf  # sed is not on broad server…?

And installed newer version of VCFtools….
for some reason it won't add to my path so will use this command: ~/bin/vcftools



/gap/esp/ESP_cohorts/FHS/Framingham_NPU/Framingham_V13/phs000342v1/p5/genotype/phg000006v5

/gap/esp/ESP_cohorts/FHS/Framingham_GRU/Framingham_V13/phs000342v1/p5/genotype/phg000006v5



################### june 16 - looking at perlegen dataset ####################
#located at broad 
#genotype calls:
seq/mczody/perlegen/Volumes/Oct 16 2009/AFD_Data/Genotypes

I'm looking at the haplotypes, which I presume to be phased data
/seq/mczody/perlegen/Volumes/Oct 16 2009/AFD_Data/Haplotypes


/humgen/cnp04/sandbox/lboettger/perlegen

---> perlegen data is in hg16


################### June 19 2011 --- getting phased 1000 genomes snps to use as reference panel for imputation #######
-used baylor calls 
-saved at broad   /humgen/cnp04/sandbox/lboettger/tgp_snps/
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/working/20110512_wg_VQSRv2_GL_beagle_genotypes/ALL.chr17.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf.gz

--geno Exclude sites on the basis of the proportion of missing data (defined to be between 0 and 1).

### this was the final command used
bsub -N -q week ./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tgp_snps/ALL.chr17.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf --chr 17 --positions /humgen/cnp04/sandbox/lboettger/tgp_snps/positions_hg19.txt --keep /humgen/cnp04/sandbox/lboettger/tgp_snps/keep_indvs.txt --min-alleles 2 --max-alleles 2 --BEAGLE-GL --plink-tped --out /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_affy5intersect.vcf

Errors:
TERM_RUNLIMIT: job killed after reaching LSF run time limit.
RUNLIMIT: Cannot exceed queue's hard limit(s). Job not submitted.

using LSF info:
https://iwww.broadinstitute.org/informatics/docs/lsf6.2/pdf/lsf6.2_using.pdf
queue info: https://iwww.broadinstitute.org/informatics/docs/lsf4.2/admin_4.2/B_display14.html#39145

I used the week queue to give the job a greater runtime bsub -N -q week
vcftools
--positions <filename>

Include a set of sites on the basis of a list of positions. Each line of the input file should contain a (tab-separated) chromosome and position. The file should have a header line. Sites not included in the list are excluded.


######### then use jim's program to get into beagle format with CNVs, bialleleic
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.tcsh
source configGAPAnalysisEnvironment.bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs

Options:
  -h, --help            show this help message and exit
  --snpGenotypesFile=SNPGENOTYPESFILE
                        (Required) A tped file from plink.
  --famFile=FAMFILE     (Required) A tfam file from plink.
  --cnvGenotypesFile=CNVGENOTYPESFILE
                        (Optional) A file of CNV genotypes.  The format is
                        (NAxxxx are sample IDs)                       CNP
                        CHR    START    END    NA06986    NA06994
                        CNP1    1      10      100        2         1
  --sampleType=SAMPLETYPE
                        (Required) What sort of samples are in the fam file?
                        Needed                       to organize the bgl
                        output file correctly for phasing.  Choices:
                        [trio] [pair] [unrelated]
  --topSet              Take the first part of the samples submitted.  Goes
                        with pctSamples to allow                       one to
                        sample some pct of samples from either the beginning
                        or end of the list of valid samples
                        for analysis. Defaults to False unless selected.  This
                        will have no effect unless pctSamples is set to less
                        than 100 (it's default)
  --pctSamples=PCTSAMPLES
                        Take only part of the samples from the submitted set.
                        Goes with the topset flag to allow one to sample some
                        pct of samples from either the beginning or end of the
                        list of valid samplesfor analysis. Defaults to all
                        samples
  --outFile=OUTFILE     Where to put output results.  Three outputs will be
                        created, .bgl, .sample. and .marker
  --cnvFreqToExcludeSNP=CNVFREQTOEXCLUDE
                        If set, excludes SNPs from beagle input that overlap
                        CNVs above this frequency threshold.
                        Defaults to all SNPs being excluded (0% frequency).
                        Requires cnvGenotypesFile parameter to be set
  --includeCNVGenotypesInOutput
                        If this flag is set, include the CNV genotypes and
                        markers in the beagle input file.
                        Requires cnvGenotypesFile parameter to be set.


###### actually should get rid of c68/complex region first so it doesn't mess up analysis##################
# 41731776-42139847 #hg18
# chr17:44375999-44784664 #hg19
bsub -N plink --tfile /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_affy5intersect.vcf --exclude /humgen/cnp04/sandbox/lboettger/tgp_snps/c68range.txt --range --recode --transpose --out /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_affy5intersect.noc68
----> turned out no SNPs in this region anyway


### command used to convert to beagle with CNP
bsub -N /fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_affy5intersect.noc68.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_affy5intersect.noc68.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/cnvgen_CNP12_biallelic.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/tgp_affy5intersect --includeCNVGenotypesInOutput




########### looking at LD in perlegen data ###################
plink --file /Users/lindaboettger/McCarroll_Projects/Perlegen/perlegen_myreg --r2 --ld-snp afd3283075 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/Perlegen/perlegen_myreg_perfectld

########### this might be helpful in correcting strand issues
convert_bim_allele.pl




############### june 21 phase 1000 genomes low coverage SNPs ########################
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 like=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/my_region_affy5intersect.vcf.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing/tpg_affy5intersect
-----> works without likelihoods file, maybe because CNPs are not included

### this includes likelihoods for CNPs
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 like=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/likelihoods/my_region_affy5intersect.addCNP.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing/tpg_affy5intersect



######### June 23 ---> the beagle command was run again excluding the individuals previously deemed to be poorly imputed (ie H1ND stuck with H1DD)
excludecolumns=<excluded columns file> where <excluded columns file> is the name of file containing column identifiers (one identifier per line) that will be excluded from the analysis and output files. Beagle will check the column identifiers in the first sample identifier line (I ...) of each Beagle input file and exclude any columns whose identifier is in the excluded samples file.

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 excludecolumns=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/indvs_to_exclude.txt like=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/likelihoods/my_region_affy5intersect.addCNP.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing/tpg_affy5intersect_filtered

#### command used to do phasing in loop##############
for i in {3..1807}
do
	out=$(( $i % 2 ))
	if [ $out -eq 0 ] #if the number is even
	then
		next
	else
	java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/testing/to_impute/TI_${i}.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/testing/ref/REF_${i}.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/testing/out/out_${i}.txt
done

### seems like none of them is wrong???!!!


##################
#doing it again without genotype likelihoods to see what happens
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 excludecolumns=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/indvs_to_exclude.txt out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing_noGL/tpg_affy5intersect_filtered_noGL


######## June 26 --> the beagle command was run again excluding the individuals previously deemed to be poorly imputed (ie H1ND stuck with H1DD) &&& excluded another 3 individuals who seem to have odd haplotypes:
HG00119
NA12342
NA20513

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 excludecolumns=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/indvs_to_exclude.txt like=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/likelihoods/my_region_affy5intersect.addCNP.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing/tpg_affy5intersect_filtered

### also without genotype likelihoods
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/tgp_affy5intersect.marker missing=-1 excludecolumns=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/indvs_to_exclude.txt out=/Users/lindaboettger/McCarroll_Projects/imputation/tg_SNPs/phasing_noGL/tpg_affy5intersect_filtered_noGL


######### bob's c68 genotypes
vcftools --vcf regions_c68_m2.genotypes.vcf --remove-indv NA11933 --remove-indv NA12718 --remove-indv NA18599 --remove-indv NA18619 --remove-indv NA19002 --remove-indv NA19081 --remove-indv NA19087 --remove-indv NA19223 --remove-indv NA19429 --remove-indv NA19431 --remove-indv NA19449 --remove-indv NA19455 --remove-indv NA19466 --remove-indv NA19468 --remove-indv NA19470 --remove-indv NA19720 --remove-indv NA19908  --extract-FORMAT-info CN

vcftools --vcf regions_c68_m2.genotypes.vcf --extract-FORMAT-info CN

############
Getting the read length from a SAM file
len=`zcat $NA10861_region.sam|grep chr1|head -1|cut -f10|wc -c`        
let len=($len-1)      
echo "len= ${len}"


http://samtools.sourceforge.net/samtools.shtml
idxstats	 samtools idxstats <aln.bam>
Retrieve and print stats in the index file. The output is TAB delimited with each line consisting of reference sequence name, sequence length, # mapped reads and # unmapped reads.


use Samtools
bsub -N samtools idxstats NA10861_region.sorted.bam

awk '{print $6}' NA10861_region.sam

average read length:
samtools view NA10861_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '

samtools view NA10861_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.8766756757951

samtools view NA11993_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.5691662902173
samtools view NA12249_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.6334463911364
samtools view NA12707_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.8060684681371
samtools view NA20589_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.6787857721076
samtools view NA20806_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.6552761419157
samtools view NA20871_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.7087491574805

samtools view NA20890_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.7826167620233
samtools view NA21339_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.1850026072931

samtools view NA21685_region.sorted.bam | cut -f 10 | perl -e 'while (<>) {$sum += length($_)."\n"; $c++;} print $sum / $c . "\n"; '
74.7162464963226

it turns out we ordered paired end 72 cycles but the quality dropped off at cycle 76

The difference in read lengths has nothing to do with alignment score but is instead due to the fact that the quality scores at the 5' ends of some reads were low and so these bases were removed. 

The reads are of different length because I got rid of low quality bases at the ends of some reads.  Thee quality string for the bases at the ends of these reads are "B", also known as a quality score of 'Q2'.  From the Illumina manual: "This Q2 indicator does not predict a specific error rate, but rather indicates that a specific final portion of the read should not be used in further analyses".


########## July 23rd 2011 #################
### I want to find clean SNPs to call H1/H2 and combine this with bob's CN data and the QuantaLife data 

### this file contains omni SNP genotypes for the individuals bob has copy number info for. It also only contains the region of the inversion
/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/OMNI_genotypes_bobindv
… this was made sometime back in March


I will pull out everything that is in perfect LD across the region throughout all populations… then I will verify that these SNPs have a minor allele frequency of 20% in CEU.

New folder called /Users/lindaboettger/McCarroll_Projects/1kg_haplotypes

From here:
/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes
cp OMNI_genotypes_bobindv.ped /Users/lindaboettger/McCarroll_Projects/1kg_haplotypes


plink --map OMNI_genotypes_bobindv.map --ped OMNI_genotypes_bobindv.ped --make-bed --out OMNI_genotypes_bobindv

plink --bfile OMNI_genotypes_bobindv --blocks --ld-window-kb 1000 --out OMNI_LD_blocks ---> this found no blocks!!! …?


#Look for SNPs in LD with rs17334797, rs12185233, rs17577094 (known tagging SNPs from HapMap) rs17660464--> used to tag HM3

plink --bfile OMNI_genotypes_bobindv --r2 --ld-snp rs17660464 --ld-window-r2 .9 --ld-window 99999 --ld-window-kb 10000 --out OMNI_r9

####need phenotype to work
perl -nle 's/(NA\d+\tNA\d+\t0\t0)\t0\t-9/$1\t1\t1/; print;' OMNI_genotypes_bobindv.ped > OMNI_genotypes_bobindv_phen.ped

perl -nle 's/(HG\d+\tHG\d+\t0\t0)\t0\t-9/$1\t1\t1/; print;' OMNI_genotypes_bobindv_phen.ped > OMNI_genotypes_bobindv_phen2.ped


plink --map OMNI_genotypes_bobindv.map --ped OMNI_genotypes_bobindv_phen2.ped --make-bed --out OMNI_genotypes_bobindv

plink --map OMNI_genotypes_bobindv.map --ped OMNI_genotypes_bobindv_phen2.ped --ld-window-kb 1000 --blocks --out OMNI_LD_blocks

#### try next
plink --map OMNI_genotypes_bobindv.map --ped OMNI_genotypes_bobindv_phen2.ped --r2 --ld-window-r2 .99 --ld-snp rs17660464 --ld-window 99999 --ld-window-kb 1000 --out omni_LD_99new
---> OMNI haplotype calling SNPs

############### FASTX ###################
http://hannonlab.cshl.edu/fastx_toolkit/index.html
---> would have used, but need barcode on every read


######### interactive bsub ###########
screen
bsub -Is -q week bash      **** (use this -q week for long jobs)

bsub -Is bash
exit: to leave

to leave screen control a control d

screen -dr will list the screens or if only one, will go to that screen
screen -dr followed by the number of the screen will take you to that screen 


I used the week queue to give the job a greater runtime: bsub -o -q week perl fastqSort_notrim_Dec2010.pl s_1_1_sequence.txt.gz.Z s_1_2_sequence.txt.gz.Z

Run complete. 98473404 lines per file. 24618350 reads processed.
JUNK:   1946301.
NA10861_1n1n:   4605563.
NA11993_1d1d:   446465.
NA12249_1n1n:   1416865.
NA12707_1d1d:   3931680.
NA20589_2n2n:   1939972.
NA20806_2d2d:   1490503.
NA20871_1d2d:   1418880.
NA20890_2d2d:   1535559.
NA21339_1n2n:   2242282.
NA21685_1n1n:   3644280.


Run complete. 98473404 lines per file. 24618350 reads processed.
JUNK:   1946301.
NA10861_1n1n:   4605563.
NA11993_1d1d:   446465.
NA12249_1n1n:   1416865.
NA12707_1d1d:   3931680.
NA20589_2n2n:   1939972.
NA20806_2d2d:   1490503.
NA20871_1d2d:   1418880.
NA20890_2d2d:   1535559.
NA21339_1n2n:   2242282.
NA21685_1n1n:   3644280.

############ move fastqSplit.pl to broad server ############
scp -r fastqSplit.pl boettger@copper.broadinstitute.org:/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31

#################################### split fastq into 2 different files #####################
cd sortedpairs
FILES=`ls *sortedpairs.txt`
cd ..

for f in $FILES
do
  echo "splitting $f"
  perl fastqSplit.pl sortedpairs/$f split_fastq/${f}_1.fastq split_fastq/${f}_2.fastq
done 
############################################################################################################
### needed newer version of bwa than broad had
wget http://sourceforge.net/projects/bio-bwa/files/bwa-0.5.9.tar.bz2/download
tar xvjf bwa-0.5.9.tar.bz2

use BWA

cd split_fastq
FILES=`ls *fastq`
cd ..

for f in $FILES
do
  echo "aligning $f"
  bwa-0.5.9/bwa aln -I /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta split_fastq/$f > align/$f.sai
done 

# -I info ############################################################################################################

###!!!!!!!!!! need to change from 64 byte offset to 33
http://seqanswers.com/forums/showthread.php?t=11986

-I	 The input is in the Illumina 1.3+ read format (quality equals ASCII-64).

bwa aln -I -l 32 -t 4 $GENOME fooR1.fastq > fooR1.sai 
bwa aln -I -l 32 -t 4 $GENOME fooR2.fastq > fooR2.sai 

####### adding read group info#####
ode:
./bwa sampe

-------> this is a patch from the broad (not sure if I need it)
Usage:   bwa sampe [options] <prefix> <in1.sai> <in2.sai> <in1.fq> <in2.fq>

Options: -a INT   maximum insert size [500]
         -o INT   maximum occurrences for one end [100000]
         -n INT   maximum hits to output for paired reads [3]
         -N INT   maximum hits to output for discordant pairs [10]
         -c FLOAT prior of chimeric rate (lower bound) [1.0e-05]
         -f FILE sam file to output results to [stdout]

         -P       preload index into memory (for base-space reads only)
         -s       disable Smith-Waterman for the unmapped mate
         -A       disable insert size estimate (force -s)

         -i       read group identifier (ID)
         -m       read group sample (SM), required if ID is given
         -l       read group library (LB)
         -p       read group platform (PL)
Notes: 1. For SOLiD reads, <in1.fq> corresponds R3 reads and <in2.fq> to F3.
       2. For reads shorter than 30bp, applying a smaller -o is recommended to
          to get a sensible speed at the cost of pairing accuracy.
the -i, -m, -l and -p options are the ticket!

There is a -r option where you can pass the RG information to bwa sampe, but
my problem is that you can only do that for one read group.
------
I tried: bwa sampe -r <string> -r <string> -r <string> ... , but bwa only
takes the first -r and ignores the rest.
------

##### this is what I have
bwa sampe [options] <prefix> <in1.sai> <in2.sai> <in1.fq> <in2.fq>

Options: -a INT   maximum insert size [500]
         -o INT   maximum occurrences for one end [100000]
         -n INT   maximum hits to output for paired reads [3]
         -N INT   maximum hits to output for discordant pairs [10]
         -c FLOAT prior of chimeric rate (lower bound) [1.0e-05]
         -f FILE  sam file to output results to [stdout]
         -r STR   read group header line such as `@RG\tID:foo\tSM:bar' [null]
         -P       preload index into memory (for base-space reads only)
         -s       disable Smith-Waterman for the unmapped mate
         -A       disable insert size estimate (force -s)

Notes: 1. For SOLiD reads, <in1.fq> corresponds R3 reads and <in2.fq> to F3.
       2. For reads shorter than 30bp, applying a smaller -o is recommended to
          to get a sensible speed at the cost of pairing accuracy.
------
Is this one lane of sequencing?
If so, then it seems like we could do one read group per sample.

I think we have two questions for you regarding alignments (Linda was taking notes and may remember more, plus some non-alignment questions).
1. Do you have a properly formatted sam header for /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta.fai that we can merge in with Picard?

/seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.dict -----

Everything is there, including the bwa indexes already built, so you can just run bwa.

2. What information do you need in the read group? That can be added in the sampe phase, but there are apparently two components, ID and SM, and we don't know how they're used and whether they need to mean anything other than being unique within the data set.
We should generate our own read group IDs, and mnemonic is probably good, unique is very helpful.
Typically it's the lane identifier, but for us maybe Run1_<sample> or something.

Besides generating the IDs, which go on each record, we should add the following tags to the @RG record in the header:
PL:ILLUMINA LB:Lib1 SM:<sample>
Sample should be the NAxxxxx identifier.
It's good to have the library identifier in case we want to merge these bams together with other data later.
It tells us that all of these reads came from the same library, will have a common fragment size distribution, etc.

I'm guessing that sampe will put the RGID on each record for us, but if not we need to figure out how to do it.
And post-bwa it would be good to run the picard fixup module to clean up various illegal records bwa generates.

problems:
In this case, the headers are incomplete, the @HD record is not present, there is no read group or library information,
no sample information. And there are no RG tags on the reads to refer to the header information.

Also the @SQ tags in the header do not match the standard Broad hg19 reference.
What reference were these aligned against?


------
we should add the following tags to the @RG record in the header:
PL:ILLUMINA LB:Lib1 SM:<sample>
-r STR   read group header line such as `@RG\tID:foo\tSM:bar' [null]

This is what I need to add:
-r STR   read group header line such as `@RG\tID:Run1_NA…\tPL:ILLUMINA\tLB:Lib1\tSM:NA…' [null]


######## trying one first all the way through to see if it works ################
these are the smallest .sai files:
NA11993_1d1d.sortedpairs.txt_2.fastq.sai
NA11993_1d1d.sortedpairs.txt_1.fastq.sai
names changed to this: NA11993_1d1d_1.sai NA11993_1d1d_2.sai

fastqnames: NA11993_1d1d.sortedpairs.txt_1.fastq NA11993_1d1d.sortedpairs.txt_2.fastq

#command to make sam file and add in RG info:
./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../align/NA11993_1d1d_1.sai ../align/NA11993_1d1d_2.sai ../split_fastq/NA11993_1d1d.sortedpairs.txt_1.fastq ../split_fastq/NA11993_1d1d.sortedpairs.txt_2.fastq > ../align/NA11993_aln.sam



######### how can I tell if it has RG info???#######
http://www.broadinstitute.org/gsa/wiki/index.php/Frequently_Asked_Questions#How_can_I_tell_if_my_BAM_file_has_read_group_and_sample_information.3F

use Samtools
### turn into bam
samtools view -bS NA11993_aln.sam > NA11993_aln.bam

######## look for @RG in the header
samtools view -H NA11993_aln.bam | grep '^@RG'

$ @RG     ID:Run1_NA11993 LB:Lib1 SM:NA11993

###### look for @RG on each record 
samtools view NA11993_aln.bam | grep '^@RG'
---> nothing found
### actually should be this: 
samtools view NA11993_aln.bam | grep 'RG:Z'

---> looks like they are present in each line as well

now doing the rest of the commands:
samtools sort NA11993_aln.bam NA11993_aln.sorted
samtools index NA11993_aln.sorted.bam


now I need to:
run the picard bwa fixup module
run Picard mark duplicates

And post-bwa it would be good to run the picard fixup module to clean up various illegal records bwa generates.

CleanSam ---> this is probably the mixup module that was discussed

USAGE: CleanSam [options]

Read SAM and perform various fix-ups. Currently, the only fix-up it to soft-clip an alignment that hangs off the end of its reference sequence.

Option	Description
INPUT=File	Input SAM to be cleaned. Required.
OUTPUT=File	Where to write cleaned SAM. Required.

wget http://sourceforge.net/projects/picard/files/picard-tools/1.48/picard-tools-1.48.zip/download

### my clean-up ---> this can only be done in SAM files
picard-tools COMMAND [OPTION]
picard-tools CleanSam INPUT=NA11993_aln.sam OUTPUT=NA11993_clean_aln.sam


java -jar CleanSam.jar INPUT=../align/NA11993_aln.sam OUTPUT=../align/NA11993_clean_aln.sam


############# re-make bam affle from this#######
samtools view -bS NA11993_clean_aln.sam > NA11993_clean_aln.bam
## check RG
samtools view -H NA11993_clean_aln.bam | grep '^@RG'
samtools view NA11993_clean_aln.bam | grep 'RG:Z'

samtools sort NA11993_clean_aln.bam NA11993_clean_aln.sorted
samtools index NA11993_clean_aln.sorted.bam

############# use Picard Mark Duplicates #######
java -jar MarkDuplicates.jar INPUT=../align/NA11993_clean_aln.sorted.bam OUTPUT=../align/NA11993_clean_aln_mkdup.sorted.bam METRICS_FILE=../align/NA11993_markdup_metrics

-----> I get the error that "NA11993_clean_aln.sorted.bam is not coordinate sorted"

http://seqanswers.com/forums/archive/index.php/t-5494.html
"this is samtools' fault. The SAM specification lists a header (HD) tag for sort order (SO). The three permissible values for this tag are "unsorted", "coordinate", indicating that the entries have been sorted by chromosome and start position, and "queryname", meaning the file is sorted by the read IDs. When you sort the file with samtools it does not update the SO tag to reflect the fact the file has been sorted. According to the author of samtools, the SAM specification does not require this so it is not a bug (see this thread (http://seqanswers.com/forums/showthread.php?t=3739)). Perhaps not but it's damned annoying.

You can view the header information for your bam file with the command
samtools view -H test_sorted.bam
Picard reads the SO tag to determine whether or not the file is sorted. This is obviously much easier and more efficient than actually checking every line of the file to determine whether or not it has been sorted.

Before you can use Picard to remove duplicates you will have to fix the SO tag. Fourtunately Picard has a command to this, ReplaceSamHeader. Alternatively you could use the Picard SortSam instead of the samtools sort (For the record I don't know for sure if Picard SortSam properly 
updates the SO tag.)"

 because samtools does not update the SO tag to reflect the fact the file has been sorted, but Picard reads the SO tag to determine whether or not the file is sorted
######### I will use Picard SortSam instead of the one in bwa ######
samtools sort NA11993_clean_aln.bam NA11993_clean_aln.sorted.bam

java -jar SortSam.jar INPUT=../align/NA11993_clean_aln.bam OUTPUT=../align/NA11993_clean_aln.sorted.bam SORT_ORDER=coordinate

############# use Picard Mark Duplicates #######
java -jar MarkDuplicates.jar INPUT=../align/NA11993_clean_aln.sorted.bam OUTPUT=../align/NA11993_clean_aln_mkdup.sorted.bam METRICS_FILE=../align/NA11993_markdup_metrics

samtools index NA11993_clean_aln_mkdup.sorted.bam

########################### DONE !!!!! ####################################
./bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../split_fastq/NA11993_1d1d.sortedpairs.txt_1.fastq > ../align/NA11993_new_1.sai


./bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../split_fastq/NA11993_1d1d.sortedpairs.txt_2.fastq > ../align/NA11993_new_2.sai

./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../align/NA11993_new_1.sai ../align/NA11993_new_2.sai ../split_fastq/NA11993_1d1d.sortedpairs.txt_1.fastq ../split_fastq/NA11993_1d1d.sortedpairs.txt_2.fastq > ../align/NA11993_new_aln.sam


samtools view -bS NA11993_new_aln.sam > NA11993_new_aln.bam


#### check read groups:
samtools view -H NA11993_new_aln.bam | grep '^@RG'

samtools view NA11993_new_aln.bam | grep 'RG:Z'

java -jar CleanSam.jar INPUT=../align/NA11993_new_aln.bam OUTPUT=../align/NA11993_new_clean_aln.bam ---> errors
Ignoring SAM validation error: ERROR: Record 892609, Read name HWI-EAS00214_0041_FC00211:1:100:5116:20667#0, CIGAR should have zero elements for unmapped read.
java -jar ValidateSamFile.jar INPUT=../align/NA11993_new_clean_aln.bam
errors: Mate negative strand flag does not match read negative strand flag of mate
CIGAR should have zero elements for unmapped read

#### had to add this in order to proceed ---------------
VALIDATION_STRINGENCY=LENIENT

java -jar SortSam.jar INPUT=../align/NA11993_new_clean_aln.bam OUTPUT=../align/NA11993_new_clean_aln.sorted.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT

java -jar MarkDuplicates.jar INPUT=../align/NA11993_new_clean_aln.sorted.bam OUTPUT=../align/NA11993_new_clean_aln_mkdup.sorted.bam METRICS_FILE=../align/NA11993_new_markdup_metrics VALIDATION_STRINGENCY=LENIENT

samtools index NA11993_new_clean_aln_mkdup.sorted.bam

####################### RE-DO OF ALL SAMPLES WITH MASKING UNMAPPED BP ###############
./bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../split_fastq/NA11993_1d1d.sortedpairs.txt_1.fastq > ../align/NA11993_new_1.sai

cd split_fastq
FILES=`ls *fastq`
cd ..

for f in $FILES
do
  echo "aligning $f"
  bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta split_fastq/$f > new_align/$f.sai
done 


######################## July 28th 2011 ###########
##### need to get rid of 3' adaptor/barcode sequence 
fastx_clipper
version 0.0.6
	   [-h]         = This helpful help screen.
	   [-a ADAPTER] = ADAPTER string. default is CCTTAAGG (dummy adapter).
	   [-l N]       = discard sequences shorter than N nucleotides. default is 5.
	   [-d N]       = Keep the adapter and N bases after it.
			  (using '-d 0' is the same as not using '-d' at all. which is the default).
	   [-c]         = Discard non-clipped sequences (i.e. - keep only sequences which contained the adapter).
	   [-C]         = Discard clipped sequences (i.e. - keep only sequences which did not contained the adapter).
	   [-k]         = Report Adapter-Only sequences.
	   [-n]         = keep sequences with unknown (N) nucleotides. default is to discard such sequences.
	   [-v]         = Verbose - report number of sequences.
			  If [-o] is specified,  report will be printed to STDOUT.
			  If [-o] is not specified (and output goes to STDOUT),
			  report will be printed to STDERR.
	   [-z]         = Compress output with GZIP.
	   [-D]		= DEBUG output.
	   [-i INFILE]  = FASTA/Q input file. default is STDIN.
	   [-o OUTFILE] = FASTA/Q output file. default is STDOUT.

### must run adaptor sequence with the barcode first, and then the sequence without the barcode
fastx_clipper -a (adaptor string) -n -i (infile) -o (outfile)

testing:
WITHOUT BARCODE:
AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG *** correct
WITHBARCIDE:
BARCODE-AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT

WITH BARCODE:
NA11993
TTGTGA
TTGTGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT *** correct

./fastx_clipper -a NN -n -i /Users/lindaboettger/Desktop/test_sortedpairs.txt -o /Users/lindaboettger/Desktop/test_sortedpairs_trim.txt

./fastx_clipper -a TTACTATGCCGCTGGTGGCTCTAGATGTGAGAAAGGGATGTGCTGCGAGAAGGCTAGATTGTGA*** wrong orientatin -n -i /Users/lindaboettger/Desktop/test_sortedpairs.txt -o /Users/lindaboettger/Desktop/test_sortedpairs_trim.txt

maybe this? FastqMcf
btrim might work, but couldn't get it installed
http://graphics.med.yale.edu/trim/
./Btrim64 -t /Users/lindaboettger/Desktop/test_sortedpairs.txt -o /Users/lindaboettger/Desktop/test_sortedpairs_trim.txt  

############################ sort again and trim N's off end
perl fastqSort_clipN_Dec2010.pl s_1_1_sequence.txt.gz.Z s_1_2_sequence.txt.gz.Z

Run complete. 98473404 lines per file. 24618350 reads processed.
JUNK:   1946301.
NA10861_1n1n:   4605563.
NA11993_1d1d:   446465.
NA12249_1n1n:   1416865.
NA12707_1d1d:   3931680.
NA20589_2n2n:   1939972.
NA20806_2d2d:   1490503.
NA20871_1d2d:   1418880.
NA20890_2d2d:   1535559.
NA21339_1n2n:   2242282.
NA21685_1n1n:   3644280.

###broad's it blog
https://it.broadinstitute.org/blog/

########### use fasts to trim off the 3'barcodes and adaptor
### for NA11993
fastx_clipper -a TTGTGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -l 20 -n -i NA11993_1d1d.sortedpairs.txt -o NA11993_1d1d.sortedpairs_trim.txt

fastx_clipper -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -l 20 -n -i NA11993_1d1d.sortedpairs_trim.txt -o NA11993_1d1d.sortedpairs_trim2.txt

perl fastqSplit.pl new_sortedpairs/NA11993_1d1d.sortedpairs_trim2.txt new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq

#### align
./bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq > ../new_align/NA11993_1.sai


./bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > ../new_align/NA11993_2.sai


### make sample and put in  RG
./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../new_align/NA11993_1.sai ../new_align/NA11993_2.sai ../new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq ../new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > ../new_align/NA11993_new_aln.sam

### make bam
samtools view -bS NA11993_new_aln.sam > NA11993_new_aln.bam

#### check read groups:
samtools view -H NA11993_new_aln.bam | grep '^@RG'
samtools view NA11993_new_aln.bam | grep 'RG:Z'


### Picard -  clean Sam
java -jar CleanSam.jar INPUT=../new_align/NA11993_new_aln.bam OUTPUT=../new_align/NA11993_new_clean_aln.bam

### sort
java -jar SortSam.jar INPUT=../new_align/NA11993_new_clean_aln.bam OUTPUT=../new_align/NA11993_new_clean_aln.sorted.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT

## mark dups
java -jar MarkDuplicates.jar INPUT=../new_align/NA11993_new_clean_aln.sorted.bam OUTPUT=../new_align/NA11993_new_clean_aln_mrkdup.sorted.bam METRICS_FILE=../new_align/NA11993_new_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT








samtools index NA11993_new_clean_aln_mrkdup.sorted.bam





bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq > new_align/NA11993_1.sai

bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > new_align/NA11993_new_2.sai

-------------- /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31

./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../align/NA11993_new_1.sai ../align/NA11993_new_2.sai ../split_fastq/NA11993_1d1d.sortedpairs.txt_1.fastq ../split_fastq/NA11993_1d1d.sortedpairs.txt_2.fastq > ../align/NA11993_new_aln.sam


samtools view -bS NA11993_new_aln.sam > NA11993_new_aln.bam








####################### perl script written to trim 3' adaptors and only pick the longer read from those pairs ####################
to fix ####### mark dups problem #########
Exception in thread "main" net.sf.picard.PicardException: Value was put into PairInfoMap more than once.

### b pattern (barcode)
TTGTGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT

### a pattern (no barcode)
AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG

### testing
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TTGTGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA11993_good.fastq -k new_sortedpairs/NA11993_bad.fastq -m 7 -f new_sortedpairs/NA11993_1d1d.sortedpairs.txt -q 12
Lines:  3571720
Reads:  446464
Trim 1: 82873
NoTrim 1:       2048
Trim 2: 39229
NoTrim 2:       424
NoTrim 1&2:     276700


perl fastqSplit.pl new_sortedpairs/NA11993_good.fastq new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq



#align good paired ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq > new_align/NA11993_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > new_align/NA11993_2.sai

./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../new_align/NA11993_1.sai ../new_align/NA11993_2.sai ../new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq ../new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > ../new_align/NA11993_pe_aln.sam


samtools view -bS NA11993_pe_aln.sam > NA11993_pe_aln.bam

## align bad single ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA11993_bad.fastq > new_align/NA11993_se.sai

bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA11993_se.sai new_sortedpairs/NA11993_bad.fastq > new_align/NA11993_se_aln.sam

samtools view -bS NA11993_se_aln.sam > NA11993_se_aln.bam

### merge the bamflies
samtools merge NA11993_all.aln.bam NA11993_se_aln.bam NA11993_pe_aln.bam

#### check read groups:
samtools view -H NA11993_all.aln.bam | grep '^@RG'
samtools view NA11993_all.aln.bam | grep 'RG:Z'


### Picard -  clean Sam
java -jar CleanSam.jar INPUT=../new_align/NA11993_all.aln.bam OUTPUT=../new_align/NA11993_all_clean.aln.bam

### sort
java -jar SortSam.jar INPUT=../new_align/NA11993_all_clean.aln.bam OUTPUT=../new_align/NA11993_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT

## mark dups
java -jar MarkDuplicates.jar INPUT=../new_align/NA11993_all_clean_sorted.aln.bam OUTPUT=../new_align/NA11993_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA11993_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT

#index
samtools index NA11993_all_clean_mkdup_sorted.aln.bam

### check it
samtools flagstat NA11993_all_clean_mkdup_sorted.aln.bam
677974 in total
0 QC failure
197085 duplicates
340826 mapped (50.27%)
553400 paired in sequencing
276700 read1
276700 read2
167298 properly paired (30.23%)
207984 with itself and mate mapped
19254 singletons (3.48%)
1840 with mate mapped to a different chr
793 with mate mapped to a different chr (mapQ>=5)




#################################################### trim and align all individuals ##################

/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31

### testing
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TTGTGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA11993_good.fastq -k new_sortedpairs/NA11993_bad.fastq -m 7 -f new_sortedpairs/NA11993_1d1d.sortedpairs.txt -q 12


testing:
WITHOUT BARCODE:
-a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG *** correct
WITHBARCIDE:
-b RC_BARCODE-AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT

### 3'Adpaptor trimming for each individual

##NA11993
-a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TTGTGA-AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT


## NA10861
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b AACCTGAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA10861_good.fastq -k new_sortedpairs/NA10861_bad.fastq -m 7 -f new_sortedpairs/NA10861_1n1n.sortedpairs.txt -q 12
Lines:  36844504
Reads:  4605562
Trim 1: 1038821
NoTrim 1:       20324
Trim 2: 611068
NoTrim 2:       1389
NoTrim 1&2:     2761791
use Samtools
perl fastqSplit.pl new_sortedpairs/NA10861_good.fastq new_splitfastq/NA10861_1.fastq new_splitfastq/NA10861_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA10861_1.fastq > new_align/NA10861_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA10861_2.fastq > new_align/NA10861_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA10861\tPL:ILLUMINA\tLB:Lib1\tSM:NA10861' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA10861_1.sai new_align/NA10861_2.sai new_splitfastq/NA10861_1.fastq new_splitfastq/NA10861_2.fastq > new_align/NA10861_pe_aln.sam
samtools view -bS new_align/NA10861_pe_aln.sam > new_align/NA10861_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA10861_bad.fastq > new_align/NA10861_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA10861\tPL:ILLUMINA\tLB:Lib1\tSM:NA10861' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA10861_se.sai new_sortedpairs/NA10861_bad.fastq > new_align/NA10861_se_aln.sam
samtools view -bS new_align/NA10861_se_aln.sam > new_align/NA10861_se_aln.bam
samtools merge new_align/NA10861_all.aln.bam new_align/NA10861_se_aln.bam new_align/NA10861_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA10861_all.aln.bam OUTPUT=../new_align/NA10861_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA10861_all_clean.aln.bam OUTPUT=../new_align/NA10861_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA10861_all_clean_sorted.aln.bam OUTPUT=../new_align/NA10861_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA10861_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA10861_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA10861_all_clean_mkdup_sorted.aln.bam
### NA10861
7195184 in total
0 QC failure
2937763 duplicates
6199803 mapped (86.17%)
5523582 paired in sequencing
2761791 read1
2761791 read2
3695742 properly paired (66.91%)
4402555 with itself and mate mapped
202030 singletons (3.66%)
38347 with mate mapped to a different chr
16054 with mate mapped to a different chr (mapQ>=5)



### NA12249 -screen 9364
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TGATGTAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA12249_good.fastq -k new_sortedpairs/NA12249_bad.fastq -m 7 -f new_sortedpairs/NA12249_1n1n.sortedpairs.txt -q 12
Lines:  11334920
Reads:  1416864
Trim 1: 391561
NoTrim 1:       5917
Trim 2: 190267
NoTrim 2:       354
NoTrim 1&2:     761003
perl fastqSplit.pl new_sortedpairs/NA12249_good.fastq new_splitfastq/NA12249_1.fastq new_splitfastq/NA12249_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA12249_1.fastq > new_align/NA12249_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA12249_2.fastq > new_align/NA12249_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA12249\tPL:ILLUMINA\tLB:Lib1\tSM:NA12249' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA12249_1.sai new_align/NA12249_2.sai new_splitfastq/NA12249_1.fastq new_splitfastq/NA12249_2.fastq > new_align/NA12249_pe_aln.sam
samtools view -bS new_align/NA12249_pe_aln.sam > new_align/NA12249_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA12249_bad.fastq > new_align/NA12249_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA12249\tPL:ILLUMINA\tLB:Lib1\tSM:NA12249' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA12249_se.sai new_sortedpairs/NA12249_bad.fastq > new_align/NA12249_se_aln.sam
samtools view -bS new_align/NA12249_se_aln.sam > new_align/NA12249_se_aln.bam
samtools merge new_align/NA12249_all.aln.bam new_align/NA12249_se_aln.bam new_align/NA12249_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA12249_all.aln.bam OUTPUT=../new_align/NA12249_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA12249_all_clean.aln.bam OUTPUT=../new_align/NA12249_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA12249_all_clean_sorted.aln.bam OUTPUT=../new_align/NA12249_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA12249_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA12249_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA12249_all_clean_mkdup_sorted.aln.bam
# NA12249---------------------------------------------------------
2110105 in total
0 QC failure
969187 duplicates
1708180 mapped (80.95%)
1522006 paired in sequencing
761003 read1
761003 read2
881290 properly paired (57.90%)
1081240 with itself and mate mapped
65434 singletons (4.30%)
11018 with mate mapped to a different chr
4860 with mate mapped to a different chr (mapQ>=5)


## NA21339 - 8419
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TGCGCTAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA21339_good.fastq -k new_sortedpairs/NA21339_bad.fastq -m 7 -f new_sortedpairs/NA21339_1n2n.sortedpairs.txt -q 12
Lines:  17938256
Reads:  2242281
Trim 1: 510947
NoTrim 1:       12553
Trim 2: 254918
NoTrim 2:       2042
NoTrim 1&2:     1388798
perl fastqSplit.pl new_sortedpairs/NA21339_good.fastq new_splitfastq/NA21339_1.fastq new_splitfastq/NA21339_2.fastq
#align good paired ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA21339_1.fastq > new_align/NA21339_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA21339_2.fastq > new_align/NA21339_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21339\tPL:ILLUMINA\tLB:Lib1\tSM:NA21339' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA21339_1.sai new_align/NA21339_2.sai new_splitfastq/NA21339_1.fastq new_splitfastq/NA21339_2.fastq > new_align/NA21339_pe_aln.sam
samtools view -bS new_align/NA21339_pe_aln.sam > new_align/NA21339_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA21339_bad.fastq > new_align/NA21339_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA21339\tPL:ILLUMINA\tLB:Lib1\tSM:NA21339' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA21339_se.sai new_sortedpairs/NA21339_bad.fastq > new_align/NA21339_se_aln.sam
samtools view -bS new_align/NA21339_se_aln.sam > new_align/NA21339_se_aln.bam
samtools merge new_align/NA21339_all.aln.bam new_align/NA21339_se_aln.bam new_align/NA21339_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA21339_all.aln.bam OUTPUT=../new_align/NA21339_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA21339_all_clean.aln.bam OUTPUT=../new_align/NA21339_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA21339_all_clean_sorted.aln.bam OUTPUT=../new_align/NA21339_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA21339_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA21339_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA21339_all_clean_mkdup_sorted.aln.bam
#NA21339-------------------------------------------
3558056 in total
0 QC failure
1414862 duplicates
2897369 mapped (81.43%)
2777596 paired in sequencing
1388798 read1
1388798 read2
1779122 properly paired (64.05%)
2072413 with itself and mate mapped
86848 singletons (3.13%)
17608 with mate mapped to a different chr
7350 with mate mapped to a different chr (mapQ>=5)


#NA12707
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b TTGATGAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA12707_good.fastq -k new_sortedpairs/NA12707_bad.fastq -m 7 -f new_sortedpairs/NA12707_1d1d.sortedpairs.txt -q 12
Lines:  31453440
Reads:  3931679
Trim 1: 975068
NoTrim 1:       15530
Trim 2: 540423
NoTrim 2:       3551
NoTrim 1&2:     2236554
use Samtools
perl fastqSplit.pl new_sortedpairs/NA12707_good.fastq new_splitfastq/NA12707_1.fastq new_splitfastq/NA12707_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA12707_1.fastq > new_align/NA12707_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA12707_2.fastq > new_align/NA12707_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA12707\tPL:ILLUMINA\tLB:Lib1\tSM:NA12707' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA12707_1.sai new_align/NA12707_2.sai new_splitfastq/NA12707_1.fastq new_splitfastq/NA12707_2.fastq > new_align/NA12707_pe_aln.sam
samtools view -bS new_align/NA12707_pe_aln.sam > new_align/NA12707_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA12707_bad.fastq > new_align/NA12707_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA12707\tPL:ILLUMINA\tLB:Lib1\tSM:NA12707' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA12707_se.sai new_sortedpairs/NA12707_bad.fastq > new_align/NA12707_se_aln.sam
samtools view -bS new_align/NA12707_se_aln.sam > new_align/NA12707_se_aln.bam
samtools merge new_align/NA12707_all.aln.bam new_align/NA12707_se_aln.bam new_align/NA12707_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA12707_all.aln.bam OUTPUT=../new_align/NA12707_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA12707_all_clean.aln.bam OUTPUT=../new_align/NA12707_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA12707_all_clean_sorted.aln.bam OUTPUT=../new_align/NA12707_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA12707_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA12707_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA12707_all_clean_mkdup_sorted.aln.bam
# NA12707 -------------------------------------------------------------------------------
6007680 in total
0 QC failure
2482512 duplicates
4937602 mapped (82.19%)
4473108 paired in sequencing
2236554 read1
2236554 read2
2703146 properly paired (60.43%)
3281985 with itself and mate mapped
203721 singletons (4.55%)
34241 with mate mapped to a different chr
15261 with mate mapped to a different chr (mapQ>=5)

##NA20589##################### - 7283
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b AATAGCAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA20589_good.fastq -k new_sortedpairs/NA20589_bad.fastq -m 7 -f new_sortedpairs/NA20589_2n2n.sortedpairs.txt -q 12
Lines:  15519776
Reads:  1939971
Trim 1: 512771
NoTrim 1:       10388
Trim 2: 260280
NoTrim 2:       1006
NoTrim 1&2:     968789
use Samtools
perl fastqSplit.pl new_sortedpairs/NA20589_good.fastq new_splitfastq/NA20589_1.fastq new_splitfastq/NA20589_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20589_1.fastq > new_align/NA20589_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20589_2.fastq > new_align/NA20589_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20589\tPL:ILLUMINA\tLB:Lib1\tSM:NA20589' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20589_1.sai new_align/NA20589_2.sai new_splitfastq/NA20589_1.fastq new_splitfastq/NA20589_2.fastq > new_align/NA20589_pe_aln.sam
samtools view -bS new_align/NA20589_pe_aln.sam > new_align/NA20589_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA20589_bad.fastq > new_align/NA20589_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA20589\tPL:ILLUMINA\tLB:Lib1\tSM:NA20589' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20589_se.sai new_sortedpairs/NA20589_bad.fastq > new_align/NA20589_se_aln.sam
samtools view -bS new_align/NA20589_se_aln.sam > new_align/NA20589_se_aln.bam
samtools merge new_align/NA20589_all.aln.bam new_align/NA20589_se_aln.bam new_align/NA20589_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA20589_all.aln.bam OUTPUT=../new_align/NA20589_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA20589_all_clean.aln.bam OUTPUT=../new_align/NA20589_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA20589_all_clean_sorted.aln.bam OUTPUT=../new_align/NA20589_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA20589_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA20589_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA20589_all_clean_mkdup_sorted.aln.bam
#NA20589----------------------------------------------------------------
2722023 in total
0 QC failure
1106602 duplicates
2100819 mapped (77.18%)
1937578 paired in sequencing
968789 read1
968789 read2
1036244 properly paired (53.48%)
1279946 with itself and mate mapped
114292 singletons (5.90%)
15214 with mate mapped to a different chr
6620 with mate mapped to a different chr (mapQ>=5)


##NA20806 - screen 8419
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b GATCTAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA20806_good.fastq -k new_sortedpairs/NA20806_bad.fastq -m 7 -f new_sortedpairs/NA20806_2d2d.sortedpairs.txt -q 12
Lines:  11924024
Reads:  1490502
Trim 1: 330217
NoTrim 1:       6820
Trim 2: 183230
NoTrim 2:       424
NoTrim 1&2:     781493
perl fastqSplit.pl new_sortedpairs/NA20806_good.fastq new_splitfastq/NA20806_1.fastq new_splitfastq/NA20806_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20806_1.fastq > new_align/NA20806_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20806_2.fastq > new_align/NA20806_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20806\tPL:ILLUMINA\tLB:Lib1\tSM:NA20806' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20806_1.sai new_align/NA20806_2.sai new_splitfastq/NA20806_1.fastq new_splitfastq/NA20806_2.fastq > new_align/NA20806_pe_aln.sam
samtools view -bS new_align/NA20806_pe_aln.sam > new_align/NA20806_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA20806_bad.fastq > new_align/NA20806_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA20806\tPL:ILLUMINA\tLB:Lib1\tSM:NA20806' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20806_se.sai new_sortedpairs/NA20806_bad.fastq > new_align/NA20806_se_aln.sam
samtools view -bS new_align/NA20806_se_aln.sam > new_align/NA20806_se_aln.bam
samtools merge new_align/NA20806_all.aln.bam new_align/NA20806_se_aln.bam new_align/NA20806_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA20806_all.aln.bam OUTPUT=../new_align/NA20806_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA20806_all_clean.aln.bam OUTPUT=../new_align/NA20806_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA20806_all_clean_sorted.aln.bam OUTPUT=../new_align/NA20806_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA20806_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA20806_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA20806_all_clean_mkdup_sorted.aln.bam
#NA20806--------------------------------------------
2083677 in total
0 QC failure
1015248 duplicates
1832783 mapped (87.96%)
1562986 paired in sequencing
781493 read1
781493 read2
1070988 properly paired (68.52%)
1269110 with itself and mate mapped
71244 singletons (4.56%)
11114 with mate mapped to a different chr
5120 with mate mapped to a different chr (mapQ>=5)


# NA20871 --> screen 8943
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b GTCATGAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA20871_good.fastq -k new_sortedpairs/NA20871_bad.fastq -m 7 -f new_sortedpairs/NA20871_1d2d.sortedpairs.txt -q 12
Lines:  11351040
Reads:  1418879
Trim 1: 212147
NoTrim 1:       11248
Trim 2: 145739
NoTrim 2:       2981
NoTrim 1&2:     884379
perl fastqSplit.pl new_sortedpairs/NA20871_good.fastq new_splitfastq/NA20871_1.fastq new_splitfastq/NA20871_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20871_1.fastq > new_align/NA20871_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20871_2.fastq > new_align/NA20871_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20871\tPL:ILLUMINA\tLB:Lib1\tSM:NA20871' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20871_1.sai new_align/NA20871_2.sai new_splitfastq/NA20871_1.fastq new_splitfastq/NA20871_2.fastq > new_align/NA20871_pe_aln.sam
samtools view -bS new_align/NA20871_pe_aln.sam > new_align/NA20871_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA20871_bad.fastq > new_align/NA20871_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA20871\tPL:ILLUMINA\tLB:Lib1\tSM:NA20871' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20871_se.sai new_sortedpairs/NA20871_bad.fastq > new_align/NA20871_se_aln.sam
samtools view -bS new_align/NA20871_se_aln.sam > new_align/NA20871_se_aln.bam
samtools merge new_align/NA20871_all.aln.bam new_align/NA20871_se_aln.bam new_align/NA20871_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA20871_all.aln.bam OUTPUT=../new_align/NA20871_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA20871_all_clean.aln.bam OUTPUT=../new_align/NA20871_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA20871_all_clean_sorted.aln.bam OUTPUT=../new_align/NA20871_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA20871_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA20871_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA20871_all_clean_mkdup_sorted.aln.bam
#NA20871-------------------------------------------------------------------------------------
0 QC failure
884445 duplicates
1803500 mapped (84.24%)
1768758 paired in sequencing
884379 read1
884379 read2
1198464 properly paired (67.76%)
1387140 with itself and mate mapped
79246 singletons (4.48%)
14452 with mate mapped to a different chr
6835 with mate mapped to a different chr (mapQ>=5)



## NA20890 ######### 13440
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b CGATTCAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA20890_good.fastq -k new_sortedpairs/NA20890_bad.fastq -m 7 -f new_sortedpairs/NA20890_2d2d.sortedpairs.txt -q 12
Lines:  12284472
Reads:  1535558
Trim 1: 307843
NoTrim 1:       8329
Trim 2: 199486
NoTrim 2:       1247
NoTrim 1&2:     881579
use Samtools
perl fastqSplit.pl new_sortedpairs/NA20890_good.fastq new_splitfastq/NA20890_1.fastq new_splitfastq/NA20890_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20890_1.fastq > new_align/NA20890_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA20890_2.fastq > new_align/NA20890_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib1\tSM:NA20890' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20890_1.sai new_align/NA20890_2.sai new_splitfastq/NA20890_1.fastq new_splitfastq/NA20890_2.fastq > new_align/NA20890_pe_aln.sam
samtools view -bS new_align/NA20890_pe_aln.sam > new_align/NA20890_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA20890_bad.fastq > new_align/NA20890_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib1\tSM:NA20890' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA20890_se.sai new_sortedpairs/NA20890_bad.fastq > new_align/NA20890_se_aln.sam
samtools view -bS new_align/NA20890_se_aln.sam > new_align/NA20890_se_aln.bam
samtools merge new_align/NA20890_all.aln.bam new_align/NA20890_se_aln.bam new_align/NA20890_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA20890_all.aln.bam OUTPUT=../new_align/NA20890_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA20890_all_clean.aln.bam OUTPUT=../new_align/NA20890_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA20890_all_clean_sorted.aln.bam OUTPUT=../new_align/NA20890_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA20890_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA20890_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA20890_all_clean_mkdup_sorted.aln.bam
#20890------------------------------------------- stats
1103167 duplicates
2091443 mapped (91.73%)
1763158 paired in sequencing
881579 read1
881579 read2
1309268 properly paired (74.26%)
1539886 with itself and mate mapped
59840 singletons (3.39%)
11942 with mate mapped to a different chr
4959 with mate mapped to a different chr (mapQ>=5)



# NA21685
perl trim_3adaptor.pl -a AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGTATGCCGTCTTCTGCTTG -b AGAAGAAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -j new_sortedpairs/NA21685_good.fastq -k new_sortedpairs/NA21685_bad.fastq -m 7 -f new_sortedpairs/NA21685_1n1n.sortedpairs.txt -q 12
Lines:  29154240
Reads:  3644279
Trim 1: 630475
NoTrim 1:       15433
Trim 2: 455906
NoTrim 2:       503
NoTrim 1&2:     2357927
use Samtools
perl fastqSplit.pl new_sortedpairs/NA21685_good.fastq new_splitfastq/NA21685_1.fastq new_splitfastq/NA21685_2.fastq
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA21685_1.fastq > new_align/NA21685_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA21685_2.fastq > new_align/NA21685_2.sai
bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21685\tPL:ILLUMINA\tLB:Lib1\tSM:NA21685' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA21685_1.sai new_align/NA21685_2.sai new_splitfastq/NA21685_1.fastq new_splitfastq/NA21685_2.fastq > new_align/NA21685_pe_aln.sam
samtools view -bS new_align/NA21685_pe_aln.sam > new_align/NA21685_pe_aln.bam
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA21685_bad.fastq > new_align/NA21685_se.sai
bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA21685\tPL:ILLUMINA\tLB:Lib1\tSM:NA21685' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA21685_se.sai new_sortedpairs/NA21685_bad.fastq > new_align/NA21685_se_aln.sam
samtools view -bS new_align/NA21685_se_aln.sam > new_align/NA21685_se_aln.bam
samtools merge new_align/NA21685_all.aln.bam new_align/NA21685_se_aln.bam new_align/NA21685_pe_aln.bam
cd picard-tools-1.48
java -jar CleanSam.jar INPUT=../new_align/NA21685_all.aln.bam OUTPUT=../new_align/NA21685_all_clean.aln.bam
java -jar SortSam.jar INPUT=../new_align/NA21685_all_clean.aln.bam OUTPUT=../new_align/NA21685_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../new_align/NA21685_all_clean_sorted.aln.bam OUTPUT=../new_align/NA21685_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA21685_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ..
samtools index new_align/NA21685_all_clean_mkdup_sorted.aln.bam
samtools flagstat new_align/NA21685_all_clean_mkdup_sorted.aln.bam
## NA21685 ------------------------------------------------
5818171 in total
0 QC failure
2370964 duplicates
4917701 mapped (84.52%)
4715854 paired in sequencing
2357927 read1
2357927 read2
3195784 properly paired (67.77%)
3684119 with itself and mate mapped
210165 singletons (4.46%)
33389 with mate mapped to a different chr
15711 with mate mapped to a different chr (mapQ>=5)

############### Auguest 5th - CN phasing CEU trios##################

/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes.map
/Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes.ped

---> get trios and get correct range

range:
--range /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/myrange1.txt

individuals:
--keep /Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/all_trio_indvs.txt

command
plink --file /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes --extract /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/myrange1.txt --range --recode --transpose --keep /Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/all_trio_indvs.txt --out /Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/OMNI

---> found no indivs to keep

plink --file /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes  --make-bed --out /Users/lindaboettger/McCarroll_Projects/Bob_CN_genotyping/1000_genomes_genotypes/ONMNI_genotypes
----> not all my trio indvs are in this omni genotypes file

---> beagle won't accept GL data for trios (only unphased/unrelated)
--gzvcf is untested
will unzip and then run
get my region with all individuals as vcf file:
./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tg/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 17 --from-bp 43411769 --to-bp 44883562 --recode --out /humgen/cnp04/sandbox/lboettger/tg/OMNI_invregion_allindvs

./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tg/OMNI_invregion_allindvs.recode.vcf --keep /humgen/cnp04/sandbox/lboettger/tg/informativetrioINDVS.txt --min-alleles 2 --max-alleles 2 --plink-tped --out /humgen/cnp04/sandbox/lboettger/tg/inv_CEUtrios
----> this only got 33 individuals, also need to download the children

./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tg/1KG_TrioKidsBatch1_Omni25_Genotypes_155_Samples.b37.vcf --chr 17 --from-bp 43411769 --to-bp 44883562 --keep /humgen/cnp04/sandbox/lboettger/tg/informativetrioINDVS.txt --min-alleles 2 --max-alleles 2 --plink --out /humgen/cnp04/sandbox/lboettger/tg/inv_CEUkids
----> only two more there

going to try this one… maybe it will have all hapmap
ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20101206_hapmap_omni_results/
./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tg/OMNI.440s.HapMap.vcf --chr 17 --from-bp 43411769 --to-bp 44883562 --keep /humgen/cnp04/sandbox/lboettger/tg/informativetrioINDVS.txt --min-alleles 2 --max-alleles 2 --plink-tped --out /humgen/cnp04/sandbox/lboettger/tg/HapMaptrios_invregion
--------> yes! this has 60 individuals!!!!



ftp://ftp.1000genomes.ebi.ac.uk/vol2/ftp/technical/working/20110217_broad_omni_genotypes/


##### Jim's program won't correctly put in the phased CN
--cnvGenotypesFile=CNVGENOTYPESFILE
                        (Optional) A file of CNV genotypes.  The format is
                        (NAxxxx are sample IDs)                       CNP
                        CHR    START    END    NA06986    NA06994
                        CNP1    1      10      100        2         1


/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=HapMaptrios_invregion.tped --famFile=HapMaptrios_invregion.tfam --cnvGenotypesFile=CNVgen_trio_allinform.txt --sampleType=unrelated --outFile=HMtrio --includeCNVGenotypesInOutput

error:
Error in if (!is.element(trioDF[i, 1], cnvSamples) | !is.element(trioDF[i,  : 
  argument is of length zero
Calls: buildBeagalFile ... selectSamples -> selectUnrelatedSamples -> selectTrioSamples 
Execution halted

------> jim fixed the bug

#### this works!!!!!!!!!------------------------------------------
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=HapMaptrios_invregion_s.tped --famFile=HapMaptrios_invregion_s.tfam --cnvGenotypesFile=CNVgen_trio_allinform.txt --sampleType=unrelated --outFile=HM_trio --includeCNVGenotypesInOutput

now need to make trio file correct

/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=HapMaptrios_invregion_s.tped --famFile=HapMaptrios_invregion_s.tfam --cnvGenotypesFile=CNVgen_trio_allinform.txt --sampleType=trio --outFile=HM_trio --includeCNVGenotypesInOutput

java -Xmx1000m -jar beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.bgl markers=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.bgl markers=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio_asunrel



############# AUG 9 -- using GATK ###################
http://www.broadinstitute.org/gsa/wiki/index.php/Running_the_GATK_for_the_first_time

wget ftp://ftp.broadinstitute.org/pub/gsa/GenomeAnalysisTK/GenomeAnalysisTK-1.1-23-g8072bd9.tar.bz2




wget ftp://ftp.broadinstitute.org/pub/gsa/GenomeAnalysisTK/GenomeAnalysisTK-1.6-7-g2be5704.tar.bz2
tar xvjf GenomeAnalysisTK-1.6-7-g2be5704.tar.bz2
################ aug 14############# 
looking for snps in my c68 assay
--from-bp <integer>
--to-bp <integer>


vcftools --vcf ALL.chr17.phase1.projectConsensus.genotypes.vcf --chr 17 --from-bp 44451558 --to-bp 44669629 --recode --out c68assay_region

vcftools --vcf c68assay_region.vcf --chr 17 --from-bp 44451595 --to-bp 44451614 --recode --out c68assay_F


#henny clone
vcftools --vcf ALL.chr17.phase1.projectConsensus.genotypes.vcf --chr 17 --from-bp 44108842 --to-bp 44108906 --recode --out henny_region


################# transfer new sequence data ####AUG 28, 2011 ##########

wget --ftp-user lboettger --ftp-password l2i2n2d2a2 ftp://genome.med.harvard.edu/FC_00296/5/s_5_1_sequence.txt.bz2
bunzip2 s_5_1_sequence.txt.bz2

wget --ftp-user lboettger --ftp-password l2i2n2d2a2 ftp://genome.med.harvard.edu/FC_00296/5/
tar xvjf s_5_2_sequence.txt.bz2

wget --ftp-user lboettger --ftp-password l2i2n2d2a2 ftp://genome.med.harvard.edu/FC_00296/5/s_5_1_sequence.txt.bz2.md5

wget --ftp-user lboettger --ftp-password l2i2n2d2a2 ftp://genome.med.harvard.edu/FC_00296/5/s_5_2_sequence.txt.bz2.md5

### sort
perl ../scripts/fastqSort_notrim_Summer2011.pl ../raw_data/s_5_1_sequence.txt.gz.Z ../raw_data/s_5_2_sequence.txt.gz.Z

ssh -X username@login

Linux:  We have included a wrapper script, called 'fastqc' which is the easiest 
way to 
start the program.  The wrapper is in the top level of the FastQC installation. 
 You 
may need to make this file executable:

chmod 755 fastqc

..but once you have done that you can run it directly

./fastqc

..or place a link in /usr/local/bin to be able to run the program from any locat
ion:

sudo ln -s /path/to/FastQC/fastqc /usr/local/bin/fastqc


###
echo $DISPLAY #from headnode
export DISPLAY=tin.broadinstitute.org:16.0 #on subnode to connect to X

./fastqc /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/new_sortedpairs/NA21339_good.fastq
### ---> then download zip file

./fastqc /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/sorted/NA21685.sortedpairs.txt
./fastqc /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/sorted/NA21113.sortedpairs.txt
./fastqc /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/sorted/NA06984.sortedpairs.txt
./fastqc /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/sorted/NA12340.sortedpairs.txt

##################### PIPELINE #######################################
##from main lboettger folder
use Samtools

###NA21685
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA21685.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA21685_1.fastq Summer2011_17q21.31/split_fastq/NA21685_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21685_1.fastq > Summer2011_17q21.31/align/NA21685_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21685_2.fastq > Summer2011_17q21.31/align/NA21685_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21685\tPL:ILLUMINA\tLB:Lib2\tSM:NA21685' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA21685_1.sai Summer2011_17q21.31/align/NA21685_2.sai Summer2011_17q21.31/split_fastq/NA21685_1.fastq Summer2011_17q21.31/split_fastq/NA21685_2.fastq > Summer2011_17q21.31/align/NA21685_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA21685_aln.sam > Summer2011_17q21.31/align/NA21685_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA21685_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21685_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA21685_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21685_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA21685_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA21685_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA21685_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA21685_clean_mkdup_sorted.aln.bam
samtools flagstat NA21685_clean_mkdup_sorted.aln.bam
###NA21685
3800456 in total
0 QC failure
3048408 duplicates
3748947 mapped (98.64%)
3800456 paired in sequencing
1900228 read1
1900228 read2
3653608 properly paired (96.14%)
3706543 with itself and mate mapped
42404 singletons (1.12%)
41131 with mate mapped to a different chr
30358 with mate mapped to a different chr (mapQ>=5)

###NA06984
##from main lboettger folder
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA06984.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA06984_1.fastq Summer2011_17q21.31/split_fastq/NA06984_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA06984_1.fastq > Summer2011_17q21.31/align/NA06984_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA06984_2.fastq > Summer2011_17q21.31/align/NA06984_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA06984\tPL:ILLUMINA\tLB:Lib2\tSM:NA06984' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA06984_1.sai Summer2011_17q21.31/align/NA06984_2.sai Summer2011_17q21.31/split_fastq/NA06984_1.fastq Summer2011_17q21.31/split_fastq/NA06984_2.fastq > Summer2011_17q21.31/align/NA06984_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA06984_aln.sam > Summer2011_17q21.31/align/NA06984_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA06984_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA06984_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA06984_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA06984_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA06984_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA06984_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA06984_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA06984_clean_mkdup_sorted.aln.bam
samtools flagstat NA06984_clean_mkdup_sorted.aln.bam
14673562 in total
0 QC failure
11758516 duplicates
14487111 mapped (98.73%)
14673562 paired in sequencing
7336781 read1
7336781 read2
14214666 properly paired (96.87%)
14334330 with itself and mate mapped
152781 singletons (1.04%)
89493 with mate mapped to a different chr
62328 with mate mapped to a different chr (mapQ>=5)


##NA20589
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA20589.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA20589_1.fastq Summer2011_17q21.31/split_fastq/NA20589_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20589_1.fastq > Summer2011_17q21.31/align/NA20589_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20589_2.fastq > Summer2011_17q21.31/align/NA20589_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20589\tPL:ILLUMINA\tLB:Lib2\tSM:NA20589' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA20589_1.sai Summer2011_17q21.31/align/NA20589_2.sai Summer2011_17q21.31/split_fastq/NA20589_1.fastq Summer2011_17q21.31/split_fastq/NA20589_2.fastq > Summer2011_17q21.31/align/NA20589_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA20589_aln.sam > Summer2011_17q21.31/align/NA20589_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA20589_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20589_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA20589_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20589_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA20589_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA20589_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA20589_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA20589_clean_mkdup_sorted.aln.bam
samtools flagstat NA20589_clean_mkdup_sorted.aln.bam
13925086 in total
0 QC failure
11222860 duplicates
13777816 mapped (98.94%)
13925086 paired in sequencing
6962543 read1
6962543 read2
13492306 properly paired (96.89%)
13660817 with itself and mate mapped
116999 singletons (0.84%)
128609 with mate mapped to a different chr
88365 with mate mapped to a different chr (mapQ>=5)


##NA21137
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA21137.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA21137_1.fastq Summer2011_17q21.31/split_fastq/NA21137_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21137_1.fastq > Summer2011_17q21.31/align/NA21137_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21137_2.fastq > Summer2011_17q21.31/align/NA21137_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21137\tPL:ILLUMINA\tLB:Lib2\tSM:NA21137' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA21137_1.sai Summer2011_17q21.31/align/NA21137_2.sai Summer2011_17q21.31/split_fastq/NA21137_1.fastq Summer2011_17q21.31/split_fastq/NA21137_2.fastq > Summer2011_17q21.31/align/NA21137_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA21137_aln.sam > Summer2011_17q21.31/align/NA21137_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA21137_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21137_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA21137_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21137_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA21137_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA21137_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA21137_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA21137_clean_mkdup_sorted.aln.bam
samtools flagstat NA21137_clean_mkdup_sorted.aln.bam
8701422 in total
0 QC failure
7136740 duplicates
8597738 mapped (98.81%)
8701422 paired in sequencing
4350711 read1
4350711 read2
8428086 properly paired (96.86%)
8511256 with itself and mate mapped
86482 singletons (0.99%)
62740 with mate mapped to a different chr
44731 with mate mapped to a different chr (mapQ>=5)


##NA11894
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA11894.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA11894_1.fastq Summer2011_17q21.31/split_fastq/NA11894_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA11894_1.fastq > Summer2011_17q21.31/align/NA11894_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA11894_2.fastq > Summer2011_17q21.31/align/NA11894_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA11894\tPL:ILLUMINA\tLB:Lib2\tSM:NA11894' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA11894_1.sai Summer2011_17q21.31/align/NA11894_2.sai Summer2011_17q21.31/split_fastq/NA11894_1.fastq Summer2011_17q21.31/split_fastq/NA11894_2.fastq > Summer2011_17q21.31/align/NA11894_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA11894_aln.sam > Summer2011_17q21.31/align/NA11894_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA11894_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA11894_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA11894_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA11894_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA11894_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA11894_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA11894_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA11894_clean_mkdup_sorted.aln.bam
samtools flagstat NA11894_clean_mkdup_sorted.aln.bam
8660084 in total
0 QC failure
6997295 duplicates
8553877 mapped (98.77%)
8660084 paired in sequencing
4330042 read1
4330042 read2
8351480 properly paired (96.44%)
8465426 with itself and mate mapped
88451 singletons (1.02%)
92584 with mate mapped to a different chr
69983 with mate mapped to a different chr (mapQ>=5)



#NA12707
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA12707.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA12707_1.fastq Summer2011_17q21.31/split_fastq/NA12707_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA12707_1.fastq > Summer2011_17q21.31/align/NA12707_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA12707_2.fastq > Summer2011_17q21.31/align/NA12707_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA12707\tPL:ILLUMINA\tLB:Lib2\tSM:NA12707' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA12707_1.sai Summer2011_17q21.31/align/NA12707_2.sai Summer2011_17q21.31/split_fastq/NA12707_1.fastq Summer2011_17q21.31/split_fastq/NA12707_2.fastq > Summer2011_17q21.31/align/NA12707_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA12707_aln.sam > Summer2011_17q21.31/align/NA12707_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA12707_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA12707_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA12707_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA12707_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA12707_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA12707_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA12707_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA12707_clean_mkdup_sorted.aln.bam
samtools flagstat NA12707_clean_mkdup_sorted.aln.bam
7992296 in total
0 QC failure
6470858 duplicates
7883425 mapped (98.64%)
7992296 paired in sequencing
3996148 read1
3996148 read2
7691846 properly paired (96.24%)
7792603 with itself and mate mapped
90822 singletons (1.14%)
82364 with mate mapped to a different chr
64095 with mate mapped to a different chr (mapQ>=5)


#NA21113
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA21113.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA21113_1.fastq Summer2011_17q21.31/split_fastq/NA21113_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21113_1.fastq > Summer2011_17q21.31/align/NA21113_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21113_2.fastq > Summer2011_17q21.31/align/NA21113_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21113\tPL:ILLUMINA\tLB:Lib2\tSM:NA21113' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA21113_1.sai Summer2011_17q21.31/align/NA21113_2.sai Summer2011_17q21.31/split_fastq/NA21113_1.fastq Summer2011_17q21.31/split_fastq/NA21113_2.fastq > Summer2011_17q21.31/align/NA21113_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA21113_aln.sam > Summer2011_17q21.31/align/NA21113_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA21113_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21113_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA21113_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21113_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA21113_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA21113_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA21113_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA21113_clean_mkdup_sorted.aln.bam
samtools flagstat NA21113_clean_mkdup_sorted.aln.bam
6725932 in total
0 QC failure
5479978 duplicates
6643562 mapped (98.78%)
6725932 paired in sequencing
3362966 read1
3362966 read2
6508468 properly paired (96.77%)
6574636 with itself and mate mapped
68926 singletons (1.02%)
50457 with mate mapped to a different chr
36397 with mate mapped to a different chr (mapQ>=5)



###NA21106
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA21106.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA21106_1.fastq Summer2011_17q21.31/split_fastq/NA21106_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21106_1.fastq > Summer2011_17q21.31/align/NA21106_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21106_2.fastq > Summer2011_17q21.31/align/NA21106_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21106\tPL:ILLUMINA\tLB:Lib2\tSM:NA21106' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA21106_1.sai Summer2011_17q21.31/align/NA21106_2.sai Summer2011_17q21.31/split_fastq/NA21106_1.fastq Summer2011_17q21.31/split_fastq/NA21106_2.fastq > Summer2011_17q21.31/align/NA21106_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA21106_aln.sam > Summer2011_17q21.31/align/NA21106_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA21106_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21106_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA21106_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA21106_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA21106_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA21106_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA21106_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA21106_clean_mkdup_sorted.aln.bam
samtools flagstat NA21106_clean_mkdup_sorted.aln.bam
6504878 in total
0 QC failure
5311956 duplicates
6438482 mapped (98.98%)
6504878 paired in sequencing
3252439 read1
3252439 read2
6312772 properly paired (97.05%)
6384850 with itself and mate mapped
53632 singletons (0.82%)
57518 with mate mapped to a different chr
44165 with mate mapped to a different chr (mapQ>=5)



### NA20890
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA20890.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA20890_1.fastq Summer2011_17q21.31/split_fastq/NA20890_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20890_1.fastq > Summer2011_17q21.31/align/NA20890_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20890_2.fastq > Summer2011_17q21.31/align/NA20890_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib2\tSM:NA20890' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA20890_1.sai Summer2011_17q21.31/align/NA20890_2.sai Summer2011_17q21.31/split_fastq/NA20890_1.fastq Summer2011_17q21.31/split_fastq/NA20890_2.fastq > Summer2011_17q21.31/align/NA20890_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA20890_aln.sam > Summer2011_17q21.31/align/NA20890_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA20890_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20890_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA20890_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20890_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA20890_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA20890_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA20890_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA20890_clean_mkdup_sorted.aln.bam
samtools flagstat NA20890_clean_mkdup_sorted.aln.bam
5065038 in total
0 QC failure
4140069 duplicates
5003509 mapped (98.79%)
5065038 paired in sequencing
2532519 read1
2532519 read2
4890396 properly paired (96.55%)
4953317 with itself and mate mapped
50192 singletons (0.99%)
46811 with mate mapped to a different chr
32956 with mate mapped to a different chr (mapQ>=5)


### NA20770
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA20770.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA20770_1.fastq Summer2011_17q21.31/split_fastq/NA20770_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20770_1.fastq > Summer2011_17q21.31/align/NA20770_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20770_2.fastq > Summer2011_17q21.31/align/NA20770_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20770\tPL:ILLUMINA\tLB:Lib2\tSM:NA20770' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA20770_1.sai Summer2011_17q21.31/align/NA20770_2.sai Summer2011_17q21.31/split_fastq/NA20770_1.fastq Summer2011_17q21.31/split_fastq/NA20770_2.fastq > Summer2011_17q21.31/align/NA20770_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA20770_aln.sam > Summer2011_17q21.31/align/NA20770_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA20770_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20770_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA20770_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20770_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA20770_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA20770_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA20770_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA20770_clean_mkdup_sorted.aln.bam
samtools flagstat NA20770_clean_mkdup_sorted.aln.bam
4806608 in total
0 QC failure
3906031 duplicates
4741780 mapped (98.65%)
4806608 paired in sequencing
2403304 read1
2403304 read2
4636192 properly paired (96.45%)
4688854 with itself and mate mapped
52926 singletons (1.10%)
43130 with mate mapped to a different chr
30672 with mate mapped to a different chr (mapQ>=5)


##NA20768
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA20768.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA20768_1.fastq Summer2011_17q21.31/split_fastq/NA20768_2.fastq
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20768_1.fastq > Summer2011_17q21.31/align/NA20768_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA20768_2.fastq > Summer2011_17q21.31/align/NA20768_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20768\tPL:ILLUMINA\tLB:Lib2\tSM:NA20768' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/align/NA20768_1.sai Summer2011_17q21.31/align/NA20768_2.sai Summer2011_17q21.31/split_fastq/NA20768_1.fastq Summer2011_17q21.31/split_fastq/NA20768_2.fastq > Summer2011_17q21.31/align/NA20768_aln.sam
samtools view -bS Summer2011_17q21.31/align/NA20768_aln.sam > Summer2011_17q21.31/align/NA20768_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/NA20768_aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20768_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/NA20768_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/NA20768_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/NA20768_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/finished_bam/NA20768_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/finished_bam/NA20768_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/finished_bam
samtools index NA20768_clean_mkdup_sorted.aln.bam
samtools flagstat NA20768_clean_mkdup_sorted.aln.bam
4581976 in total
0 QC failure
3755374 duplicates
4538074 mapped (99.04%)
4581976 paired in sequencing
2290988 read1
2290988 read2
4442842 properly paired (96.96%)
4503039 with itself and mate mapped
35035 singletons (0.76%)
50988 with mate mapped to a different chr
37634 with mate mapped to a different chr (mapQ>=5)



########## count percent ##########
samtools view chr2:1,000,000-2,000,000 -c

### actul capture region: chr17:43411014-44884739
use Samtools
samtools view -c NA21685_clean_mkdup_sorted.aln.bam 17:43410014-44885739 
1975668/3800456 = 52% from our region
NA06984: 8208880/14673562 56%
NA06984: 56%


final alignments are here: /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam
stats for average:
6725932 in total
0 QC failure
5479978 duplicates
6643562 mapped (98.78%)
6725932 paired in sequencing
3362966 read1
3362966 read2
6508468 properly paired (96.77%)
6574636 with itself and mate mapped
68926 singletons (1.02%)
50457 with mate mapped to a different chr
36397 with mate mapped to a different chr (mapQ>=5)






############ September 24 2011 ---> trying to impute all CN haplotypes ##############

bsub -N -q priority ./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tgp_snps/ALL.chr17.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf --chr 17 --from-bp 43075693 --keep /humgen/cnp04/sandbox/lboettger/tgp_snps/known_indv.txt --to-bp 45455670 --min-alleles 2 --max-alleles 2 --BEAGLE-GL --plink-tped --out /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_knownindv.vcf

-----> feed into jim's program and call everyone a 0 for each CNP (will change later) ----> this will also get rid of each cnp region

cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.bash
source configGAPAnalysisEnvironment.tcsh

/fg/software/gap/gap_analysis/imputation_generateBeagleInputs


!!!!!!!! OMG - Jim's program doesn't like \t…. you need spaces !!!!!!!!!!!!!!!

bsub -Is -q week bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_knownindv.vcf2.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_knownindv.vcf.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNPhap_known --includeCNVGenotypesInOutput


perl -nle 's/\t/ /g; print;' my_region_allSNPs_knownindv.vcf.tped > my_region_allSNPs_knownindv.vcf2.tped  



###### then use R script to put in the correct Cn haplotypes (fill_in_CNbgl.R)
get rid of NA12891!!!!! because this one is odd


moved to:
/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes


############ phase known individuals ##############

#### 
### this includes likelihoods for CNP
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/CNPhap_known.bgl markers=//Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/CNPhap_known.marker missing=-1 like=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/my_region_allSNPs_knownindv.addCNV.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/CNPhap_known

number of markers    =   21429----> need to cut this down!!!!!!!!!


java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/CNPhap_known.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/CNPhap_known.marker missing=-1 like=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/my_region_allSNPs_knownindv.addCNV.BEAGLE.GL out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/CNPhap_known

number of markers    =    9217
number of haplotypes =     782 (CNPhap_known.bgl)
number of haplotypes =     782 (my_region_allSNPs_knownindv.addCNV.BEAGLE.GL)


################### check dataset? cycle one out and re-impute #################
##### make files with one missing
in this folder:
/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/leave_one_out


#### command used to do phasing in loop##############
for i in {3..783}
do
	out=$(( $i % 2 ))
	if [ $out -eq 0 ] #if the number is even
	then
		continue
	fi
	java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/leave_one_out/to_impute/TI_${i}.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/leave_one_out/ref/REF_${i}.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/CNPhap_known.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/leave_one_out/out/out_${i}.txt
done

###################### impute CN for unknown individuals ############### oct 4th, 2011 ################

##### get same region for unknown individuals -----
bsub -Is -q week bash

./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tgp_snps/ALL.chr17.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf --chr 17 --from-bp 43475929 --to-bp 44800946 --min-alleles 2 --max-alleles 2 --remove /humgen/cnp04/sandbox/lboettger/tgp_snps/known_indv.txt --BEAGLE-GL --plink-tped --out /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf

#### change spaces to tabs
perl -nle 's/\t/ /g; print;' my_region_allSNPs_unknownindvs.vcf.tped > my_region_allSNPs_unknownindvs.vcf2.tped
perl -nle 's/\t/ /g; print;' my_region_allSNPs_unknownindvs.vcf.tfam > my_region_allSNPs_unknownindvs.vcf2.tfam 


########### make CNV_genotypes file for jim's program ----> get names of all individuals and put all as "-1"
/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes_unknowns.txt


##### then use jim's program similarly to this ----

cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.bash
source configGAPAnalysisEnvironment.tcsh


/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf2.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes_unknowns.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNPhap_unknowns --includeCNVGenotypesInOutput
----> it got confused by the "-1" so I'm going to leave them all as "0????---> this still doesn't work

/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf2.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf2.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes_unknowns0.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNPhap_unknowns --includeCNVGenotypesInOutput

test old
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_knownindv.vcf2.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_knownindv.vcf.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNPhap_knowntest --includeCNVGenotypesInOutput
----> this works fine

######### only difference seems to be that the old file has more markers…. I'll make a new file with the same number of markers
./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tgp_snps/ALL.chr17.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf --chr 17 --from-bp 43075693 --to-bp 45455670 --min-alleles 2 --max-alleles 2 --remove /humgen/cnp04/sandbox/lboettger/tgp_snps/known_indv.txt --BEAGLE-GL --plink-tped --out /humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs2.vcf

###### this works
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs2.vcf2.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/my_region_allSNPs_unknownindvs.vcf2.tfam --cnvGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNV_genotypes_unknowns0.txt --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/CNPhap_unknowns_new --includeCNVGenotypesInOutput
----->trim file and move chinese individuals #################### ON THIS PART #########################
>>>> add chinese to these files


#### phase CHS c68CN=8 individuals with the rest of the known dataset --- no GL used for sake of time
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_known_4p4.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_known_4p4.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhapknown_4p4


###### phase and impute CN for unknowns
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_unknowns_new_trim_no44.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhapknown_4p4.CNPhap_known_4p4.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_known_4p4.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/imputed_unknowns
----> marker file is missing tons of stuff…. need to combine old files and run through jim's program again

######## making complete marker file ##########
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.bash
source configGAPAnalysisEnvironment.tcsh

/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/all.tped --famFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/all.tfam --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/tgp_snps/allout


############## first round phasing/imputing command #####################
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_unknowns_new_trim_no44.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhapknown_4p4.CNPhap_known_4p4.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/allout_trim.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/imputed_unknowns

############## second round phasing/imputing command ##################### using original set of references (without c68=4 guys)
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_unknowns_new_trim_no44.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/trim_to_phase/CNPhap_known.my_region_allSNPs_knownindv.addCNV.BEAGLE.GL.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/allout_trim.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/imputed_unknowns2

###### third round ---> newref excludes all homozygous H1_1 and includes chinese NC=4 ##########
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/CNPhap_unknowns_new_trim_no44.bgl phased=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/newref.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/allout_trim.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/impute_CN_haplotypes/impute_unknown_indvs/trim/imputed_unknowns3




################################# OCTOBER 13, 2011 - RE-ALIGN HOMOZYGOUS H2 TO H2 CONSENSIS ###########################

SAMPLE FROM LAST ALIGNMENT to change:
##NA20768
use Samtools
cd /humgen/cnp04/sandbox/lboettger
use Samtools
perl Summer2011_17q21.31/scripts/fastqSplit.pl Summer2011_17q21.31/sorted/NA20768.sortedpairs.txt Summer2011_17q21.31/split_fastq/NA20768_1.fastq Summer2011_17q21.31/split_fastq/NA20768_2.fastq
…. this is already done

Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20768_1.fastq > Summer2011_17q21.31/align/H2/NA20768_H2_1.sai

Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20768_2.fastq > Summer2011_17q21.31/align/H2/NA20768_H2_2.sai

Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20768\tPL:ILLUMINA\tLB:Lib2H2\tSM:NA20768' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/align/H2/NA20768_H2_1.sai Summer2011_17q21.31/align/H2/NA20768_H2_2.sai Summer2011_17q21.31/split_fastq/NA20768_1.fastq Summer2011_17q21.31/split_fastq/NA20768_2.fastq > Summer2011_17q21.31/align/H2/NA20768_H2_aln.sam

#### result doesn't look awesome
[infer_isize] (25, 50, 75) percentile: (362, 376, 393)
[infer_isize] low and high boundaries: 300 and 455 for estimating avg and std
[infer_isize] inferred external isize from 60883 pairs: 378.526 +/- 23.165
[infer_isize] skewness: 0.253; kurtosis: -0.168; ap_prior: 1.00e-05
[infer_isize] inferred maximum insert size: 527 (6.43 sigma)
[bwa_sai2sam_pe_core] time elapses: 9.09 sec
[bwa_sai2sam_pe_core] changing coordinates of 12237 alignments.
[bwa_sai2sam_pe_core] align unmapped mate...
[bwa_paired_sw] 1611 out of 4065 Q17 singletons are mated.
[bwa_paired_sw] 262 out of 506 Q17 discordant pairs are fixed.
[bwa_sai2sam_pe_core] time elapses: 1.25 sec
[bwa_sai2sam_pe_core] refine gapped alignments... 0.76 sec
[bwa_sai2sam_pe_core] print alignments... 2.01 sec
[bwa_sai2sam_pe_core] 2290988 sequences have been processed.



samtools view -bS Summer2011_17q21.31/align/H2/NA20768_H2_aln.sam > Summer2011_17q21.31/align/H2/NA20768_H2_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20768_H2_aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20768_H2_clean.aln.bam

java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20768_H2_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20768_H2_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT

java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20768_H2_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/H2_finished_bam/NA20768_H2_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/H2_finished_bam/NA20768_H2_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT

cd ../../Summer2011_17q21.31/H2_finished_bam
samtools index NA20768_H2_clean_mkdup_sorted.aln.bam
samtools flagstat NA20768_H2_clean_mkdup_sorted.aln.bam

….. then should get stats
4581976 in total
0 QC failure
3755374 duplicates
4538074 mapped (99.04%)
4581976 paired in sequencing
2290988 read1
2290988 read2
4442842 properly paired (96.96%)
4503039 with itself and mate mapped
35035 singletons (0.76%)
50988 with mate mapped to a different chr
37634 with mate mapped to a different chr (mapQ>=5)

##this is what I got
4581976 + 0 in total (QC-passed reads + QC-failed reads)
2295920 + 0 duplicates
3470818 + 0 mapped (75.75%:nan%)
4581976 + 0 paired in sequencing
2290988 + 0 read1
2290988 + 0 read2
0 + 0 properly paired (0.00%:nan%)
3355331 + 0 with itself and mate mapped
115487 + 0 singletons (2.52%:nan%)
3179537 + 0 with mate mapped to a different chr
1676159 + 0 with mate mapped to a different chr (mapQ>=5)


You can find my H2 synthetic reference here:
/humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference


THESE ARE THE HOMOZYGOUS H2 INDVS:
NA20770 	H2D_H2D 	TSI
NA20768 	H2D_H2D 	TSI
NA20890 	H2D_H2D 	GIH
NA20589 	H2ND_H2ND 	TSI

##### NA20589 #######
cd /humgen/cnp04/sandbox/lboettger
use Samtools
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20589_1.fastq > Summer2011_17q21.31/align/H2/NA20589_H2_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20589_2.fastq > Summer2011_17q21.31/align/H2/NA20589_H2_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20589\tPL:ILLUMINA\tLB:Lib2H2\tSM:NA20589' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/align/H2/NA20589_H2_1.sai Summer2011_17q21.31/align/H2/NA20589_H2_2.sai Summer2011_17q21.31/split_fastq/NA20589_1.fastq Summer2011_17q21.31/split_fastq/NA20589_2.fastq > Summer2011_17q21.31/align/H2/NA20589_H2_aln.sam
samtools view -bS Summer2011_17q21.31/align/H2/NA20589_H2_aln.sam > Summer2011_17q21.31/align/H2/NA20589_H2_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20589_H2_aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20589_H2_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20589_H2_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20589_H2_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20589_H2_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/H2_finished_bam/NA20589_H2_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/H2_finished_bam/NA20589_H2_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/H2_finished_bam
samtools index NA20589_H2_clean_mkdup_sorted.aln.bam
samtools flagstat NA20589_H2_clean_mkdup_sorted.aln.bam
13925086 + 0 in total (QC-passed reads + QC-failed reads)
9411188 + 0 duplicates
10316958 + 0 mapped (74.09%:nan%)
13925086 + 0 paired in sequencing
6962543 + 0 read1
6962543 + 0 read2
9946786 + 0 properly paired (71.43%:nan%)
10003110 + 0 with itself and mate mapped
313848 + 0 singletons (2.25%:nan%)
142 + 0 with mate mapped to a different chr
112 + 0 with mate mapped to a different chr (mapQ>=5)



######## NA20770 ###########
cd /humgen/cnp04/sandbox/lboettger
use Samtools
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20770_1.fastq > Summer2011_17q21.31/align/H2/NA20770_H2_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20770_2.fastq > Summer2011_17q21.31/align/H2/NA20770_H2_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20770\tPL:ILLUMINA\tLB:Lib2H2\tSM:NA20770' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/align/H2/NA20770_H2_1.sai Summer2011_17q21.31/align/H2/NA20770_H2_2.sai Summer2011_17q21.31/split_fastq/NA20770_1.fastq Summer2011_17q21.31/split_fastq/NA20770_2.fastq > Summer2011_17q21.31/align/H2/NA20770_H2_aln.sam
samtools view -bS Summer2011_17q21.31/align/H2/NA20770_H2_aln.sam > Summer2011_17q21.31/align/H2/NA20770_H2_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20770_H2_aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20770_H2_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20770_H2_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20770_H2_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20770_H2_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/H2_finished_bam/NA20770_H2_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/H2_finished_bam/NA20770_H2_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/H2_finished_bam
samtools index NA20770_H2_clean_mkdup_sorted.aln.bam
samtools flagstat NA20770_H2_clean_mkdup_sorted.aln.bam
4806608 + 0 in total (QC-passed reads + QC-failed reads)
3320886 + 0 duplicates
3658877 + 0 mapped (76.12%:nan%)
4806608 + 0 paired in sequencing
2403304 + 0 read1
2403304 + 0 read2
3531170 + 0 properly paired (73.46%:nan%)
3543336 + 0 with itself and mate mapped
115541 + 0 singletons (2.40%:nan%)
42 + 0 with mate mapped to a different chr
32 + 0 with mate mapped to a different chr (mapQ>=5)



############ NA20890 ############
cd /humgen/cnp04/sandbox/lboettger
use Samtools
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20890_1.fastq > Summer2011_17q21.31/align/H2/NA20890_H2_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA20890_2.fastq > Summer2011_17q21.31/align/H2/NA20890_H2_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib2H2\tSM:NA20890' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/align/H2/NA20890_H2_1.sai Summer2011_17q21.31/align/H2/NA20890_H2_2.sai Summer2011_17q21.31/split_fastq/NA20890_1.fastq Summer2011_17q21.31/split_fastq/NA20890_2.fastq > Summer2011_17q21.31/align/H2/NA20890_H2_aln.sam
samtools view -bS Summer2011_17q21.31/align/H2/NA20890_H2_aln.sam > Summer2011_17q21.31/align/H2/NA20890_H2_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20890_H2_aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20890_H2_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20890_H2_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA20890_H2_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/H2/NA20890_H2_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/H2_finished_bam/NA20890_H2_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/H2_finished_bam/NA20890_H2_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/H2_finished_bam
samtools index NA20890_H2_clean_mkdup_sorted.aln.bam
samtools flagstat NA20890_H2_clean_mkdup_sorted.aln.bam
5065038 + 0 in total (QC-passed reads + QC-failed reads)
3483066 + 0 duplicates
3803045 + 0 mapped (75.08%:nan%)
5065038 + 0 paired in sequencing
2532519 + 0 read1
2532519 + 0 read2
3666612 + 0 properly paired (72.39%:nan%)
3685772 + 0 with itself and mate mapped
117273 + 0 singletons (2.32%:nan%)
30 + 0 with mate mapped to a different chr
23 + 0 with mate mapped to a different chr (mapQ>=5)


##/humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/H2_finished_bam
#### NA21685 ###
cd /humgen/cnp04/sandbox/lboettger
use Samtools
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA21685_1.fastq > Summer2011_17q21.31/align/H2/NA21685_H2_1.sai
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/split_fastq/NA21685_2.fastq > Summer2011_17q21.31/align/H2/NA21685_H2_2.sai
Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21685\tPL:ILLUMINA\tLB:Lib2H2\tSM:NA21685' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta Summer2011_17q21.31/align/H2/NA21685_H2_1.sai Summer2011_17q21.31/align/H2/NA21685_H2_2.sai Summer2011_17q21.31/split_fastq/NA21685_1.fastq Summer2011_17q21.31/split_fastq/NA21685_2.fastq > Summer2011_17q21.31/align/H2/NA21685_H2_aln.sam
samtools view -bS Summer2011_17q21.31/align/H2/NA21685_H2_aln.sam > Summer2011_17q21.31/align/H2/NA21685_H2_aln.bam
cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA21685_H2_aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA21685_H2_clean.aln.bam
java -jar SortSam.jar INPUT=../../Summer2011_17q21.31/align/H2/NA21685_H2_clean.aln.bam OUTPUT=../../Summer2011_17q21.31/align/H2/NA21685_H2_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Summer2011_17q21.31/align/H2/NA21685_H2_clean_sorted.aln.bam OUTPUT=../../Summer2011_17q21.31/H2_finished_bam/NA21685_H2_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Summer2011_17q21.31/H2_finished_bam/NA21685_H2_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Summer2011_17q21.31/H2_finished_bam
samtools index NA21685_H2_clean_mkdup_sorted.aln.bam
samtools flagstat NA21685_H2_clean_mkdup_sorted.aln.bam



##################### Jan 10, 2012 imputing HPR CN into HGDP populations #####################

working with data in this folder: /Users/lindaboettger/McCarroll_Projects/McCarroll_Lab_old/HGDP/plink_format

I used this a few years ago…. it looks like the stanford data


#trim to correct region and clean 
###exclude individuals with less than 90% data
###exclude snps with less than 90% genotyping rate
### no maf cutoff was used

Bob's region in gh18
chr16: 69652821 - 71659957

from HGDP I'll take:
16    rs7499876     0.696284     69628379
16    rs8051826     0.716600     71659957

plink --map /Users/lindaboettger/McCarroll_Projects/McCarroll_Lab_old/HGDP/plink_format/cHGDP.map --ped /Users/lindaboettger/McCarroll_Projects/McCarroll_Lab_old/HGDP/plink_format/cHGDP.ped --from rs7499876 --to rs8051826 --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region

plink --bfile /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region --recode --tab --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region

#get best tag SNP
plink --bfile /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region --from rs8045316 --to rs8045316 --recode --tab --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/rs8045316


#### get just the HGDP overlapping SNPs
egrep -i "71124923|71166188|71227328|71234413|71234903|71249346|71254941|71300859|71310697|71314097|71314528|71318001|71318577|71319539|71331728|71342916|71343397|71352071|71356135|71358937|71360615|71371993|71375462|71389182|71389788|71392062|71394595|71396290|71404780|71407382|71407530|71408287|71408475|71408940|71415506|71419102|71426563|71429924|71430753|71439049|71442416|71446856|71447270|71458299|71458638|71460372|71460583|71463602|71467951|71478888|71479892|71480239|71484929|71487206|71494097|71505303|71514638|71519612|71524543|71524632|71526720|71541226|71545488|71550853|71551141|71551521|71552257|71562526|71583655|71584333|71590511|71590669|71609268|71621858|71622207|71624342|71625209|71625880|71634544|71646525|71648299|71649416|71655035|71660310|71669624|71681153|71700504|71702975|71703436|71704222|71724090|71761061|71773190|71816899|71837477|71850632|71862133|71868168|71893498|71906597|71931219|71958052|71961906|71964175|71965725|71988728|71993638|72001136|72002308|72007232|72007399|72011181|72013539|72018417|72020134|72020323|72022041|72022941|72029094|72030580|72031860|72036577|72037206|72042682|72043039|72048332|72049212|72050480|72052625|72075341|72078907|72088331|72089740|72117751|72120683|72123886|72126514|72142111|72152755|72154682|72157384|72172300|72175156|72184629|72185001|72188683|72201119|72210050|72210865|72213316|72214276|72217113|72221457|72224335|72225574|72225786|72232762|72234472|72236956|72237535|72242412|72243624|72248088|72249130|72250217|72251074|72252752|72258281|72260693|72261782|72263965|72276824|72277649|72279852|72291732|72297706|72309016|72311826|72315331|72316884|72333576|72351797|72356899|72381557|72389230|72406328|72407574|72426448|72426960|72432949|72437741|72439633|72464460|72469463|72509460|72517014|72527247|72532362|72544447|72556930|72603988|72612848|72635674|72645949|72705151|72734104|72737477|72754019|72754901|72756101|72757436|72772418|72798271|72800567|72813742|72857544|72875403|72887183|72891898|72896694|72898348|72898864|72901709|72907058|72910403|72915236|72917601|72925982|72927533|72928928|72933055|72933804|72935686|72936570|72941435|72942904|72945704|72950468|72952291|72956308|72956544|72958432|72960230|72967363|72972090|72976179|72981230|72984668|72991286|72994419|72997747|73001957|73007970|73009698|73012164|73012685|73014746|73016143|73016768|73017118|73017684|73019004|73019416|73019560|73020116|73024276|73028249|73028921|73029160|73032465|73033473|73034938|73036633|73051818|73053579|73059729|73065656|73068977|73069888|73073289|73079683|73087494|73090039|73102456" Africans_merged.txt > Africans_merged_HGDPoverlapping.txt


################ Jan 14, 2012 lampLD #######################
The datafiles for local ancestry are located at - 
Diploid genotype data: /groups/reich/Affy6.0Data/HapmapCoriell.*

EIGENSTRAT Format: Used by EIGENSTRAT (both in the 07/23/06 release and in the current release).

§         genotype file: see example.eigenstratgeno

§         snp file:      see example.snp (same as above)

§         indiv file:    see example.ind (same as above)

for lampLD
<posfile>
	- file containing physical positions of each SNP in the data one SNP per line
	- Example: test_data/chr1.pos
<ancestral haplotype files>
	- file containing ancestral haplotype data one haplotype per line in a 0/1/?/ format, no spaces between alleles
	- 0 denotes reference allele, 1-variant allele, ?-missing data; 
	- encoding is arbitrary but NEEDS to be consistent across all ancestral reference panels and admixed genotype s
ample
	- for ensuring encoding consistency we recommend removing G/C SNPs if Affymetrix genotyping platforms are used
	- one file per European, Native American and West African are required
	- WARNING::Number of alleles per haplotype needs to match the number of SNPs in the posfile
	- Example: test/EUR_haps.ref, test/NA_Haps.ref,  test/YRI_haps.ref
<admixed genotype sample>
	- one line per sample in a 0/1/2/? format
	- 0/1/2 denotes number of reference alleles (encoding of allele NEEDS to be consistent in sample and reference 
panels)


Lamp Ld: 

All the scripts to run LampLd are located in -
/groups/reich/pm82/local_anc/lampld/scripts

Steps: 
1. Convert eigenstrat to lampld input format
format_eig_lampld.sh

2. Run LampLd
run_LAMPLD.pl

Lampld Executable: /groups/reich/pm82/dev/lamp-ld/unolanc2way

3. Convert lampLd output to plot
format_output_plot.sh

### get rid of NA19085 in one file and make another with just NA19085
bsub -o ~/lampLd/CHB+JPT_noNA19085.phgeno cut -c 1-232,235-340 /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phgeno
bsub -o ~/lampLd/only_NA19085.phgeno cut -c 233-234 /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phgeno
bsub -o ~/lampLd/CHB+JPT_noNA19085.phind sed '233,234d' /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phind
bsub -o ~/lampLd/only_NA19085.phind sed -n '233,234p' /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phind



### my japanese/chinese in eigenstrat format:
~/lampLd/CHB+JPT_noNA19085.phgeno
~/lampLd/CHB+JPT_noNA19085.phind
/groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp


~/lampLd/only_NA19085.phgeno
~/lampLd/only_NA19085.phind
/groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp


### convert into lampLD format
/groups/reich/pm82/local_anc/lampld/scripts

bsub -o ~/lampLd/convert.log perl /groups/reich/pm82/local_anc/lampld/scripts/convert_eig_lampld_ancpop.pl ~/lampLd/CHB+JPT_noNA19085.phgeno /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp ~/lampLd/CHB+JPT_noNA19085_lampld


### CEU in lampLD format
/groups/reich/pm82/local_anc/lampld/Datafiles/CEU.17

sh file.sh

# 1/14/2012

how to start interactive jobs on Orchestra:
https://wiki.med.harvard.edu/Orchestra/IntroductionToLSF#Interactive_Jobs 

from interactive shell in /home/lmb28/lampLd:

perl /groups/reich/pm82/local_anc/lampld/scripts/convert_eig_lampld_ancpop.pl ~/lampLd/CHB+JPT_noNA19085.phgeno /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp ~/lampLd/CHB+JPT_noNA19085_lampld

#I deleted the sub prepended output from ~/lampLd/CHB+JPT_noNA19085.phgeno

#clear old files:
mkdir new_input
mv ~/lampLd/CHB+JPT_noNA19085.phgeno ~/lampLd/CHB+JPT_noNA19085.phind ~/lampLd/only_NA19085.phgeno ~/lampLd/only_NA19085.phind  new_input
rm *
mv new_input/* ..
rmdir new_input

#I deleted the sub prepended output from the other three files: 
lmb28@clarinet002-001:~/lampLd$ vim CHB+JPT_noNA19085.phind
lmb28@clarinet002-001:~/lampLd$ vim only_NA19085.phgeno
lmb28@clarinet002-001:~/lampLd$ vim only_NA19085.phind
#dd to delete each line, :wq to save and quit each (:u to undo if you delete too far)


#copying Priya's /groups/reich/pm82/local_anc/lampld/scripts/convert_eig_lampld_ancpop.pl to our own dir inside lampLd
mkdir scripts
cd scripts
cp /groups/reich/pm82/local_anc/lampld/scripts/convert_eig_lampld_ancpop.pl .

perl scripts/convert_eig_lampld_ancpop.pl ~/lampLd/CHB+JPT_noNA19085.phgeno /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp ~/lampLd/CHB+JPT_noNA19085_lampld

#added a label as the last argument so the physpos files don't all look like .1, .2, .3, etc
perl scripts/convert_eig_lampld_ancpop.pl ~/lampLd/CHB+JPT_noNA19085.phgeno /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp ~/lampLd/CHB+JPT_noNA19085_lampld CHB+JPT_noNA19085


bsub -Is -q shared_int_12h bash
################# CHB/JPT ancestral files #####################
#outfile:
~/lampLdCHB+JPT_noNA19085_lampld.17

## physical position file:
~/lampLdCHB+JPT_noNA19085.17

~/lampLd/only_NA19085.phgeno
~/lampLd/only_NA19085.phind
/groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp


perl scripts/convert_eig_lampld_LB.pl ~/lampLd/only_NA19085.phgeno /groups/reich/HAPMAP_PHASED/CHB+JPT/hapmap3_r2_b36_chr17_CHB+JPT.phsnp ~/lampLd/only_NA19085_lampld onlyNA19085

#unknown indv
~/lampLd/only_NA19085_lampld.17

#### need to get something that isn't phased (.geno and .snp) …> get our guy out of /groups/reich/Affy6.0Data/HapmapCoriell.snp, and /groups/reich/Affy6.0Data/HapmapCoriell.geno

grep -n "NA19085" HapmapCoriell.032008.ind
616: NA19085 M JPT

## our guy is in column 616
cut -c 616 /groups/reich/Affy6.0Data/HapmapCoriell.geno > ~/lampLd/only_NA19085.geno

perl -le s/9/?/ ~/lampLd/only_NA19085.geno > ~/lampLd/only_NA19085?.geno
~/lampLd/only_NA19085?.geno
 
#### to convert NA19085 #########
perl /groups/reich/pm82/local_anc/lampld/scripts/convert_eig_lampld.pl ~/lampLd/only_NA19085.geno /groups/reich/Affy6.0Data/HapmapCoriell.snp ~/lampLd/only_NA19085_lampld

~/lampLd/only_NA19085_lampld.17


############# LampLD input ############## 

### CEU in lampLD format
/groups/reich/pm82/local_anc/lampld/Datafiles/CEU.17

#outfile:
~/lampLdCHB+JPT_noNA19085_lampld.17

## physical position file:
~/lampLdCHB+JPT_noNA19085.17

~/lampLd/only_NA19085_lampld.17


<posfile> <EURHaps> <NAHaps> <YRIHaps> <genfile> <outfile>

#### to run lampld
perl run_LAMPLD_2ancpop.pl ~/lampLd/CHB+JPT_noNA19085.17 /groups/reich/pm82/local_anc/lampld/Datafiles/CEU.17 ~/lampLd/CHB+JPT_noNA19085_lampld.17 ~/lampLd/only_NA19085_lampld.17 ~/lampLd/lampped.out

###### checking files #######
position file
38401 SNPs

Jap file :
38401
338 individuals

INDV file: ~/lampLd/only_NA19085_lampld.17
20658 SNPS

/groups/reich/pm82/local_anc/lampld/Datafiles/CEU.17
218 rows (indvs)
7959 columns (SNPs)

#### THis is the commond that will run lampld from priya's folder, but I need to fix the input files. They don't have the same number of SNPs and I don't know if they are on the same strand… I should just start from one dataset with everything and phase some of it and then put it in the right format
perl run_LAMPLD_2ancpop.pl ~/lampLd/CHB+JPT_noNA19085.17 /groups/reich/pm82/local_anc/lampld/Datafiles/CEU.17 ~/lampLd/CHB+JPT_noNA19085_lampld.17 ~/lampLd/only_NA19085_lampld.17 ~/lampLd/lampped.out



######## Back to HGDP stuff
get rid of SNPs in HGDP dataset that aren't in HM3
in hg19 coords:
setdiff(HGDP,HM3)
 [1] 71070878 71229089 71776144 71877966
 [5] 72027611 72108093 72125733 72149061
 [9] 72464525 72594387 72860611 72871205
[13] 73004537 73043247


plink --map /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HPR_region.ped --exclude /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/rmSNPs.txt --recode --tab --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDP_HM3overlap

plink --map /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDPoverlapping_matchingmap.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDP_HM3overlap.ped --transpose --recode --tab --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDP_HM3overlapt

### flip strands that need flipping
plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_letters.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDP_HM3overlapt.tfam --flip /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/snps_to_flip.txt --recode --transpose --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix

### run through Jim's program to make beagle files
/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.tped
/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.tfam

scp /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.tfam boettger@tin.broadinstitute.org:/humgen/cnp04/sandbox/lboettger/Hpr

/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix.tped
/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix.tfam

bsub -Is -q week bash
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.tcsh
source configGAPAnalysisEnvironment.bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix.tped  --famFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix.tfam --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix



java -Xmx1000m -jar beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/Africans_merged_HGDPoverlapping_strandfix.bgl unphased=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.marker missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/imputation/HGDP_Hpr

### the imputation results were really odd. I think that some of the a/t g/c snps are not on the correct strand and need to be flipped. The HGDP is on the Illumina 650Y array and I might be able to use bead studio to get a SNPTable file to correct this. For now it would be good to toss all AT/GC SNPs that are at intermediate frequency in YRI

### these SNPs had intermediate freq and were AT/GC SNPs so I'm tossing them 1/17/12
[1] "16:71227328" "16:71319539" "16:71358937" "16:71584333" "16:71965725" "16:71988728" "16:72201119" "16:72221457"
 [9] "16:72225786" "16:72260693" "16:72432949" "16:72437741" "16:72527247" "16:72928928" "16:72967363" "16:72991286"
[17] "16:73019560"

### make tped/tfam file again
plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_letters.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/HGDP_HM3overlapt.tfam --flip /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/snps_to_flip.txt --recode --transpose --exclude /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/tossSNPs.txt --out /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix_toss

### run-through jim's program to make beagle file ##
bsub -Is -q week bash
cd  /fg/software/gap/gap_analysis
source configGAPAnalysisEnvironment.tcsh
source configGAPAnalysisEnvironment.bash
/fg/software/gap/gap_analysis/imputation_generateBeagleInputs --snpGenotypesFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix_toss.tped  --famFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix_toss.tfam --sampleType=unrelated --outFile=/humgen/cnp04/sandbox/lboettger/Hpr/HGDP_strandfix_toss

### impute with snps that should all be accurate ###
java -Xmx1000m -jar beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/Africans_merged_HGDPoverlapping_strandfix.bgl unphased=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix_toss.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix_toss.marker missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/imputation/HGDP_Hpr_corrected
…. it still looks really bad. Individuals from all populations have the duplication
----> I think beagle does some of this related to frequency, so I should really only be imputing into african populations

change the A in 25 and then exclude non-africans




###################### Looking at mapping percentage to our region for H2 indvs mapped to hg19 and to H2 consensus ######### Feb 22, 2012 #####
example:
samtools view -c NA21685_clean_mkdup_sorted.aln.bam 17:43410014-44885739 

NA20770 	H2D_H2D 	TSI
NA20768 	H2D_H2D 	TSI
NA20890 	H2D_H2D 	GIH
NA20589 	H2ND_H2ND 	TSI


 use Samtools
H1 alignments:
/humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam


samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam/NA20770_clean_mkdup_sorted.aln.bam 17:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam/NA20768_clean_mkdup_sorted.aln.bam 17:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam/NA20890_clean_mkdup_sorted.aln.bam 17:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/finished_bam/NA20589_clean_mkdup_sorted.aln.bam 17:43410014-44885739


H2 alignments:
samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/H2_finished_bam/NA20770_H2_clean_mkdup_sorted.aln.bam 17H2:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/H2_finished_bam/NA20768_H2_clean_mkdup_sorted.aln.bam 17H2:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/H2_finished_bam/NA20890_H2_clean_mkdup_sorted.aln.bam 17H2:43410014-44885739

samtools view -c /humgen/cnp04/sandbox/lboettger/Summer2011_17q21.31/H2_finished_bam/NA20589_H2_clean_mkdup_sorted.aln.bam 17H2:43410014-44885739


results in H2_OnTarget_reads.xlsx



############# April 5th 2012, aligning miseq #############
/humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls/
screen
bsub -Is -q week bash
unzip run_240259_fastq.zip
cd data/intensities/basecalls
gunzip *


################ NA21106 H1 ######################
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.1 s_G1_L001_R1_002.fastq.1 > NA21106_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA21106_1.fastq > NA21106_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.1 s_G1_L001_R2_002.fastq.1 > NA21106_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA21106_2.fastq > NA21106_2_fixed.fastq

/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21106_1_fixed.fastq > align/NA21106_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21106_2_fixed.fastq > align/NA21106_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21106\tPL:ILLUMINA\tLB:Lib3\tSM:NA21106' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA21106_1.sai align/NA21106_2.sai NA21106_1_fixed.fastq NA21106_2_fixed.fastq > align/NA21106_aln.sam
cd align
samtools view -bS align/NA21106_aln.sam > align/NA21106_aln.bam

cd Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21106_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21106_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21106_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21106_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21106_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21106_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21106_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA21106_clean_mkdup_sorted.aln.bam
samtools flagstat NA21106_clean_mkdup_sorted.aln.bam
####################
1694190 + 0 in total (QC-passed reads + QC-failed reads)
19919 + 0 duplicates
1571853 + 0 mapped (92.78%:nan%)
1694190 + 0 paired in sequencing
847095 + 0 read1
847095 + 0 read2
1500488 + 0 properly paired (88.57%:nan%)
1541776 + 0 with itself and mate mapped
30077 + 0 singletons (1.78%:nan%)
3098 + 0 with mate mapped to a different chr
2358 + 0 with mate mapped to a different chr (mapQ>=5)
samtools view -c /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21106_clean_mkdup_sorted.aln.bam 17:43410014-44885739
# 46% on target
# 1% duplicates


############## NA21113 H1 ################
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.2 s_G1_L001_R1_002.fastq.2 > NA21113_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA21113_1.fastq > NA21113_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.2 s_G1_L001_R2_002.fastq.2 > NA21113_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA21113_2.fastq > NA21113_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21113_1_fixed.fastq > align/NA21113_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21113_2_fixed.fastq > align/NA21113_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21113\tPL:ILLUMINA\tLB:Lib3\tSM:NA21113' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA21113_1.sai align/NA21113_2.sai NA21113_1_fixed.fastq NA21113_2_fixed.fastq > align/NA21113_aln.sam
cd align
samtools view -bS NA21113_aln.sam > NA21113_aln.bam
cd ../../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21113_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21113_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21113_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21113_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21113_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21113_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21113_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA21113_clean_mkdup_sorted.aln.bam
samtools flagstat NA21113_clean_mkdup_sorted.aln.bam
1715340 + 0 in total (QC-passed reads + QC-failed reads)
23219 + 0 duplicates
1592612 + 0 mapped (92.85%:nan%)
1715340 + 0 paired in sequencing
857670 + 0 read1
857670 + 0 read2
1510330 + 0 properly paired (88.05%:nan%)
1565450 + 0 with itself and mate mapped
27162 + 0 singletons (1.58%:nan%)
2059 + 0 with mate mapped to a different chr
1486 + 0 with mate mapped to a different chr (mapQ>=5)




########### NA21137 H1 #################
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.3 s_G1_L001_R1_002.fastq.3 > NA21137_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA21137_1.fastq > NA21137_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.3 s_G1_L001_R2_002.fastq.3 > NA21137_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA21137_2.fastq > NA21137_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21137_1_fixed.fastq > align/NA21137_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA21137_2_fixed.fastq > align/NA21137_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA21137\tPL:ILLUMINA\tLB:Lib3\tSM:NA21137' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA21137_1.sai align/NA21137_2.sai NA21137_1_fixed.fastq NA21137_2_fixed.fastq > align/NA21137_aln.sam
samtools view -bS align/NA21137_aln.sam > align/NA21137_aln.bam
cd ../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21137_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21137_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21137_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21137_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA21137_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21137_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA21137_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA21137_clean_mkdup_sorted.aln.bam
samtools flagstat NA21137_clean_mkdup_sorted.aln.bam
767916 + 0 in total (QC-passed reads + QC-failed reads)
11461 + 0 duplicates
614020 + 0 mapped (79.96%:nan%)
767916 + 0 paired in sequencing
383958 + 0 read1
383958 + 0 read2
518008 + 0 properly paired (67.46%:nan%)
595248 + 0 with itself and mate mapped
18772 + 0 singletons (2.44%:nan%)
760 + 0 with mate mapped to a different chr
483 + 0 with mate mapped to a different chr (mapQ>=5)


########### NA11894 H1 #################
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.7 s_G1_L001_R1_002.fastq.7 > NA11894_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA11894_1.fastq > NA11894_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.7 s_G1_L001_R2_002.fastq.7 > NA11894_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA11894_2.fastq > NA11894_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA11894_1_fixed.fastq > align/NA11894_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA11894_2_fixed.fastq > align/NA11894_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA11894\tPL:ILLUMINA\tLB:Lib3\tSM:NA11894' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA11894_1.sai align/NA11894_2.sai NA11894_1_fixed.fastq NA11894_2_fixed.fastq > align/NA11894_aln.sam
samtools view -bS align/NA11894_aln.sam > align/NA11894_aln.bam
cd ../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA11894_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA11894_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA11894_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA11894_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA11894_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA11894_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA11894_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA11894_clean_mkdup_sorted.aln.bam
samtools flagstat NA11894_clean_mkdup_sorted.aln.bam
1736008 + 0 in total (QC-passed reads + QC-failed reads)
87789 + 0 duplicates
1468141 + 0 mapped (84.57%:nan%)
1736008 + 0 paired in sequencing
868004 + 0 read1
868004 + 0 read2
1280564 + 0 properly paired (73.76%:nan%)
1423444 + 0 with itself and mate mapped
44697 + 0 singletons (2.57%:nan%)
2518 + 0 with mate mapped to a different chr
1786 + 0 with mate mapped to a different chr (mapQ>=5)



########### NA20770 H2 ###############
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.4 s_G1_L001_R1_002.fastq.4 > NA20770_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA20770_1.fastq > NA20770_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.4 s_G1_L001_R2_002.fastq.4 > NA20770_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA20770_2.fastq > NA20770_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20770_1_fixed.fastq > align/NA20770_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20770_2_fixed.fastq >  align/NA20770_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20770\tPL:ILLUMINA\tLB:Lib3\tSM:NA20770' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta align/NA20770_1.sai align/NA20770_2.sai NA20770_1_fixed.fastq NA20770_2_fixed.fastq > align/NA20770_aln.sam
samtools view -bS align/NA20770_aln.sam > align/NA20770_aln.bam
cd ../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20770_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20770_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20770_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20770_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20770_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20770_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20770_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA20770_clean_mkdup_sorted.aln.bam
samtools flagstat NA20770_clean_mkdup_sorted.aln.bam
1758356 + 0 in total (QC-passed reads + QC-failed reads)
55581 + 0 duplicates
1040174 + 0 mapped (59.16%:nan%)
1758356 + 0 paired in sequencing
879178 + 0 read1
879178 + 0 read2
910364 + 0 properly paired (51.77%:nan%)
1004238 + 0 with itself and mate mapped
35936 + 0 singletons (2.04%:nan%)
54 + 0 with mate mapped to a different chr
19 + 0 with mate mapped to a different chr (mapQ>=5)


######## NA20768 H2 ############
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.5 s_G1_L001_R1_002.fastq.5 > NA20768_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA20768_1.fastq > NA20768_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.5 s_G1_L001_R2_002.fastq.5 > NA20768_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA20768_2.fastq > NA20768_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20768_1_fixed.fastq > align/NA20768_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20768_2_fixed.fastq > align/NA20768_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20768\tPL:ILLUMINA\tLB:Lib3\tSM:NA20768' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta align/NA20768_1.sai align/NA20768_2.sai NA20768_1_fixed.fastq NA20768_2_fixed.fastq > align/NA20768_aln.sam
cd align
samtools view -bS NA20768_aln.sam > NA20768_aln.bam
cd ../../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20768_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20768_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20768_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20768_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20768_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20768_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20768_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA20768_clean_mkdup_sorted.aln.bam
samtools flagstat NA20768_clean_mkdup_sorted.aln.bam
1591010 + 0 in total (QC-passed reads + QC-failed reads)
16870 + 0 duplicates
1051405 + 0 mapped (66.08%:nan%)
1591010 + 0 paired in sequencing
795505 + 0 read1
795505 + 0 read2
985600 + 0 properly paired (61.95%:nan%)
1027066 + 0 with itself and mate mapped
24339 + 0 singletons (1.53%:nan%)
64 + 0 with mate mapped to a different chr
44 + 0 with mate mapped to a different chr (mapQ>=5)


######## NA20890 H2 #############
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
cat s_G1_L001_R1_001.fastq.6 s_G1_L001_R1_002.fastq.6 > NA20890_1.fastq
sed -e s/.1:N:0:1/\\/1/ NA20890_1.fastq > NA20890_1_fixed.fastq
cat s_G1_L001_R2_001.fastq.6 s_G1_L001_R2_002.fastq.6 > NA20890_2.fastq
sed -e s/.2:N:0:1/\\/2/ NA20890_2.fastq > NA20890_2_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20890_1_fixed.fastq > align/NA20890_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta NA20890_2_fixed.fastq > align/NA20890_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib3\tSM:NA20890' /humgen/cnp04/bobh/1kg/cnv/phase1/genotyping/chr17H2/reference/17H2_reference.fasta align/NA20890_1.sai align/NA20890_2.sai NA20890_1_fixed.fastq NA20890_2_fixed.fastq > align/NA20890_aln.sam
samtools view -bS align/NA20890_aln.sam > align/NA20890_aln.bam
cd ../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20890_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20890_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20890_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20890_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/align/NA20890_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20890_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/finished_bam/NA20890_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/finished_bam
samtools index NA20890_clean_mkdup_sorted.aln.bam
samtools flagstat NA20890_clean_mkdup_sorted.aln.bam
1714622 + 0 in total (QC-passed reads + QC-failed reads)
46303 + 0 duplicates
1109451 + 0 mapped (64.71%:nan%)
1714622 + 0 paired in sequencing
857311 + 0 read1
857311 + 0 read2
978492 + 0 properly paired (57.07%:nan%)
1079058 + 0 with itself and mate mapped
30393 + 0 singletons (1.77%:nan%)
68 + 0 with mate mapped to a different chr
30 + 0 with mate mapped to a different chr (mapQ>=5)

######################################################################### H2 aligned to hg19 #####################################################################
#################NA20768
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20768_1_fixed.fastq > H2_hg19_align/NA20768_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20768_2_fixed.fastq > H2_hg19_align/NA20768_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20768\tPL:ILLUMINA\tLB:Lib3\tSM:NA20768' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta H2_hg19_align/NA20768_1.sai H2_hg19_align/NA20768_2.sai NA20768_1_fixed.fastq NA20768_2_fixed.fastq > H2_hg19_align/NA20768_aln.sam
cd H2_hg19_align
samtools view -bS NA20768_aln.sam > NA20768_aln.bam
cd ../../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20768_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20768_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20768_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20768_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20768_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20768_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20768_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam
samtools index NA20768_clean_mkdup_sorted.aln.bam
samtools flagstat NA20768_clean_mkdup_sorted.aln.bam
1591010 + 0 in total (QC-passed reads + QC-failed reads)
19036 + 0 duplicates
1460204 + 0 mapped (91.78%:nan%)
1591010 + 0 paired in sequencing
795505 + 0 read1
795505 + 0 read2
1377088 + 0 properly paired (86.55%:nan%)
1432155 + 0 with itself and mate mapped
28049 + 0 singletons (1.76%:nan%)
1980 + 0 with mate mapped to a different chr
1411 + 0 with mate mapped to a different chr (mapQ>=5)


############# NA20770 ########### 
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20770_1_fixed.fastq > H2_hg19_align/NA20770_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20770_2_fixed.fastq > H2_hg19_align/NA20770_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20770\tPL:ILLUMINA\tLB:Lib3\tSM:NA20770' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta H2_hg19_align/NA20770_1.sai H2_hg19_align/NA20770_2.sai NA20770_1_fixed.fastq NA20770_2_fixed.fastq > H2_hg19_align/NA20770_aln.sam
cd H2_hg19_align
samtools view -bS NA20770_aln.sam > NA20770_aln.bam
cd ../../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20770_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20770_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20770_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20770_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20770_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20770_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20770_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam
samtools index NA20770_clean_mkdup_sorted.aln.bam
samtools flagstat NA20770_clean_mkdup_sorted.aln.bam
1758356 + 0 in total (QC-passed reads + QC-failed reads)
69104 + 0 duplicates
1505583 + 0 mapped (85.62%:nan%)
1758356 + 0 paired in sequencing
879178 + 0 read1
879178 + 0 read2
1330652 + 0 properly paired (75.68%:nan%)
1457981 + 0 with itself and mate mapped
47602 + 0 singletons (2.71%:nan%)
2566 + 0 with mate mapped to a different chr
1744 + 0 with mate mapped to a different chr (mapQ>=5)


############# NA20890 ########### 
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Spring_2012_miseq/data/intensities/basecalls
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20890_1_fixed.fastq > H2_hg19_align/NA20890_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA20890_2_fixed.fastq > H2_hg19_align/NA20890_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA20890\tPL:ILLUMINA\tLB:Lib3\tSM:NA20890' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta H2_hg19_align/NA20890_1.sai H2_hg19_align/NA20890_2.sai NA20890_1_fixed.fastq NA20890_2_fixed.fastq > H2_hg19_align/NA20890_aln.sam
cd H2_hg19_align
samtools view -bS NA20890_aln.sam > NA20890_aln.bam
cd ../../../../../Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20890_aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20890_clean.aln.bam
java -jar SortSam.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20890_clean.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20890_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_align/NA20890_clean_sorted.aln.bam OUTPUT=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20890_clean_mkdup_sorted.aln.bam METRICS_FILE=../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam/NA20890_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd ../../Spring_2012_miseq/data/intensities/basecalls/H2_hg19_finished_bam
samtools index NA20890_clean_mkdup_sorted.aln.bam
samtools flagstat NA20890_clean_mkdup_sorted.aln.bam
1714622 + 0 in total (QC-passed reads + QC-failed reads)
54685 + 0 duplicates
1485893 + 0 mapped (86.66%:nan%)
1714622 + 0 paired in sequencing
857311 + 0 read1
857311 + 0 read2
1320810 + 0 properly paired (77.03%:nan%)
1447959 + 0 with itself and mate mapped
37934 + 0 singletons (2.21%:nan%)
1690 + 0 with mate mapped to a different chr
1099 + 0 with mate mapped to a different chr (mapQ>=5)


################### look at haplotypes of NA21512 (H2.a1.g1) ##################

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/my_region/MKK.ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/my_region/MKK.map > /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/my_region/MKK.bgl

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/my_region/MKK.bgl markers=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_input/OMNI_affy5names_intersect_hg18.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/imputation/imputation_output/out_unrel


########################### PSP conversion and imputation May 9, 2012 ###########################
plink --bfile /Users/lindaboettger/McCarroll_Projects/PSP/PSP/PSP-allcase-cont-17q --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/PSP/PSP-allcase-cont-17q


ped_to_beagle is here:
cd /Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/PSP/PSP/PSP-allcase-cont-17q.ped /Users/lindaboettger/McCarroll_Projects/PSP/PSP/PSP-allcase-cont-17q.map > //Users/lindaboettger/McCarroll_Projects/PSP/PSP/PSP-allcase-cont-17q.bgl

1/2 allele coding, if Illumina's A/B will need to be converted: http://www.openbioinformatics.org/gengen/tutorial_allele_coding.html#plink12


####### lift over hg18 to hg19

these snps don't convert:
#Deleted in new
chr17:41235818-41235818
#Deleted in new
chr17:41560151-41560151
#Deleted in new
chr17:42214305-42214305
----> removing from original plink file (by setting pos to neg value) along with out of HWE etc.

plink --file /Users/lindaboettger/McCarroll_Projects/PSP/PSP-allcase-cont-17q.dbsnp --hardy --geno 0.1 --mind 0.1 --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/PSP-allcase-cont-17q.filtered

### exclude SNPS HWE p <= 0.001
###exclude individuals with less than 90% data
###exclude snps with less than 90% genotyping rate
### no maf cutoff was used

#### check strand between 1kg and PSP ####
plink --bfile mydata --flip-scan (gives flipscan output file ###
A simple approach to detect some proportion of such SNPs uses differential patterns of LD in cases versus controls: the command --flip-scan will query each SNP, and calculate the signed correlation between it and a set of nearby SNPs in cases and controls separately (of course, with the --pheno command, case and control status can be set to represent any binary split of the sample). 
### might be strange cuz PSP all euro and 1kg many pops….
To specify an alternate phenotype for analysis, i.e. other than the one in the *.ped file (or, if using a binary fileset, the *.fam file), use the --pheno option:
plink --file mydata --pheno pheno.txt
where pheno.txt is a file that contains 3 columns (one row per individual):

     Family ID
     Individual ID
     Phenotype

##### first convert 1kg samples into plink
##### used my own R code for this

#### found overlapping SNPs in two datasets
# decided to use HM3 imputation dataset because 217 SNPs overlap and only 92 overlap using 1kg data
#replace "?" with "0" in  HM3
perl -nle 's/\?/  0/g; print;' /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3.ped > /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3fix.ped 
### trim both datasets to just overlapping SNPs ###3


plink --map /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3.map --ped /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3fix.ped --extract /Users/lindaboettger/McCarroll_Projects/PSP/PSP_HM3_overlap.txt --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3

plink --map /Users/lindaboettger/McCarroll_Projects/PSP/PSP_hg19.filtered.map --ped /Users/lindaboettger/McCarroll_Projects/PSP/PSP-allcase-cont-17q.filtered.ped --extract /Users/lindaboettger/McCarroll_Projects/PSP/PSP_HM3_overlap.txt --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSP

###### merge and check for snps disrupting LD ####
awk < /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSP.ped '{ print $1, $2, $3 }' > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/pspnames.txt

awk < /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3.ped '{ print $1, $2, $3 }' > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3names.txt

### find snps with more than 2 alleles ###
plink --file /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3 --merge /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSP.ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSP.map --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/merge.txt
##flip strand
plink --file /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSP --flip /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/merge.txt.missnp --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSPfix1.ped

plink --file /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3 --merge /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSPstrandfix.ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSPstrandfix.map --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/all

plink --bfile /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/PSPstrandfix --bmerge /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3.bed /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3.bim /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/hm3.fam --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/all
### SNPs out of order

###shows no disruption of LD
plink --bfile /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/all --pheno /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/pheno.txt --flip-scan --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/flipscan


######### convert into beagle format…. will have to adjust 0s to ? and keep encoded ones later ##########
ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5

./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.map > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.bgl

awk < /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.ped '{ print $2}' > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.names


############### all unphased, imputing and phasing together ###################
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.bgl missing=? out=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder_imputed.bgl


######### something went wrong with the bgl to ped conversion, will need to redo ###
plink --map /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3.map --ped /Users/lindaboettger/McCarroll_Projects/PSP/imputation_data_13022012/imputation_cnv_panel_hm3fix.ped --extract /Users/lindaboettger/McCarroll_Projects/PSP/PSP_HM3_overlap.txt --recode --out /Users/lindaboettger/McCarroll_Projects/PSP/May11_overlap/hm3

java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed.bgl missing=? out=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed_phased2





######## look at LD again
###shows no disruption of LD
plink --file /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder --pheno /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/pheno.txt --flip-scan --flip-scan-verbose --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/flipscan2 ---> looks OK

###shows no disruption of LD
plink --ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.ped --map /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder3.map --map3 --pheno /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/pheno.txt --flip-scan --flip-scan-verbose --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/flipscan2 --flip-scan-threshold 0.4 --ld-window 300

#### change beagle back to plink and look again
ped_to_beagle is here:
/Users/lindaboettger/bioapps/germline-1-5
./bgl_to_ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed.bgl > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed_back.ped

./bgl_to_ped /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed.bgl /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/all.fam > /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed_back.ped

plink --map /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/allreorder.map --ped 

 --pheno /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/pheno.txt --flip-scan --flip-scan-verbose --out /Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/flipscan2




#### forced H1/H2 difference based on tag SNP
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/allreorder_encodefixed.bgl missing=? out=/Users/lindaboettger/McCarroll_Projects/PSP/overlap_hm3_psp/fixed/fixencoding/forceINV_phased
---> r2 not good 



################################ May 16, 2012 -  Hpr alignments ##########################

/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr

screen
bsub -Is -q week bash
unzip run_240259_fastq.zip
cd data/intensities/basecalls
gunzip *


#### NA18862 - Hpr #####
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr
sed -e s/.1:N:0:1/\\/1/ NA18862_S2_L001_R1_001.fastq > NA18862_S2_L001_R1_001_fixed.fastq
sed -e s/.2:N:0:1/\\/2/ NA18862_S2_L001_R2_001.fastq > NA18862_S2_L001_R2_001_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA18862_S2_L001_R1_001_fixed.fastq > align/NA18862_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA18862_S2_L001_R2_001_fixed.fastq > align/NA18862_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA18862\tPL:ILLUMINA\tLB:Lib1\tSM:NA18862' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA18862_1.sai align/NA18862_2.sai NA18862_S2_L001_R1_001_fixed.fastq NA18862_S2_L001_R2_001_fixed.fastq > align/NA18862_aln.sam
samtools view -bS align/NA18862_aln.sam > align/NA18862_aln.bam
cd /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA18862_aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA18862_clean.aln.bam
java -jar SortSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA18862_clean.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA18862_clean.sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA18862_clean.sorted.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA18862_clean.sorted.mrkdup.aln.bam METRICS_FILE=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA18862_clean.sorted.mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/
samtools index NA18862_clean.sorted.mrkdup.aln.bam
samtools flagstat NA18862_clean.sorted.mrkdup.aln.bam
4222104 + 0 in total (QC-passed reads + QC-failed reads)
205735 + 0 duplicates
3985299 + 0 mapped (94.39%:nan%)
4222104 + 0 paired in sequencing
2111052 + 0 read1
2111052 + 0 read2
3815724 + 0 properly paired (90.37%:nan%)
3936118 + 0 with itself and mate mapped
49181 + 0 singletons (1.16%:nan%)
6964 + 0 with mate mapped to a different chr
5122 + 0 with mate mapped to a different chr (mapQ>=5)
samtools view -c NA18862_clean.sorted.mrkdup.aln.bam 16:71900000-72260000
2345900/3985299
58% on target


##### NA19197 - Hpr #######

use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr
sed -e s/.1:N:0:1/\\/1/ NA19197_S3_L001_R1_001.fastq > NA19197_S3_L001_R1_001_fixed.fastq
sed -e s/.2:N:0:1/\\/2/ NA19197_S3_L001_R2_001.fastq > NA19197_S3_L001_R2_001_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA19197_S3_L001_R1_001_fixed.fastq > align/NA19197_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA19197_S3_L001_R2_001_fixed.fastq > align/NA19197_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA19197\tPL:ILLUMINA\tLB:Lib1\tSM:NA19197' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA19197_1.sai align/NA19197_2.sai NA19197_S3_L001_R1_001_fixed.fastq NA19197_S3_L001_R2_001_fixed.fastq > align/NA19197_aln.sam
samtools view -bS align/NA19197_aln.sam > align/NA19197_aln.bam
cd /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19197_aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19197_clean.aln.bam
java -jar SortSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19197_clean.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19197_clean.sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19197_clean.sorted.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA19197_clean.sorted.mrkdup.aln.bam METRICS_FILE=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA19197_clean.sorted.mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/
samtools index NA19197_clean.sorted.mrkdup.aln.bam
samtools flagstat NA19197_clean.sorted.mrkdup.aln.bam
4350628 + 0 in total (QC-passed reads + QC-failed reads)
463206 + 0 duplicates
3998821 + 0 mapped (91.91%:nan%)
4350628 + 0 paired in sequencing
2175314 + 0 read1
2175314 + 0 read2
3721440 + 0 properly paired (85.54%:nan%)
3935697 + 0 with itself and mate mapped
63124 + 0 singletons (1.45%:nan%)
4403 + 0 with mate mapped to a different chr
2714 + 0 with mate mapped to a different chr (mapQ>=5)
samtools view -c NA19197_clean.sorted.mrkdup.aln.bam 16:71900000-72260000
2675287/3998821
66% on target


###NA19238 Hpr ########
use LSF
bsub -Is -q week bash
use Samtools
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr
sed -e s/.1:N:0:1/\\/1/ NA19238_S1_L001_R1_001.fastq > NA19238_S1_L001_R1_001_fixed.fastq
sed -e s/.2:N:0:1/\\/2/ NA19238_S1_L001_R2_001.fastq > NA19238_S1_L001_R2_001_fixed.fastq
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA19238_S1_L001_R1_001_fixed.fastq > align/NA19238_1.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa aln -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta NA19238_S1_L001_R2_001_fixed.fastq > align/NA19238_2.sai
/humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/bwa-0.5.9/bwa sampe -r '@RG\tID:Run1_NA19238\tPL:ILLUMINA\tLB:Lib1\tSM:NA19238' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta align/NA19238_1.sai align/NA19238_2.sai NA19238_S1_L001_R1_001_fixed.fastq NA19238_S1_L001_R2_001_fixed.fastq > align/NA19238_aln.sam
samtools view -bS align/NA19238_aln.sam > align/NA19238_aln.bam
cd /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/picard-tools-1.48
java -jar CleanSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19238_aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19238_clean.aln.bam
java -jar SortSam.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19238_clean.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19238_clean.sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT
java -jar MarkDuplicates.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/NA19238_clean.sorted.aln.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA19238_clean.sorted.mrkdup.aln.bam METRICS_FILE=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA19238_clean.sorted.mrkdup_metrics VALIDATION_STRINGENCY=LENIENT
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/
samtools index NA19238_clean.sorted.mrkdup.aln.bam
samtools flagstat NA19238_clean.sorted.mrkdup.aln.bam
3444274 + 0 in total (QC-passed reads + QC-failed reads)
246681 + 0 duplicates
3247187 + 0 mapped (94.28%:nan%)
3444274 + 0 paired in sequencing
1722137 + 0 read1
1722137 + 0 read2
3094816 + 0 properly paired (89.85%:nan%)
3167378 + 0 with itself and mate mapped
79809 + 0 singletons (2.32%:nan%)
7668 + 0 with mate mapped to a different chr
5928 + 0 with mate mapped to a different chr (mapQ>=5)
samtools view -c NA19238_clean.sorted.mrkdup.aln.bam 16:71900000-72260000
1898199/3247187
58% on target





variant calling
http://www.broadinstitute.org/gsa/wiki/index.php/Best_Practice_Variant_Detection_with_the_GATK_v3

#Initial_variant_discovery_and_genotyping
Deep (> 10x coverage per sample) data 
    we recommend a minimum confidence score threshold of Q30

raw.vcf <- unifiedGenotyper(sample1.bam, sample2.bam, ..., sampleN.bam)
HprDup.vcf <- unifiedGenotyper(NA18862_clean.sorted.mrkdup.aln.bam, NA19197_clean.sorted.mrkdup.aln.bam, NA19238_clean.sorted.mrkdup.aln.bam)



~/bin
wget ftp://ftp.broadinstitute.org/pub/gsa/GenomeAnalysisTK/GenomeAnalysisTK-1.6-7-g2be5704.tar.bz2
tar xvjf GenomeAnalysisTK-1.6-7-g2be5704.tar.bz2

##look at coverage
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CoverageBySample -I NA18862_clean.sorted.mrkdup.aln.bam -I NA19197_clean.sorted.mrkdup.aln.bam -I NA19238_clean.sorted.mrkdup.aln.bam -L 16:71900000-72260000 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -o coverage

## create raw vcf
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T UnifiedGenotyper -I NA18862_clean.sorted.mrkdup.aln.bam -I NA19197_clean.sorted.mrkdup.aln.bam -I NA19238_clean.sorted.mrkdup.aln.bam -L 16:71900000-72260000 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -o Hpr_raw.vcf

-----> don't have any training datasets
ftp://boettger@ftp.broadinstitute.org/bundle/1.2/b37/dbsnp_132.b37.vcf.gz

## Variant quality score recalibration
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantRecalibrator --input Hpr_raw.vcf -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta --recal_file hpr.snp.recal --tranches_file hpr.snp.tranches -an DP -an FS -an BaseQRankSum -an MQ -an MQ0 -an MQRankSum -an QD -an ReadPosRankSum -resource:hapmap,known=false,training=true,truth=true,prior=15.0 /humgen/gsa-hpprojects/GATK/bundle/current/b37/hapmap_3.3.b37.sites.vcf -resource:omni,known=false,training=true,truth=false,prior=12.0 /humgen/gsa-hpprojects/GATK/bundle/current/b37/1000G_omni2.5.b37.sites.vcf -resource:dbsnp,known=true,training=false,truth=false,prior=8.0 /humgen/gsa-hpprojects/GATK/bundle/current/b37/dbsnp_135.b37.vcf



INFO  15:47:56,729 VariantDataManager - DP: 	 mean = 692.44	 standard deviation = 169.87 
INFO  15:47:56,729 VariantDataManager - FS: 	 mean = 5.30	 standard deviation = 6.13 
INFO  15:47:56,730 VariantDataManager - BaseQRankSum: 	 mean = -0.10	 standard deviation = 1.61 
INFO  15:47:56,744 VariantDataManager - MQ: 	 mean = 58.12	 standard deviation = 1.72 
INFO  15:47:56,749 VariantDataManager - MQ0: 	 mean = 0.23	 standard deviation = 0.49 
INFO  15:47:56,753 VariantDataManager - MQRankSum: 	 mean = 0.91	 standard deviation = 1.27 
INFO  15:47:56,758 VariantDataManager - QD: 	 mean = 27.78	 standard deviation = 6.50 
INFO  15:47:56,762 VariantDataManager - ReadPosRankSum: 	 mean = 0.68	 standard deviation = 1.89 
INFO  15:47:56,767 VariantDataManager - Training with 180 variants after standard deviation thresholding. 
WARN  15:47:56,771 VariantDataManager - WARNING: Training with very few variant sites! Please check the model reporting PDF to ensure the quality of the model is reliable. 
INFO  15:47:56,780 GaussianMixtureModel - Initializing model with 30 k-means iterations... 
INFO  15:47:57,058 VariantRecalibratorEngine - Finished iteration 0. 
INFO  15:47:57,158 VariantRecalibratorEngine - Finished iteration 5. 	Current change in mixture coefficients = 0.34766 
INFO  15:47:57,184 VariantRecalibratorEngine - Finished iteration 10. 	Current change in mixture coefficients = 0.06850 
INFO  15:47:57,196 VariantRecalibratorEngine - Convergence after 12 iterations! 
INFO  15:47:57,221 VariantRecalibratorEngine - Evaluating full set of 834 variants... 
INFO  15:47:57,225 VariantDataManager - Found 0 variants overlapping bad sites training tracks. 
##### ERROR ------------------------------------------------------------------------------------------
##### ERROR A USER ERROR has occurred (version 1.6-7-g2be5704): 
##### ERROR The invalid arguments or inputs must be corrected before the GATK can proceed
##### ERROR Please do not post this error to the GATK forum
##### ERROR
##### ERROR See the documentation (rerun with -h) for this tool to view allowable command-line arguments.
##### ERROR Visit our wiki for extensive documentation http://www.broadinstitute.org/gsa/wiki
##### ERROR Visit our forum to view answers to commonly asked questions http://getsatisfaction.com/gsa
##### ERROR
##### ERROR MESSAGE: Bad input: Error during negative model training. Minimum number of variants to use in training is larger than the whole call set. One can attempt to lower the --minNumBadVariants arugment but this is unsafe.
##### ERROR ------------------------------------------------------------------------------------------

##### instead will just look at depth of coverage (12x is considered callable) --> also excluding duplication area
DepthOfCoverage --next one

### conservative estimate for breakpoint of duplications
16:72094702-72111503

### for NA18862
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callinfo_NA18862 -o coverage_NA18862.bed --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I NA18862_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503

## NA19197
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA19197 -o callableinfo/coverage_NA19197.bed --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I NA19197_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503


##NA19238
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA19238 -o callableinfo/coverage_NA19238.bed --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I NA19238_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503

#### making variant file in Beagle format
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantsToBeagleUnphased --variants Hpr_raw.vcf -o Hpr_variants.bgl -missing 0 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 


##### look at allele counts for each base ####
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T DepthOfCoverage --printBaseCounts --out callableinfo/alleleratio -I bams/NA18862_clean.sorted.mrkdup.aln.bam -I bams/NA19197_clean.sorted.mrkdup.aln.bam -I bams/NA19238_clean.sorted.mrkdup.aln.bam -L 16:71900000-72260000 -XL 16:72094702-72111503 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 

java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T AlleleBalanceBySample

Available annotations for the VCF FORMAT field:
    ReadDepthAndAllelicFractionBySample
    AlleleBalanceBySample
    DepthPerAlleleBySample
    MappingQualityZeroBySample

### for NA18862
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantAnnotator --variant Hpr_raw.vcf --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503 -A AlleleBalanceBySample -o Hpr_alleleratio.vcf -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 

java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantFiltration --variant Hpr_raw.vcf --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503 -A AlleleBalanceBySample -o Hpr_alleleratio.vcf -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 

###### want to more closely examine ~70 SNPs to check





#### NA19197 almost always is odd one out, perhaps it has unduplicated chromosome 
write R program to get number of loci where individuals are different and are part of callable loci ####

java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantEval

####################### GATK commands #############################

java -jar GenomeAnalysisTK.jar -T <analysis_type> [-args <arg_file>] [-I <input_file>] [-rbs <read_buffer_size>] [-et 
       <phone_home>] [-K <gatk_key>] [-rf <read_filter>] [-L <intervals>] [-XL <excludeIntervals>] [-isr <interval_set_rule>] 
       [-im <interval_merging>] [-R <reference_sequence>] [-ndrs] [-dt <downsampling_type>] [-dfrac <downsample_to_fraction>] 
       [-dcov <downsample_to_coverage>] [-baq <baq>] [-baqGOP <baqGapOpenPenalty>] [-PF <performanceLog>] [-OQ] [-BQSR <BQSR>] 
       [-qq <quantize_quals>] [-DBQ <defaultBaseQualities>] [-S <validation_strictness>] [-U <unsafe>] [-nt <num_threads>] 
       [-bfh <num_bam_file_handles>] [-rgbl <read_group_black_list>] [-ped <pedigree>] [-pedString <pedigreeString>] 
       [-pedValidationType <pedigreeValidationType>] [-l <logging_level>] [-log <log_to_file>] [-h]

 -T,--analysis_type <analysis_type>                                     Type of analysis to run
 -args,--arg_file <arg_file>                                            Reads arguments from the specified file
 -I,--input_file <input_file>                                           SAM or BAM file(s)
 -rbs,--read_buffer_size <read_buffer_size>                             Number of reads per SAM file to buffer in memory
 -et,--phone_home <phone_home>                                          What kind of GATK run report should we generate? 
                                                                        STANDARD is the default, can be NO_ET so nothing 
                                                                        is posted to the run repository. Please see 
                                                                        broadinstitute.org/gsa/wiki/index.php/Phone_home 
                                                                        for details. (NO_ET|STANDARD|STDOUT)
 -K,--gatk_key <gatk_key>                                               GATK Key file. Required if running with -et 
                                                                        NO_ET. Please see 
                                                                        broadinstitute.org/gsa/wiki/index.php/Phone_home 
                                                                        for details.
 -rf,--read_filter <read_filter>                                        Specify filtration criteria to apply to each 
                                                                        read individually
 -L,--intervals <intervals>                                             One or more genomic intervals over which to 
                                                                        operate. Can be explicitly specified on the 
                                                                        command line or in a file (including a rod file)
 -XL,--excludeIntervals <excludeIntervals>                              One or more genomic intervals to exclude from 
                                                                        processing. Can be explicitly specified on the 
                                                                        command line or in a file (including a rod file)
 -isr,--interval_set_rule <interval_set_rule>                           Indicates the set merging approach the interval 
                                                                        parser should use to combine the various -L or 
                                                                        -XL inputs (UNION|INTERSECTION)
 -im,--interval_merging <interval_merging>                              Indicates the interval merging rule we should 
                                                                        use for abutting intervals (ALL|
                                                                        OVERLAPPING_ONLY)
 -R,--reference_sequence <reference_sequence>                           Reference sequence file
 -ndrs,--nonDeterministicRandomSeed                                     Makes the GATK behave non deterministically, 
                                                                        that is, the random numbers generated will be 
                                                                        different in every run
 -dt,--downsampling_type <downsampling_type>                            Type of reads downsampling to employ at a given 
                                                                        locus.  Reads will be selected randomly to be 
                                                                        removed from the pile based on the method 
                                                                        described here (NONE|ALL_READS|BY_SAMPLE)
 -dfrac,--downsample_to_fraction <downsample_to_fraction>               Fraction [0.0-1.0] of reads to downsample to
 -dcov,--downsample_to_coverage <downsample_to_coverage>                Coverage [integer] to downsample to at any given 
                                                                        locus; note that downsampled reads are randomly 
                                                                        selected from all possible reads at a locus
 -baq,--baq <baq>                                                       Type of BAQ calculation to apply in the engine 
                                                                        (OFF|CALCULATE_AS_NECESSARY|RECALCULATE)
 -baqGOP,--baqGapOpenPenalty <baqGapOpenPenalty>                        BAQ gap open penalty (Phred Scaled).  Default 
                                                                        value is 40.  30 is perhaps better for whole 
                                                                        genome call sets
 -PF,--performanceLog <performanceLog>                                  If provided, a GATK runtime performance log will 
                                                                        be written to this file
 -OQ,--useOriginalQualities                                             If set, use the original base quality scores 
                                                                        from the OQ tag when present instead of the 
                                                                        standard scores
 -BQSR,--BQSR <BQSR>                                                    Filename for the input covariates table 
                                                                        recalibration .csv file which enables on the fly 
                                                                        base quality score recalibration
 -qq,--quantize_quals <quantize_quals>                                  Quantize quality scores to a given number of 
                                                                        levels.
 -DBQ,--defaultBaseQualities <defaultBaseQualities>                     If reads are missing some or all base quality 
                                                                        scores, this value will be used for all base 
                                                                        quality scores
 -S,--validation_strictness <validation_strictness>                     How strict should we be with validation (STRICT|
                                                                        LENIENT|SILENT)
 -U,--unsafe <unsafe>                                                   If set, enables unsafe operations: nothing will 
                                                                        be checked at runtime.  For expert users only 
                                                                        who know what they are doing.  We do not support 
                                                                        usage of this argument. (ALLOW_UNINDEXED_BAM|
                                                                        ALLOW_UNSET_BAM_SORT_ORDER|
                                                                        NO_READ_ORDER_VERIFICATION|
                                                                        ALLOW_SEQ_DICT_INCOMPATIBILITY|ALL)
 -nt,--num_threads <num_threads>                                        How many threads should be allocated to running 
                                                                        this analysis.
 -bfh,--num_bam_file_handles <num_bam_file_handles>                     The total number of BAM file handles to keep 
                                                                        open simultaneously
 -rgbl,--read_group_black_list <read_group_black_list>                  Filters out read groups matching <TAG>:<STRING> 
                                                                        or a .txt file containing the filter strings one 
                                                                        per line.
 -ped,--pedigree <pedigree>                                             Pedigree files for samples
 -pedString,--pedigreeString <pedigreeString>                           Pedigree string for samples
 -pedValidationType,--pedigreeValidationType <pedigreeValidationType>   How strict should we be in validating the 
                                                                        pedigree information? (STRICT|SILENT)
 -l,--logging_level <logging_level>                                     Set the minimum level of logging, i.e. setting 
                                                                        INFO get's you INFO up to FATAL, setting ERROR 
                                                                        gets you ERROR and FATAL level logging.
 -log,--log_to_file <log_to_file>                                       Set the logging location
 -h,--help                                                              Generate this help message

 alignment                       Analyses used to validate the correctness and performance the BWA Java bindings.
   Align                         Aligns reads to a given reference using Heng Li's BWA aligner, presenting the resulting 
                                 alignments in SAM or BAM format.
   AlignmentValidation           Validates consistency of the aligner interface by taking reads already aligned by BWA 
                                 in a BAM file, stripping them of their alignment data, realigning them, and making sure 
                                 one of the best resulting realignments matches the original alignment from the input 
                                 file.
   CountBestAlignments           Counts the number of best alignments as presented by BWA and outputs a histogram of 
                                 number of placements vs.
                                 
 annotator                       
   VariantAnnotator              Annotates variant calls with context information.
                                 
 beagle                          
   BeagleOutputToVCF             Takes files produced by Beagle imputation engine and creates a vcf with modified 
                                 annotations.
   ProduceBeagleInput            Converts the input VCF into a format accepted by the Beagle imputation/analysis 
                                 program.
   VariantsToBeagleUnphased      Produces an input file to Beagle imputation engine, listing unphased, hard-called 
                                 genotypes for a single sample in input variant file.
                                 
 coverage                        
   CallableLoci                  Emits a data file containing information about callable, uncallable, poorly mapped, and 
                                 other parts of the genome <p/>
   CompareCallableLoci           Test routine for new VariantContext object
   DepthOfCoverage               Toolbox for assessing sequence coverage by a wide array of metrics, partitioned by 
                                 sample, read group, or library
   GCContentByInterval           Walks along reference and calculates the GC content for each interval.
                                 
 diagnostics                     
   ErrorRatePerCycle             Computes the read error rate per position in read (in the original 5'->3' orientation 
                                 that the read had coming off the machine)  Emits a GATKReport containing readgroup, 
                                 cycle, mismatches, counts, qual, and error rate for each read group in the input BAMs 
                                 FOR ONLY THE FIRST OF PAIR READS.
   ReadGroupProperties           Emits a GATKReport containing read group, sample, library, platform, center, sequencing 
                                 data, paired end status, simple read type name (e.g.
   ReadLengthDistribution        Outputs the read lengths of all the reads in a file.
                                 
 diffengine                      
   DiffObjects                   A generic engine for comparing tree-structured objects
                                 
 examples                        
   CoverageBySample              Computes the coverage per sample.
   GATKPaperGenotyper            A simple Bayesian genotyper, that outputs a text based call format.
                                 
 fasta                           
   FastaAlternateReferenceMaker  Generates an alternative reference sequence over the specified interval.
   FastaReferenceMaker           Renders a new reference in FASTA format consisting of only those loci provided in the 
                                 input data set.
   FastaStats                    Calculates basic statistics about the reference sequence itself
                                 
 filters                         
   VariantFiltration             Filters variant calls using a number of user-selectable, parameterizable criteria.
                                 
 genotyper                       
   UnifiedGenotyper              A variant caller which unifies the approaches of several disparate callers -- Works for 
                                 single-sample and multi-sample data.
                                 
 indels                          
   IndelRealigner                Performs local realignment of reads based on misalignments due to the presence of 
                                 indels.
   LeftAlignIndels               Left-aligns indels from reads in a bam file.
   RealignerTargetCreator        Emits intervals for the Local Indel Realigner to target for realignment.
   SomaticIndelDetector          Tool for calling indels in Tumor-Normal paired sample mode; this tool supports 
                                 single-sample mode as well, but this latter functionality is now superceded by 
                                 UnifiedGenotyper.
                                 
 phasing                         
   PhaseByTransmission           Computes the most likely genotype combination and phases trios and parent/child pairs
   ReadBackedPhasing             Walks along all variant ROD loci, caching a user-defined window of VariantContext 
                                 sites, and then finishes phasing them when they go out of range (using upstream and 
                                 downstream reads).
                                 
 qc                              
   CountBases                    Walks over the input data set, calculating the number of reads seen for diagnostic 
                                 purposes.
   CountIntervals                Counts the number of contiguous regions the walker traverses over.
   CountLoci                     Walks over the input data set, calculating the total number of covered loci for 
                                 diagnostic purposes.
   CountMales                    Walks over the input data set, calculating the number of reads seen for diagnostic 
                                 purposes.
   CountReadEvents               Walks over the input data set, counting the number of reads ending in 
                                 insertions/deletions or soft-clips
   CountReads                    Walks over the input data set, calculating the number of reads seen for diagnostic 
                                 purposes.
   CountRODs                     Prints out counts of the number of reference ordered data objects encountered.
   CountRODsByRef                Prints out counts of the number of reference ordered data objects encountered.
   CountTerminusEvent            Walks over the input data set, counting the number of reads ending in 
                                 insertions/deletions or soft-clips
   CycleQuality                  Walks over the input data set, calculating the number of reads seen for diagnostic 
                                 purposes.
   ErrorThrowing                 a walker that simply throws errors.
   QCRef                         Prints out counts of the number of reference ordered data objects encountered.
   ReadClippingStats             Walks over the input reads, printing out statistics about the read length, number of 
                                 clipping events, and length of the clipping to the output stream.
   ReadValidation                Checks all reads passed through the system to ensure that the same read is not passed 
                                 to the walker multiple consecutive times.
   RodSystemValidation           a walker for validating (in the style of validating pile-up) the ROD system.
   ValidatingPileup              At every locus in the input set, compares the pileup data (reference base, aligned base 
                                 from each overlapping read, and quality score) to the reference pileup data generated 
                                 by samtools.
                                 
 recalibration                   
   CountCovariates               First pass of the base quality score recalibration -- Generates recalibration table 
                                 based on various user-specified covariates (such as reported quality score, cycle, and 
                                 dinucleotide).
   TableRecalibration            Second pass of the base quality score recalibration -- Uses the table generated by 
                                 CountCovariates to update the base quality scores of the input bam file using a 
                                 sequential table calculation making the base quality scores more accurately reflect the 
                                 actual quality of the bases as measured by reference mismatch rate.
                                 
 targets                         
   DiagnoseTargets               Short one line description of the walker.
                                 
 validation                      
   GenotypeAndValidate           Genotypes a dataset and validates the calls of another dataset using the Unified 
                                 Genotyper.
   ValidationAmplicons           Creates FASTA sequences for use in Seqenom or PCR utilities for site amplification and 
                                 subsequent validation
                                 
 validationsiteselector          
   ValidationSiteSelector        Randomly selects VCF records according to specified options.
                                 
 varianteval                     
   VariantEval                   General-purpose tool for variant evaluation (% in dbSNP, genotype concordance, Ti/Tv 
                                 ratios, and a lot more)
                                 
 variantrecalibration            
   ApplyRecalibration            Applies cuts to the input vcf file (by adding filter lines) to achieve the desired 
                                 novel truth sensitivity levels which were specified during VariantRecalibration
   VariantRecalibrator           Create a Gaussian mixture model by looking at the annotations values over a high 
                                 quality subset of the input call set and then evaluate all input variants.
                                 
 variantutils                    
   CombineVariants               Combines VCF records from different sources.
   FilterLiftedVariants          Filters a lifted-over VCF file for ref bases that have been changed.
   LeftAlignVariants             Left-aligns indels from a variants file.
   LiftoverVariants              Lifts a VCF file over from one build to another.
   RandomlySplitVariants         Takes a VCF file, randomly splits variants into two different sets, and outputs 2 new 
                                 VCFs with the results.
   SelectHeaders                 Selects headers from a VCF source.
   SelectVariants                Selects variants from a VCF source.
   ValidateVariants              Strictly validates a variants file.
   VariantsToBinaryPed           Yet another VCF to Ped converter.
   VariantsToTable               Emits specific fields from a VCF file to a tab-deliminated table
   VariantsToVCF                 Converts variants from other file formats to VCF format.
   VariantValidationAssessor     Annotates a validation (from Sequenom for example) VCF with QC metrics (HW-equilibrium, 
                                 % failed probes)
                                 
 walkers                         Runs the desired analysis on the smallest meaningful subset of the dataset.
   ClipReads                     This tool provides simple, powerful read clipping capabilities to remove low quality 
                                 strings of bases, sections of reads, and reads containing user-provided sequences.
   FindReadsWithNames            Renders, in SAM/BAM format, all reads from the input data set in the order in which 
                                 they appear in the input file.
   FlagStat                      A reimplementation of the 'samtools flagstat' subcommand in the GATK.
   Pileup                        Prints the alignment in the pileup format.
   PrintReads                    Renders, in SAM/BAM format, all reads from the input data set in the order in which 
                                 they appear in the input file.
   PrintRODs                     Prints out all of the RODs in the input data set.
   SplitSamFile                  Divides the input data set into separate BAM files, one for each sample in the input 
                                 data set.
                                 
################ 

maybe for getting whole bam>
Arguments for CallableLoci:
-format,--format <format>                                                Output format (BED|STATE_PER_BASE

cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/

use LSF
bsub -Is -q week bash



how many reads containing the alt allele does it take for a SNP to be called?

probably worth tracking what the allelic balance is in the sites that are called -- hopefully it would show a binomial distribution centered around something close to 50/50




todo
1. make list of loci we want to look at (~70) ----> a little more than this since only using two people 
2. use vcftools to look at allele counts with --counts option

--positions <filename>
--exclude-positions <filename>

Include/exclude a set of sites on the basis of a list of positions in a file. Each line of the input file should contain a (tab-separated) chromosome and position. The file should have a header line. 


./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/vcf_Hpr/Hpr_raw.vcf --recode --indv NA18862 --indv NA19238 --positions /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/vcf_Hpr/Pos_to_Eval.txt --out /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/vcf_Hpr/Hpr_raw_poly.vcf


GT:AD:DP:GQ:PL  0/0:39,1:40:62.25:0,62,1088 AD is allele depth, in this case 39ref and 1 alt

use VariantsToTable               Emits specific fields from a VCF file to a tab-deliminated table

java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantsToTable --variant Hpr_raw.vcf --fields AD  --out Hpr_AD -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 
----> also didn't work


 callableinfo/alleleratio -I bams/NA18862_clean.sorted.mrkdup.aln.bam -I bams/NA19197_clean.sorted.mrkdup.aln.bam -I bams/NA19238_clean.sorted.mrkdup.aln.bam -L 16:71900000-72260000 -XL 16:72094702-72111503 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 

### orchestra interactive ####
bsub -Is -q shared_int_12h bash

#get only chr16
grep -n '>16' pt2hs_v2.fa > chimp_chr16.fa
bsub grep "\>16" pt2hs_v2.fa > chimp_chr16.fa

grep -n '>16' pt2hs_v2.fa > chimp_chr16.fa

31:>16
…… what I want should be on line 32

to print the second column of a file, you might use the following simple awk script:

        awk < file '{ print $2 }'

cut -f4-13 file

awk 'NR==32' "pt2hs_v2.fa" >> chimp_chr16.fa

get ### interval
16:71900000-72260000
360,000 bases

grep -n '>16'

############################## July 2nd 2012 ##################################################################################################################################################################
hadn't actually been enforcing any sort of mapping quality… so redoing analysis
### MQ set to 30
### must have 12x coverage over each site at 30 MQ
hopefully this will get rid of a lot of sites with odd allele ratios

### for NA18862
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callinfo_NA18862 -o coverage_NA1886230MQ.bed --minMappingQuality 30 --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA18862_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503

## NA19197
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA19197 -o callableinfo/coverage_NA1919730MQ.bed --minMappingQuality 30 --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA19197_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503


##NA19238
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA19238 -o callableinfo/coverage_NA1923830MQ.bed --minMappingQuality 30 --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I bams/NA19238_clean.sorted.mrkdup.aln.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503


############# will re-pick SNPs in R using new callable loci tables
a lot of snps didn't look good, so I'm realigning around indels


############### code to realign areas around indels and remove PCR duplicates ###############
##NA19238
#get indels intervals to realign
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T RealignerTargetCreator \
    -I bams/NA19238_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:71900000-72260000 \
    --excludeIntervals 16:72094702-72111503 \
    -o bams/NA19238.realign.intervals 
   
#indel realign using intervals
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T IndelRealigner \
    -I bams/NA19238_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:71900000-72260000 \
    --excludeIntervals 16:72094702-72111503 \
    -o bams/NA19238.realign.bam \
    -targetIntervals bams/NA19238.realign.intervals

cd /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/picard-tools-1.48
java -jar MarkDuplicates.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA19238.realign.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA19238.realign.mkdup.bam METRICS_FILE=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA19238_realign.mrkdup_metrics VALIDATION_STRINGENCY=LENIENT

samtools index /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA19238.realign.mkdup.bam




###NA18862
#get indels intervals to realign
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T RealignerTargetCreator \
    -I bams/NA18862_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:71900000-72260000 \
    --excludeIntervals 16:72094702-72111503 \
    -o bams/NA18862.realign.intervals 
   
#indel realign using intervals
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T IndelRealigner \
    -I bams/NA18862_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:71900000-72260000 \
    --excludeIntervals 16:72094702-72111503 \
    -o bams/NA18862.realign.bam \
    -targetIntervals bams/NA18862.realign.intervals

cd /humgen/cnp04/sandbox/lboettger/Dec2010_17q21.31/picard-tools-1.48
java -jar MarkDuplicates.jar INPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA18862.realign.bam OUTPUT=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA18862.realign.mkdup.bam METRICS_FILE=/humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/NA18862_realign.mrkdup_metrics VALIDATION_STRINGENCY=LENIENT

samtools index /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA18862.realign.mkdup.bam

########### Just Duplicated Region #####################################################################################################################################################################################################################################################################



###NA18862
#get indels intervals to realign
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T RealignerTargetCreator \
    -I bams/NA18862_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:72094702-72111503 \
    -o bams/NA18862.realigndup.intervals 


#indel realign using intervals
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T IndelRealigner \
    -I bams/NA18862_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:72094702-72111503 \
    -o bams/NA18862.realigndup.bam \
    -targetIntervals bams/NA18862.realigndup.intervals

samtools index bams/NA18862.realigndup.bam


###NA19238
#get indels intervals to realign
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T RealignerTargetCreator \
    -I bams/NA19238_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:72094702-72111503 \
    -o bams/NA19238.realigndup.intervals 


#indel realign using intervals
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T IndelRealigner \
    -I bams/NA19238_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:72094702-72111503 \
    -o bams/NA19238.realigndup.bam \
    -targetIntervals bams/NA19238.realigndup.intervals

samtools index bams/NA19238.realigndup.bam
###################################################################################################################################################################




samtools tview bams/NA19238.realign.bam /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta

## create raw vcf
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
       -T UnifiedGenotyper \
       -I bams/NA18862.realign.mkdup.bam \
       -I bams/NA19238.realign.mkdup.bam \
       --intervals 16:71900000-72260000 \
       --excludeIntervals 16:72094702-72111503 \
       -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
       -o Hpr_realign_raw.vcf

#### making variant file in Beagle format --> will make polybases input file
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T VariantsToBeagleUnphased --variants Hpr_realign_raw.vcf -o Hpr_realign_variants.bgl -missing 0 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 


### for NA18862
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA18862 -o coverage_NA18862_realign_30MQ.bed --minMappingQuality 30 --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/bams/NA18862.realign.mkdup.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503


##NA19238
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CallableLoci --summary callableinfo/callinfo_NA19238 -o callableinfo/coverage_NA19238_realign_30MQ.bed --minMappingQuality 30 --minDepth 12 --format BED -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -I bams/NA19238.realign.mkdup.bam --intervals 16:71900000-72260000 --excludeIntervals 16:72094702-72111503


########## look at only CN2 indvs in important regions ########
use LSF
bsub -Is -q week bash
./vcftools --vcf /humgen/cnp04/sandbox/lboettger/tgp_snps/HPR/ALL.chr16.VQSRv2_bcmGL_beagle.20101123.snps.genotypes.vcf --keep /humgen/cnp04/sandbox/lboettger/tgp_snps/HPR/nodupindvs.txt --chr 16 --from-bp 71900000 --to-bp 72260000 --recode --plink --out /humgen/cnp04/sandbox/lboettger/tgp_snps/HPR/HPRregion_CN2indvs


#get SNPs that I'm looking at

plink --file /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/CN2_1kg/HPRregion_CN2indvs --extract /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/CN2_1kg/handcheck2_SNPpositions.txt --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/CN2_1kg/CN2indvs_mySNPs


#look at frequency of these SNPs in CN2 indvs

plink --file data --freq

plink --file /Users/lindaboettger/McCarroll_Projects/HPR/Dating_Duplication/CN2_1kg/CN2indvs_mySNPs --freq 

882 individuals



########################### generate consensus file from vcf and reference #############################################################
cd /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/

use LSF
bsub -Is -q week bash



###usable range for dating
chr16:72111503-72234472

java -Xmx2g -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
   -T FastaAlternateReferenceMaker \
   -o /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/datreg_dupindv.fa \
   -L 16:72111503-72234472 \
   --variant /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/Hpr_realign_raw.vcf

#### get hg19 sequence for the same region
samtools faidx /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 16:71900000-72260000 > /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/myregion_16_71900000_72260000.fa


samtools faidx /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta 16:72111503-72234472 > /humgen/cnp04/sandbox/lboettger/Hpr/Spring2012_MiSeq_Hpr/align/finished_bam/hg19_16_72111503_72234472.fa



bsub -Is -q hour bash
bsub -Is -q week bash
#location of chimp sequence
/groups/reich/shop/work/temp_other_peeps/linda/pt2hs_v2.fa

### get just region we want
/opt/samtools/bin/samtools faidx /groups/reich/shop/work/temp_other_peeps/linda/pt2hs_v2.fa 16:72111503-72234472 > chimp_16_72111503_72234472.fa

perl -ne 'chomp; print;' chimp_dupcon_hg19.fa > temp.txt 
perl -nle 's/([\w -])/  $1\n/g; print;' temp.txt > chimp_dupcon_hg19_bybase.txt  

perl -ne 'chomp; print;' build_37seq_43-44mb.fa > c_build_37seq_43-44mb.fa


########## get Hpr OMNI SNPs #################
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 16 --from-bp 71095220 --to-bp 73102556 --recode --out /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/Hprregion


/Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Omni25_genotypes_1212_samples_v2.b37.vcf.gz 


#### getting african indivs (YRI, LWK, ASW) and 
./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/Hprregion.recode.vcf --plink-tped --keep /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/tgphased_Africans2.txt --out /Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg/HprReg_Africans_1kg --chr 16


###### get phased africans and remove duplication region
#duplication 16:72094702-72111503
plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg/HprReg_Africans_1kg.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg/HprReg_Africans_1kg.tfam --keep /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/tgphased_Africans2.txt --exclude /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/Dup_range.txt --range --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg/HprReg_Africans_1kg 



./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.map > /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.bgl
###### !!!!!!!!!!!!!!!!!! be careful that last two digits are left off bgl file !!!!!!!!!!!!!!!!!!
  
###phasing 1kg beagle indvs (OMNI)
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg_OMNI/HprReg_Africans_1kgCN.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/YRI_LWK_ASW_imputationReference/1kg_OMNI/HprReg_Africans_1kg.phased.bgl


##### grep from specific column
ls -l | awk '$3 == "16"' Human1M-Duov3_H_SNPlist.txt > I1M_chr16.txt




## July 18 2012 ---> impute Hpr duplication into Tishkoff data ###
#duplication 16:72094702-72111503
plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16.tfam --exclude /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/Dup_range.txt --range --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16_nodupregion

Problem with line 1 in [ /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16.tped ]
Expecting 4 + 2 * 613 = 1230 columns, but found more
## I have 1450 lines


1446/2 = 723 individuals ---> I do have 723 individuals, but many of them don't have population info

plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16_hg19.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16.tfam --exclude /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Hpr_region/Dup_range.txt --range --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/cnv_chr16_nodupregion

####make bgl file
./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.map > /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.bgl





######### merge and look for strand flips ########
plink --file /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/all_African_ref_Tish.overlap --merge /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/Tish.overlap.wref.ped /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/Tish.overlap.wref.map --out /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/out
 ---> gets misssnp file with more than two alleles

## recode Tishkoff data to new strands
plink --file data --flip list.txt --recode 

### merge then check for LD issues #########
plink --file /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/all_African_ref_Tish.overlap --merge /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/Tish_overlap_flip1.ped /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/all_African_ref_Tish.overlap.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/merged_flip1

To specify an alternate phenotype for analysis, i.e. other than the one in the *.ped file (or, if using a binary fileset, the *.fam file), use the --pheno option:
plink --file mydata --pheno pheno.txt
where pheno.txt is a file that contains 3 columns (one row per individual):

     Family ID
     Individual ID
     Phenotype


### check for LD
plink --file mydata --flip-scan



./ped_to_bgl /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.ped /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.map > /Users/lindaboettger/McCarroll_Projects/imputation/autism/mend_hardy/autismtoss.bgl



########## impute ########
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.bgl markers=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio.marker missing=-1 out=/Users/lindaboettger/McCarroll_Projects/c61_c63_c68CN_phasing/Steve_CEU/HM_trio_asunrel

java -Xmx1000m -jar beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/all_African_ref_Tish.overlap_noab.bgl unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/Tish_overlap_toimpute.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/markers.txt missing=0 out=

… didn't work well 

java -Xmx1000m -jar beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/all_African_ref_Tish.overlap_noab.bgl unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/Tish_overlap_toimpute.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/markers.txt missing=0 out=


 java -Xmx1000m -jar beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/ridoftransversions/imputed.out.all_African_ref_Tish.overlap_noab.notranv.phased unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/ridoftransversions/Tish_overlap_toimpute_notv.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/ridoftransversions/markers_notv.txt missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/ridoftransversions/Tish_overlap_imputeds niterations=15


####### this file imputed best #########
/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/ridofodd.test.Tish_overlap_toimpute_qq.bgl.phased
--> got rid of two odd Tagging SNPs that might be PSVs and got rid of flanks


####### the one that worked
####
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/Tish_overlap_toimpute_qq.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/all_African_ref_Tish.overlap_noab_q.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd.test excludemarkers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/tossSNPS.txt 


### phase it's ref 
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/all_African_ref_Tish.overlap_noab_q.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/ref


### try again with ref phased .885
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/Tish_overlap_toimpute_qq.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/ref.all_African_ref_Tish.overlap_noab_q.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/theone_phasedref

### try with getting rid of odd SNPs .886
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/Tish_overlap_toimpute_qq.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/ref.all_African_ref_Tish.overlap_noab_q.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/theone_phasedref_toss2 excludemarkers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/tossSNPS.txt

### same thing but with tabs instead of spaces OMFG r2=0.168
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/Tish_overlap_toimpute_q_tab.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/ref.all_African_ref_Tish.overlap_noab_q.bgl.tab.phased.bgl off_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/ref.all_African_ref_Tish.overlap_noab_q.bgl.phased markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/tabtest

### put back in the spaces .168
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/Tish_overlap_toimpute_q_space.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/ref.all_African_ref_Tish.overlap_noab_q.bgl.space.phased.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/test_space


####### what are the differences between these files?????????
diff /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/ref.all_African_ref_Tish.overlap_noab_q.bgl.phased /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/ref.all_African_ref_Tish.overlap_noab_q.bgl.space.phased.bgl

\ No newline at end of file

## diff between unphased
diff /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/Tish_overlap_toimpute_qq.bgl /Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/Tish_overlap_toimpute_q_space.bgl


### add newline just to phased file .168
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/Tish_overlap_toimpute_q_space.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/ref.all_African_ref_Tish.overlap_noab_q.bgl.space_newline.phased.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/refnewline

### add newline to both # 0.168
HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/Tish_overlap_toimpute_q_space_newline.txt phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/ref.all_African_ref_Tish.overlap_noab_q.bgl.space_newline.phased.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/both_newline

### it is not newline, looks like deleting first 100 SNPs ### yes!! 0.837
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/add_qs/Tish_overlap_toimpute_qq.bgl phased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/add_qs/ref.all_African_ref_Tish.overlap_noab_q.bgl.space_newline.phased.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/markers.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/trouble_shooting/ridofodd/phasing_working_one/tab/back_to_spaces/newline/add_qs/testqq

### re-doing imputation by adding in extra blank SNPs ##########
#for hap analysis
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/addSNPsback/Tish_overlap_imputed_tophase.bgl markers=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/addSNPsback/markers.txt missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Sarah/Tishkoff_1Mdata/imputation/strand_fix/addSNPsback/phased

######## add rows to HGDP imputation to have blank SNPs ######
HGDPdata=/Users/lindaboettger/McCarroll_Projects/HPR/HGDP/imputation

cp /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/Plink_format/formatting/HGDP_strandfix.bgl /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/imputation/blankSNPs/HGDP_Hpr_strandfix_blanksnp.tmp

##remove names
sed '1d' $HGDPdata/blankSNPs/HGDP_Hpr_strandfix_blanksnp.tmp > $HGDPdata/blankSNPs/test.txt

## make SNP names line numbers
awk '{$2=NR}1' $HGDPdata/blankSNPs/test.txt > $HGDPdata/blankSNPs/test1.txt

### make SNPs unknown "?"
sed 's/[A-Z]/?/g' <$HGDPdata/blankSNPs/test1.txt > $HGDPdata/blankSNPs/test2.txt

awk '{$1="M"}1' $HGDPdata/blankSNPs/test2.txt > $HGDPdata/blankSNPs/test3.txt

cat /Users/lindaboettger/McCarroll_Projects/HPR/HGDP/imputation/blankSNPs/HGDP_Hpr_strandfix_blanksnp.tmp $HGDPdata/blankSNPs/test3.txt > $HGDPdata/blankSNPs/HGDP_Hpr_strandfix_blanksnp.bgl

java -Xmx1000m -jar beagle.jar unphased=$HGDPdata/blankSNPs/HGDP_Hpr_strandfix_blanksnp.bgl missing=? out=$HGDPdata/blankSNPs/HGDP_Hpr


###### ftp to get malaria data

/humgen/cnp04/sandbox/lboettger/Malaria

wget -r ftp://username:password@ftpaddress/directoryname

wget -r ftp://ega-box-94:JFV7jMzE@ftp-private.ebi.ac.uk/EGAS00000000026_Cases

wget -r ftp://ega-box-94:JFV7jMzE@ftp-private.ebi.ac.uk/EGAS00000000026_Controls




######## python debugger

to load the debugger at a specific line, put in:

import pdb
pdb.set_trace()

to load the whole program so it runs in the debugger, add -m pdb to python, like

python -m pdb python_program.py
press "c" to start running and to continue running



########
bsub -Is -q week bash

. /broad/tools/scripts/useuse
reuse -q Python-2.6

python -u plot_spidergram_paper_Hpr.py Hpr_spider_input_shorter.phased African_smod_shorter.pdf
## this is actually an eps file output!!!!

### make it shorter and more spaces between dots

use Python-3.4

python -u plot_spidergram_paper_Hpr.py Hpr_spider_input_shorter.phased African_smod_shorter_test.pdf




tar -zcvf fastq1.tar.gz /humgen/cnp04/sandbox/lboettger/monty/fastq1





########## Dec 6th, 2012 Getting Chimp data to look at C4

ftp://birch.well.ox.ac.uk

at ftp://birch.well.ox.ac.uk.


get C4 region in hg18
chr6:32050000-32120000
10 chimps
get C4 region in hg18
chr6:32050000-32120000

wget ftp://birch.well.ox.ac.uk/BAMs/HG18/PtLI_rmdup_baq.bam.bai
wget ftp://birch.well.ox.ac.uk/BAMs/HG18/PtLI_rmdup_baq.bam

samtools view -b PtLI_rmdup_baq.bam chr6:32050000-32120000 > PtLI_C4.bam
samtools index PtLI_C4.bam
rm PtLI_rmdup_baq.bam
rm PtLI_rmdup_baq.bam.bai

####### Ded 11th, getting aligned to chimp genome ######
wget ftp://birch.well.ox.ac.uk/BAMs/PT2/PtRN_rmdup_recal.bam


samtools view -b PtRN_rmdup_recal.bam chr6:32545297-32562370 > PtRN_chimpalign_C4.bam
samtools index PtRN_chimpalign_C4.bam
rm PtRN_rmdup_recal.bam
rm PtRN_rmdup_recal.bam.bai


samtools view -b PtFR_rmdup_recal.bam chr6:32545297-32562370 > PtFR_chimpalign_C4.bam
samtools index PtFR_chimpalign_C4.bam
rm PtFR_rmdup_recal.bam
rm PtFR_rmdup_recal.bam.bai

samtools view -b PtLA_rmdup_recal.bam chr6:32545297-32562370 > PtLA_chimpalign_C4.bam
samtools index PtLA_chimpalign_C4.bam
rm PtLA_rmdup_recal.bam
rm PtLA_rmdup_recal.bam.bai



wget ftp://birch.well.ox.ac.uk/BAMs/PT2/PtYO_rmdup_recal.bam.bai

samtools view -b PtAC_rmdup_recal.bam chr6:32545297-32562370 > PtAC_chimpalign_C4.bam
samtools index PtAC_chimpalign_C4.bam
rm PtAC_rmdup_recal.bam
rm PtAC_rmdup_recal.bam.bai








######## bonobo #######
samtools view -b Bonobo_ALL.bam chr6:32050000-32120000 > Bonobo_hg18_C4.bam
samtools index Bonobo_hg18_C4.bam
rm Bonobo_ALL.bam
rm Bonobo_ALL.bam.bai


######### look at chimp rpp30 in hg18 #################
current rpp30 assay in hg18: chr10:92621739-92621800
take this region: chr10:92620619-92660000

also get PMP22, in case: chr17:15072621-15111918

also get HP/HPR: chr16:70638268-70685004


wget ftp://birch.well.ox.ac.uk/BAMs/HG18/PtYO_rmdup_baq.bam.bai
wget ftp://birch.well.ox.ac.uk/BAMs/HG18/PtYO_rmdup_baq.bam


#### for PtAC #################
samtools view -b PtAC_rmdup_baq.bam chr10:92620619-92660000 > PtAC_rpp30.bam
samtools index PtAC_rpp30.bam

samtools view -b PtAC_rmdup_baq.bam chr17:15072621-15111918 > PtAC_pmp22.bam
samtools index PtAC_pmp22.bam

samtools view -b PtAC_rmdup_baq.bam chr16:70638268-70685004 > PtAC_hpr.bam
samtools index PtAC_hpr.bam

rm PtAC_rmdup_baq.bam
rm PtAC_rmdup_baq.bam.bai



#### for PtFR #################
samtools view -b PtFR_rmdup_baq.bam chr10:92620619-92660000 > PtFR_rpp30.bam
samtools index PtFR_rpp30.bam

samtools view -b PtFR_rmdup_baq.bam chr17:15072621-15111918 > PtFR_pmp22.bam
samtools index PtFR_pmp22.bam

samtools view -b PtFR_rmdup_baq.bam chr16:70638268-70685004 > PtFR_hpr.bam
samtools index PtFR_hpr.bam

rm PtFR_rmdup_baq.bam
rm PtFR_rmdup_baq.bam.bai













cp /seq/references/Homo_sapiens_assembly19/v0/Homo_sapiens_assembly19.fasta /humgen/cnp04/sandbox/lboettger/c4_chimps/hg19reference.fasta

cp /seq/references/Homo_sapiens_assembly18/v-1/hg18.fasta /humgen/cnp04/sandbox/lboettger/c4_chimps/hg18.fasta


## create raw vcf
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
       -T UnifiedGenotyper \
       -I  PtAC_C4.bam \
       -I  PtFR_C4.bam \
       -I  PtGI_C4.bam \
       -I  PtLA_C4.bam \
       -I  PtLI_C4.bam \
       -I  PtPE_C4.bam \
       -I  PtRG_C4.bam \
       -I  PtRN_C4.bam \
       -I  PtSU_C4.bam \
       -I  PtYO_C4.bam \
       --intervals intervals/C4a_hg18.intervals \
       -R /humgen/cnp04/sandbox/lboettger/c4_chimps/hg18.fasta \
       -o chimpvcf/chimp_C4Ahg18_raw.vcf


>1 dna:chromosome chromosome:GRCh37:1:1:249250621:1

perl -nle 's/^>/>chr/g; print;' hg19reference.fasta > hg19refchr.fasta 
perl -nle 's/^>chr20//; print;' hg19refchr.fasta > hg19refchrno20.fasta   ###chr20 has different number of bases 
#### so does 21
### getting rid of higher chromosomes in reference
grep -n ">chr19" hg19refchrno20.fasta
head -33243082 hg19refchrno20.fasta > hg19refchrno20plus.fasta ###blah chr5 has different number of bases

grep -n ">chr6" hg19refchrno20.fasta
13281783


grep -n ">chr7" hg19refchrno20.fasta

15420723:>chr7 dna:chromosome chromosome:GRCh37:7:1:159138663:1


awk 'NR>=13281783&&NR<=15420722' "hg19refchrno20.fasta" > hg19refchr6.fasta


ERROR MESSAGE: Input files reads and reference have incompatible contigs: Found contigs with the same name but different lengths:
##### ERROR   contig reads = chr6 / 170899992
##### ERROR   contig reference = chr6 / 171115067.

/seq/references/Homo_sapiens_assembly18/v0/Homo_sapiens_assembly18.fasta




C4A_hg18_coding exons
chr6:32090601-32090665
chr6:32090798-32090996
chr6:32091211-32091412
chr6:32091622-32091692
chr6:32091771-32091859
chr6:32092078-32092160 
chr6:32092331-32092427
chr6:32092566-32092671
chr6:32092769-32092901
chr6:32099685-32099800
chr6:32099900-32100079
chr6:32100225-32100407
chr6:32100540-32100725
chr6:32100879-32101037
chr6:32101289-32101415
chr6:32101583-32101657
chr6:32101918-32102115
chr6:32102207-32102318
chr6:32102409-32102479
chr6:32102738-32102877
chr6:32102991-32103200
chr6:32103445-32103496
chr6:32103598-32103687
chr6:32104212-32104287
chr6:32104448-32104604
chr6:32104700-32104816
chr6:32104922-32105093
chr6:32105322-32105554
chr6:32105637-32105804
chr6:32106198-32106257
chr6:32107307-32107400
chr6:32107498-32107684
chr6:32107799-32107889
chr6:32107980-32108054
chr6:32109546-32109648
chr6:32109814-32109903
chr6:32109989-32110087
chr6:32110270-32110353
chr6:32110616-32110748
chr6:32110892-32111033




use their VCF file and only get sites in coding region
##need to filter on INFO hg18pos
vcftools  --vcf chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf --bed C4A_hg18_codingexons.bed --recode --out c4asnps --keep-INFO hg18chr --keep-INFO hg18pos

vcftools  --vcf chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf --chr chr6 --recode --out chr6snps --keep-INFO hg18chr --keep-INFO hg18pos


vcftools  --vcf chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf --bed C4A_hg18_codingexons.bed --recode --out c4asnps



--keep-INFO hg18chr --keep-INFO hg18pos

C4A SNPs in coding regions



grep "hg18pos=321[0-9][0-9][0-9][0-9][0-9]" chr6snps.recode.vcf > c4aregionsnps.vcf



hg18chr=chr6;hg18pos=32131892 $8

awk '$1 < 75' filename


grep "hg18pos=[3][2][0-1][0-9][0-9][0-9][0-9][0-9]" chr6snps.recode.vcf > c4aregionsnps.vcf
but there are no snps in my region



############# 4-30-12 Denisovan genome
wget ftp://hgdownload.cse.ucsc.edu/gbdb/hg19/bbi/T_hg19_1000g.bam.bai

samtools view -b T_hg19_1000g.bam 16:72088300-72095100 > Denisova_HP.bam

samtools sort Denisova_HP.bam Denisova_HP.sorted

samtools index Denisova_HP.sorted.bam

samtools view -b PtFR_rmdup_recal.bam chr6:32545297-32562370 > PtFR_chimpalign_C4.bam

#get Amy's sequence chromosome 1 98511612-98511837

coalescent simulations

samtools view -b T_hg19_1000g.bam 1:98511612-98511837 > Denisova_AMYvntr.bam
samtools sort Denisova_AMYvntr.bam Denisova_AMYvntr.sorted

samtools index Denisova_AMYvntr.sorted.bam

/home/lmb28/foramy

/files/.retain-snapshots.d14d-w60d/Genetics/1000Genomes/seqdb/AltaiNeandertal_jul2012/Denisova/align_pt2/BAM

samtools view -b


#####Neanderthal HP region
samtools view -b /psych/genetics_data/working/giulio/b37/neandertal/AltaiNea.hg19_1000g.16.dq.bam 16:72088300-72095100 > /humgen/cnp04/sandbox/lboettger/Neanderthal/Neanderthal_HP.bam

samtools sort Neanderthal_HP.bam Neanderthal_HP.sorted

samtools index Neanderthal_HP.sorted.bam


#C4
samtools view -b /psych/genetics_data/working/giulio/b37/neandertal/AltaiNea.hg19_1000g.6.dq.bam 6:31900000-32050000 > /humgen/cnp04/sandbox/lboettger/Neanderthal/Neanderthal_C4.bam

samtools sort Neanderthal_C4.bam Neanderthal_C4.sorted

samtools index Neanderthal_C4.sorted.bam



java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CoverageBySample -I /psych/genetics_data/working/giulio/b37/neandertal/AltaiNea.hg19_1000g.16.dq.bam -I NA19197_clean.sorted.mrkdup.aln.bam -I NA19238_clean.sorted.mrkdup.aln.bam -L 16:71900000-72260000 -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -o coverage

java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar -T CoverageBySample -I /psych/genetics_data/working/giulio/b37/neandertal/AltaiNea.hg19_1000g.16.dq.bam  -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta -o coverage



bash:node1632:/psych/genetics_data/working/giulio/b37/neandertal 37 $ samtools flagstat AltaiNea.hg19_1000g.16.dq.bam

64218310 + 225098 in total (QC-passed reads + QC-failed reads)
0 + 0 duplicates
64218310 + 225098 mapped (100.00%:100.00%)
2769900 + 225098 paired in sequencing
1444352 + 96365 read1
1325548 + 128733 read2
2107131 + 163997 properly paired (76.07%:72.86%)
2138116 + 168447 with itself and mate mapped
631784 + 56651 singletons (22.81%:25.17%)
15693 + 2396 with mate mapped to a different chr
10694 + 1805 with mate mapped to a different chr (mapQ>=5)
bash:node1632:/psych/genetics_data/working/giulio/b37/neandertal 38 $ 
bash:node1632:/psych/genetics_data/working/giulio/b37/neandertal 38 $ 





Genome STRiP  june 4, 2013
/humgen/cnp04/sandbox/lboettger
http://www.broadinstitute.org/software/genomestrip/genotyping-novel-sites-against-1000-genomes-phase-1

## get metadata for use with genome STRiP
/humgen/cnp04/sandbox/lboettger/software/svtoolkit/cookbook/bin/download_svtoolkit_metadata.sh /humgen/cnp04/sandbox/lboettger/1kg/SV_metadata


from cookbook dir
scripts/validate_local_install.sh



###### june 11 2013 ###
get HP region from CEU samples
taking about 50kb on each side

I"ll take from:
rs8050097	0	72039417
rs956065	0	72144267


exclude these 3:
16	rs4887826	0	72092755 X
16	rs825850	0	72093584 X
16	rs825851	0	72093722 X


### get region and filter
./plink --map /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --from rs8050097 --to rs956065 --exclude /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/HP_SNP_exclude.txt --geno 0.1 --mind 0.1 --recode  --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_region


./plink --map /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP.map --ped /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/cHGDP.ped --from rs7501777 --to rs11869026 --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/Desktop/McCarroll_Lab/HGDP/plink_format/myregion_cHGDP_clean



 --make-bed --geno 0.1 --mind 0.1 --out /Users/lindaboettger/Desktop/HMdata_all/HM_plink/genotypes_chr17_CEU_r27_nr.b36_fwd

It turns out that HM3 has about 15 missing individuals for CEu, I'll be using the 1kg OMNNI data instead...


##########
wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20110217_broad_omni_genotypes/Omni25_genotypes_1212_samples_v2.b37.vcf.gz



./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 16 --plink-tped --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16

./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 16 --plink --force-index-write --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16


./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/1000genomes/OMNI/Omni25_genotypes_1212_samples_v2.b37.vcf --chr 16 --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16

./vcftools --vcf /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16.recode.vcf --plink-tped --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16b

./plink --tped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16b.tped --tfam /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16b.tfam --allow-no-sex --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16


### get the region that I want and the CEU population only
from 16	rs1820248	0	72039605 to 16	rs9302635	0	72144174

exclude:SNP16-70647736	0	72090235

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16.ped --from rs1820248 --to rs9302635 --exclude /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNI_exclude.txt --allow-no-sex --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_HPregion


./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_HPregion.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_HPregion.ped --keep /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/CEU.txt --allow-no-sex --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_HPregion_CEU

######## many are also missing from OMNI genotypes !!!!




###### phase HM3 parents with bgl ######
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_regionRents.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_region_Rents.out




######## I didn't take enough yesterday, taking larger HM region #######
### get region and filter
./plink --map /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.map --ped /Users/lindaboettger/McCarroll_Projects/HapMap3/hapmap3_pop/hapmap3_r2_b36_fwd.CEU.qc.poly.ped --from rs17609577 --to rs12716768 --exclude /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/HP_SNP_exclude.txt --geno 0.1 --mind 0.1 --recode  --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_Lregion


java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_LregionRents.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_Lregion_Rents.out

java -Xmx1000m -jar beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_LregionallCompletetriof.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_LregionallCompletetrio.out

./plink --file /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEU_HP_LregionallCompletetrio --mendel
######### would need to spend time looking at trio info

########### downloading phased HM3 CEU trios #######
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEUtrio_phased/CEU_trio_snpencode.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/HM_genotypes/CEUtrio_phased/CEU_trio_snpencode.out




######### June 24 2013 --- Find out which SNPs are valuable for imputation #############

vcftools --vcf CEU.low_coverage.2010_07.genotypes.vcf --chr 16 --plink --out CEU_lowcov
… the names were changed to tgp_CEU.map/ped

These SNP locations are for genome build 36.3 reference assembly

using 2010 low coverage genotypes from ncbi
https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CDgQFjAB&url=ftp%3A%2F%2Fftp-trace.ncbi.nih.gov%2F1000genomes%2Fftp%2Fpilot_data%2Frelease%2F2010_07%2Flow_coverage%2Fsnps%2FCEU.low_coverage.2010_07.genotypes.vcf.gz&ei=4E3IUd6KFvOq4AO214DQDw&usg=AFQjCNE4Wvz8tmeZg30Mkev2A6gcAoU_PQ&sig2=eW8jOKLLMKLoOUWnoPK-iQ&bvm=bv.48293060,d.dmg

on broad server, couldn't unzip on my computer

can also look with bob's data
/Users/lindaboettger/bioapps/vcftools_0.1.9/bin/vcftools --vcf CNV_HP.beagle.out.vcf --plink --out PGC_CNV_HP
… the ped file looks funny. many bases with no space between. 

### take about 800kb on either side
--from rs2113276 --to rs4788478

./plink --map /Users/lindaboettger/McCarroll_Projects/1000genomes/CEU_low_cov/CEU_lowcov_16.map --from rs2113276 --to rs4788478 --allow-no-sex  --ped /Users/lindaboettger/McCarroll_Projects/1000genomes/CEU_low_cov/CEU_lowcov_16.ped --recode --out /Users/lindaboettger/McCarroll_Projects/1000genomes/CEU_low_cov/CEU_1kglowcov_HPreg

##### phase the 1kg SNPs with HP encoding
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_withenode.bgl missing=-1 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode

########## find SNPs in high-LD with encoding

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.ped --r2 --ld-snp HP2 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP2snps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.ped --r2 --ld-snp HPRGC_LEFT --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HPRGC_LEFTsnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.ped --r2 --ld-snp HPRGC_SHORT --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HPRGC_SHORTsnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.ped --r2 --ld-snp HP2B_LEFT --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP2B_LEFTsnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_enode_phased.ped --r2 --ld-snp HPRGC_LONG --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HPRGC_LONGsnps


########## 90% correct imputation ##########
some of the phasing doesn't look good. I'll try doing more iterations

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=CEU1kg_HP_withenode.bgl missing=-1 niterations=50 nsamples=50 out=CEU1kg_HP_enode_it50ns50

I tried many combinations of nsamples and niterations. This one correctly phased rs12935091 with HP2B in each case:
 java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=CEU1kg_HP_withenode.bgl missing=-1 niterations=10 nsamples=20 out=CEU1kg_HP_enode_it10ns20



################ June 26, 2013 -- take wider region on OMNI array to get better HP2B tag SNP ############
./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_chr16.ped --from rs8047583 --to rs12373097 --exclude /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNI_exclude.txt --allow-no-sex --recode --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/ONMNI_genotypes_HPregionnew


##### phase new OMNI data in beagle
java -Xmx1000m -jar beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/CEUOMNI_HPnew.bgl missing=0 niterations=10 nsamples=20 out=/Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/CEUOMNI_HP_it10ns20


####### look at SNP LD to haplotype using low coverage data #########
./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.ped --r2 --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP1Asnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.ped --r2 --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP1Bsnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.ped --r2 --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP2Asnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/CEU1kg_HP_snphapenode_phased.ped --r2 --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/HP2Bsnps

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-window-r2 0.15 --ld-snp rs6499560 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/1kg/eqtlsnps

rs6499560



######omni hap LD
./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP1Asnp

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP1Bhap

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP2Ahap

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP2Bhap

./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-snp HP2 --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP2


./plink --map /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.map --ped /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIhapencodeinc.ped --r2 --ld-window-r2 0.15 --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out /Users/lindaboettger/McCarroll_Projects/HPR/Haptoglobin/imputation/OMNI/OMNIHP2Bhap









############### ############# ############# ############# getting new OMNI and HM3 data, AUG19, 2013 ############# #############  #############  ############# ############# ############# ############# ############# ############# ############ ############## ############## ############ 
info about data for various reference panels
for commands search for "getting new OMNI and HM3 data, AUG19, 2013" in code_notes.txt


OMNI hg19
Omni25_genotypes_2141_samples.b37.vcf downloaded from ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20120131_omni_genotypes_and_intensities/

on broad server /humgen/cnp04/sandbox/lboettger/1kg

-trio phase IBS and CEU, where possible
-then add in rest and TSI


HM3 hg18
hapmap3_r2_b36_fwd.consensus.qc.poly.ped.bz2 downloaded from ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2009-01_phaseIII/plink_format/

on broad server /humgen/cnp04/sandbox/lboettger/HM3

-trio phase CEU then add in TSI



For each dataset I'll take 1Mb on either side of the gene
HP gene begins
72088508
HP gene ends
72094955

hg19 chr16:71088508-73094955
hg18 chr16:69646009-71652456







#broad server
##OMNI
use VCFtools
vcftools --vcf Omni25_genotypes_2141_samples.b37.vcf --chr 16 --plink --out ONMNI2141_chr16genotypes

vcftools --vcf Omni25_genotypes_2141_samples.b37.vcf --chr 16 --plink --out ONMNI2141_chr16genotypes


#### switch to plink
take this region: hg19 chr16:71088508-73094955

start SNP16-69645694	at 71088193
end SNP16-71655164  at  73097663

hg19 chr16:71088193-73097663

plink --noweb --file ONMNI2141_chr16genotypes --from SNP16-69645694 --to SNP16-71655164 --make-bed --out ONMNI2141_b37_HPreg
2141 individuals read from [ ONMNI2141_chr16genotypes.ped ] 
0 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 0 controls and 2141 missing
0 males, 0 females, and 2141 of unspecified sex
Before frequency and genotyping pruning, there are 1274 SNPs
2141 founders and 0 non-founders found
 #### no trio data in this file

### July 11 2015
check OMNI combined data for other bad SNPs plink-1.07-mac-intel/plink --noweb —map



/Users/boettger/PhD_Laptop/bioapps


#### moved to my computer
############# OMNI CEU ####################
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile ONMNI2141_b37_HPreg --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/CEUindvs_nofamid.txt --make-bed --out CEU/CEU_OMNI_b37_HPreg
2037 individuals removed with --keep option
Before frequency and genotyping pruning, there are 1274 SNPs
104 founders and 0 non-founders found
## only 104 CEU typed on OMNI? Yes, looking at the 1kg excel document, many have not been run. Most offspring not run

only 2 trios in this datasetI need to remove these two individuals for all to be unrelated:NA12878NA12329
….. these are in rmCEU.txt

I have kept some kids, but their parent were not run.
See CEU_OMNI_triocheck.xlsx

I should check this with my kids list to be sure!!!!

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile CEU_OMNI_b37_HPreg --hwe .001 --remove rmCEU.txt --recode --out CEU_HM3_b36_HPreg_f2  #### should have been build 37!!!
2 individuals removed with --remove option
Before frequency and genotyping pruning, there are 1274 SNPs
102 founders and 0 non-founders found
2 markers to be excluded based on HWE test ( p <= 0.001 ) 
	0 markers failed HWE test in cases
	0 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.996591

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile CEU_OMNI_b37_HPreg --hardy --out CEUhardy
filtered SNPs:
SNP16-69672839
SNP16-70654780
These are the same snips filtered in CEU I NEED TO REMOVE THESE FROM IBS !!!!!!!!!!!!!!!!!!!!!!!!!! 




###### ---> convert to beagle format with HM3_HP_imputation.R
#outfile: /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/filter_format/TSI/TSI_HM3_b36_HPreg_encode.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar nsamples=10 unphased=CEUunrel_OMNI_b37_HPreg.bgl missing=0 out=nsam10




############# OMNI IBS ####################
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile ONMNI2141_b37_HPreg --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBSindvs_nofamid.txt --make-bed --out IBS/IBS_OMNI_b37_HPreg
1991 individuals removed with --keep option
Before frequency and genotyping pruning, there are 1274 SNPs
150 founders and 0 non-founders found
all are complete trios!!!


I will need to add trio info to these files in R
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile IBS/IBS_OMNI_b37_HPreg --recode --out IBS/IBS_OMNI_b37_HPreg
outfile: IBStrio_OMNI_b37_HPreg.ped

## filter out SNPs in trios that have mendelian inconsistencies and defy hwe
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --map IBS_OMNI_b37_HPreg.map --ped IBStrio_OMNI_b37_HPreg.ped --me 1 1 --set-me-missing --hwe .001 --recode --out IBS_OMNI_b37_HPreg_f2 ### this should have been 37
After filtering, 77 males, 73 females, and 0 of unspecified sex
50 nuclear families, 0 founder singletons found
50 non-founders with 2 parents in 50 nuclear families
0 non-founders without 2 parents in 0 nuclear families
0 affected offspring trios
0 phenotypically discordant parent pairs found
Filtering SNPs/families for Mendel Error rates above 1, 1
19 Mendel errors detected in total
0 markers to be excluded based on HWE test ( p <= 0.001 )  !!!!!!!!!!!!!!!!!!!

#### out file: IBS_OMNI_b37_HPreg_f2 (fixed order of people in excel 

### him made for later
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file IBS_OMNI_b37_HPreg_f2 --make-bed --out IBS_OMNI_b37_HPreg_f2

#### converted to beagle in R
outfile:IBStrio_OMNI_b37_HPreg.bgl

### trio phase IBS OMNI #####
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar trios=IBStrio_OMNI_b37_HPreg.bgl nsamples=10 missing=0 out=nsam10

plink missed:
for marker SNP16-69716614
Inconsistent sample identifiers and alleles are  HG02235.1=T HG02235.2=T HG02236.1=T HG02236.2=T HG02237.1=C HG02237.2=T
rs3096381
Inconsistent sample identifiers and alleles are  HG01694=T HG01694=G HG01695=G HG01695=G HG01696=T HG01696=T
for marker rs12102284
Inconsistent sample identifiers and alleles are  HG02235=G HG02235=G HG02236=A HG02236=A HG02237=G HG02237=G
rs7203231
Inconsistent sample identifiers and alleles are  HG02235=G HG02235=G HG02236=G HG02236=G HG02237=T HG02237=G
SNP16-70417361
Inconsistent sample identifiers and alleles are  HG01709=T HG01709=T HG01710=C HG01710=T HG01711=C HG01711=C
rs2288031
Inconsistent sample identifiers and alleles are  HG02235=A HG02235=A HG02236=C HG02236=C HG02237=A HG02237=A
SNP16-70859185
Inconsistent sample identifiers and alleles are  HG02235=G HG02235=C HG02236=C HG02236=C HG02237=G HG02237=G
SNP16-71069992
Inconsistent sample identifiers and alleles are  HG02235=C HG02235=C HG02236=A HG02236=A HG02237=A HG02237=A

################ NOTE ##############################
getting rid of HG02235, HG02236, HG02237 it is a trio with HP2B and problems could mess it up

SNP16-71541138
Inconsistent sample identifiers and alleles are  HG01500=C HG01500=C HG01501=G HG01501=G HG01502=C HG01502=C
SNP16-71541138
Inconsistent sample identifiers and alleles are  HG01524=C HG01524=C HG01525=G HG01525=G HG01526=C HG01526=C




############# OMNI TSI ######################
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile ONMNI2141_b37_HPreg --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/TSIindvs.txt --make-bed --out TSI/TSI_OMNI_b37_HPreg
2041 individuals removed with --keep option
Before frequency and genotyping pruning, there are 1274 SNPs
100 founders and 0 non-founders found
### I think there are more TSI typed than I have structural data for (I ran one 96 well plate)

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile TSI_OMNI_b37_HPreg --hardy --out hardy

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile TSI_OMNI_b37_HPreg --hwe .001 --recode --out TSI_OMNI_b37_HPreg_f2
2 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	0 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.996515
0 SNPs failed missingness test ( GENO > 1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 1272 SNPs

removed SNPS:
SNP16-69672839
SNP16-70654780

### convert to beagle format with R
outfile: TSIunrel_OMNI_b37_HPreg.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=TSIunrel_OMNI_b37_HPreg.bgl nsamples=10 missing=0 out=nsam10


############# OMNI YRI #################### done in March 2013 ####
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/ONMNI2141_b37_HPreg --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/YRIindvs_nofamid.txt --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg

1980 individuals removed with --keep option
Before frequency and genotyping pruning, there are 1274 SNPs
161 founders and 0 non-founders found
Total genotyping rate in remaining individuals is 0.996729
0 SNPs failed missingness test ( GENO > 1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 1274 SNPs
After filtering, 0 cases, 0 controls and 161 missing


###do I have trios?
likely some

### recode and add in trio info in R

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg

### filter
## filter out SNPs in trios that have mendelian inconsistencies and defy hwe
#so many non-trios that will just do pop phasing
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRItrio_OMNI_b37_HPreg.ped --me 1 1 --set-me-missing --geno 0.1 --mind 0.1 --hwe .001 --maf 0.01 --filter-founders --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg_f2


java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=YRIunrel_OMNI_b37_HPreg.bgl nsamples=10 missing=0 out=nsam10



#### this should be run again to not filter out MAF 0.01!!!!!!!!!!!!!!! fuck!
## filter out SNPs in trios that have mendelian inconsistencies and defy hwe
#so many non-trios that will just do pop phasing
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg.map --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRItrio_OMNI_b37_HPreg.ped --me 1 1 --set-me-missing --geno 0.1 --mind 0.1 --hwe .001 --maf 0.01 --filter-founders --recode --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg_f2

### july 2015 no maf filter
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg.map --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRItrio_OMNI_b37_HPreg.ped --me 1 1 --set-me-missing --geno 0.1 --mind 0.1 --hwe .001 --filter-founders --recode --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRI_OMNI_b37_HPreg_f2_july2015



java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=YRIunrel_OMNI_b37_HPreg.bgl nsamples=10 missing=0 out=nsam10







######################################################## getting and filtering HM3 ################################################
################################################################################################################################
wget ftp://ftp.ncbi.nlm.nih.gov/hapmap/genotypes/2009-01_phaseIII/plink_format/hapmap3_r2_b36_fwd.consensus.qc.poly.map.bz2
bunzip2
use Plink
#90% genotyping rate
#exclude indv with more than 10% missing genotypes
plink --noweb --file hapmap3_r2_b36_fwd.consensus.qc.poly --chr 16 --make-bed --out HM3_b36_chr16
plink --noweb --bfile HM3_b36_chr16 --recode --out HM3_b36_chr16

hg18 chr16:69646009-71652456

start rs7499876	 at  69628379
end rs8052905	 at  71655164

hg18 chr16:69628379-71655164

plink --noweb --bfile HM3_b36_chr16 --from rs7499876 --to rs8052905 --make-bed --out HM3_b36_HPreg

### on my computer
#path
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/filter_format/HM3_b36_HPreg


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile HM3_b36_HPreg --geno 0.1 --mind 0.1 --make-bed --out HM3_b36_HPreg_f1







#############################################################HM3  CEU################################################
##only 163 CEU individuals were kept (only 163 CEU typed in HM3??)
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile HM3_b36_HPreg_f1 --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/CEUindvs.txt --make-bed --out CEU_HM3_b36_HPreg

### look at how bad it is
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile CEU_HM3_b36_HPreg --hardy --mendel --out CEUchecks

## filter out SNPs in trios that have mendelian inconsistencies and defy hwe
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile CEU_HM3_b36_HPreg --me 1 1 --set-me-missing --hwe .001 --recode --out CEU_HM3_b36_HPreg_f2

#stats from this filter:
After filtering, 79 males, 84 females, and 0 of unspecified sex
61 nuclear families, 8 founder singletons found
44 non-founders with 2 parents in 44 nuclear families
15 non-founders without 2 parents in 9 nuclear families
0 affected offspring trios
0 phenotypically discordant parent pairs found
Converting data to Individual-major format
Filtering SNPs/families for Mendel Error rates above 1, 1
14 Mendel errors detected in total
0 markers to be excluded based on HWE test ( p <= 0.001 )

## make bim file to later make beagle markers file
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file CEU_HM3_b36_HPreg_f2 --make-bed --out CEU_HM3_b36_HPreg_f2


CEU_HM3_b36_HPreg_f2 gets converted to beagle format HM3_HP_imputation.R (use trios)


#### phase complete HM3 CEU trios
outfile: /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/filter_format/CEU_HM3_b36_HPreg_trios.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar trios=CEU_HM3_b36_HPreg_trios_encode.bgl missing=0 out=10it

#### phase CEU HM3 unrelateds using already phased complete HM3 CEU trios
CEU_HM3_b36_HPreg_unrel_encode.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar phased=CEU_phased_trios/10it.CEU_HM3_b36_HPreg_trios_encode.bgl.phased unphased=CEU_HM3_b36_HPreg_unrel_encode.bgl markers=HPreg_HM3_HG18.markers.txt missing=0 out=CEU_phased_unrel/10it

###########NOTE SOME ALLELES IN MARKERS FILE ARE "B" TO REPLACE 0 (I SHOULD HAVE REMOVED ALL NON-VARIENT SNPS)



######################################HM3 TSI ################################################
## only 88 TSI individuals in HM3
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile HM3_b36_HPreg_f1 --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/TSIindvs.txt --make-bed --out TSI_HM3_b36_HPreg


## filter out SNPs in trios that have mendelian inconsistencies and defy hwe
#folder /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/filter_format/TSI
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile TSI_HM3_b36_HPreg --hwe .001 --recode --out TSI_HM3_b36_HPreg_f2

#notes
0 markers to be excluded based on HWE test ( p <= 0.001 )

###### ---> convert to beagle format with HM3_HP_imputation.R
outfile: /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/filter_format/TSI/TSI_HM3_b36_HPreg_encode.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar nsamples=10 unphased=TSI_HM3_b36_HPreg_encode.bgl missing=0 out=nsam10


##IBS
IBS not typed in HM3

######################################HM3 YRI ################################################ done on April 1, 2014

#I'm not trio phasing these since I'll need to re-phase each time for the leave-one-out trials

## removing the children


## only 88 YRI individuals in HM3
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bed HM3_b36_HPreg_f1.bed --bim HM3_b36_HPreg_f1.bim --fam HM3_b36_HPreg_f1nofamids.fam --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/YRIindvs_nofamid.txt --make-bed --out YRI_HM3_b36_HPreg

### 112 parents
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile YRI_HM3_b36_HPreg --remove /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/YRI_kids.txt --allow-no-sex --make-bed --out YRIrents_HM3_b36_HPreg

--remove /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/YRI_kids.txt --allow-no-sex

## filter out SNPs 
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile YRIrents_HM3_b36_HPreg --geno 0.1 --mind 0.1 --hwe .001 --maf 0.001 --make-bed --out YRIrents_HM3_b36_HPreg_f2
0 of 112 individuals removed for low genotyping ( MIND > 0.1 )
0 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	0 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.998207
0 SNPs failed missingness test ( GENO > 0.1 )
130 SNPs failed frequency test ( MAF < 0.001 )
After frequency and genotyping pruning, there are 846 SNPs
After filtering, 0 cases, 0 controls and 112 missing
After filtering, 55 males, 57 females, and 0 of unspecified sex


######### make new ref pan without filtering on maf
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_format/YRIrents_HM3_b36_HPreg --geno 0.1 --mind 0.1 --hwe .001 --recode --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_formatYRIrents_HM3_b36_HPreg_f2_july2015
112 founders and 0 non-founders found
0 of 112 individuals removed for low genotyping ( MIND > 0.1 )
0 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	0 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.998207
0 SNPs failed missingness test ( GENO > 0.1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 976 SNPs
After filtering, 0 cases, 0 controls and 112 missing
After filtering, 55 males, 57 females, and 0 of unspecified sex
Writing recoded ped file to [ /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_formatYRIrents_HM3_b36_HPreg_f2_july2015.ped ] 
Writing new map file to [ /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_formatYRIrents_HM3_b36_HPreg_f2_july2015.map ] 








######################################HM3 YRI ################################################ done on April 1, 2014
### use for trio phasing for YRI

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile YRI_HM3_b36_HPreg --mendel --out menout


## filter out SNPs in trios that have mendelian inconsistencies and defy hwe, didn't set MAF because want to merge with CEU later
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile YRI_HM3_b36_HPreg --geno 0.1 --mind 0.1  --me 1 1 --set-me-missing --hwe .001 --recode --out YRI_HM3_b36_HPreg_f3


#### then make into beagle trio file in R



Writing this text to log file [ YRI_HM3_b36_HPreg_f2.log ]
Analysis started: Wed Jul 30 13:53:06 2014

Options in effect:
	--noweb
	--bfile YRI_HM3_b36_HPreg
	--geno 0.1
	--mind 0.1
	--me 1 1
	--set-me-missing
	--hwe .001
	--maf 0.001
	--recode
	--out YRI_HM3_b36_HPreg_f2

Reading map (extended format) from [ YRI_HM3_b36_HPreg.bim ] 
976 markers to be included from [ YRI_HM3_b36_HPreg.bim ]
Reading pedigree information from [ YRI_HM3_b36_HPreg.fam ] 
167 individuals read from [ YRI_HM3_b36_HPreg.fam ] 
0 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 0 controls and 167 missing
90 males, 77 females, and 0 of unspecified sex
Reading genotype bitfile from [ YRI_HM3_b36_HPreg.bed ] 
Detected that binary PED file is v1.00 SNP-major mode
Before frequency and genotyping pruning, there are 976 SNPs
113 founders and 54 non-founders found
0 of 167 individuals removed for low genotyping ( MIND > 0.1 )
0 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	0 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.998337
0 SNPs failed missingness test ( GENO > 0.1 )
130 SNPs failed frequency test ( MAF < 0.001 )
After frequency and genotyping pruning, there are 846 SNPs
After filtering, 0 cases, 0 controls and 167 missing
After filtering, 90 males, 77 females, and 0 of unspecified sex
167 nuclear families, 113 founder singletons found
0 non-founders with 2 parents in 0 nuclear families
54 non-founders without 2 parents in 54 nuclear families
0 affected offspring trios
0 phenotypically discordant parent pairs found
Converting data to Individual-major format
Filtering SNPs/families for Mendel Error rates above 1, 1
0 Mendel errors detected in total…………. THEY LIE……..
0 families ( 0 individuals ) removed due to Mendel errors
0 markers removed due to Mendel errors, 846 remaining
Writing recoded ped file to [ YRI_HM3_b36_HPreg_f2.ped ] 
Writing new map file to [ YRI_HM3_b36_HPreg_f2.map ] 

# MENDEL ERRORS
rs7499876  NA18863.1=T NA18863.2=T NA18853.1=T NA18853.2=T NA18852.1=C NA18852.2=T
NA19139.1=T NA19139.2=T NA19128.1=T NA19128.2=T NA19127.1=C NA19127.2=T
NA19120.1=T NA19120.2=T NA19210.1=C NA19210.2=C NA19209.1=C NA19209.2=C
NA18872.1=C NA18872.2=T NA19130.1=T NA19130.2=T NA19131.1=C NA19131.2=C

rs6499412
NA19120.1=T NA19120.2=T NA19210.1=T NA19210.2=T NA19209.1=C NA19209.2=T


python check_mendelian_trio.py trios.bgl new_trios.bgl missing_code
python /Users/lindaboettger/Downloads/check_strands_16May11/check_mendelian_trio.py /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_format/unphased/YRI_HM3_b36_HPreg_trios_encode.bgl /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_format/unphased/YRI_HM3_b36_HPreg_trios_encode.mendel.bgl 0



java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar trios=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_format/unphased/YRI_HM3_b36_HPreg_trios_encode.mendel.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/YRI/filter_format/phased/out

############### make spider gram for phased trios ### july 31 2014
HM3.triophased.ceuyri.afrodot.txt
python -u plot_spidergram_Hpr_LB.py HM3.triophased.ceuyri.label.txt HM3.triophased.ceuyri.label.pdf

python -u plot_spidergram_Hpr_LB_smallname.py HM3.triophased.ceuyri.label.txt HM3.triophased.ceuyri.label.pdf

python -u plot_spidergram_Hpr_LB_smallname.py HM3.triophased.ceuyri.label_50kb.txt HM3.triophased.ceuyri.label_50kb.pdf


python -u plot_spidergram_paper_Hpr_smalldots.py HM3.triophased.ceuyri.afrodot_150kb.txt HM3.triophased.ceuyri.afrodot_150kb.pdf





/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile HM3_b36_HPreg_f1 --hardy --mendel --out checks




####### make spidergram smodplot for CEU HM3
bsub -Is -q week bash

. /broad/tools/scripts/useuse
reuse -q Python-2.6

##just CEU
python -u plot_spidergram_Hpr_LB.py spiderinput_allCEU_HM3_hg19.phased HP_CEU_HM3.pdf

## all CEU and TSI (with labels) 
python -u plot_spidergram_Hpr_LB.py spiderinput_allEuro_HM3.phased HP_Euro_HM3.pdf

#python -u plot_spidergram_Hpr_LB.py spiderinput_allEuro.noname_HM3.phased HP_Euro_HM3_noname.pdf


python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro.noname_HM3.phased HP_Euro_HM3_noname.pdf

python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro_HM3_colors.phased HP_Euro_HM3_noname_color.pdf

python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro_HM3_colors.phased HP_Euro_HM3_noname_color.pdf


python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro_HM3_200kb.txt HP_Euro_HM3_noname_color_200kb.pdf

python -u plot_spidergram_Hpr_LB.py spiderinput_allEuro_HM3_200kb_names.txt HP_Euro_HM3_noname_color_names_200kb.pdf


python -u plot_spidergram_Hpr_LB.py spiderinput_allEuro_HM3_500kb_names.txt HP_Euro_HM3_color_names_500kb.pdf



python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_HM3.FHSoverlap.phased HP_Euro_HM3_FHSoverlap.pdf

python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_OMNI.FHSoverlap.phased HP_Euro_OMNI_FHSoverlap.pdf

############# make spider gram for OMNI #################

python -u plot_spidergram_Hpr_LB.py spiderinput_TSI_OMNI.phased HP_TSI_OMNI.pdf

python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro_noname_OMNI.phased_200kb.txt HP_Euro_OMNI_noname_200kb.pdf

### check TSI it imputes poorly
python -u plot_spidergram_Hpr_LB.py spiderinput_allEuro_OMNI.phased.txt HP_Euro_OMNI.pdf

python -u plot_spidergram_Hpr_LB_grynoname.py spiderinput_allEuro_noname_OMNI.phased_200kb




############## req using plink################

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file CEUunrel_OMNI --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out CEU_OMNI_HP1A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file CEUunrel_OMNI --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out CEU_OMNI_HP1B
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file CEUunrel_OMNI --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out CEU_OMNI_HP2A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file CEUunrel_OMNI --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out CEU_OMNI_HP2B

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file TSI_OMNI --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out TSI_OMNI_HP2B

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file TSI_OMNI --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out TSI_OMNI_HP1A

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file TSI_OMNI --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out TSI_OMNI_HP1B

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file TSI_OMNI --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out TSI_OMNI_HP2A



/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro_OMNI --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out Euro_OMNI_HP1A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro_OMNI --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out Euro_OMNI_HP1B
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro_OMNI --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out Euro_OMNI_HP2A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro_OMNI --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out Euro_OMNI_HP2B
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro_OMNI --ld-snp HP2 --ld-window 99999 --ld-window-kb 1000 --out Euro_OMNI_HP2


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro.HM3phased --ld-snp HP1Ahap --ld-window 99999 --ld-window-kb 1000 --out Euro_HM3_HP1A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro.HM3phased --ld-snp HP1Bhap --ld-window 99999 --ld-window-kb 1000 --out Euro_HM3_HP1B
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro.HM3phased --ld-snp HP2Ahap --ld-window 99999 --ld-window-kb 1000 --out Euro_HM3_HP2A
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro.HM3phased --ld-snp HP2Bhap --ld-window 99999 --ld-window-kb 1000 --out Euro_HM3_HP2B
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file Euro.HM3phased --ld-snp HP2 --ld-window 99999 --ld-window-kb 1000 --out Euro_HM3_HP2




/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/Euro.HM3phased




####################### orchesta nodes 2 hour ###

bsub -q interactive -W 2:00 bash


#################### getting FHS data from broad server framingham ########### 
/fg/fhs_jhs/scratch/flannick/raw

hg19 chr16:71088508-73094955
from FHS data:
from:
16 ss66055258 0 71067798 C T 
to: 16 ss66287848 0 73117297 G A


12	ss66277479	0	73097237	A	T

this is an Affy array, by SNP names

plink --noweb --bfile Framingham_ALL.hg19 --from ss66055258 --to ss66287848 --recode --out /humgen/cnp04/sandbox/lboettger/FHS/FHS_ALL_hg19_HPregion
Missing phenotype value is also -9
0 cases, 0 controls and 9235 missing
4250 males, 4985 females, and 0 of unspecified sex



########## sept 5th 2013 ########## merging OMNI and HM3 haptoglobin SNP datasets 
./plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.ref.physpos --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.map --out //Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.omni.merge.txt

##### oddly, there are duplicate markers in omni
 *** WARNING *** DUPLICATE MARKERS FOUND *** 
Duplicate marker name found: [ 71373230 ]
Duplicate marker name found: [ 72817582 ]

Using merge mode 1 : consensus call (default)

985 (of 985) markers to be merged from [ /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.map ]
Of these, 578 are new, 407 already exist
Problem encountered merging files, with the following markers:
71373230
72817582
72251288


####they seem to be identical, so I guess there is no problem and I'll just remove one

./plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.ref.physpos --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.map --out //Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.omni.merge.txt


########## concerned about strand switching, so going to ditch 20 individuals who are on HM3, but not on OMNI. This includes only 1 HP2B (NA07055) new file: hm3.ref.omniindvoverlap.physpos.ped


./plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.ref.physpos --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.omniindvoverlap.physpos.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.map --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.hm3.merge

984 (of 984) markers to be merged from [ /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.physpos.map ]
Of these, 577 are new, 407 already exist
176 individuals merged from [ /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/hm3.ref.omniindvoverlap.physpos.ped ] 
Of these, 0 were new, 176 were already in current data



######### get rid of fixed SNPs #######
./plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.hm3.merge --maf 0.0001 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/omni.hm3.merge.nofixsnps



####### phase HM3 SNPs with OMNI SNPs ############
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=OMNI_HM3_merged.nofixedsnps.bgl missing=0 maxwindow=2000 out=maxwin2000
###Warning: All data sets have > 0.07 missing alleles for the markers in the markers file.
         To obtain the most accurate imputation, at least one input Beagle file should be genotyped
         for all markers in the markers file and should have < 0.07 missing alleles.

########### phase ref file all overlapping individuals
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=allsnpindv.omni.hm3.bgl missing=0 maxwindow=1000 out=maxwin1000 nsamples=20 niterations=20


########### impute hm3 snps into omni indvs
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar markers=ref.markers.txt phased=maxwin1000.allsnpindv.omni.hm3.bgl.phased unphased=toimpute.nohm3snps.bgl missing=0 maxwindow=1000 out=maxwin1000 nsamples=20 niterations=20


######### remember to check this when phasing ##########
3.2.6 Advanced options not intended for general use
 maxwindow=<maximum window size> where <maximum window size> is a positive 
integer giving the maximum number of consecutive markers that will be considered when 
building the haplotype frequency model. The maxwindow argument is optional. The 
default value is maxwindow=500. The default value should be sufficiently large for most
data sets. For example, if your marker density is one marker per kilobase, BEAGLE will 
consider markers in a 500 kilobase window when using the default maxwindow
parameter.



java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/for_Stephan/17q/17q_Euro_1kg.encode.bgl.txt missing=? out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/for_Stephan/17q/17q_Euro_1kg.encode.bgl



########## LD to top SNP ############
./plink --bfile /Users/lindaboettger/McCarroll_Projects/17q21/PSP/imputation_data_13022012/imputation_cnv_panel_1kg --r2 --ld-window-r2 0.1 --ld-snp 17:43986179 --ld-window 999999 --ld-window-kb 10000 --out /Users/lindaboettger/McCarroll_Projects/17q21/PSP/imputation_data_13022012/topsnp_snp




####################### get ready to impute into YRI Sept 11 2013 #########################
I need SNPs rs5470 rs5471 because they cause HP not to be expressed. Neither of these SNPs is in the OMNI or HM3 arrays, so I'm going to impute using low coverage data.

1kg phase 1 

wget http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/analysis_results/integrated_call_sets/ALL.chr16.integrated_phase1_v3.20101123.snps_indels_svs.genotypes.vcf.gz


use VCFtools

vcftools --vcf ALL.chr16.integrated_phase1_v3.20101123.snps_indels_svs.genotypes.vcf --chr 16 --from-bp 71088000 --to-bp 73098000 --remove-indels --recode --out phase1.1kg.v3.20101123_HPreg_noindel


vcftools --vcf phase1.1kg.v3.20101123_HPreg_noindel.recode.vcf --plink --out phase1_1kg_20101123_HPreg_noindel

#### switch to plink
take this region: hg19 chr16:71088508-73094955

	at 71088000
 73098000 

plink --noweb --file phase1.1kg.v3.20101123_chr16 --chr 16 --from-bp 71088000 --to-bp 73098000 --recode --out phase1_1kg_20101123_HPreg


#### on my computer, get YRI
./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_20101123_HPreg_noindel --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/YRIindvs.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_YRI


#### remove any YRI kids
./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_YRI --remove /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/YRI_kids.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_YRIrents


#### filter YRI dataset 

./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_YRIrents --geno 0.1 --mind 0.1 --hwe .001 --maf 0.01 --recode --allow-no-sex --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_YRIrents_f1


#### in R convert to beagle format, add encoding
### phase YRI beagle file with encoding 
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=YRIrents_encode.phase1.1kg.HPreg.bgl nsamples=15 missing=0 out=nsam15



######## phase malaria overlap ref panel 
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=YRIrents_encode.phase1.1kg.Maloverlap.bgl nsamples=15 missing=0 out=nsam15


####### top SNP in cases vs controls ######
grep "rs11643192" /Users/lindaboettger/McCarroll_Projects/HPR/Malaria_GEN/Malaria_data/genotypes_fwd_Cases_ML_16.txt > /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/topHP2snp.cases.txt


grep "rs11643192" /Users/lindaboettger/McCarroll_Projects/HPR/Malaria_GEN/Malaria_data/genotypes_fwd_Controls_AFC_16.txt > /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/topHP2snp.controls.txt

genotypes_fwd_Controls_AFC_16.txt


##### check best SNP in region in Malaria dataset ############
./plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/malaria_overlap.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/malaria_to_plink_mgen_subset.ped --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/d_malaria


### start
./plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/malaria_overlap.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/mgen_subset.ped --geno 0.1 --mind 0.1 --hwe .001 --maf 0.01 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/Malaria_HP_filter
19 markers to be excluded based on HWE test ( p <= 0.001 )
	13 markers failed HWE test in cases
	19 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.968414
20 SNPs failed missingness test ( GENO > 0.1 )
6 SNPs failed frequency test ( MAF < 0.01 )
After frequency and genotyping pruning, there are 203 SNPs
After filtering, 978 cases, 1399 controls and 0 missing



./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/Malaria_HP_filter --assoc --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/assocfiltered


./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/phase1_1kg_20101123_HPreg_noindel --extract /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_imp_SNPs.txt --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/phase1_1kg_20101123_HPreg_malsnps



./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/YRI/finsihed_ref/YRI_HP_ref --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/Malaria_HP_filter.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Malaria_data_plink/Malaria_HP_filter.map --allow-no-sex --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/merge

#### no snips need to be flipped
### scan for strand problem\
./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/malaria_strandcheck_phen.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/ATGCcheck

### no SNPs in neg LD


./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/merge --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/Mal_ref_merge/merge


########## converted merged file to beagle #########

### re-phase reference file 
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/YRI_ref_forMalaria.bgl.txt nsamples=15 missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/nsam15

### impute into Malaria dataset ####
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/nsam15.YRI_ref_forMalaria.bgl.txt.phased unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/Malaria_toimpute.bgl.txt markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/malaria_markers.txt missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Malaria/imputation/Malaria_HPimputed
#### output frequencies are 17, 41, 41… this is about correct so I'll move on with the association




############ Sept 15, 2013 ###### make 1kg phase 1 ref panel for europeans
./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/phase1_1kg_20101123_HPreg_noindel --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/CEUrents.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrents
#### only 79 in phase 1, 1kg

./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrents --hwe .001 --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrentshwe
##1 marker



./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/phase1_1kg_20101123_HPreg_noindel --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/TSIindvs.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_TSI
### 98
./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_TSI --hwe .001 --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_TSIhwe
#3 markers

./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/phase1_1kg_20101123_HPreg_noindel --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/IBSrents.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_IBSrents
### only 14 of them :(
./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_IBSrents --hwe .001 --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_IBSrentshwe
## 0 excluded


### combine the files 
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile p1_1kg_HP_CEUrentshwe --merge-list Eurofiles.txt --make-bed --out p1_1kg_Euromerge

### rest of filtering done on whole dataset
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --allow-no-sex --bfile p1_1kg_Euromerge --geno 0.1 --mind 0.1 --maf 0.01 --recode --out p1_1kg_Euromergef2

#### working with this file:p1_1kg_Euromergef2
need to merge with encoding and do phase one out to test
then try to impute into FHS

#### phase Euro 1kg phase 1 ref panel combined with structural encoding ###

## April 1, 2014 made whole reference dataset (not just for FHS)
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/finished_ref/1kgphase1.Euro.bgl










# for FHS only
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/1kgphase1.Euro.FHSoverlap.bgl

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=1kgphase1.Euro.FHSoverlap.bgl missing=0 nsamples=10 out=nsam10




####### make 1kg FHS overlap all Euro spider gram ###
python -u plot_spidergram_Hpr_LB_grynoname.py Euro_1kgp1_FHSoverlap_spiderinput.txt Euro1kg_FHSoverlap_smod.pdf

### check for strand flips between 1kg ref and FHS ###

### filter FHS data
./plink --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/FHS_ALL_hg19_HPregion.ped --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/FHS_ALL_hg19_HPregion.snploc.map --set-me-missing --geno 0.1 --mind 0.1 --hwe .001 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_hg19_filter


./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/finished_ref/Euro_1kgp1_FHSoverlap --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_hg19_filter.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_hg19_filter.map --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_merge

./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/finished_ref/Euro_1kgp1_FHSoverlap --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_hg19_filter.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_hg19_filter.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_merge


#reorder so can get him to make markers
./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_merge --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_merge_order

### they did merge fine, I guess there were no SNPs to be flipped. I should still scan for LD problems

./plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/phenos.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/fhs1kgstrand


################ impute structure from 1kg into FHS ############
java -Xmx2000m -jar /Users/lindaboettger/bioapps/beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/finished_ref/nsam10.1kgphase1.Euro.FHSoverlap.bgl.phased unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/FHS_ALL_hg19_HPregion.bgl nsamples=10 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/nsam10 missing=0 markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_imputation.markers.txt

### phasing all of them individually ########
for i in {3..18472}
do
out=$(( $i % 2 ))
if [ $out -eq 0 ] #if the number is even
then
continue
fi
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/finished_ref/nsam10.1kgphase1.Euro.FHSoverlap.bgl.phased unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_one/TI_${i}.bgl nsamples=10 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_one_out/out_${i}.txt missing=0 gprobs=false markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/FHS/imputation/1kg_FHS/FHS_1kg_imputation.markers.txt
done


############ make spider gram with YRI and Euro ##########
#### on my computer, get all pops

## first filter HWE by pop

./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/YRI/phase1_1kg_YRIrents --allow-no-sex --hwe .001 --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/YRI/phase1_1kg_YRIrents_hwe
## one marker not HWE

#### remove any YRI kids
./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/phase1_1kg_allpop --remove /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/YRI_kids.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/phase1_1kg_allpoprents

### merge with HWE tested european files
./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrentshwe --merge-list /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/Allpop_merge.txt --allow-no-sex --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/p1_1kg_Allpopmerge


#### filter all pop dataset

./plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/p1_1kg_Allpopmerge --geno 0.1 --mind 0.1 --maf 0.01 --recode --allow-no-sex --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/p1_1kg_Allpopmerge_f2


#### in R convert to beagle format, add encoding
### phase YRI beagle file with encoding 
java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/Allpops_encode.phase1.1kg.HPreg.bgl nsamples=10 maxwindow=6426 missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/nsam15


######## make all pop HP spider gram #######
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput.phased Allpop_HP_long.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_200kb.phased Allpop_HP_200kb.pdf




python -u plot_spidergram_paper_Hpr.py Allpop_spiderinput_1kg_100kb.phased Allpop_HP_100kb.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_100kb.phased Allpop_HP_100kb_smalldot.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_50kb.phased Allpop_HP_50kb_smalldot.pdf



################ do fast IBD stuff to find recombination spots ########

###### got centamorgan map from: ftp://ftp.hapmap.org/hapmap/recombination/2011-01_phaseII_B37/

#### get SNPs in CM



java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/HM2_genetic_map/usedsnps.bgl ibdpairs=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/sample_pairs.txt markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/HM2_genetic_map/cm.markers missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/ibdtest.cm

java -Xmx1000m -jar /Users/lindaboettger/bioapps/beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/HM2_genetic_map/usedsnps.bgl fastibd=true markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/HM2_genetic_map/cm.markers missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/IBD/ibdtest.cm.f

######### I don't think IBD estimation is what I want. I'm going to use plinks "blocks" and "r2" functions

./plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/Euro_OMNI_ref.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/Euro_OMNI_ref.ped --blocks --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/blockstest ---> no LD blocks?

./plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/Euro_OMNI_ref.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/Euro_OMNI_ref.ped --r2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/finished_ref/r2







############# feb 19, 2013 #######

##get primates to look for variation in gene conversion

samtools view -c NA19238_clean.sorted.mrkdup.aln.bam 16:71900000-72260000

### omen's primates on broad server:
/home/unix/omer/public_html/bam_files

to my folder /humgen/cnp04/sandbox/lboettger/Haptoglobin/primate_HPreg_Omer/

### are these aligned to hg19? I think they are…

## I'll take chr16:72080310-72103744 10 kb on either side  of structure (struct var region is chr16:72090310-72093744)

samtools view AG06105.bam chr16:72080310-72103744 > /humgen/cnp04/sandbox/lboettger/Haptoglobin/primate_HPreg_Omer/AG06105
….> omer's files are blank…. :(





bsub -Is -q interactive bash


##### pan map is 10 chimps with reads mapped to pantro2 #######
samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtAC_rmdup_recal.bam chr16:71929922-71971348 > /humgen/cnp04/sandbox/lboettger/Haptoglobin/primate_HPreg_PanMap

samtools index PtAC_HPreg.bam


chr16:71409119-71450075 pt3
chr16:71929922-71971348 pt2


samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtAC_rmdup_recal.bam chr16:71929922-71971348 -b -o PtAC_HPreg.bam
samtools index PtAC_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtFR_rmdup_recal.bam chr16:71929922-71971348 -b -o PtFR_HPreg.bam
samtools index PtFR_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtGI_rmdup_recal.bam chr16:71929922-71971348 -b -o PtGI_HPreg.bam
samtools index PtGI_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtLA_rmdup_recal.bam chr16:71929922-71971348 -b -o PtLA_HPreg.bam
samtools index PtLA_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtLI_rmdup_recal.bam chr16:71929922-71971348 -b -o PtLI_HPreg.bam
samtools index PtLI_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtPE_rmdup_recal.bam chr16:71929922-71971348 -b -o PtPE_HPreg.bam
samtools index PtPE_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtRG_rmdup_recal.bam chr16:71929922-71971348 -b -o PtRG_HPreg.bam
samtools index PtRG_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtRN_rmdup_recal.bam chr16:71929922-71971348 -b -o PtRN_HPreg.bam
samtools index PtRN_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtSU_rmdup_recal.bam chr16:71929922-71971348 -b -o PtSU_HPreg.bam
samtools index PtSU_HPreg.bam

samtools view ftp://birch.well.ox.ac.uk/BAMs/PT2/PtYO_rmdup_recal.bam chr16:71929922-71971348 -b -o PtYO_HPreg.bam
samtools index PtYO_HPreg.bam



They all look like clint :(

### right gene conversion
chr16:71,941,171-71,941,236 (looks same as clint)
chr16:71,960,216-71,960,347 (in HPP

WHY THE FUCK DID I GRAB THE VERSION ALIGNED TO PANTRO2???!!! I NEED IT ALIGNED TO HG18
chr16:70,644,829-70,664,172

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtAC_rmdup_baq.bam chr16:70644829-70669000 -b -o PtAC_HPreghg18.bam
samtools index PtAC_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtFR_rmdup_baq.bam chr16:70644829-70669000 -b -o PtFR_HPreghg18.bam
samtools index PtFR_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtGI_rmdup_baq.bam chr16:70644829-70669000 -b -o PtGI_HPreghg18.bam
samtools index PtGI_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtLA_rmdup_baq.bam chr16:70644829-70669000 -b -o PtLA_HPreghg18.bam
samtools index PtLA_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtLI_rmdup_baq.bam chr16:70644829-70669000 -b -o PtLI_HPreghg18.bam
samtools index PtLI_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtPE_rmdup_baq.bam chr16:70644829-70669000 -b -o PtPE_HPreghg18.bam
samtools index PtPE_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtRG_rmdup_baq.bam chr16:70644829-70669000 -b -o PtRG_HPreghg18.bam
samtools index PtRG_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtRN_rmdup_baq.bam chr16:70644829-70669000 -b -o PtRN_HPreghg18.bam
samtools index PtRN_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtSU_rmdup_baq.bam chr16:70644829-70669000 -b -o PtSU_HPreghg18.bam
samtools index PtSU_HPreghg18.bam

samtools view ftp://birch.well.ox.ac.uk/panMap/BAMs/HG18/PtYO_rmdup_baq.bam chr16:70644829-70669000 -b -o PtYO_HPreghg18.bam
samtools index PtYO_HPreghg18.bam


############### Feb 24, 2014 ###########

get data from Gina/sek for cholesterol imputation

/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC
/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA
/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/FHS

my ref panel is from 16:71070878 - 16:73097663… grabbing this region in three plink files

plink --map chr16.map --ped chr16.ped --from 16_71066843 --to 16_73098690 --make-bed --geno 0.1 --mind 0.1 --out ARIC_HPreg
ARIC
13693 (of 13693) markers to be included from [ chr16.map ]
Scan region on chromosome 16 from [ 16_71066843 ] to [ 16_73098690 ]
13095 individuals read from [ chr16.ped ] 
0 individuals with nonmissing phenotypes
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 0 controls and 13095 missing
5849 males, 7246 females, and 0 of unspecified sex
Before frequency and genotyping pruning, there are 236 SNPs
13095 founders and 0 non-founders found
Writing list of removed individuals to [ ARIC_HPreg.irem ]
6 of 13095 individuals removed for low genotyping ( MIND > 0.1 )
Total genotyping rate in remaining individuals is 0.996539
0 SNPs failed missingness test ( GENO > 0.1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 236 SNPs
After filtering, 0 cases, 0 controls and 13089 missing
After filtering, 5848 males, 7241 females, and 0 of unspecified sex
Writing pedigree information to [ ARIC_HPreg.fam ] 
Writing map (extended format) information to [ ARIC_HPreg.bim ] 
Writing genotype bitfile to [ ARIC_HPreg.bed ] 
Using (default) SNP-major mode


plink --map chr16.map --ped chr16.ped --from 16_71207879 --to 16_73132839 --make-bed --geno 0.1 --mind 0.1 --out FHS_HPreg
Assuming a disease phenotype (1=unaff, 2=aff, 0=miss)
Missing phenotype value is also -9
0 cases, 0 controls and 8775 missing
4033 males, 4742 females, and 0 of unspecified sex
Before frequency and genotyping pruning, there are 182 SNPs
8775 founders and 0 non-founders found
0 of 8775 individuals removed for low genotyping ( MIND > 0.1 )
Total genotyping rate in remaining individuals is 0.993954
0 SNPs failed missingness test ( GENO > 0.1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 182 SNPs
After filtering, 0 cases, 0 controls and 8775 missing
After filtering, 4033 males, 4742 females, and 0 of unspecified sex
Writing pedigree information to [ FHS_HPreg.fam ]
Writing map (extended format) information to [ FHS_HPreg.bim ]
Writing genotype bitfile to [ FHS_HPreg.bed ]
Using (default) SNP-major mode

MESA
plink --map chr16.map --ped chr16.ped --from 16_71067139 --to 16_73097663 --make-bed --geno 0.1 --mind 0.1 --out MESA_HPreg

##### I should impute with HM3 instead of 1kg omni because there will be more SNPs in common!!!!!!!!


## SNP comp
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile ARIC_HPreg --recode --out ARIC_HPreg
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile MESA_HPreg --recode --out MESA_HPreg
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile FHS_HPreg --recode --out FHS_HPreg

/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.map
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/MESA_HPreg.map
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/FHS_HPreg.map


## SNP comp in R
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.map
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/1kg.HPSNPs.txt
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/HM3.HPSNPs.txt

ARIC.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.map", header=F)
MESA.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/MESA_HPreg.map", header=F)
FHS.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/FHS_HPreg.map", header=F)


kg.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/1kg.HPSNPs.txt", header=F)
hm3.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/HM3.HPSNPs.txt", header=F)

length(intersect(as.matrix(ARIC.snp[,4]), as.matrix(kg.snp))) #229
length(intersect(as.matrix(ARIC.snp[,4]), as.matrix(hm3.snp))) #219   of 236 total SNPs in ARIC

length(intersect(as.matrix(MESA.snp[,4]), as.matrix(kg.snp))) #208
length(intersect(as.matrix(MESA.snp[,4]), as.matrix(hm3.snp))) #191   of 212 total SNPs in ARIC


length(intersect(as.matrix(FHS.snp[,4]), as.matrix(kg.snp))) #181
length(intersect(as.matrix(FHS.snp[,4]), as.matrix(hm3.snp))) #168

###about the same, probably should use HM3 since Affy array. I should check to make sure important SNPs are present

imp.snp <- read.table("/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/Imp_critical_SNPs.txt", header=F)


#### no SNPS critical to the imputation are different between 1kg and HM3 datasets, choosing to use HM3 for better quality

SNP on OMNI essential for good HP2SS mutation 72886284, rs34914030

actually I have African Americans in ARIC, so I'm going to start by using the 1kg dataset

plink --bfile data1 --merge data2.ped data2.map --make-bed --out merge

merge the files switch the bases in ARIC

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/finished_ref/Allpops_encode.phase1.1kg.HPreg --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/ARIC_1kgref_merge

### seems like everything is OK, nothing had more than 2 alleles


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/ARIC_1kgref_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/PHENO_ARIC_1kgref_merge.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/flipscan
###### NO SNPS in neg LD!!


#####convert ARIC file to bgl
mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg.ped"


### imputing ARIC Af Am and Euro together with all 1kg samples
java -Xmx3000m -jar ./beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Allpops/finished_ref/nsam15.Allpops_encode.phase1.1kg.HPreg.bgl.phased unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/ARIC_HPreg_toimpute.bgl.txt markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/ARIC_1kg_markers.txt missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/out


### on broad server
java -Xmx4000m -jar ./beagle.jar markers=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/ARIC_1kg_markers.txt unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/ARIC_HPreg_toimpute.bgl.txt phased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/reference/Allpop1kg.HPreg.bgl.phased missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/out

java -Xmx4000m -jar ~/bin/beagle.jar 


#################### imputing all of ARIC with all of 1kg is taking too long ####### I'm just going to take the European ARIC and impute with HM3
#Feb 27, 2014

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_HPreg --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/ARIC_Euro_names.txt --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg

3297 individuals removed with --keep option
Before frequency and genotyping pruning, there are 236 SNPs
9792 founders and 0 non-founders found

### converted HM3 to plink

### merge HM3 ref with ARIC euros
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/finished_ref/Reference_EuroHM3.dupsnpfix.hg19pos --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/ARICEuro_HM3ref_merge

### scan for strand problems
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/ARICEuro_HM3ref_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/ARICEuro_HM3ref_pheno.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/out


###### seems like there are a lot of non-polymorphic SNPs
I'm going to get rid of them

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/ARICEuro_HM3ref_merge --hwe .001 --maf 0.001 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/flipscan/ARICEuro_HM3ref_merge_filter

1 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	1 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.249622
0 SNPs failed missingness test ( GENO > 1 )
179 SNPs failed frequency test ( MAF < 0.001 )
After frequency and genotyping pruning, there are 821 SNPs
After filtering, 0 cases, 0 controls and 9988 missing
After filtering, 4615 males, 5177 females, and 196 of unspecified sex

######## convert both to bgl

mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/ARICEuro_HM3ref_forimp.map.txt"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/HM3only_forARICimp.ped.txt"

pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/ARIConly_forimp.ped.txt"


########### impute into ARIC dataset with HM3

### first phase ref dataset
java -Xmx4000m -jar ./beagle.jar unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/HM3only_forARICimp.bgl missing=0 out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/HM3only_forARICimp

java -Xmx4000m -jar ./beagle.jar phased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/HM3only_forARICimp.HM3only_forARICimp.bgl.phased unphased=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/ARIConly_forimp.bgl missing=0 markers=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/ARICEuro_HM3ref_markers.txt out=/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/imputation/ARICimp.Euro.bgl



############# start on MESA dataset EURO with HM3
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/MESA_HPreg --maf 0.001  --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/MESA_Euro.txt --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/MESA_Euro_HPreg

5776 individuals removed with --keep option
Before frequency and genotyping pruning, there are 212 SNPs
2447 founders and 0 non-founders found
Total genotyping rate in remaining individuals is 0.998547
0 SNPs failed missingness test ( GENO > 1 )
0 SNPs failed frequency test ( MAF < 0.001 )
After frequency and genotyping pruning, there are 212 SNPs

### merge with the HM3 ref
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_ref/finished_ref/Reference_EuroHM3.dupsnpfix.hg19pos --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge

### scan for strand problems
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref.pheno.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/out

###### seems like there are a lot of non-polymorphic SNPs
I'm going to get rid of them
### also getting rid of SNPs not in HM3 dataset, will cause it to run slow and not that useful

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge --hwe .001 --maf 0.001 --geno 0.5 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge_filter
2643 founders and 0 non-founders found
1 markers to be excluded based on HWE test ( p <= 0.001 )
	0 markers failed HWE test in cases
	1 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 0.267579
793 SNPs failed missingness test ( GENO > 0.5 )
179 SNPs failed frequency test ( MAF < 0.001 )
After frequency and genotyping pruning, there are 212 SNPs
After filtering, 0 cases, 196 controls and 2447 missing
After filtering, 1173 males, 1274 females, and 196 of unspecified sex

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge --hwe .001 --maf 0.001 --geno 0.5 --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge_filter



### convert to bbl and add in structure for HM3 and phase
mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge_filter.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/HM3_forMESAimp_nostruct.ped.txt"


mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HM3ref_merge_filter.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/MESA_forimp.ped.txt"


java -Xmx4000m -jar ~/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_forMESAimp_wstruct.bgl.txt out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_forMESAimp_wstruct missing=0


gunzip /humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_forMESAimp_wstruct.HM3_forMESAimp_wstruct.bgl.txt.phased.gz


java -Xmx4000m -jar ~/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/MESA_forMESAimp.bgl phased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_forMESAimp_wstruct.HM3_forMESAimp_wstruct.bgl.txt.phased missing=0 markers=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/MESA_Euro_HM3ref_markers.txt out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/out



#########Feb 28, 2014 ############ LDL Chol signal maybe real. I'm now going to impute into HM3+OMNI ref panel

############################################ FHS ###############################################
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref

### check strands
### merge with the HM3 ref
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/FHS_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/FHS_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/HM3_OMNI_FHS_merge

### scan for strand problems
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/HM3_OMNI_FHS_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/FHS_HM3_OMNI_pheno.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/out

### no problems seen

### check for hew and fixed snps
--maf 0.001 (not doing HWE since have fams in FHS 
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/HM3_OMNI_FHS_merge --maf 0.001 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/HM3_OMNI_FHS_merge_filter

### convert FHS to blg format
mapfile <-"/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/merge_scan_strand/HM3_OMNI_FHS_merge_filter.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/FHS/impute/FHS_toimpute.ped.txt"


##### set up to impute on Broad server
java -Xmx4000m -jar ~/bin/beagle.jar phased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/reference/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/FHS/imputation/FHS_toimpute.bgl markers=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/FHS/imputation/FHSimpmarkers_HM3_OMNI.markers out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/FHS/imputation/out missing=0

number of markers    =    1413
number of haplotypes =   17550 (FHS_toimpute.bgl)
number of haplotypes =     548 (maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased)


############################################ ARIC ###############################################
### merge

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/Euro_ARIC_OMNI_HM3_merge


### scan for strand problems
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/Euro_ARIC_OMNI_HM3_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/ARIC_hm3_OMNI_pheno.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/out

#no problems
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/Euro_ARIC_OMNI_HM3_merge --maf 0.001 --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/flip/OMNI_HM3ref/Euro_ARIC_OMNI_HM3_merge
### nothing filtered

### convert to bgl

mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/Euro_ARIC/ARIC_Euro_HPreg.ped"


>>> printed .bgl to this directory, using markers file 


java -Xmx4000m -jar /humgen/cnp04/sandbox/lboettger/bin/beagle.jar phased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/reference/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/HM3_OMNI/ARIC_Euro_HPreg.bgl markers=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/HM3_OMNI/ARIC_OMNI_HM3_markers.txt missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/ARIC/imputation/HM3_OMNI/out


number of markers    =    1414
number of haplotypes =   19584 (ARIC_Euro_HPreg.bgl)
number of haplotypes =     548 (maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased)


bsub -Is -q interactive bash ## won't let me have two of these
bsub -N -q week ### used this instead



############################################ MESA ###############################################
#convert to bgl
mapfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.map"
pedfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.ped"

### combine and check that no flip SNPs necessary
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames --merge /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/MESA_Euro_HPreg.map --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/HM3_OMNI_merge/MESA_HM3_OMNI_merge


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/HM3_OMNI_merge/MESA_HM3_OMNI_merge --flip-scan --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/HM3_OMNI_merge/MESA_HM3_OMNI_pheno.txt --out //Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/HM3_OMNI_merge/out



java -Xmx4000m -jar ~/bin/beagle.jar phased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/reference/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_OMNIref/MESA_Euro_HPreg.bgl markers=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_OMNIref/MESA_HM3_OMNI_markers.txt missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/Chol/MESA/imputation/HM3_OMNIref/out

number of markers    =    1414
number of haplotypes =    4894 (MESA_Euro_HPreg.bgl)
number of haplotypes =     548 (maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.bgl.phased)



############################### convert HM3/OMNI imputed files (FHS, ARIC, MESA) to plink format and combine ################
bglfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/Euro3cohorts_HM3_OMNI_impute/imputed_cohorts/out.ARIC_Euro_HPreg.bgl.phased"


bglfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/Euro3cohorts_HM3_OMNI_impute/imputed_cohorts/out.FHS_toimpute.bgl.phased"


bglfile <- "/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/Euro3cohorts_HM3_OMNI_impute/imputed_cohorts/out.MESA_Euro_HPreg.bgl.phased"




######## merge three pop plink files into one
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/Euro3cohorts_HM3_OMNI_impute/imputed_cohorts/ARIC_Euro_HPreg_HM3_OMNI_impute --merge-list /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Chol_merge_files.txt --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed

################### look at LD in imputed dataset ################
--ld-window (for full, but takes too long)
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --ld 72018417 HP2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/HPregLD

R-sq = 0.074



/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --ld 72078990 HP2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/HP2LD72078990

R-sq = 0.144


### rs2000999
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --bfile /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --noweb --ld 72108093 HP2 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/HP2LD72108093

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --bfile /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --noweb --ld 72108093 HP2Bhap --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/HP2ssLD72108093





others:
72008225
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --ld 72979374 HP2 


########### look at LD in whole region
--ld-snp command in conjunction with --r2
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --ld-snp HP2 --r2 --ld-window-kb 1000000 --ld-window 99999999 --ld-window-r2 0 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/LD/HP2LD_rsq



########### association with three merged populations ##########
/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed

# phenotype order in file
1. TC
2. HDL
3. LDL
4. LTG
############################################################ TC ############################################################

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_TC_wcovar



#### imdv pops separate
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp.bgl.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp.bgl.ped --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp.bgl.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp.bgl.ped --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/MESA/Euro/imputation/imputed/out.MESA_forMESAimp --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/IndvPop_phen/Chol_phenotypes.MESA.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_cov_MESA.txt  --allow-no-sex --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/MESA_TC_wcovar


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/out.ARIC_Euro_HPreg.map --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/out.ARIC_Euro_HPreg.ped --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/IndvPop_phen/Chol_phenotypes.ARIC.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_cov_ARIC.txt --allow-no-sex --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ARIC_TC_wcovar




##### remerge with same name for struc var
######## merge three pop plink files into one
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/ARIC/imputation/out.ARIC_Euro_HPreg --merge-list /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Chol_merge_filesnew.txt --make-bed --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputednew

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariatesnew.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_TC_wcovarnew





--covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_cov_MESA.txt 
############################## TC CONDITIONAL ANALYSIS ############################

### TC  condition on HP2
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition HP2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_TC_cHP2


### TC  condition on SNP 72018417
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition 72018417 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_TC_c72018417

### TC  condition on SNP 72108093 (rs2000999)
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 1 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition 72108093 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_TC_c72108093


############################################################ HDL ############################################################

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 2 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_HDL_wcovar

### doesn't look associated with structure

############################################################ LDL ############################################################
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 3 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_LDL_wcovar

############################## LDL CONDITIONAL ANALYSIS ############################

### LDL  condition on HP2
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 3 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition HP2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_LDL_cHP2


### LDL  condition on SNP 72078990
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 3 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition 72078990 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_LDL_c72078990

### LDL  condition on SNP rs2000999
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 3 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --condition 72108093 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_LDL_c72108093

72091565
############################################################ LTG ############################################################

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/data_merge/Three_pop_imputed --linear --pheno /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_phenotypes.txt --mpheno 4 --covar /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/ThreePop_phen/Chol_covariates.txt --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Chol/assoc/results/ThreePop_LTG_wcovar


##### get chimps from diversity project. I think some have original haptoglobin ####
wget https://eichlerlab.gs.washington.edu/greatape/data/VCFs/SNPs/Pan_troglodytes.vcf.gz

vcftools --gzvcf Pan_troglodytes.vcf.gz --chr chr16 --recode --out Pan_tro_16_Eichler

HP-Left:70649067-70649128, HP-Right:70650782-70650843, HPR: 70666819-70666880

--from-bp <integer> 
--to-bp <integer>

vcftools --vcf Pan_tro_16_Eichler.recode.vcf --chr chr16 --from-bp 70649027 --to-bp 70649128 --recode --out HP_leftalign_chimps  (no sites)
vcftools --vcf Pan_tro_16_Eichler.recode.vcf --chr chr16 --from-bp 70650742 --to-bp 70650803 --recode --out HP_rightalign_chimps (no sites)
vcftools --vcf Pan_tro_16_Eichler.recode.vcf --chr chr16 --from-bp 70666779 --to-bp 70666880 --recode --out HPR_align_chimps (no sites)




####### make 1kg spider gram to look at names and pick samples March 17, 2014###
python -u plot_spidergram_Hpr_LB_grynoname.py Euro_1kgp1_FHSoverlap_spiderinput.txt Euro1kg_FHSoverlap_smod.pdf


python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_50kb.phased Allpop_1kg_smod_50kb.pdf



######### April 14, 2014, get affy 6.0 SNPs on chr16 ##########
"AFFX-SNP_10036267","rs1943277","11","58562418","-","0","q12.1","GGCACGAAATAATAGC[A/G]CTCTCCTTCAACTTAT","A","G","ENST00000526644 // upstream // 33892 // --- // --- // --- // --- /// ENST00000529148 // downstream // 1292 // --- // --- // --- // --- /// NM_005838 // upstream // 62971 // Hs.145384 // GLYAT // 10249 // glycine-N-acyltransferase /// NM_145016 // downstream // 39122 // Hs.254271 // GLYATL2 // 219970 // glycine-N-acyltransferase-like 2","64.2744 // D11S1983 // D11S1335 // --- // --- // deCODE /// 59.8574 // D11S1385 // D11S4191 // GATA2A01 // AFM338WC1 // Marshfield /// 55.9737 // --- // --- // 51760 // 1006949 // SLM1","D11S4657 // downstream // 47252 /// D11S3525 // upstream // 38243","NspI // GCATGT_ACATGT // 1029 // 58561821 // 58562849 /// StyI // CCATGG_CCTAGG // 4736 // 58560793 // 58565528","0.1417 // 0.8583 // CEU /// 0.1889 // 0.8111 // CHB /// 0.2386 // 0.7614 // JPT /// 0.2034 // 0.7966 // YRI","0.2833 // CEU /// 0.3333 // CHB /// 0.2955 // JPT /// 0.3390 // YRI","60 // CEU /// 45 // CHB /// 45 // JPT /// 60 // YRI","YES","reverse","Variation_48858 // 11:58553771-58632368 // Illumina HumanHap550 V1 BeadChip  // 19592680 // Shaikh et al. (2009) // CopyNumber","8","0","YES","A // CEU /// A // CHB /// A // JPT /// A // YRI","0.1417 // CEU /// 0.1889 // CHB /// 0.2386 // JPT /// 0.2034 // YRI","---","---"

grep -Po "/"rs\d+/",/"17/",/"\d+/"" GenomeWideSNP_6.na34.annot.csv > Affy_6.0SNPs.txt




Illumin 1M-single SNPs
wget ftp://ftp.illumina.com/Customer%20Transfer/Human1%20csv/Human1Mv1_C.csv --user=guest --password=illumina
--user=userName: Your FTP/HTTP username
--password=passWord : Your HTTP/FTP password



##############   May 8, 2013, Look at LD across the structurally variant region ###### 
# do SNP haplotypes persist through the variation


/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --ped /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.ped --map /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/maxwin2000.OMNI_HM3_merged.nofixedsnps.structnames.map  --r2 --ld-window 30 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/Euror2


### check strange r-2 statistics for YRI on OMNI
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/nsam10.YRIunrel_OMNI_b37_HPreg --ld-snp HP1Ahap --ld-window 900 --ld-window-r2 0.4 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRIr2HP1A
##### this also looks strange very high

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/nsam10.YRIunrel_OMNI_b37_HPreg --ld-snp HP2Ahap --ld-window 900 --ld-window-r2 0.4 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRIr2HP2A

/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/nsam10.YRIunrel_OMNI_b37_HPreg --ld-snp HP2 --ld-window 900 --ld-window-r2 0.4 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/OMNI_ref/filter_format/YRI/YRIr2HP2




######### popgen stats #######

### filter to just get people in haplotype plot
/Users/lindaboettger/bioapps/vcftools_0.1.9/bin/vcftools --vcf /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.v3.20101123_HPreg_noindel.recode.vcf --keep /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/popgen_measures/hap_plot_indvs.txt --recode --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.happlotindvs



##### June 13, 2014 Look at Heidelberg Chimps for left gene conversion ###
http://www.ebi.ac.uk/ena/data/view/PRJEB1675

first fast from ERR247228
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247228_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247228_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247228_1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247228_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247228_1.fastq ## test clint-like, yes, at least three hits

first fast from ERR247229
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247229_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247229_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247229_1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247229_1.fastq ## test clint-like, yes, hits
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247229_1.fastq ## test clint-like, yes, 2 hits

grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247229_2.fastq #for vntr grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247229_2.fastq 
grep "CCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247229_2.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247229_2.fastq ## no hits
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247229_2.fastq ## test clint-like, yes, 2 hits


first fast from ERR247230
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247230_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247230_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247230_1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247230_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247230_1.fastq ## test clint-like, yes, at least three hits



ERR247231_1
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247231_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247231_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247231_1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247231_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247231_1.fastq ## test clint-like, yes, at least three hits

ERR247231_2
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247231_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247231_2.fastq 

wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247232/ERR247232_1.fastq.gz


ERR247232_1
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247232_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247232_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247232_1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247232_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247232_1.fastq ## test clint-like, yes, at least 
/Users/lindaboettger
wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247232/ERR247232_2.fastq.gz
ERR247232_2
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247232_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247232_2.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247232_2.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247232_2.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247232_2.fastq ## test clint-like, yes, at least 
/Users/lindaboettger

wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247233/ERR247233_1.fastq.gz
ERR247233.1
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247233_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247233_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247233.1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247233_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247233_1.fastq ## test clint-like, yes, at least 
/Users/lindaboettger


wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247233/ERR247233_2.fastq.gz
ERR247233.2
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247233_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247233_2.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247233_2.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247233.2.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247233.2.fastq ## test clint-like, yes, at least 
/Users/lindaboettger


wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247234/ERR247234_1.fastq.gz
ERR247234_1
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247234_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247234_1.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247233.1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247234_1.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247234_1.fastq ## test clint-like, yes, at least 
/Users/lindaboettger

ERR247234_2
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247234_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247234_2.fastq 
grep "CTTGGCTGTGACCGCCATGACCACAGTGTGTTCTGCTGGGCTTAACTGGTG" ERR247233.1.fastq
grep "CCACAGTATGTTCTGCTGAGCTTAACTGGCA" ERR247234_2.fastq ## test clint-like, nothing found
grep "AGGAGTGTACACCTTAAACAATGAGAAGC" ERR247234_2.fastq ## test clint-like, yes, at least 



wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247235/ERR247235_1.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247235_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247235_1.fastq 

wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247235/ERR247235_1.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247235_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247235_2.fastq 



wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247236/ERR247236_1.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247236_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247236_1.fastq 

wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247236/ERR247236_2.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247236_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247236_2.fastq 


wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247237/ERR247237_1.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247237_1.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247237_1.fastq 


wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247237/ERR247237_2.fastq.gz
grep "GGTGCTGAGCACTGAGCACTTAAGAGAGCAGGCAG" ERR247237_2.fastq #for vntr
grep "CTCATATTCTCTCTCCTTTCTCCC" ERR247237_2.fastq 

wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR247/ERR247238/ERR247238_1.fastq.gz

###################### June 17, splitting HM3 into affy and illumina snps ############

folder:/Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/Affy_6.0/
#this one
perl -ne 'm/("rs\d+","16","\d+")/ && print "$1\n"' Affy6.0_SNPs.csv > chr16_Affy_6.0SNPs.txt





Illumina 1M
perl -ne 'm/(rs\d+).+(36,16,\d+,)/ && print "$1\t$2\n"' Human1M_single_SNPs.csv > chr16_Illumina1MSNPs.txt







#get only rsid and SNP call
perl -ne '(rs\d+\",\"16\",\"d+,) print;' Affy6.0_SNPs.csv > chr16snps.txt

grep -Po "/"rs\d+/",/"16/",/"\d+/"" Affy6.0_SNPs.csv > chr16_Affy_6.0SNPs.txt

grep -Po "/"rs\d+/",/"16/",/"\d+/"" Affy6.0_SNPs.csv > chr16_Affy_6.0SNPs.txt


#get only rsid and SNP call
perl -ne 's/.+(rs\d+).+(\w)$/$1\t$2/; print;' HapMap2Chimp_Chr17.txt > HapMap2Chimp_Chr17_SNPS.txt



############ iterations for beagle ######
## reference for nsamples=25
http://www.biomedsearch.com/nih/Evaluation-haplotype-inference-using-definitive/19424418.html

 and others not uncommon to do 25

### reference for iterations=50
http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1000529#pgen-1000529-g005



############## pacbio analysis ###### June 30, 2014
#this command was run to demultiplex and filter the reads

pbbarcode.py emitFastqs --minReadScore 0.75 --minMaxInsertLength 400 input.fofn barcode.fofn

use bwa long read, or blasr to align long reads, look at quality score scale
then align
#use Samtools
Dec2010_17q21.31/bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta Summer2011_17q21.31/split_fastq/NA21685_2.fastq > Summer2011_17q21.31/align/NA21685_2.sai


--minReadScore 0.75 (or 0.8) --minLength 500

######### changing directory permissions for rany
sudo chmod -R 0777 /humgen/cnp04/sandbox/lboettger/Haptoglobin/Rany_results

Sorry, user boettger is not allowed to execute '/bin/chmod -R 0777 /humgen/cnp04/sandbox/lboettger/Haptoglobin/Rany_results' as root on node1382.
Sorry, user boettger is not allowed to execute '/bin/chmod -R 0777 /humgen/cnp04/sandbox/lboettger/Haptoglobin/Rany_results' as root on tin.broadinstitute.org.

ls -l "/humgen/cnp04/sandbox/lboettger/Haptoglobin/Rany_results"


sudo chmod -R 0777 "/home/unix/boettger/Rany_HP_results"

#### this worked to change read/write permissions
chmod -R a+wrx /humgen/cnp04/sandbox/lboettger/Haptoglobin/Rany_results/



################# using GATK to analyze PacBio, July 6 2014 ################
### first did this to filter and sort
pbbarcode.py emitFastqs --minReadScore 0.75 --minMaxInsertLength 400 input.fofn barcode.fofn

#### build reference
bwa index -a bwtsw <your reference sequence>.fasta

###this is HP2  from hg19
/humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa

###this is HP1 from sequenced individual and ends (not sangered) are  from hg19
bwa index -a bwtsw /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa



#### aligning
Aligners for long reads (>200bp): BLAT, SSAHA2 and BWA-SW.
Long-read algorithm (BWA-SW): sample reference subsequences and
perform Smith-Waterman alignment between the subsequences and
the read

bwa bwasw /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc16_NA20502_HP1S_Forward--H_bc16_NA20502_HP1S_Forward.fastq > bwasw_aligned/H_bc16_NA20502_HP1S.sam

samtools view -bS bwasw_aligned/H_bc16_NA20502_HP1S.sam > bwasw_aligned/H_bc16_NA20502_HP1S.bam
samtools sort bwasw_aligned/H_bc16_NA20502_HP1S.bam bwasw_aligned/H_bc16_NA20502_HP1S.bam.sorted
samtools index bwasw_aligned/H_bc16_NA20502_HP1S.bam.sorted.bam


bwa bwasw /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc27_NA18502_HP1S_Forward--H_bc27_NA18502_HP1S_Forward.fastq > bwasw_aligned/H_bc27_NA18502_HP1S.sam
samtools view -bS bwasw_aligned/H_bc27_NA18502_HP1S.sam > bwasw_aligned/H_bc27_NA18502_HP1S.bam
samtools sort bwasw_aligned/H_bc27_NA18502_HP1S.bam bwasw_aligned/H_bc27_NA18502_HP1S.bam.sorted
samtools index bwasw_aligned/H_bc27_NA18502_HP1S.bam.sorted.bam

### my long reads didn't align

#### using BWA-MEM
-x pacbio


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc27_NA18502_HP1S_Forward--H_bc27_NA18502_HP1S_Forward.fastq > bwamem_pacbio/H_bc27_NA18502_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc27_NA18502_HP1S.sam > bwamem_pacbio/H_bc27_NA18502_HP1S.bam
samtools sort bwamem_pacbio/H_bc27_NA18502_HP1S.bam bwamem_pacbio/H_bc27_NA18502_HP1S.bam.sorted
samtools index bwamem_pacbio/H_bc27_NA18502_HP1S.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc1_NA18909_HP1FAS_Forward--D_bc1_NA18909_HP1FAS_Forward.fastq > bwamem_pacbio/D_bc1_NA18909_HP1FAS.sam
samtools view -bS bwamem_pacbio/D_bc1_NA18909_HP1FAS.sam > bwamem_pacbio/D_bc1_NA18909_HP1FAS.bam
samtools sort bwamem_pacbio/D_bc1_NA18909_HP1FAS.bam bwamem_pacbio/D_bc1_NA18909_HP1FAS.bam.sorted
samtools index bwamem_pacbio/D_bc1_NA18909_HP1FAS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc12_NA20524_HP2FS_Forward--D_bc12_NA20524_HP2FS_Forward.fastq > bwamem_pacbio/D_bc12_NA20524_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc12_NA20524_HP2FS.sam > bwamem_pacbio/D_bc12_NA20524_HP2FS.bam
samtools sort bwamem_pacbio/D_bc12_NA20524_HP2FS.bam bwamem_pacbio/D_bc12_NA20524_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc12_NA20524_HP2FS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc4_NA11840_HP2FSASS_Forward--D_bc4_NA11840_HP2FSASS_Forward.fastq > bwamem_pacbio/D_bc4_NA11840_HP2FSASS.sam
samtools view -bS bwamem_pacbio/D_bc4_NA11840_HP2FSASS.sam > bwamem_pacbio/D_bc4_NA11840_HP2FSASS.bam
samtools sort bwamem_pacbio/D_bc4_NA11840_HP2FSASS.bam bwamem_pacbio/D_bc4_NA11840_HP2FSASS.bam.sorted
samtools index bwamem_pacbio/D_bc4_NA11840_HP2FSASS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc7_NA12236_HP2FSASS_Forward--D_bc7_NA12236_HP2FSASS_Forward.fastq > bwamem_pacbio/D_bc7_NA12236_HP2FSASS.sam
samtools view -bS bwamem_pacbio/D_bc7_NA12236_HP2FSASS.sam > bwamem_pacbio/D_bc7_NA12236_HP2FSASS.bam
samtools sort bwamem_pacbio/D_bc7_NA12236_HP2FSASS.bam bwamem_pacbio/D_bc7_NA12236_HP2FSASS.bam.sorted
samtools index bwamem_pacbio/D_bc7_NA12236_HP2FSASS.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc8_PR00107_Gorilla_Forward--D_bc8_PR00107_Gorilla_Forward.fastq > bwamem_pacbio/D_bc8_PR00107_Gorilla.sam
samtools view -bS bwamem_pacbio/D_bc8_PR00107_Gorilla.sam > bwamem_pacbio/D_bc8_PR00107_Gorilla.bam
samtools sort bwamem_pacbio/D_bc8_PR00107_Gorilla.bam bwamem_pacbio/D_bc8_PR00107_Gorilla.bam.sorted
samtools index bwamem_pacbio/D_bc8_PR00107_Gorilla.bam.sorted.bam



/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc10_PR00251_Bonobo_Forward--D_bc10_PR00251_Bonobo_Forward.fastq > bwamem_pacbio/D_bc10_PR00251_Bonobo.sam
samtools view -bS bwamem_pacbio/D_bc10_PR00251_Bonobo.sam > bwamem_pacbio/D_bc10_PR00251_Bonobo.bam
samtools sort bwamem_pacbio/D_bc10_PR00251_Bonobo.bam bwamem_pacbio/D_bc10_PR00251_Bonobo.bam.sorted
samtools index bwamem_pacbio/D_bc10_PR00251_Bonobo.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc14_NA20810_HP1var_Forward--D_bc14_NA20810_HP1var_Forward.fastq > bwamem_pacbio/D_bc14_NA20810_HP1var.sam
samtools view -bS bwamem_pacbio/D_bc14_NA20810_HP1var.sam > bwamem_pacbio/D_bc14_NA20810_HP1var.bam
samtools sort bwamem_pacbio/D_bc14_NA20810_HP1var.bam bwamem_pacbio/D_bc14_NA20810_HP1var.bam.sorted
samtools index bwamem_pacbio/D_bc14_NA20810_HP1var.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc15_NA20795_HP2FS_Forward--D_bc15_NA20795_HP2FS_Forward.fastq > bwamem_pacbio/D_bc15_NA20795_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc15_NA20795_HP2FS.sam > bwamem_pacbio/D_bc15_NA20795_HP2FS.bam
samtools sort bwamem_pacbio/D_bc15_NA20795_HP2FS.bam bwamem_pacbio/D_bc15_NA20795_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc15_NA20795_HP2FS.bam.sorted.bam



/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc19_HG01686_HP2var_Forward--D_bc19_HG01686_HP2var_Forward.fastq > bwamem_pacbio/D_bc19_HG01686_HP2var.sam
samtools view -bS bwamem_pacbio/D_bc19_HG01686_HP2var.sam > bwamem_pacbio/D_bc19_HG01686_HP2var.bam
samtools sort bwamem_pacbio/D_bc19_HG01686_HP2var.bam bwamem_pacbio/D_bc19_HG01686_HP2var.bam.sorted
samtools index bwamem_pacbio/D_bc19_HG01686_HP2var.bam.sorted.bam



/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc21_NA19098_HP2FS_Forward--D_bc21_NA19098_HP2FS_Forward.fastq > bwamem_pacbio/D_bc21_NA19098_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc21_NA19098_HP2FS.sam > bwamem_pacbio/D_bc21_NA19098_HP2FS.bam
samtools sort bwamem_pacbio/D_bc21_NA19098_HP2FS.bam bwamem_pacbio/D_bc21_NA19098_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc21_NA19098_HP2FS.bam.sorted.bam


x/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc23_NA19099_HP2FS_Forward--D_bc23_NA19099_HP2FS_Forward.fastq > bwamem_pacbio/D_bc23_NA19099_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc23_NA19099_HP2FS.sam > bwamem_pacbio/D_bc23_NA19099_HP2FS.bam
samtools sort bwamem_pacbio/D_bc23_NA19099_HP2FS.bam bwamem_pacbio/D_bc23_NA19099_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc23_NA19099_HP2FS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc33_NA12812_HP2FS_Forward--D_bc33_NA12812_HP2FS_Forward.fastq > bwamem_pacbio/D_bc33_NA12812_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc33_NA12812_HP2FS.sam > bwamem_pacbio/D_bc33_NA12812_HP2FS.bam
samtools sort bwamem_pacbio/D_bc33_NA12812_HP2FS.bam bwamem_pacbio/D_bc33_NA12812_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc33_NA12812_HP2FS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc34_NS03641_Chimp_Forward--D_bc34_NS03641_Chimp_Forward.fastq > bwamem_pacbio/D_bc34_NS03641_Chimp.sam
samtools view -bS bwamem_pacbio/D_bc34_NS03641_Chimp.sam > bwamem_pacbio/D_bc34_NS03641_Chimp.bam
samtools sort bwamem_pacbio/D_bc34_NS03641_Chimp.bam bwamem_pacbio/D_bc34_NS03641_Chimp.bam.sorted
samtools index bwamem_pacbio/D_bc34_NS03641_Chimp.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc42_NG06209_Orang_Forward--D_bc42_NG06209_Orang_Forward.fastq > bwamem_pacbio/D_bc42_NG06209_Orang.sam
samtools view -bS bwamem_pacbio/D_bc42_NG06209_Orang.sam > bwamem_pacbio/D_bc42_NG06209_Orang.bam
samtools sort bwamem_pacbio/D_bc42_NG06209_Orang.bam bwamem_pacbio/D_bc42_NG06209_Orang.bam.sorted
samtools index bwamem_pacbio/D_bc42_NG06209_Orang.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc40_NS03489_Chimp_Forward--D_bc40_NS03489_Chimp_Forward.fastq > bwamem_pacbio/D_bc40_NS03489_Chimp.sam
samtools view -bS bwamem_pacbio/D_bc40_NS03489_Chimp.sam > bwamem_pacbio/D_bc40_NS03489_Chimp.bam
samtools sort bwamem_pacbio/D_bc40_NS03489_Chimp.bam bwamem_pacbio/D_bc40_NS03489_Chimp.bam.sorted
samtools index bwamem_pacbio/D_bc40_NS03489_Chimp.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa D_bc45_NA12873_HP2FS_Forward--D_bc45_NA12873_HP2FS_Forward.fastq > bwamem_pacbio/D_bc45_NA12873_HP2FS.sam
samtools view -bS bwamem_pacbio/D_bc45_NA12873_HP2FS.sam > bwamem_pacbio/D_bc45_NA12873_HP2FS.bam
samtools sort bwamem_pacbio/D_bc45_NA12873_HP2FS.bam bwamem_pacbio/D_bc45_NA12873_HP2FS.bam.sorted
samtools index bwamem_pacbio/D_bc45_NA12873_HP2FS.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc13_NA20806_HP1oftrip_Forward--H_bc13_NA20806_HP1oftrip_Forward.fastq > bwamem_pacbio/H_bc13_NA20806_HP1oftrip.sam
samtools view -bS bwamem_pacbio/H_bc13_NA20806_HP1oftrip.sam > bwamem_pacbio/H_bc13_NA20806_HP1oftrip.bam
samtools sort bwamem_pacbio/H_bc13_NA20806_HP1oftrip.bam bwamem_pacbio/H_bc13_NA20806_HP1oftrip.bam.sorted
samtools index bwamem_pacbio/H_bc13_NA20806_HP1oftrip.bam.sorted.bam



/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc16_NA20502_HP1S_Forward--H_bc16_NA20502_HP1S_Forward.fastq > bwamem_pacbio/H_bc16_NA20502_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc16_NA20502_HP1S.sam > bwamem_pacbio/H_bc16_NA20502_HP1S.bam
samtools sort bwamem_pacbio/H_bc16_NA20502_HP1S.bam bwamem_pacbio/H_bc16_NA20502_HP1S.bam.sorted
samtools index bwamem_pacbio/H_bc16_NA20502_HP1S.bam.sorted.bam



/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc18_NA20786_HP1S_Forward--H_bc18_NA20786_HP1S_Forward.fastq > bwamem_pacbio/H_bc18_NA20786_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc18_NA20786_HP1S.sam > bwamem_pacbio/H_bc18_NA20786_HP1S.bam
samtools sort bwamem_pacbio/H_bc18_NA20786_HP1S.bam bwamem_pacbio/H_bc18_NA20786_HP1S.bam.sorted
samtools index bwamem_pacbio/H_bc18_NA20786_HP1S.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa H_bc20_NA11843_HP1S_Forward--H_bc20_NA11843_HP1S_Forward.fastq > bwamem_pacbio/H_bc20_NA11843_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc20_NA11843_HP1S.sam > bwamem_pacbio/H_bc20_NA11843_HP1S.bam
samtools sort bwamem_pacbio/H_bc20_NA11843_HP1S.bam bwamem_pacbio/H_bc20_NA11843_HP1S.bam.sorted
samtools index bwamem_pacbio/H_bc20_NA11843_HP1S.bam.sorted.bam


/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP1_refseq.fa D_bc30_NA12348_HP1S_Forward--D_bc30_NA12348_HP1S_Forward.fastq > bwamem_pacbio/D_bc30_NA12348_HP1S.sam
samtools view -bS bwamem_pacbio/D_bc30_NA12348_HP1S.sam > bwamem_pacbio/D_bc30_NA12348_HP1S.bam
samtools sort bwamem_pacbio/D_bc30_NA12348_HP1S.bam bwamem_pacbio/D_bc30_NA12348_HP1S.bam.sorted
samtools index bwamem_pacbio/D_bc30_NA12348_HP1S.bam.sorted.bam




### align haploid deleted indvs to HP2 for direct comp
/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa H_bc16_NA20502_HP1S_Forward--H_bc16_NA20502_HP1S_Forward.fastq > bwamem_pacbio/H_bc16_NA20502_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc16_NA20502_HP1S.sam > bwamem_pacbio/H_bc16_NA20502_HP1S.bam
samtools sort bwamem_pacbio/H_bc16_NA20502_HP1S.bam bwamem_pacbio/H_bc16_NA20502_HP1StoHP2.bam.sorted
samtools index bwamem_pacbio/H_bc16_NA20502_HP1StoHP2.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa H_bc18_NA20786_HP1S_Forward--H_bc18_NA20786_HP1S_Forward.fastq > bwamem_pacbio/H_bc18_NA20786_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc18_NA20786_HP1S.sam > bwamem_pacbio/H_bc18_NA20786_HP1S.bam
samtools sort bwamem_pacbio/H_bc18_NA20786_HP1S.bam bwamem_pacbio/H_bc18_NA20786_HP1StoHP2.bam.sorted
samtools index bwamem_pacbio/H_bc18_NA20786_HP1StoHP2.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa H_bc20_NA11843_HP1S_Forward--H_bc20_NA11843_HP1S_Forward.fastq > bwamem_pacbio/H_bc20_NA11843_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc20_NA11843_HP1S.sam > bwamem_pacbio/H_bc20_NA11843_HP1S.bam
samtools sort bwamem_pacbio/H_bc20_NA11843_HP1S.bam bwamem_pacbio/H_bc20_NA11843_HP1StoHP2.bam.sorted
samtools index bwamem_pacbio/H_bc20_NA11843_HP1StoHP2.bam.sorted.bam

/home/unix/boettger/opt/bwa/bwa mem -x pacbio /humgen/cnp04/sandbox/lboettger/Haptoglobin/pacbio/refs/HP2_refseq.fa H_bc27_NA18502_HP1S_Forward--H_bc27_NA18502_HP1S_Forward.fastq > bwamem_pacbio/H_bc27_NA18502_HP1S.sam
samtools view -bS bwamem_pacbio/H_bc27_NA18502_HP1S.sam > bwamem_pacbio/H_bc27_NA18502_HP1S.bam
samtools sort bwamem_pacbio/H_bc27_NA18502_HP1S.bam bwamem_pacbio/H_bc27_NA18502_HP1StoHP2.bam.sorted
samtools index bwamem_pacbio/H_bc27_NA18502_HP1StoHP2.bam.sorted.bam



##### spider gram by population july 14 2014
python -u plot_spidergram_Hpr_LB_grynoname.py allpop_popcolors_1kg.phased HP_allpop_1kg_50kb_popcolors.pdf


python -u plot_spidergram_paper_Hpr_smalldots.py allpop_popcolors_1kg_HP2dots.phased HP_allpop_1kg_50kb_popcolors_HP2dots.pdf



July 17 2014. looking for HP duplication in 1kg phase 3 data ####################
use VCFtools
vcftools --gzvcf  ALL.chr16.phase3_shapeit2_mvncall_integrated_v2.20130502.genotypes.vcf.gz --chr 16 --from-bp 72088508 --to-bp 72094955 --recode --out HP_1kg_phase3

DUP_gs_CNV_16_72094527_72110961 ->this is the only deletion called in the HP region it is the HPR duplication

The HP1/HP2 duplication/deletion does not appear in the phase 3 dataset


########### July 21, 2014 get r-2 for SNPs in region for figure 1 ##############
### pull out just YRI parents
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/YRI/phase1_1kg_YRIrents --r2 --ld-window-kb 100000 --ld-window 999999 --ld-window-r2 0.2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/YRI_1kg_LD

	  --r2 
          --ld-snp rs12345 
          --ld-window-kb 1000 
          --ld-window 99999 
          --ld-window-r2 0



plink --file data --freq
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/YRI/phase1_1kg_YRIrents --freq --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/YRI_1kg_MAF


### CEU parents
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrentshwe --r2 --ld-window-kb 100000 --ld-window 999999 --ld-window-r2 0.2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/CEU_1kg_LD


plink --file data --freq
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_HP_CEUrentshwe --freq --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/CEU_1kg_MAF


### merged EURO
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_Euromergef2 --r2 --ld-window-kb 100000 --ld-window 999999 --ld-window-r2 0.2 --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/Euro_1kg_LD


plink --file data --freq
/Users/lindaboettger/bioapps/plink-1.07-mac-intel/plink --noweb --file /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/phase1_1kg_ref/filter_format/Euro/p1_1kg_Euromergef2 --freq --out /Users/lindaboettger/McCarroll_Projects/Haptoglobin_new/HP_recomb/Euro_1kg_MAF


p1_1kg_Euromergef2.map





############# using only trio-phased CEU and YRI for spider gram ################# July 30, 2014
http://hapmap.ncbi.nlm.nih.gov/downloads/phasing/2009-02_phaseIII/HapMap3_r2/
but this data doesn't have the kids, and I need it phased with the structure



bsub -Is -q interactive bash

####### Sept 26, 2014, make 25kb spider gram from 1kg pop phased data ###########

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_25kb.phased Allpop_HP_25kb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20kb.phased Allpop_HP_20kb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30kb.phased Allpop_HP_30kb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_40kb.phased Allpop_HP_40kb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_35kb.phased Allpop_HP_35kb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30bkb.phased Allpop_HP_30bkb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30bkb.phased Allpop_HP_30ckb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30dkb.phased Allpop_HP_30ekb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30fkb.phased Allpop_HP_30fkb_smalldot.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30ekb.phased Allpop_HP_30ekb_smalldot.pdf
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30gkb.phased Allpop_HP_30gkb_smalldot.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30hkb.phased Allpop_HP_30hkb_smalldot.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30ikb.phased Allpop_HP_30ikb_smalldot.pdf



h is the best one
python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_30hkb.phased Allpop_HP_30hkb_names.pdf

fixing phase of HP1 dels
python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_30hkb.delfixphased Allpop_HP_30hkbdelfix_names.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_30hkb.delfixphased Allpop_HP_30hkbdelfix_smalldot.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased Allpop_HP_20hkbdelfix_smalldot.pdf
python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_20hkb.delfixphased Allpop_HP_20hkbdelfix_names.pdf


#### I removed NA19095 and NA19235 because of obvious phasing error (they are both the same as NA19093, which is phased correctly
### I should confirm this with drop phase then add them back
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot.pdf
python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase.phased Allpop_HP_20hkbdelfix_rmmisphase_names.pdf


python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase.phased Allpop_HP_20kb_smalldotTEST.pdf


### colors fixed everyone included, Jan 13, 2015
bsub -q hour python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.recolor.phased.delfixphased -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_spidergram/Allpop_spiderinput_1kg_20hkb.recolor.pdf
 crap 




##### also make a 50kb one so people can tell they are long
Allpop_spiderinput_1kg_delphasefix_badphaserm_50kb

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_delphasefix_badphaserm_50kb.txt Allpop_HP_50hkbdelfix_rmmisphase_smalldot.pdf


python -u plot_spidergram_Hpr_LB_smallname.py Allpop_spiderinput_1kg_delphasefix_badphaserm_50kb.txt Allpop_HP_50hkbdelfix_rmmisphase_names.pdf



October 18 2014 making figure for neanderthal and denisova variants

## start by calling each at region defining bases

Need to use options:
--output_mode EMIT_ALL_SITES
https://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_tools_walkers_genotyper_UnifiedGenotyper.php#--output_mode

--intervals INTERVAL_FILE, described here: https://www.broadinstitute.org/gatk/guide/article?id=1204
https://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_engine_CommandLineGATK.php#--intervals

##### problem between my reference and theirs chr vs just chromosome
### get header
samtools view -H /humgen/cnp04/sandbox/lboettger/Denisova/Denisova_HP.sorted.bam > /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_head.sam

### header fixed manually

### put new header on bam file
samtools reheader /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chrhead.sam /humgen/cnp04/sandbox/lboettger/Denisova/Denisova_HP.sorted.bam > /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam


#### uniquely mapped denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.interval_list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.raw.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.interval_list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.vcf \
   --output_mode EMIT_ALL_SITES




######### neanderthal

samtools view -H /humgen/cnp04/sandbox/lboettger/Neanderthal/Neanderthal_HP.sorted.bam > /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_head.sam

### header fixed manually

### put new header on bam file
samtools reheader /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_headchr.sam /humgen/cnp04/sandbox/lboettger/Neanderthal/Neanderthal_HP.sorted.bam > /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam


samtools index /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam


#### uniquely mapped Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.interval_list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.uniquemap.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.interval_list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.vcf \
   --output_mode EMIT_ALL_SITES

…… note!!! I accentually overwrote denisova with neanderthal!!!!!!!!!!!!
--- there was a problem with some bp location on the right side due to indels.. I correct for these here



################### neanderthal corrections #################
#### uniquely mapped Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.intervalcorrections.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.uniquemap.Necorr.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.intervalcorrections.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.Necorr.vcf \
   --output_mode EMIT_ALL_SITES


################### denisova corrections #################
#### uniquely mapped denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.intervalcorrections.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.raw.Dencorr.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvar.intervalcorrections.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.Dencorr.vcf \
   --output_mode EMIT_ALL_SITES


################# do breakpoint bp #####
HPbreakpoint.interval.list

#### uniquely mapped denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPbreakpoint.interval.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.raw.Denbkpt.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all denisova
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Denisova_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPbreakpoint.interval.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.Denbkpt.vcf \
   --output_mode EMIT_ALL_SITES


#### uniquely mapped Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPbreakpoint.interval.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.uniquemap.Nebkbt.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all Neanderthal
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/cnp04/sandbox/lboettger/reference/hg19.fa \
   -T UnifiedGenotyper \
   -I /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/Neanderthal_chr.bam \
   -L /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPbreakpoint.interval.list \
   -o /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_Nean_Den_fig/HPvarsnps.allreads.Nebkbt.vcf \
   --output_mode EMIT_ALL_SITES




############ make pastel spider gram
### last used command
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot.pdf

### pastel version
plot_spidergram_paper_Hpr_smalldots.py …. actually is in input file

#####changes
#90ee90 green stays…. to light blue
#ff0000 (red) to #bd9af5 (lavender)… to light lavender #dbc8f9… #9f6cf0 dark #7227e9 darker
#0000ff (royal blue) to #9ad2f5 (light blue)… to green #90ee90
#ffea00 (yellow) to orange-yellow (#f5dc9a)

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase_pastel.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot_pastel.pdf
### switch blue and green

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase_pastel2.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot_pastel2.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase_pastel3.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot_pastel3.pdf

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.delfixphased_rmmisphase_pastel4.phased Allpop_HP_20hkbdelfix_rmmisphase_smalldot_pastel4.pdf




############ vert group broad

ssh boettger@vert02.broadinstitute.org
use GridEngine8
path: /seq/vgb/linda

qsub -q vert -m bas



####### november 21, 2014, add HP2FS haplotype colors to ref panel ########
java -Xmx1000m -jar /humgen/cnp04/sandbox/lboettger/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/HP_Euroref_1kgOMNI_HM3_merged_SNPhapcolors.bgl nsamples=15 niterations=15 missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/out

The purple haplotype doesn’t impute very well
I’ll try moving the variants further away

####### Dec 2, 2014, add HP2FS haplotype colors to ref panel ########
java -Xmx1000m -jar /humgen/cnp04/sandbox/lboettger/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/HP_Euroref_1kgOMNI_HM3_merged_SNPhapcolorsLeft.bgl nsamples=15 niterations=15 missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/out


java -Xmx1000m -jar /humgen/cnp04/sandbox/lboettger/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/HP_Euroref_1kgOMNI_HM3_merged_SNPhapcolorsRight.bgl nsamples=15 niterations=15 missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/out

java -Xmx1000m -jar /humgen/cnp04/sandbox/lboettger/bin/beagle.jar unphased=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/HP_Euroref_1kgOMNI_HM3_merged_SNPhapcolorsMid.bgl nsamples=25 niterations=50 missing=0 out=/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_ref_panel/new_refpans_hapcol/out
 





############### December 8, 2014 convert beagle 3 to vcf #############

### make bed on reference file to get markers file
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink —-noweb --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map --make-bed —-noweb --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged


http://faculty.washington.edu/browning/beagle_utilities/utilities.html#beagle2vcf
java -jar beagle2vcf.jar [chrom] [markers] [bgl] [missing] > [vcf]

java -jar /Users/boettger/bin/beagle2vcf.jar 16 /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.markers /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_mergedC.bgl.phased 0 > /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/HM3_OMNI_Euroref.vcf 

##### phase multi allelic with beagle 4 ########## my version of java doesn’t work
java -jar /Users/boettger/bin/beagle3.3.2.jar unphased=/Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/multi_allelic_colors/HP_Euroref_OMNI_HM3_mult_allele.bgl nsamples=15 niterations=15 missing=0 out=/Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/multi_allelic_colors/out


### try better colored reference epanl
java -Xmx1000m -jar /Users/boettger/PhD_Laptop/bioapps/beagle.jar unphased=/Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colorednew.bgl nsamples=15 niterations=15 missing=0 out=/Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/out

#### converted file in R, now running imputation ######

##HP1A
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld HP2Bhap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2b_rs2000999 --noweb




#### Decmber 11 LD between rs2000999 and HP2FS-green

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld HP2FS_SNPhap_purple 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2FSgrn_rs2000999 --noweb

LD information for SNP pair [ HP2 72108093 ]

   R-sq = 0.140     D' = 0.959

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       AA          0.003            0.076
       BA          0.201            0.128
       AG          0.369            0.296
       BG          0.426            0.499

   In phase alleles are AG/BA




/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld HP2Bhap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2FSgrn_rs2000999 --noweb





LD information for SNP pair [ HP2FS_SNPhap_green 72108093 ]

   R-sq = 0.816     D' = 1.000

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       BA          0.173            0.035
       AA          0.031            0.169
       BG          0.000            0.138
       AG          0.796            0.658

   In phase alleles are BA/AG


LD information for SNP pair [ HP2FS_SNPhap_orange 72108093 ]

   R-sq = 0.083     D' = 1.000

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       BA          0.000            0.050
       AA          0.204            0.154
       BG          0.245            0.195
       AG          0.551            0.601

   In phase alleles are BG/AA

LD information for SNP pair [ HP2FS_SNPhap_purple 72108093 ]

   R-sq = 0.057     D' = 1.000

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       BA          0.000            0.037
       AA          0.204            0.167
       BG          0.181            0.144
       AG          0.615            0.652


72088964 - T allele is green
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld 72088964 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2FSgrn_rs2000999 --noweb

LD information for SNP pair [ 72088964 72108093 ]

   R-sq = 0.476     D' = 1.000

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       TA          0.204            0.072
       CA          0.000            0.133
       TG          0.146            0.279
       CG          0.650            0.517

   In phase alleles are TA/CG


######### NOT in LD with HP1F (green) allele
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld HP1Bhap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2FSgrn_rs2000999 --noweb

LD information for SNP pair [ HP1Bhap 72108093 ]

   R-sq = 0.043     D' = 1.000

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       BA          0.000            0.029
       AA          0.204            0.175
       BG          0.144            0.115
       AG          0.651            0.681

   In phase alleles are BG/AA


######### NOT in LD with HP1A (orange) allele
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_OMNI_HM3_HP2colornew.bgl.phased.map  --ld HP1Ahap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/new_colored/HP_Euroref_HP2FSgrn_rs2000999 --noweb

LD information for SNP pair [ HP1Ahap 72108093 ]

   R-sq = 0.060     D' = 0.891

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
       BA          0.005            0.047
       AA          0.199            0.158
       BG          0.223            0.181
       AG          0.573            0.614



######### january 2, 2015 convert axelson’s 6 wolf genotype data from plink to tped #####

#### filter wolf data ######

### exclude SNPs not typed in all 6 wolves, this excludes cur 27+
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --file /Users/boettger/postdoc/dog_behavior/GSD_Marcin/wolf.chip.6individuals/data --geno 0.1 --mind 0.1 --recode --transpose --out /Users/boettger/postdoc/dog_behavior/GSD_Marcin/wolf.chip.6individuals/data.clean --noweb --dog




######## get chimpanzee 1kg alleles #########

/Users/boettger/postdoc/gen_apps/vcftools_0.1.12b/vcftools --vcf /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.v3.20101123_HPreg_noindel.recode.vcf --chr 16 --from-bp 72080405 --to-bp 72103769 --recode --plink-tped --derived --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.v3.20101123_HPreg20kb_ancestral_allele

####### get chimpanzee 1kg alleles #########

/Users/boettger/postdoc/gen_apps/vcftools_0.1.12b/bin/vcftools --vcf /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.v3.20101123_HPreg_noindel.recode.vcf --derived --chr 16 --from-bp 72080405 --to-bp 72103769 --recode --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/popgen_measures/phase1.1kg.v3.20101123_HPreg20kb_ancestral_allele

--derived
For use with the previous four frequency and count options only. Re-orders the output file columns so that the ancestral allele appears first. This option relies on the ancestral allele being specified in the VCF file using the AA tag in the INFO field.





################# February 27, 2015 1000 Genomes human ancestral allele #########

human ancestor:
wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/analysis_results/supporting/ancestral_alignments/
neanderthal:
http://cdna.eva.mpg.de/neandertal/altai/AltaiNeandertal/bam/
cp /psych/genetics_data/working/giulio/b37/neandertal /seq/vgb/

denisova
http://cdna.eva.mpg.de/denisova/alignments/



########## March 18 17q LD to SNPS

#### for dup beta ######
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.map --r2 --ld-snp 17:44166202 --ld-window-r2 1 --ld-window 99999 --ld-window-kb 1000 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/LD/ld


#### for dup alpha ######
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.map --r2 --ld-snp 17:44166302 --ld-window-r2 0.9 --ld-window 99999 --ld-window-kb 1000 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/LD/ldtoalphadup



#### for dup alpha ######
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/ref/imputation_cnv_panel_1kg_NA.map --r2 --ld-snp 17:44166302 --ld-window-r2 0.5 --ld-window 99999 --ld-window-kb 1000 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/17q21/Sanger_imputation/LD/ld.5toalphadup







############## March 19, 2015 #############
downloading 1000 genomes data for balancing selection project
I will keep YRI population for analysis

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz


wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz


wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz

wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz.tbi
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20110521/ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz





################# march 23 2015 make new spider gram to fix colors and include missing individuals ###################

Allpop_spiderinput_1kg_20hkb.recolor.phased.delfixphased

python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.recolor.phased.delfixphased AAllpop_spiderinput_1kg_20hkb.recolor.phased.delfixphased.pdf


##### phasing fixed,now need to fix color scheme
python -u plot_spidergram_paper_Hpr_smalldots.py Allpop_spiderinput_1kg_20hkb.phased.mar23fixphased Allpop_spiderinput_1kg_20hkb.phased.mar23fixphased.pdf

HP2B #f0aa6c baige
 HP1F light blue #9ad2f5 to darker blue
HP2A lavander #dbc8f9
HP1S green #90ee90


python -u plot_spidergram_paper_Hpr_smalldots.py  Allpop_spiderinput_1kg_20hkb.phasedpastel.mar23fixphased Allpop_spiderinput_1kg_20hkb.phasedpastel.mar23fixphased.pdf

I need to darken the blue a bit

green to gray #8095a2

navy blue….?

#### new colors april 23rd
python -u plot_spidergram_paper_Hpr_smalldots.py  Allpop_spiderinput_1kg_20hkb.phasedpastel.ap23colfix.txt Allpop_spiderinput_1kg_20hkb.phasedpastel.ap23colfix.pdf


############## to give as 
Python-2.7
/humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_spidergram/dots
python -u plot_spidergram_paper_Hpr_smalldots.py  Allpop_spiderinput_1kg_20hkb.phasedpastel.ap23colfix.txt Allpop_spiderinput_1kg_20hkb.TEST.pdf


cp /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_spidergram/dots/plot_spidergram_paper_Hpr_smalldots.py /humgen/cnp04/sandbox/lboettger/spidergram_dots/spidergram_smalldots.py

cp /humgen/cnp04/sandbox/lboettger/Haptoglobin/HP_spidergram/dots/Allpop_spiderinput_1kg_20hkb.phasedpastel.ap23colfix.txt /humgen/cnp04/sandbox/lboettger/spidergram_dots/Allpop_1kg_20kb.phased.txt


################## to give to girl in daily lab
I haven’t used this recently and can’t guarantee it will work for newer versions of python. 

use Python-2.7

/humgen/cnp04/sandbox/lboettger/spidergram_dots/

python -u spidergram_smalldots.py Allpop_1kg_20kb.phased.txt Allpop_1kg_20kb_smalldots.pdf




File "plot_spidergram_paper_Hpr_smalldots.py", line 161
    print "xrange", xrange, int(haps[len(haps)-1][1]), int(haps[0][1])
                 ^



################### March 30 - get r2 above 0.75 with top selection signal ##################### 


##### edit 1kg files so that all cue calls are in same file
### keep CEU for each chromosome, then combine all chromosomes


### looks within 1Mb of top SNP and gets all SNPs with 0.7 r2 or greater
./vcftools --vcf input_data.vcf  --geno-r2 --ld-window-bp 1000000 --min-r2 0.70 --geno-r2-positions /Users/boettger/postdoc/pioneer/disease_input/European_TopSNPCoord.txt --out /Users/boettger/postdoc/pioneer/disease_input/European_LD_SNPs.txt
###
--keep <filename> #### I should make a file that lists the name of each individual in a population I want





############# concatenate CEU stuff #########
cd /seq/vgb/linda/bal_sel/human_1kg 
use VCFtools

#### the standard broad “use vcftools” didn’t let me write to gzip so I installed version 0.1.12 ###
/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr1.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr2.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr3.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr4.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr5.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr6.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr7.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr8.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr9.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr10.vcf.gz


/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr11.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr12.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr13.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr14.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr15.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr16.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr17.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr18.vcf.gz


/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr19.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr20.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr21.vcf.gz



/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU.chr22.vcf.gz


########### concatinate chromosomes############
/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcf-concat CEU.chr1.vcf.gz CEU.chr2.vcf.gz CEU.chr3.vcf.gz CEU.chr4.vcf.gz CEU.chr5.vcf.gz CEU.chr6.vcf.gz CEU.chr7.vcf.gz CEU.chr8.vcf.gz CEU.chr9.vcf.gz CEU.chr10.vcf.gz CEU.chr11.vcf.gz CEU.chr12.vcf.gz CEU.chr13.vcf.gz CEU.chr14.vcf.gz CEU.chr15.vcf.gz CEU.chr16.vcf.gz CEU.chr17.vcf.gz CEU.chr18.vcf.gz CEU.chr19.vcf.gz CEU.chr20.vcf.gz CEU.chr21.vcf.gz CEU.chr22.vcf.gz | gzip -c > /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz

vcf-concat A.vcf.gz B.vcf.gz C.vcf.gz | gzip -c > out.vcf.gz

this can be done through VCFtools


### small test case

### looks within 1Mb of top SNP and gets all SNPs with 0.7 r2 or greater
./vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz  --geno-r2 --ld-window-bp 1000000 --min-r2 0.70 --geno-r2-positions /Users/boettger/postdoc/pioneer/disease_input/European_TopSNPCoord.txt --out /Users/boettger/postdoc/pioneer/disease_input/European_LD_SNPs.txt


### on server
/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz --min-r2 0.70 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNPCoord.txt --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Eurotest
#### this takes a very long time



/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU.chr3.vcf.gz --geno-r2 --ld-window-bp 1000000 --min-r2 0.70 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNPCoordchr3.txt --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/test3


####### i think the --geno-r2 is doing everything on the chromosome, I don’t need this command. Also getting rid of distance parameter
/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU.chr3.vcf.gz --min-r2 0.70 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNPCoordchr3.txt --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/test3fix



/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz --min-r2 0.1 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNPCoord.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Eurotest.1


/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.9/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz --min-r2 0.1 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TestLD.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Eurotest.testLD

## example use from website http://sourceforge.net/p/vcftools/mailman/vcftools-help/?viewmonth=201410&viewday=30
vcftools --min-r2 0.5 --temp . --out v0.1.12b --geno-r2-positions small.bed --gzvcf small.vcf.gz



## new version--- this works!!!! 
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNPCoord.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Eurotest.7


##### info to match patches to chromosomes
ftp://ftp.ncbi.nlm.nih.gov/genbank/genomes/Eukaryotes/vertebrates_mammals/Homo_sapiens/GRCh37.p13/PATCHES/alt_scaffolds/alt_scaffold_placement.txt



######### run on all of my european SNPs #########---> this took 18 hours
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/CEU_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Linda_European_TopSNPCoord.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Linda_EU_LD


Linda_European_TopSNPCoord.bed


######################## redo using all european populations (EUR from 1kg) #####################

cd /seq/vgb/linda/bal_sel/human_1kg
bsub -Is -q interactive bash


#### the standard broad “use vcftools” didn’t let me write to gzip so I installed version 0.1.12 ###
/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr1.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr2.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr3.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr4.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr5.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr6.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr7.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr8.vcf.gz



/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr9.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr10.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr11.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr12.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr13.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr14.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr15.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr16.vcf.gz



/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr17.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr18.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr19.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr20.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr21.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/European_EUR.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR.chr22.vcf.gz




### assemble europeans

/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcf-concat EUR.chr1.vcf.gz EUR.chr2.vcf.gz EUR.chr3.vcf.gz EUR.chr4.vcf.gz EUR.chr5.vcf.gz EUR.chr6.vcf.gz EUR.chr7.vcf.gz EUR.chr8.vcf.gz EUR.chr9.vcf.gz EUR.chr10.vcf.gz EUR.chr11.vcf.gz EUR.chr12.vcf.gz EUR.chr13.vcf.gz EUR.chr14.vcf.gz EUR.chr15.vcf.gz EUR.chr16.vcf.gz EUR.chr17.vcf.gz EUR.chr18.vcf.gz EUR.chr19.vcf.gz EUR.chr20.vcf.gz EUR.chr21.vcf.gz EUR.chr22.vcf.gz | gzip -c > /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz



######################## All East Asian populations (EAS from 1kg) #####################

cd /seq/vgb/linda/bal_sel/human_1kg
bsub -Is -q interactive bash


#### the standard broad “use vcftools” didn’t let me write to gzip so I installed version 0.1.12 ###
/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr1.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr2.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr3.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr4.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr5.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr6.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr7.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr8.vcf.gz



/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr9.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr10.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr11.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr12.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr13.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr14.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr15.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr16.vcf.gz



/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr17.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr18.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr19.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr20.vcf.gz

/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr21.vcf.gz


/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/East_Asian_EAS.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS.chr22.vcf.gz

### assemble
/broad/software/free/Linux/redhat_5_x86_64/pkgs/vcftools/vcftools_0.1.12/bin/vcf-concat EAS.chr1.vcf.gz EAS.chr2.vcf.gz EAS.chr3.vcf.gz EAS.chr4.vcf.gz EAS.chr5.vcf.gz EAS.chr6.vcf.gz EAS.chr7.vcf.gz EAS.chr8.vcf.gz EAS.chr9.vcf.gz EAS.chr10.vcf.gz EAS.chr11.vcf.gz EAS.chr12.vcf.gz EAS.chr13.vcf.gz EAS.chr14.vcf.gz EAS.chr15.vcf.gz EAS.chr16.vcf.gz EAS.chr17.vcf.gz EAS.chr18.vcf.gz EAS.chr19.vcf.gz EAS.chr20.vcf.gz EAS.chr21.vcf.gz EAS.chr22.vcf.gz | gzip -c > /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz


######### combine EAS and EUR for Hyun Ji #############
use Tabix

# convert gzip to bgzip to unable tabix indexing
gunzip ${file}
bgzip ${file%%.gz}
# index with tabix
tabix -p vcf ${bundle}/${file}
/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcf-merge EAS_allcrhom.vcf.gz EUR_allcrhom.vcf.gz | bgzip -c > EAS_EUR_allchrom.vcf.gz


### try with bcftools ######
https://github.com/samtools/bcftools/releases/download/1.2/bcftools-1.2.tar.bz2

/broad/software/free/Linux/redhat_5_x86_64/pkgs/bcftools/bcftools_1.1/bin/bcftools merge EAS_allcrhom.vcf.gz EUR_allcrhom.vcf.gz -O z -o EAS_EUR_allchrom.vcf.gz




############### get LD SNPs for asians - April 19 2015
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Asian_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Asian_noHLA_LD


######### run on all of my european SNPs ########
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/European_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/European_noHLA_LD



############ vert group broad

ssh boettger@vert02.broadinstitute.org
use GridEngine8
path: /seq/vgb/linda

qstat to check status of a job



qsub -q vert -b y -m base -M boettger@broadinstitue.org -N lmb_vcftools_test /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/old_inputs/test_inputs/European_TopSNPCoord.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Eurotest.GE

### my Europeans
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N lmb_vcftools_test /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Linda_EUR_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Linda_EUR


###My Asians
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N lmb_vcftools_test /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Linda_ASN_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Linda_ASN


### HyunJi Europeans
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HyunJiEuro1 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/HyunJi_EUR1_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_EUR1

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HyunJiEur2 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/HyunJi_EUR2_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_EUR2

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HyunJiEur3 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/HyunJi_EUR3_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_EUR3

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HyunJiEur4 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/HyunJi_EUR4_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_EUR4

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HyunJiEur5 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/HyunJi_EUR5_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_EUR5




############### my European file, ordered — testing to see if ordering the bed file makes it faster ####
Linda_EUR_ordered_noHLA.bed

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N LB_EUordered /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Linda_EUR_ordered_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Linda_EURordered





### vikki Europeans (she had no clear asian populations, I removed a pop that is partially asian #####
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N VikkiEuro /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Vikki_EUR_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Vikki_EUR

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N VikkiAsFix /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Vikki_ASN_TopSNP_noHLA_fixed.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Vikki_ASN



### Kate Europeans 
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N KateEuro /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate_EUR_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Kate_EUR

###Kate Asians
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N KateAsian /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate_ASN_TopSNP_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Kate_ASN


########## trying to make stuff run faster LD 0.9 cutoff Genome-wide significant

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ1 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr1.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr1_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr1

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ2 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr2.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr2_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr2

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ3 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr3.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr3_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr3

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ6 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr6.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr6_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr6

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ7 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr7.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr7_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr7

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ10 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr10.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr10_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr10

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ11 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr11.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr11_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr11


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ12 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr12.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr12_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr12


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJ15 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR.chr15.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/chr15_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_chr15



qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJLO1 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/LO1_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_LO1


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJLO2 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/LO2_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_LO2

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N HJLO3 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/LO3_Hyunji_noHLA.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/HyunJi_LO3






qsub -q vert -b y -m base -M boettger@broadinstitute.org -N KGWS /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.9 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate_GWAsig.bed --out /seq/vgb/disease_selection/disease/top_SNP_lists/LD_SNPs/Kate_GWAsig






################################## April 28 2015 impute HP into bangledeshi population ##########################

### I need to edit the file so that the rsids are positions

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/boettger/postdoc/HP_Cholera/HP --recode --out /Users/boettger/postdoc/HP_Cholera/HP

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --map /Users/boettger/postdoc/HP_Cholera/HP_bpcoord.map.txt --ped /Users/boettger/postdoc/HP_Cholera/HP.ped --make-bed --out /Users/boettger/postdoc/HP_Cholera/BAN_bpcoord


/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/boettger/postdoc/HP_Cholera/BAN_bpcoord --bmerge /Users/boettger/postdoc/HP_Cholera/refpan/HP_Euroref_OMNI_HM3_merged.bed /Users/boettger/postdoc/HP_Cholera/refpan/HP_Euroref_OMNI_HM3_merged.bim /Users/boettger/postdoc/HP_Cholera/refpan/HP_Euroref_OMNI_HM3_merged.fam --make-bed --out /Users/boettger/postdoc/HP_Cholera/BAN_1kg_merged

#scan for strand problems
/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --noweb --bfile /Users/boettger/postdoc/HP_Cholera/BAN_1kg_merged --flip-scan --pheno /Users/boettger/postdoc/HP_Cholera/BAN_1kg_phen.txt --out /Users/boettger/postdoc/HP_Cholera/flipscan
###four SNPs look a little funny, but aren’t A/T or G/C SNPs. It’s likely due to different LD between the populations


### converted file in R, now running imputation ######

java -Xmx1000m -jar /Users/boettger/PhD_Laptop/bioapps/beagle.jar phased=/Users/boettger/postdoc/HP_Cholera/refpan/HP_Euroref_OMNI_HM3_merged.bgl.phased unphased=/Users/boettger/postdoc/HP_Cholera/BAN_sv.bgl niterations=20 nsamples=25 markers=/Users/boettger/postdoc/HP_Cholera/markers.txt missing=0 out=/Users/boettger/postdoc/HP_Cholera/imputed




####################### YRI pop from 1kg ##################### May 6 2015

#### the standard broad “use vcftools” didn’t let me write to gzip so I installed version 0.1.12 ###
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI1 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr1.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode --out -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr1.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI2 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr2.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr2.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI3 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr3.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr3.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI4 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr4.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr4.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI5 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr5.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr5.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI6 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr6.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr6.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI7 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr7.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr7.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI8 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr8.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr8.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI9 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr9.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr9.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI10 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr10.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr10.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI11 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr11.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr11.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI12 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr12.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr12.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI13 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr13.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr13.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI14 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr14.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr14.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI15 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr15.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr15.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI16 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr16.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr16.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI17 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr17.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr17.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI18 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr18.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr18.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI19 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr19.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr19.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI20 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr20.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr20.vcf.gz

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI21 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr21.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr21.vcf.gz


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N YRI22 /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf ALL.chr22.phase1_release_v3.20101123.snps_indels_svs.genotypes.vcf.gz --keep /seq/vgb/linda/bal_sel/Pop_indv_lists/YRI_indvs.txt --recode -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr22.vcf.gz



################ May 6th, balancing selection 
# information on balancing selection overlapping sites between species

Dataset A contains 83 genomic regions of interest. Dataset B contains 63 genomic regions of interest.

An overlap of Dataset A to Dataset B gives 36 genomic regions.

https://www.biostars.org/p/8480/
http://bedtools.readthedocs.org/en/latest/content/tools/fisher.html
http://bedtools.readthedocs.org/en/latest/content/tools/window.html “nearby” is detected



### on window size
The simulations of Nordborg and Innan (2003) indicate that the appropriate window size for detecting balancing selection with Tajima's D is determined by the ratio of the population-scaled mutation (θ) and recombination (ρ) rates. Too large a window will dilute the signal and too small a window will not include enough signal to reach statistical significance. At a θ/ρ of 10/1, which is similar to that estimated from our observed data using ClonalFrame v1.2 software (Didelot and Falush 2007) (per site: θ = 0.008, ρ = 0.0007), 200 bp windows are optimal and 100 bp windows are second best (Nordborg and Innan 2003). Our scan for balancing selection was carried out using 200 bp windows and repeated using 100 bp windows. The simulations of Nordborg and Innan (2003) did not use a gene conversion model of recombination as used here for bacteria, so the truly optimal window sizes for bacteria may be smaller than what we have used here (see Andolfatto and Nordborg 1998). 






#### may 7th, downloading pan map data
ftp://birch.well.ox.ac.uk/panMap/intersection_call_set/

### tajima’s D equation
http://ocw.mit.edu/courses/health-sciences-and-technology/hst-508-quantitative-genomics-fall-2005/study-materials/tajimad1.pdf


######## May 12, 2015 ######
get small section of 1kg data to test on tajD sliding window 
get allele frequency data

#### first only get SNPs ####
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/YRI.chr1.
vcf.gz --remove-indels --recode --recode-INFO-all -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr1.snps.vcf.gz

## get 2 Mb -- there are 88 individuals in this dataset. All individuals have calls at all positions
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/YRI.chr1.snps.vcf.gz --freq --chr 1 --from-bp 100 --to-bp 2000000 --out /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_2mb_chr1

# get chr1
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/YRI.chr1.snps.vcf.gz --freq --chr 1  --out /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr1

#### first only get SNPs ####
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/YRI.chr2.vcf.gz --remove-indels --recode --recode-INFO-all -c | gzip -c > /seq/vgb/disease_selection/pops_1kg/YRI.chr2.snps.vcf.gz

######### prep YRI vcd for TajD analysis ############

#### only get SNPs, output frequency ####
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/YRI.chr2.vcf.gz --remove-indels --freq --chr 2  --out /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2

### edit file for input
### fix header
var="CHROM \t POS \t N_ALLELES \t N_CHR \t P \t Q"
sed "1s/.*/$var/" /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2.frq > /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2_in.frq
## get rid of bp 
sed "s/\w://g" /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2_in.frq > /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2_input.frq
rm /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2_in.frq
rm /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2.frq


### on subnode, path for output file is indicated in script
use R-3.1
qsub -N chr1tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr1_input.frq YRI_chr1.tajd
qsub -N chr2tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr2_input.frq YRI_chr2.tajd
qsub -N chr4tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr4_input.frq YRI_chr4.tajd
qsub -N chr5tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr5_input.frq YRI_chr5.tajd
qsub -N chr6tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr6_input.frq YRI_chr6.tajd
qsub -N chr7tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr7_input.frq YRI_chr7.tajd
qsub -N chr8tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr8_input.frq YRI_chr8.tajd

qsub -N chr9tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr9_input.frq YRI_chr9.tajd

qsub -N chr10tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr10_input.frq YRI_chr10.tajd
qsub -N chr11tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr11_input.frq YRI_chr11.tajd
qsub -N chr12tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr12_input.frq YRI_chr12.tajd

qsub -N chr13tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr13_input.frq YRI_chr13.tajd
qsub -N chr14tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr14_input.frq YRI_chr14.tajd
qsub -N chr15tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr15_input.frq YRI_chr15.tajd


qsub -N chr16tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr16_input.frq YRI_chr16.tajd

qsub -N chr17tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr17_input.frq YRI_chr17.tajd

qsub -N chr18tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr18_input.frq YRI_chr18.tajd
qsub -N chr19tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr19_input.frq YRI_chr19.tajd
qsub -N chr20tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr20_input.frq YRI_chr20.tajd
qsub -N chr21tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr21_input.frq YRI_chr21.tajd
qsub -N chr22tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_chr22_input.frq YRI_chr22.tajd

######## Sliding window Taj D on each human chromosome #####
### this works on interactive node
R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL.R

qsub -V -b y -cwd hostname
qsub -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL.R


### on subnode
qsub -N rtest -V -b y -cwd R -f /seq/vgb/linda/bal_sel/human_1kg/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/human_1kg/allele_freq/YRI_2mb_chr1_input.frq chr1.test



####### rabbit data ##########


mv /seq/vgb/jeremy/temp/snps_with_allele_counts_Broad.out /seq/vgb/linda/bal_sel/rabbit



#get a diverse wild population (Population 20, “TO”) wild from iberia
awk '{print $1,$2,$43,$44}' /seq/vgb/linda/bal_sel/rabbit/snps_with_allele_counts_Broad.out > /seq/vgb/linda/bal_sel/rabbit/Pop20_allele_counts.txt

### separate chromosomes
grep 'chr1 ' /seq/vgb/linda/bal_sel/rabbit/Pop20_allele_counts.txt > /seq/vgb/linda/bal_sel/rabbit/Pop20_counts_chr1.txt

### need to subtract 1 from second column 
### I need to put it in bed format 
#Bed format is 0-based, half-open [start-1, end) extended BED data.
#For your example, a single-base variant at position 89017961 would map to 89017960-89017961, by default.
awk '{$2 = $2 - 1280449530}' file 

awk '{print $1,$2 - 1,$2}' /seq/vgb/linda/bal_sel/rabbit/Pop20_counts_chr1.txt > Pop20_rabbit_PolyPos_chr1.bed


### made freq files on my computer in R
use R-3.1

qsub -q vert -N chr10n2tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr10.frq rabbit_chr10.tajd

qsub -q vert -N chr1Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr1.frq rabbit_chr1.tajd

qsub -q vert -N chr2Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr2.frq rabbit_chr2.tajd

qsub -q vert -N chr3Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr3.frq rabbit_chr3.tajd

qsub -q vert -N chr4Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr4.frq rabbit_chr4.tajd

qsub -q vert -N chr5Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr5.frq rabbit_chr5.tajd

qsub -q vert -N chr6Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr6.frq rabbit_chr6.tajd

qsub -q vert -N chr7Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr7.frq rabbit_chr7.tajd

qsub -q vert -N chr8Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr8.frq rabbit_chr8.tajd

qsub -q vert -N chr9Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr9.frq rabbit_chr9.tajd

qsub -q vert -N chr11Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr11.frq rabbit_chr11.tajd



qsub -q vert -N chr12Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr12.frq rabbit_chr12.tajd

qsub -q vert -N chr13Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr13.frq rabbit_chr13.tajd

qsub -q vert -N chr14Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr14.frq rabbit_chr14.tajd

qsub -q vert -N chr15Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr15.frq rabbit_chr15.tajd

qsub -q vert -N chr16Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr16.frq rabbit_chr16.tajd

qsub -q vert -N chr17Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr17.frq rabbit_chr17.tajd

qsub -q vert -N chr18Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr18.frq rabbit_chr18.tajd

qsub -q vert -N chr19Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr19.frq rabbit_chr19.tajd

qsub -q vert -N chr20Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr20.frq rabbit_chr20.tajd

qsub -q vert -N chr21Rtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr21.frq rabbit_chr21.tajd


### ere-start slow
chr1Rtajd  boettger     r     06/02/2015 09:55:58 vert@vert04.broadinstitute.org     1        
2945265 0.50100 chr2Rtajd  boettger     r     06/02/2015 09:56:43 vert@vert04.broadinstitute.org     1        
2945266 0.50100 chr3Rtajd  boettger     r     06/02/2015 09:56:43 vert@vert04.broadinstitute.org     1        
2945270 0.50100 chr7Rtajd  boettger     r     06/02/2015 09:56:43 vert@vert04.broadinstitute.org     1        
2945271 0.50100 chr8Rtajd  boettger     r     06/02/2015 09:56:43 vert@vert04.broadinstitute.org     1        
2945272 0.50100 chr9Rtajd  boettger     r     06/02/2015 09:56:43 vert@vert04.broadinstitute.org     1        
2945278 0.50100 chr12Rtajd boettger     r     06/02/2015 09:59:28 vert@vert04.broadinstitute.org     1        
2945279 0.50100 chr13Rtajd boettger     r     06/02/2015 09:59:28 vert@vert04.broadinstitute.org     1        
2945280 0.50100 chr14Rtajd boettger     r     06/02/2015 09:59:28 vert@vert04.broadinstitute.org     1        
2945281 0.50100 chr15Rtajd 

qsub -N chr1RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr1.frq rabbit_chr1new.tajd

qsub -N chr2RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr2.frq rabbit_chr2new.tajd

qsub -N chr3RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr3.frq rabbit_chr3new.tajd

qsub -N chr7RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr7.frq rabbit_chr7new.tajd
qsub -N chr8RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr8.frq rabbit_chr8new.tajd
qsub -N chr9RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr9.frq rabbit_chr9new.tajd


qsub -N chr12RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr12.frq rabbit_chr12new.tajd

qsub -N chr13RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr13.frq rabbit_chr13new.tajd

qsub -N chr14RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr14.frq rabbit_chr14new.tajd

qsub -N chr15RNtajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chr15.frq rabbit_chr15new.tajd




————— will need to write loop to do all of them — there are around 3,000 chromosomes

### get rid of files with only the header (no SNPs)
wc -l *.frq | perl -ne '/^\s+1\s(\w+\.frq)/ && print "$1 "' | xargs rm



qsub -N chrUn***tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chrUn***.frq rabbit_chr***.tajd

for i in $(seq -f %02.0f 21 50); do
     for j in $( ls TajD_chrUn${i}**.frq ); do
          qsub -N ${j} -V -b y -cwd R -f \
               /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args \
               /seq/vgb/linda/bal_sel/rabbit/allele_freq/${j} rabbit_chr${j}.tajd
     done
done







###
qsub -q vert -N chrUn0158 -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chrUn0158.frq TajD_chrUn0158.tajd



qsub -N TajD_chrUn0158.frq -V -b y -cwd R -f /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_CL_vars_rabbit.R --args /seq/vgb/linda/bal_sel/rabbit/allele_freq/TajD_chrUn0158.frq TajD_chrUn0158.frq.tajd


######## leftover top orycun2 regions
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/top.oc2.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/oc2_top.05_tohg19.bed /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/oc2_top.05_tohg19_UNMAPPED.bed


/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/oc2_top.05_tohg19.bed /seq/vgb/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/hg19_top.05_bakctooc2.bed /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/hg19_top.05_bakctooc2_UNMAPPED.bed

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/hg19_top.05_bakctooc2.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/oc2_top.05_backtohg19_2.bed /seq/vgb/linda/bal_sel/rabbit/tajd_windows/top_reg_liftover/oc2_top.05_backtohg19_2_UNMAPPED.bed








#### get leftover
wget http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64.v287/liftOver
chmod +x liftOver


#### get orycun2 to hg19 ###
http://hgdownload-test.cse.ucsc.edu/goldenPath/oryCun2/liftOver/oryCun2ToHg19.over.chain.gz (orycun2 to hg19)

### get hg19 chain file to orycun2
http://hgdownload.cse.ucsc.edu/goldenPath/hg19/vsOryCun2/ 
## chain files for liftover 
http://hgdownload-test.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToOryCun2.over.chain.gz (human to orycun2) 


#### liftover instructions http://www.geneticlegacies.com/2012/01/basic-guide-to-ucsc-liftover-command.html
## example leftover command: liftOver oldFile map.chain newFile unMapped

### my rabbit to hg19 liftover chr1
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/Pop20_rabbit_PolyPos_chr1.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/rabbit_Pop20_chr1pos_to_hg19 /seq/vgb/linda/bal_sel/rabbit/rabbitchr1_to_hg19_unMapped

### my hg19 back to rabbit liftover, chr1 
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/rabbit_Pop20_chr1pos_to_hg19.bed /seq/vgb/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb/linda/bal_sel/rabbit/rabbit_chr1_hg19_bakcto_orycun2.bed /seq/vgb/linda/bal_sel/rabbit/rabbitchr1_backto_orycun2_unMapped.bed



#### take back to orycun2 and move back to hg19

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/rabbit_chr1_hg19_bakcto_orycun2.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/rabbit_chr1_orycun2_backto_hg19.bed /seq/vgb/linda/bal_sel/rabbit/rabbit_chr1_orycun2_bakcto_hg19_Unmapped_zero.bed
### this actually had 7.9kb of stuff in it



#### make whole genome input file for rabbit (whole genome ##
awk '{print $1,$2 - 1,$2}' /seq/vgb/linda/bal_sel/rabbit/Pop20_allele_counts.txt > /seq/vgb/linda/bal_sel/rabbit/Rabbit_PolyCoords_whole_genome.bed
#get rid of first line
tail -n +2 /seq/vgb/linda/bal_sel/rabbit/Rabbit_PolyCoords_whole_genome.bed > /seq/vgb/linda/bal_sel/rabbit/Rabbit_PolyCoords_whole_genomefixed.bed

### start leftover of whole genome (on screen 32428 tin)
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/Rabbit_PolyCoords_whole_genome.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/rabbit_genomePoly_to_hg19 /seq/vgb/linda/bal_sel/rabbit/rabbitGenomePoly_to_hg19_unMapped


#### lift over back to rabbit ###

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/rabbit_genomePoly_to_hg19 /seq/vgb/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb/linda/bal_sel/rabbit/hg19_genomePoly_backto_orycun2.bed /seq/vgb/linda/bal_sel/rabbit/hg19_genome_backto_orycun2_unMapped 


### still some unmapped, bring it back to hg19
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/rabbit/hg19_genomePoly_backto_orycun2.bed /seq/vgb/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb/linda/bal_sel/rabbit/liftedorycun2_backto_hg19.bed /seq/vgb/linda/bal_sel/rabbit/liftedorycun2_backto_hg19_UNMAPPED_ZERO 




### software is available here:
 /seq/vgb/software 

including liftOver package

####### Rabbit Liftover Strategy ####
1) lift over entire Rabbit genome to hg19
2) get rid of “chrUn\d+” (I don’t have YRI data from unmapped locations, so this sequence doesn’t help me)
3) map rabbit hg19 locations back to rabbit genome —> did all of them lift over? If not, I’ll need to figure out how to match new and old locations
4) they didn’t all lift over — do cuyn2 back to hg19 and confirm everything lifts over — this will be a complete set in both genomes


#### rabbit make tajd input file in orycun2  ######
grep /seq/vgb/linda/bal_sel/rabbit/Pop20_allele_counts.txt




#### get bed format for pantro2 positions
awk '{print $1,$2-1,$2}' /seq/vgb/linda/bal_sel/chimp/chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf > /seq/vgb/linda/bal_sel/chimp/panmap_positions_pantro2.bed.tmp

#get rid of first 38 lines (header
tail -n +39 /seq/vgb/linda/bal_sel/chimp/panmap_positions_pantro2.bed.tmp > /seq/vgb/linda/bal_sel/chimp/panmap_positions_pantro2.bed
### deleted original 
rm /seq/vgb/linda/bal_sel/chimp/panmap_positions_pantro2.bed.tmp


#### lift over to hg19 (should have done sliding window tajd first)
## we know all of these lifted over to hg18, but some regions may not lift to hg9

## get chain file 
wget http://hgdownload-test.cse.ucsc.edu/goldenPath/panTro2/liftOver/panTro2ToHg19.over.chain.gz
wget http://hgdownload-test.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToPanTro2.over.chain.gz
wget http://hgdownload-test.cse.ucsc.edu/goldenPath/mm9/liftOver/mm9ToPanTro2.over.chain.gz
wget http://hgdownload-test.cse.ucsc.edu/goldenPath/panTro2/liftOver/panTro2ToMm9.over.chain.gz

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/chimp/panmap_positions_pantro2.bed /seq/vgb/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb/linda/bal_sel/chimp/pantro2_to_hg19.bed /seq/vgb/linda/bal_sel/chimp/pantro2_to_hg19_Unmapped.bed

### lift hg19 back to pantro2
/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/chimp/pantro2_to_hg19.bed /seq/vgb/linda/bal_sel/chains/hg19ToPanTro2.over.chain /seq/vgb/linda/bal_sel/chimp/hg19_backto_pantro2.bed /seq/vgb/linda/bal_sel/chimp/hg19_backtoto_pantro2_Unmapped.bed


#### these are complete lift over files with the same number of lines (all map to both genome builds)
hg19_backto_pantro2.bed
pantro2_to_hg19.bed

### get vcd file for positions that lift over on both 
#### only get SNPs, output frequency ####
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --vcf /seq/vgb/linda/bal_sel/chimp/chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf --remove-indels --freq --positions /seq/vgb/linda/bal_sel/chimp/pt2_keep_pos.txt --out /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants

### edit file for input
### fix header
var="CHROM \t POS \t N_ALLELES \t N_CHR \t P \t Q"
sed "1s/.*/$var/" /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants.frq > /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants.tmp
## get rid of bp 
sed "s/\w://g" /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants.tmp > /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariantsfix.frq


rm /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants.tmp
rm /seq/vgb/linda/bal_sel/chimp/pt2_hg19liftovers_chimpvariants.frq

### made freq files in R on my computer that changed pantry positions to hg19 positions ####


### make input file on my computer
use R-3.1
qsub -q vert -N chr1tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr1.frq chimp_chr1.tajd

qsub -q vert -N chr2tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr2.frq chimp_chr2.tajd

qsub -q vert -N chr3tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr3.frq chimp_chr3.tajd

qsub -q vert -N chr4tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr4.frq chimp_chr4.tajd

qsub -q vert -N chr5tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr5.frq chimp_chr5.tajd

qsub -q vert -N chr6tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr6.frq chimp_chr6.tajd

qsub -q vert -N chr7tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr7.frq chimp_chr7.tajd


qsub -q vert -N chr22tajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/chimp_chr22.frq chimp_chr22.tajd



############# Running TajD before Liftover ##################
######### prep YRI vcd for TajD analysis ############

#### only get SNPs, output frequency ####
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --vcf /seq/vgb/linda/bal_sel/chimp/chimp_Dec8_rmdup_recal_BAQ_autosomes_filtered_hwe_AA_CpG_Rep_hg18_passed.trusted_liftover_in_Pt2_and_hg18.vcf --freq --chr chr1 --out /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1

### edit file for input
### fix header
var="CHROM \t POS \t N_ALLELES \t N_CHR \t P \t Q"
sed "1s/.*/$var/" /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1.frq > /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1in.frq
## get rid of bp 
sed "s/\w://g" /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1in.frq > /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr1_input.frq
rm /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1in.frq
rm /seq/vgb/linda/bal_sel/chimp/chimp_pantro2_chr1.frq


... done an all chimp chr

#### re-running tajD with pantro coords ###

qsub -N chr1chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr1_input.frq pantro2_chr1.tajd
qsub -N chr2achimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr2a_input.frq pantro2_chr2a.tajd
qsub -N chr2bchimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr2b_input.frq pantro2_chr2b.tajd


qsub -N chr3chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr3_input.frq pantro2_chr3.tajd
qsub -N chr4chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr4_input.frq pantro2_chr4.tajd
qsub -N chr5chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr5_input.frq pantro2_chr5.tajd



qsub -N chr6chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr6_input.frq pantro2_chr6.tajd
qsub -N chr7chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr7_input.frq pantro2_chr7.tajd
qsub -N chr8chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr8_input.frq pantro2_chr8.tajd
qsub -N chr9chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr9_input.frq pantro2_chr9.tajd
qsub -N chr10chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr10_input.frq pantro2_chr10.tajd
qsub -N chr11chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr11_input.frq pantro2_chr11.tajd

qsub -N chr12chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr12_input.frq pantro2_chr12.tajd

qsub -N chr13chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr13_input.frq pantro2_chr13.tajd

qsub -N chr14chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr14_input.frq pantro2_chr14.tajd

qsub -N chr15chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr15_input.frq pantro2_chr15.tajd

qsub -N chr16chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr16_input.frq pantro2_chr16.tajd

qsub -N chr17chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr17_input.frq pantro2_chr17.tajd

qsub -N chr18chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr18_input.frq pantro2_chr18.tajd

qsub -N chr19chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr19_input.frq pantro2_chr19.tajd

qsub -N chr20chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr20_input.frq pantro2_chr20.tajd

qsub -N chr21chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr21_input.frq pantro2_chr21.tajd

qsub -N chr22chimptajd -V -b y -cwd R -f /seq/vgb/linda/bal_sel/chimp/allele_freq/TajD_CL_vars_chimp.R --args /seq/vgb/linda/bal_sel/chimp/allele_freq/pantro2_chr22_input.frq pantro2_chr22.tajd




########## take top 5% of regions and lift over to hg19 ############

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tajd.bed.txt /seq/vgb/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tohg19.bed /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tohg19_Unmapped.bed



/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tohg19.bed /seq/vgb/linda/bal_sel/chains/hg19ToPanTro2.over.chain /seq/vgb/linda/bal_sel/chimp/tajd_windows/liftedhg19_top.05_backtopt2.bed /seq/vgb/linda/bal_sel/chimp/tajd_windows/liftedhg19_top.05_backtopt2UNMAPPED.bed



### back to hg19
liftedhg19_top.05_backtopt2.bed

/seq/vgb/linda/bin/liftOver /seq/vgb/linda/bal_sel/chimp/tajd_windows/liftedhg19_top.05_backtopt2.bed /seq/vgb/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tohg19_2nd.bed /seq/vgb/linda/bal_sel/chimp/tajd_windows/pt2_top.05_tohg19_2nd_Unmapped.bed

######### actually need all regions lifted over to do correct size coalescence simulations #####

/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tajd.bed /seq/vgb-HAL/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tohg19.bed /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tohg19_Unmapped.bed



/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tohg19.bed /seq/vgb-HAL/linda/bal_sel/chains/hg19ToPanTro2.over.chain /seq/vgb-HAL/linda/bal_sel/chimp/liftedhg19_all_backtopt2.bed /seq/vgb-HAL/linda/bal_sel/chimp/liftedhg19_all_backtopt2UNMAPPED.bed



### back to hg19
liftedhg19_all_backtopt2.bed

/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/chimp/liftedhg19_all_backtopt2.bed /seq/vgb-HAL/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tohg19_2nd.bed /seq/vgb-HAL/linda/bal_sel/chimp/pt2_all_tohg19_2nd_Unmapped.bed


/seq/vgb-HAL/linda/peromyscus



############ Disease-Selection Project, May 21, 2015 Go through GWAS hits, which ones already have LD blocks run with r^2 > 0.7 and p-val < 1x10-5
### some of Hyun Ji’s stuff was run with LD 0.9 and genome-wide significant cut-offs 
1) Get file with snps and LD blocks that I consider to be done
2) are hyun jii’s indels getting assigned rsids? maybe another dataset needs to be called
3) Which files were run with different cutoffs? Re-start these first — 
4) Which bp positions did we not find and rsid for? why? Look at one of kate’s files




############ May 25 2015 ############
### run final LD block code

### linda’s files
qsub -q vert -b y -m base -M boettger@broadinstitute.org -N T1DEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/T1D_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/T1D_EUR_LDblocks


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N SLEEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/SLE_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/SLE_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N RAEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/RA_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/RA_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N OsteoEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Osteoarthritis_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/Osteoarthritis_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N LuNeEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Lupus_Nephritis_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/LupusNephritis_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N JuArthEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Juvenile_Arthritis_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/Juvenile_Arthritis_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N IBDEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/IBD_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/IBD_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N CKDEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/CKD_EUR_GWAShits.bed.txt --out /seq/vgb/disease_selection/disease/LD_blocks/CKD_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N CeliacEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Celiac_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/Celiac_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N CeliacRAEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Celiac_and_RA_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/CeliacRA_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N ATdermEU /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/EUR/Atopic_Dermatitis_EUR_GWAShits.bed.txt --out /seq/vgb/disease_selection/disease/LD_blocks/ATderm_EUR_LDblocks

#### what’s ASN_EUR_GWAShits.bed ??????????


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N RA_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/ASN/RA_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/RA_ASN_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N IBD_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/ASN/IBD_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/IBD_ASN_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N Graves_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/ASN/Graves_disease_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/Graves_ASN_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N ATderm_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/ASN/Atopic_Dermatitis_ASN_GWAShits.bed.txt --out /seq/vgb/disease_selection/disease/LD_blocks/ATderm_ASN_LDblocks


### african left off for now


### running kate’s gwas hits

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N LSA_EUR /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/EUR/LSA_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/LSA_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N CRC_EUR /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/EUR/CRC_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/CRC_EUR_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N BRCA_EUR /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EUR_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/EUR/BRCA_EUR_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/BRCA_EUR_LDblocks


qsub -q vert -b y -m base -M boettger@broadinstitute.org -N LSA_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/ASN/LSA_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/LSA_ASN_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N CRC_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/ASN/CRC_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/CRC_ASN_LDblocks

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N BRCA_ASN /home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --gzvcf /seq/vgb/disease_selection/pops_1kg/EAS_allcrhom.vcf.gz --min-r2 0.7 --geno-r2-positions /seq/vgb/disease_selection/disease/top_SNP_lists/Kate/ASN/BRCA_ASN_GWAShits.bed --out /seq/vgb/disease_selection/disease/LD_blocks/BRCA_ASN_LDblocks



### moving my folder
#test
rsync -va /seq/vgb/linda/bal_sel/Pop_indv_lists/CEU_indvs.txt /seq/vgb-ce/linda

worked fine


rsync -va /seq/vgb/linda/bin /seq/vgb-ce/linda

rsync -va /seq/vgb/linda/bal_sel /seq/vgb-ce/linda

sent 172662469170 bytes  received 117058 bytes  13205046.55 bytes/sec
total size is 172641010428  speedup is 1.00



######## running coalescence simulations 

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdirms 5  2 -t 6.0 >ms.out


#ms nsam nreps -t theta
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t .001 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 1000000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout

“/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 10 1000 -t .001 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 1000000 2000 50
bash: /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms: Permission denied
bash-3.2$ “



######### include recombination

ms nsam nreps -t theta -r p nsites

p= 4Nr
r is the probability of cross-over per generation between the ends of the locus being simulated


ms 15 1000 -t 10.04 -r 100.0 2501In this case,  = 100, since the cross-over probability between the two ends ofthe locus is 10􀀀8(2501􀀀1) = 2:510􀀀5, and thus  = 41062:510􀀀5 = 100.(In addition we have assumed that the neutral mutation rate is 10􀀀9 per site toobtain .) Once again, although we obtained  by multiplying the number ofsites by the mutation rate per site, the program assumes an innite-sites modelin which no recurrent mutation occurs.


for each species find mutation rate, recombination rate, effective population size

nsam= number of copies of each locus per sample
nreps = number of independent samples

ms 10 3 (output 3 samples consisting of 10 chromosomes)


O. c. algirus
Ne ≈ 1,600,000
theta = 1
roh = 1.5 (figure out crossover according to length)
http://www.genetics.org/content/181/2/593/T2.expansion.html

### need to do complete liftover to determine how much sequence has clean lift from rabbit to human

### will output 10 samples consisting of 100 chromosomes (rabbit genome has many scaffolds ) —> need to calculate average length of chromosome 
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 100 10 -t 1 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 1000000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.rabbit



############################## chimpanzee coalescence simulation ###############

http://www.nature.com/nature/journal/v437/n7055/full/nature04072.html
The diversity in West African chimpanzees is similar to that seen for human populations32

http://mbe.oxfordjournals.org/content/22/2/297.full
 effective population size of P. paniscus, P. t. troglodytes, and P. t. verus to be 12,400, 20,100, and 13,000, respectively.
4*13,000*2.5x10-8 =  0.0013 (this is less than i used for humans, they are slightly more diverse so I should use the same estimate?)



http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.0020155#pbio-0020155-Fischer1
N̂e = 17,100 is an estimate of the effective population size of western chimpanzees (based on Fischer et al. 2004) Evidence for a complex demographic history of chimpanzees
4*17100*2x10-8 = .00137



recombination rate=2x10-8 per base pair

!!!! for theta !!! use 0.001 for humans and use 0.0013 for western chimpanzees

############################## human coalescence simulation ###############
A high-resolution recombination map of the human genome. -> 1x10-8 per bp per gen

recombination rate:
http://www.nature.com/ng/journal/v44/n6/full/ng.2283.html#supplementary-information
Across all windows we found the average recombination rate to be 1.285 cM/Mb
270,000,000
1,000,000*2700

a recombination rate of 7.5 x 10-4 per base pair (Nielsen et al. 2005)—— maybe use this one?

mutation rate reference:
http://www.genetics.org/content/156/1/297.short


http://www.nature.com/nature/journal/v409/n6822/full/409928a0.html
For the human genome, π was 7.51 × 10-4, or one SNP for every 1,331 bp surveyed in two chromosomes drawn from the NIH diversity panel.


4*10,000*2.5x10-8 =  0.0001 (should have been 0.001 not 0.0015

https://www.jstage.jst.go.jp/article/ggs/83/4/83_4_353/_html

r=recomb rate * length-1 = *1999
rho = 4Ner = 4*10,000*
avg cur length= 127091571
theta= 0.0015
120 individuals
22 chromosomes each

## run without recomb for now

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 22 120 -t 0.0015 > /seq/vgb-HAL/linda/bal_sel/coal_sim/msout.human
produces 120 individuals, only 1 with a segregating site?, 22 bases?

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 22 120 -t 0.0015 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 127091571 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human





# 2 is the number of copies of the locus in each sample (2 chromosomes)
# 120 is the number of independent samples to generate (120 individuals)
# theta is 0.0015


/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 2 120 -t 0.015 -r 1 1270 > /seq/vgb-HAL/linda/bal_sel/coal_sim/msout.human
produces 120 individuals, only 1 with a segregating site?, 22 bases?



##240 is the number of chromosomes contributing my current sample (120 YRI diploid) 
# do 1000 reps
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t .0015 -r 1 127091571 > /seq/vgb-HAL/linda/bal_sel/coal_sim/msout.human

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t .0015 -r 1 127091571 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 127091571 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human
scanms finished. 9 simulations processed…. WHY 9?

qsub -q vert -b y -m base -M boettger@broadinstitute.org -N coalh /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 190637 -r 1 127091571 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 127091571 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human

theta should be 4Neu, where u is the mutation rate for the entire locus, not for a bp
theta= .0015 * 127091571
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 190637 -r 1 127091571 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 127091571 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human


#### doing it enough to be genome-wide significant - no recombination (2,800,000) 
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 420 > /seq/vgb-HAL/linda/bal_sel/coal_sim/msout.human

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 4200 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2800000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human


######## human with recombination, without MHC #######
## MHC is 3.4 megabases
#MHC region of approximately 3.37 Mb (HG19: chr6: 29691116-33054976) 
### total genome is 2793000000
r=1x10-8*2793000*10000 = 279.3

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 4189 -r 279 2793000 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2793000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human.recombnoMHC

 -r 279

bsub -Is -q interactive bash


####### rabbit
assume theta = pi = 0.008 (as in rabbit paper and http://www.genetics.org/content/181/2/593.full
using theta = .008*74000 = 592 (lift over was 74000000 bases and I will run the simulation 1000 times)
10 individuals*2 chr = 20

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t 592 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 74000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.rabbit

####### re-doing rabbit (excluding MHC and chrx which is not in 1kg
72469840 bases in length lift over

usin length of 72470 and running 1000 times

/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t 580 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 72470 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.rabbit.noXMHC

### add in recombination
Ne=1.6x10^6 16000,000
1x10^-8 prob crossover between adjacent bp 100,000,000
1x10^-8 * length of region * Ne
1x10^-8*72470*1.6x10^6 = 1160

#### run this again after adjusting length for regions that were left off the first run
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t 580 -r 1160 72470 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 72470 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.rabbit.recombnoXMHC









######## july 6th 2015, move actively used stuff to HAL

rsync -va /seq/vgb-ce/linda/bal_sel/chains /seq/vgb-HAL/linda/bal_sel

rsync -va /seq/vgb-ce/linda/bin /seq/vgb-HAL/linda


                        ##### lift over each tajd region########
### start leftover of all tajd windows
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/all.oc2.bed /seq/vgb-HAL/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/rabbit_genomePoly_to_hg19 /seq/vgb-HAL/linda/bal_sel/rabbit/rabbitGenomePoly_to_hg19_unMapped


#### lift over back to rabbit ###

/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/rabbit_genomePoly_to_hg19 /seq/vgb-HAL/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_genomePoly_backto_orycun2.bed /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_genome_backto_orycun2_unMapped 


### still some unmapped, bring it back to hg19
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_genomePoly_backto_orycun2.bed /seq/vgb-HAL/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/liftedorycun2_backto_hg19.bed /seq/vgb-HAL/linda/bal_sel/rabbit/liftedorycun2_backto_hg19_UNMAPPED_ZERO 





### start leftover of all tajd windows (filter 200)###############################
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/all200filter.oc2.bed /seq/vgb-HAL/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/all200filter.oc2_to_hg19 /seq/vgb-HAL/linda/bal_sel/rabbit/all200filter.oc2_to_hg19_unMapped


#### lift over back to rabbit ###

/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/all200filter.oc2_to_hg19 /seq/vgb-HAL/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_all200filter.oc2_backto_orycun2.bed /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_all200filter.oc2_backto_orycun2_unMapped 


### still some unmapped, bring it back to hg19
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/rabbit/hg19_all200filter.oc2_backto_orycun2.bed /seq/vgb-HAL/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/rabbit/lifted_all200filter.oc2_backto_hg19.bed /seq/vgb-HAL/linda/bal_sel/rabbit/lifted_all200filteroc2_backto_hg19_UNMAPPED_ZERO 


####################### HUMAN WINDOWS TO CHIMP AND BACK #########################
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/human/YRI_forchimp.bed /seq/vgb-HAL/linda/bal_sel/chains/hg19ToPanTro2.over.chain /seq/vgb-HAL/linda/bal_sel/human/YRI_topt2.bed /seq/vgb-HAL/linda/bal_sel/human/YRI_topt2UNMAPPED.bed


/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/human/YRI_topt2.bed /seq/vgb-HAL/linda/bal_sel/chains/panTro2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/human/YRIpt2_bakctohg19.bed /seq/vgb-HAL/linda/bal_sel/human/YRIpt2_bakctohg19UNMAPPED.bed






####################### HUMAN WINDOWS TO rabbit AND BACK #########################
/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/human/YRI_forrabbit.bed /seq/vgb-HAL/linda/bal_sel/chains/hg19ToOryCun2.over.chain /seq/vgb-HAL/linda/bal_sel/human/YRI_to_orycun2.bed /seq/vgb-HAL/linda/bal_sel/human/YRI_to_orycun2UNMAPPED.bed 

/seq/vgb-HAL/linda/bin/liftOver /seq/vgb-HAL/linda/bal_sel/human/YRI_to_orycun2.bed /seq/vgb-HAL/linda/bal_sel/chains/oryCun2ToHg19.over.chain /seq/vgb-HAL/linda/bal_sel/human/YRIoc2_backto_hg19.bed /seq/vgb-HAL/linda/bal_sel/human/YRIoc2_backto_hg19UNMAPPED.bed 





######################### pop gen stats for coal sim ###############

recombination for all###
1x10-8 per bp
“A high-resolution recombination map of the human genome”. -> 1x10-8 per bp per gen

##################human###############
theta=4*10,000*2.5x10-8 = 0.001
0.001*2793000=2793 =  theta for our length

## MHC is 3.4 megabases
#MHC region of approximately 3.37 Mb (HG19: chr6: 29691116-33054976) 
### total genome is 2793000000 (I will run 2793000 1000 times)
r=1x10-8*2,792,999*10000*4 = 1117

#### running on submode of nickel 
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 2793 -r 1117 2793000 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2793000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.human.recombnoMHC

—> human looks strange I’ll need to check it (way higher than chimp even though similar parameters)



#################### July 14 2015 ##########
########## I realized I should have found significance for human-chimp leftover sequence and human-rabbit leftover sequence (what I’m not able to use shouldn’t be counted)
## both running on nickel 
###### for human-chimp comparison (chimp length = 2,339,226,399)
mytheta = 0.001*2339226 = 2339
my rho = 1x10-8*2339225*10000*4 = 936
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 2339 -r 936 2339226 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2339226 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.humanforchimp.recombnoXnoMHC

### for human-rabbit comparison (rabbit length = 72,482,895)
my theta = 0.001*72483 = 72
my rho = 1x10^-8*72482*10000*4 = 29
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 72 -r 29 72483 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 72483 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.humanforrabbit.recombnoXMHC


#### 7.5x10-4 = recombination rate (as in Nielson Williamson et al 2005)
### also made nsam = 120
my rho for chimp comp = 7.5x10-4*2339225*10000*4=70176750
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 120 1000 -t 2339 -r 70176750 2339226 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2339226 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.humanforchimprho4.recombnoXnoMHC

my rho for rabbit comp = 7.5x10-4*72482*10000*4=2174460
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 120 1000 -t 72 -r 2174460 72483 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 72483 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.humanforrabbitrho4.recombnoXMHC



### this is outputting 1000 samples consisting of 240 chromosomes
################## chimp ###############

## total length lifted over, no X, no MHC = 2,339,226,399
http://mbe.oxfordjournals.org/content/22/2/297.full
 effective population size of P. paniscus, P. t. troglodytes, and P. t. verus to be 12,400, 20,100, and 13,000, respectively.
4*13,000*2.5x10-8 =  0.0013

I will use length 2,339,226 and run 1000 times

mytheta = 0.0013*2339226=3041

my rho = 1x10-8*2339225*13000*4 = 1216


### running logged into tin
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t 3041 -r 1216 2339226 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2339226 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.chimp.recombnoXnoMHC

for now, use chimp results for human and chimp

##################rabbit ###############RUN WHEN WE DETERMINE TOTAL LENGTH FROM LIFT OVER !!!!!!!!!
assume theta = pi = 0.008 (as in rabbit paper and http://www.genetics.org/content/181/2/593.full
Ne = 1,600,000 http://www.genetics.org/content/181/2/593.full

my theta = 0.008*72483 = 580

## length of rabbit sequence lifted over
72,482,895

using length of 72483 and running 1000 times

### add in recombination
Ne=1.6x10^6
1x10^-8 prob crossover between adjacent bp 100,000,000
1x10^-8 * length of region * Ne *4
1x10^-8*72482*1600000*4 = 4639

#### run this again after adjusting length for regions that were left off the first run
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 20 1000 -t 580 -r 4639 72483 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 72483 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout.rabbit.recombnoXMHC









### October 5, 2015 LD between rs2000999 and HP structural allele for reviewer #3

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map  --ld HP1Ahap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_HP1S_rs2000999 --noweb


/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map  --ld HP1Bhap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_HP1F_rs2000999 --noweb

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map  --ld HP2Ahap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_HP2FS_rs2000999 --noweb

/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map  --ld HP2Bhap 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_HP2SS_rs2000999 --noweb


/Users/boettger/PhD_Laptop/bioapps/plink-1.07-mac-intel/plink --ped /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.ped --map /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_OMNI_HM3_merged.map  --ld HP2 72108093 --out /Users/boettger/PhD_Laptop/McCarroll_Projects/Haptoglobin_new/HM3_OMNI_merge/finished_ref/bestref/for_Rany/HP_Euroref_HP2_rs2000999 --noweb



########### October 16 2015 ########
# looking at code for paper “calculation of Tajima’s D and other neutrality test statistics from low depth next-generation sequencing data” 

used to be : 
copper, nickel or tin
screen
use LSF
bsub -Is -q interactive bash

now is: 
gold, silver, or platinum
use UGER
ish 

## to install
http://www.popgen.dk/angsd/index.php/Download_and_installation

## setup test data
use Samtools then followed all directions here:
http://www.popgen.dk/angsd/index.php/Quick_Start

### calculate tajd
http://www.popgen.dk/angsd/index.php/Tajima#Step_3a:_Estimate_Tajimas_D_and_other_statistics
#### my test of tajd calc ###
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb/linda/bal_sel/angsd_test/bam.filelist2 -doSaf 1 -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -P 24 -out /seq/vgb/linda/bal_sel/angsd_test/out


/seq/vgb/linda/bin/angsd/misc/realSFS /seq/vgb/linda/bal_sel/angsd_test/out.saf.idx -P 24 > /seq/vgb/linda/bal_sel/angsd_test/out.sfs


/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb/linda/bal_sel/angsd_test/bam.filelist2 -out /seq/vgb/linda/bal_sel/angsd_test/out -doThetas 1 -doSaf 1 -pest /seq/vgb/linda/bal_sel/angsd_test/out.sfs -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2

/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed /seq/vgb/linda/bal_sel/angsd_test/out.thetas.gz

#Estimate for every Chromosome/scaffold
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb/linda/bal_sel/angsd_test/out.thetas.gz -nChr 20

#Do a sliding window analysis based on the output from the make_bed command.
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb/linda/bal_sel/angsd_test/out.thetas.gz -nChr 20 -win 50000 -step 10000  -outnames /seq/vgb/linda/bal_sel/angsd_test/theta.thetasWindow.gz

 dumping file /seq/vgb/linda/bal_sel/angsd_test $ more theta.thetasWindow.gz.pestPG
#(indexStart,indexStop)(firstPos_withData,lastPos_withData)(WinStart,WinStop)   Chr     WinCenter       tW      tP      tF      tH      tL      Tajima  fuf     fud     fayh    zeng    nSites
(9133,58955)(14010000,14060000)(14010000,14060000)      1       14035000        25.485972       23.950299       29.896086       26.582609       25.266453       -0.246997       -0.404805       -0.372248
        -0.101989       -0.009276       49822
(19114,68941)(14020000,14070000)(14020000,14070000)     1       14045000        23.466303       21.712690       28.286844       25.049892       23.381290       -0.305715       -0.483922       -0.439634
        -0.140299       -0.003895       49827
(29010,78719)(14030000,14080000)(14030000,14080000)     1       14055000        23.791340       20.718840       31.636690       21.228281       20.973560       -0.528505       -0.793294       -0.706347
        -0.021128       -0.127372       49709
(38987,88696)(14040000,14090000)(14040000,14090000)     1       14065000        22.609421       18.634813       32.432160       17.618884       18.126848       -0.718486       -1.051855       -0.927509
        0.044310        -0.212984       49709
(48976,98234)(14050000,14100000)(14050000,14100000)     1       14075000        22.894217       19.209065       32.700690       20.148047       19.678557       -0.658088       -1.016494       -0.915217
        -0.040450       -0.150929       49258
(90,49887)(14000000,14050000)(14000000,14050000)        2       14025000        48.318188       47.776719       49.281462       57.014251       52.395485       -0.046450       -0.055432       -0.044164
        -0.189745       0.091737        49797
(10040,59595)(14010000,14060000)(14010000,14060000)     2       14035000        55.145621       54.531865       54.363145       76.928963       65.730415       -0.046204       0.005466        0.031566-0.403379        0.208942        49555


##### arguments 
-start is a file containing a log scaled estimate of the SFS that can be used as the start point for the EM optimisation. —> don’t think I need this
-tole When the difference in successive likelihood values in the EM algorithm gets below this value the optimisation will stop
-P number of threads to allocate to program
-nSites Limit the optimisation to a region of this size. If nothing is supplied the program will use the entire saf file
-maxIter maximum number of iterations in the EM algorithm
You can also specify a region to use for estimating the SFS
-nChr — the number of chromosomes in the sample (10 people = 20 chromosomes)
-GL If your input is sequencing file you can estimate genotype likelhoods from the mapped reads. Four different methods are available.
1. SAMtools model
2. GATK model
3. SOAPsnp model
4. SYK model


########### Tajima’s D is not affected by the ancestral state, so I should be able to run everything with a folded SFS and get the same result ############# I used the chimphg19 for simplicity but shouldn’t matter
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb/linda/bal_sel/angsd_test/bam.filelist2 -doSaf 1 -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -P 24 -out /seq/vgb/linda/bal_sel/angsd_test/outFold -fold 1

#ML estimate of SFS
/seq/vgb/linda/bin/angsd/misc/realSFS /seq/vgb/linda/bal_sel/angsd_test/outFold.saf.idx -P 24 > /seq/vgb/linda/bal_sel/angsd_test/outFold.sfs

#calculate thetas
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb/linda/bal_sel/angsd_test/bam.filelist2  -out /seq/vgb/linda/bal_sel/angsd_test/outFold -doThetas 1 -doSaf 1 -pest /seq/vgb/linda/bal_sel/angsd_test/outFold.sfs -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -fold 1

### make binary version
/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed /seq/vgb/linda/bal_sel/angsd_test/outFold.thetas.gz

#Do a sliding window analysis based on the output from the make_bed command on the folded SFS.
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb/linda/bal_sel/angsd_test/outFold.thetas.gz -nChr 20 -win 50000 -step 10000  -outnames /seq/vgb/linda/bal_sel/angsd_test/thetaFold.thetasWindow.gz
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb/linda/bal_sel/angsd_test/outFold.thetas.gz -nChr 10 -win 50000 -step 10000  -outnames /seq/vgb/linda/bal_sel/angsd_test/thetaFold10.thetasWindow.gz


If you don't have the ancestral state, you can instead estimate the folded SFS. This is done by supplying the -anc with the reference genome and also supply -fold 1. Then you should remember to change the second parameter to the realSFS function as the number of individuals instead of the number of chromosomes.



################# getting YRI Phase I 
ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/
ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19113/alignment/








############ October 22, 2015, move unused files to /seq/vgb to make room for 1kg bam files ###########

rsync -va /seq/vgb-ce/linda/bal_sel/chains /seq/vgb-HAL/linda/bal_sel

####these files were first Tajd then lifted over
rsync -va /seq/vgb-HAL/linda/bal_sel/chimp /seq/vgb/linda/bal_sel/chimp/grant_liftover

rm -rf chimp

rsync -va /seq/vgb-HAL/linda/bal_sel/human /seq/vgb/linda/bal_sel/human_1kg/grant_liftover

rsync -va /seq/vgb-HAL/linda/bal_sel/rabbit /seq/vgb/linda/bal_sel/rabbit/grant_liftover

rsync -va /seq/vgb-HAL/linda/bal_sel/coal_sim /seq/vgb/linda/bal_sel/

### move back to use
rsync -va /seq/vgb/linda/bal_sel/coal_sim /seq/vgb-HAL/linda/bal_sel 


######## does binary code need to be on a high performance node? I don’t think so ######

#### get 1st individual
wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18486/alignment/NA18486.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam
…. eta is 7 hours…!!!
### should index with the alignment I have to confirm chr names the same etc. 

### will need to do each chromosome separately 

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18486/alignment/NA18486.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 23 > NA18486_chr23.bam
region "23" specifies an unknown reference name. Continue anyway.

use example

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18486/alignment/NA18486.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 17:7512445-7513455 > NA18486_test.bam
worked



samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18486/alignment/NA18486.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18486_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18487/alignment/NA18487.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18487_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18489/alignment/NA18489.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18489_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18498/alignment/NA18498.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18498_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18499/alignment/NA18499.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18499_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18501/alignment/NA18501.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18501_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18502/alignment/NA18502.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18502_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18504/alignment/NA18504.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18504_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18505/alignment/NA18505.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18505_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18507/alignment/NA18507.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18507_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18508/alignment/NA18508.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18508_chr22.bam




################# run through angsd #################
## made bamfile list
YRIfirst10_bam.filelist.txt



### generate saf file
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb-HAL/linda/bal_sel/YRI_bams/YRIfirst10_bam.filelist.txt -doSaf 1 -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -P 24 -out /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold -fold 1

#ML estimate of SFS
/seq/vgb/linda/bin/angsd/misc/realSFS /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.saf.idx -P 24 > /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.sfs


#calculate thetas
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb-HAL/linda/bal_sel/YRI_bams/YRIfirst10_bam.filelist.txt  -out /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold -doThetas 1 -doSaf 1 -pest /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.sfs -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -fold 1

### make binary version
/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.thetas.gz

#Do a sliding window analysis based on the output from the make_bed command on the folded SFS. 2kb window with 100 bp step size
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.thetas.gz -nChr 20 -win 2000 -step 100  -outnames /seq/vgb-HAL/linda/bal_sel/YRI_out/first10outFold.thetasWindow.gz


######## get rest of YRI chr22 #######
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18508/alignment/NA18508.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18508_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18510/alignment/NA18510.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18510_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18511/alignment/NA18511.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18511_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18516/alignment/NA18516.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18516_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18517/alignment/NA18517.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18517_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18519/alignment/NA18519.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18519_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18520/alignment/NA18520.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18520_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18522/alignment/NA18522.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18522_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18523/alignment/NA18523.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18523_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18853/alignment/NA18853.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18853_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18856/alignment/NA18856.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18856_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18858/alignment/NA18858.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18858_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18861/alignment/NA18861.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18861_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18867/alignment/NA18867.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18867_chr22.bam
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18868/alignment/NA18868.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18868_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18870/alignment/NA18870.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18870_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18871/alignment/NA18871.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18871_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18873/alignment/NA18873.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18873_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18874/alignment/NA18874.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18874_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18907/alignment/NA18907.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18907_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18908/alignment/NA18908.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18908_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18909/alignment/NA18909.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18909_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18910/alignment/NA18910.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18910_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18912/alignment/NA18912.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18912_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18916/alignment/NA18916.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18916_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18917/alignment/NA18917.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18917_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18923/alignment/NA18923.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18923_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18924/alignment/NA18924.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18924_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18933/alignment/NA18933.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18933_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18934/alignment/NA18934.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA18934_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19092/alignment/NA19092.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19092_chr22.bam …X just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19093/alignment/NA19093.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19093_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19095/alignment/NA19095.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19095_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19096/alignment/NA19096.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19096_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19098/alignment/NA19098.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19098_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19099/alignment/NA19099.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19099_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19102/alignment/NA19102.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19102_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19107/alignment/NA19107.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19107_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19108/alignment/NA19108.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19108_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19113/alignment/NA19113.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19113_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19114/alignment/NA19114.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19114_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19116/alignment/NA19116.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19116_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19117/alignment/NA19117.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19117_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19118/alignment/NA19118.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19118_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19119/alignment/NA19119.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19119_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19121/alignment/NA19121.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19121_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19130/alignment/NA19130.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19130_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19131/alignment/NA19131.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19131_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19137/alignment/NA19137.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19137_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19138/alignment/NA19138.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19138_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19141/alignment/NA19141.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19141_chr22.bam …X just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19143/alignment/NA19143.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19143_chr22.bam…X just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19144/alignment/NA19144.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19144_chr22.bam …X just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19146/alignment/NA19146.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19146_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19147/alignment/NA19147.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19147_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19149/alignment/NA19149.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19149_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19150/alignment/NA19150.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19150_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19152/alignment/NA19152.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19152_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19153/alignment/NA19153.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19153_chr22.bam   ….X just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19159/alignment/NA19159.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19159_chr22.bam … just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19160/alignment/NA19160.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19160_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19171/alignment/NA19171.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19171_chr22.bam





pasted in bulk:
samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19172/alignment/NA19172.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19172_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19175/alignment/NA19175.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19175_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19184/alignment/NA19184.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19184_chr22.bam… just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19185/alignment/NA19185.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19185_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19189/alignment/NA19189.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19189_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19190/alignment/NA19190.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19190_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19197/alignment/NA19197.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19197_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19198/alignment/NA19198.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19198_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19200/alignment/NA19200.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19200_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19201/alignment/NA19201.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19201_chr22.bam … just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19204/alignment/NA19204.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19204_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19206/alignment/NA19206.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19206_chr22.bam … just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19207/alignment/NA19207.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19207_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19209/alignment/NA19209.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19209_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19210/alignment/NA19210.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19210_chr22.bam… just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19213/alignment/NA19213.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19213_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19214/alignment/NA19214.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19214_chr22.bam… just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19222/alignment/NA19222.mapped.SOLID.bfast.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19222_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19223/alignment/NA19223.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19223_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19225/alignment/NA19225.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19225_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19235/alignment/NA19235.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19235_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19236/alignment/NA19236.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19236_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19238/alignment/NA19238.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19238_chr22.bam…. just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19239/alignment/NA19239.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19239_chr22.bam… just exome

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19247/alignment/NA19247.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19247_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19248/alignment/NA19248.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19248_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19256/alignment/NA19256.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19256_chr22.bam

samtools view -h ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA19257/alignment/NA19257.mapped.ILLUMINA.bwa.YRI.low_coverage.20101123.bam 22 > /seq/vgb-HAL/linda/bal_sel/YRI_bams/NA19257_chr22.bam


/seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/


################# run through angsd #################
## made bamfile list
YRIrentschr22_bam.filelist


### generate saf file GATK genotype likelihoods
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb-HAL/linda/bal_sel/YRI_bams/YRIrentschr22_bam.filelist -doSaf 1 -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -P 24 -out /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold -fold 1

“
npools:116 unfreed tnodes before clean:0 
        -> Done reading data waiting for calculations to finish
        -> Done waiting for threads
        -> Output filenames:
                ->"/seq/vgb-HAL/linda/bal_sel/YRI_out/YRIrentschr22outFold.arg"
                ->"/seq/vgb-HAL/linda/bal_sel/YRI_out/YRIrentschr22outFold.saf.gz"
                ->"/seq/vgb-HAL/linda/bal_sel/YRI_out/YRIrentschr22outFold.saf.pos.gz"
                ->"/seq/vgb-HAL/linda/bal_sel/YRI_out/YRIrentschr22outFold.saf.idx"
        -> Tue Oct 27 16:24:59 2015
        -> Arguments and parameters for all analysis are located in .arg file
        [ALL done] cpu-time used =  20392.79 sec
        [ALL done] walltime used =  2296.00 sec
20190.219u 202.665s 38:16.36 888.0%     0+0k 210731640+19475336io 62729pf+0w
“



#ML estimate of SFS
/seq/vgb/linda/bin/angsd/misc/realSFS //seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.saf.idx -P 24 > /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.sfs


#calculate thetas
/seq/vgb/linda/bin/angsd/angsd -bam /seq/vgb-HAL/linda/bal_sel/YRI_bams/YRIrentschr22_bam.filelist  -out /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold -doThetas 1 -doSaf 1 -pest /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.sfs -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa -GL 2 -fold 1

### make binary version  — on this one!!!!!!!
/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.thetas.gz

#Do a sliding window analysis based on the output from the make_bed command on the folded SFS. 2kb window with 50 bp step size
/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.thetas.gz -nChr 174 -win 2000 -step 50  -outnames /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr22/YRIrentschr22outFold.thetasWindow.gz




/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr21/YRIrentschr21outFold.thetas.gz

/seq/vgb/linda/bin/angsd/misc/thetaStat do_stat /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr21/YRIrentsoutFold_21.thetas.gz -nChr 174 -win 2000 -step 50  -outnames /seq/vgb-HAL/linda/bal_sel/YRI_out/YRI_out_chr21/YRIrentschr21outFold.thetasWindow.gz



### disk usage of folder disk space 
du -hcs vgb-HAL
df -h also shows how much is left (remaining available disk space)

df -h /wga/scr4/vgbgrp

ssh boettger@vert02.broadinstitute.org

df -h vgb-HAL


######## RUN TAJD WINDOWS FROM GENOTYPE LIKELIHOODS ############

##### test scripts on interactive node #####

sh angsd_bychr.sh 5 #works fine

sh testdir.sh 5 #works fine


#### test on subnode ####

maximum likelihood approach for generating a better estimate of the SFS,
requires genotype probabilities — using original bam files


use GridEngine8

#### run qsub test on shell script that just makes a new directory
qsub -S /bin/bash -v chr=5 -q vert -M boettger@broadinstitute.org -N dirthingworks /seq/vgb-HAL/linda/bal_sel/testdir.sh

##run chr 21
qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org -N chr21tajd /seq/vgb-HAL/linda/bal_sel/angsd_bychr.sh

### run with script that loops through individuals
qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org -N chr21tajd /seq/vgb-HAL/linda/bal_sel/angsd_bychr_dbg.sh


####### run on node with more disk space
qsub -S /bin/bash -v chr=20 -q vert -M boettger@broadinstitute.org -N chr20tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh


qsub -S /bin/bash -v chr=19 -q vert -M boettger@broadinstitute.org -N chr19tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=18 -q vert -M boettger@broadinstitute.org -N chr18tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=17 -q vert -M boettger@broadinstitute.org -N chr17tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=16 -q vert -M boettger@broadinstitute.org -N chr16tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=15 -q vert -M boettger@broadinstitute.org -N chr15tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=14 -q vert -M boettger@broadinstitute.org -N chr14tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=13 -q vert -M boettger@broadinstitute.org -N chr13tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=12 -q vert -M boettger@broadinstitute.org -N chr12tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=11 -q vert -M boettger@broadinstitute.org -N chr11tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=10 -q vert -M boettger@broadinstitute.org -N chr10tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=9 -q vert -M boettger@broadinstitute.org -N chr9tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=8 -q vert -M boettger@broadinstitute.org -N chr8tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh 

qsub -S /bin/bash -v chr=7 -q vert -M boettger@broadinstitute.org -N chr7tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=6 -q vert -M boettger@broadinstitute.org -N chr6tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=5 -q vert -M boettger@broadinstitute.org -N chr5tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=4 -q vert -M boettger@broadinstitute.org -N chr4tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=3 -q vert -M boettger@broadinstitute.org -N chr3tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=2 -q vert -M boettger@broadinstitute.org -N chr2tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh

qsub -S /bin/bash -v chr=1 -q vert -M boettger@broadinstitute.org -N chr1tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_oracle.sh


angsd_bychr_list_oracle.sh

### chr6-8 still need to be run

qsub -S /bin/bash -v chr=8 -q vert -M boettger@broadinstitute.org -N chr8tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_list_oracle.sh

####### chr 1-8 stopped midway through, not all bans downloaded

rm -rf /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr5
rm -rf /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/YRI_out_chr5

qstat -j 4971097 | grep error 

############ does ancient ethiopian genome have HP2? #####

ftp://biodisk.org/Store/Genome/African/Mota_man/Bam_and_VCF/

### get HP region of mota
use Tabix
tabix -h ftp://biodisk.org/Store/Genome/African/Mota_man/Bam_and_VCF/GB20_sort_merge_dedup_l30_IR_q30_mapDamage_Entire.vcf.gz chr16:7209100-72093400

###ugg they didn’t make an index file so I’ll get the whole thing
wget ftp://biodisk.org/Store/Genome/African/Mota_man/Bam_and_VCF/GB20_sort_merge_dedup_l30_IR_q30_mapDamage_Entire.vcf.gz
should have gotten bam and not VCF

###
#####Neanderthal HP region
samtools view -b /psych/genetics_data/working/giulio/b37/neandertal/AltaiNea.hg19_1000g.16.dq.bam 16:72088300-72095100 > /humgen/cnp04/sandbox/lboettger/Neanderthal/Neanderthal_HP.bam

samtools sort Neanderthal_HP.bam Neanderthal_HP.sorted

samtools index Neanderthal_HP.sorted.bam


samtools view -h ftp://biodisk.org/Store/Genome/African/Mota_man/Bam_and_VCF/GB20_sort_merge_dedup_l30_IR_q30_mapDamage.bam 16:72088300-72095100 > /seq/vgb/linda/mota/mota_HPreg.bam

### need whole thing because not indexed ###
wget ftp://biodisk.org/Store/Genome/African/Mota_man/Bam_and_VCF/GB20_sort_merge_dedup_l30_IR_q30_mapDamage.bam > /seq/vgb/linda/mota/mota.bam


################### Mota read depth #################


samtools index /seq/vgb-HAL/linda/bal_sel/GB20_sort_merge_dedup_l30_IR_q30_mapDamage.bam
samtools view -b /seq/vgb-HAL/linda/bal_sel/GB20_sort_merge_dedup_l30_IR_q30_mapDamage.bam chr16:72088300-72095100 > /seq/vgb-HAL/linda/mota/mota_HP.bam

samtools index /seq/vgb-HAL/linda/mota/mota_HP.bam

samtools view -H /seq/vgb-HAL/linda/mota/mota_HP.bam > /seq/vgb-HAL/linda/mota/mota_HP.sam

samtools view -h -o /seq/vgb-HAL/linda/mota/mota_HPall.sam /seq/vgb-HAL/linda/mota/mota_HP.bam


MESSAGE: Input files reads and reference have incompatible contigs: Found contigs with the same name but different lengths:
##### ERROR   contig reads = chrM / 16569
##### ERROR   contig reference = chrM / 16571.
##### ERROR   reads contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chr8, chr9, chr10, chr11, chr12, chr13, chr14, chr15, chr16, chr17, chr18, chr19, chr20, chr21, chr22, chrX, chrY, chrM]
##### ERROR   reference contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chr8, chr9, chr10, chr11, chr12, chr13, chr14, chr15, chr16, chr17, chr18, chr19, chr20, chr21, chr22, chrM, chrX, chrY]

#### looks like actually aligned to b37 not hg19
http://gatkforums.broadinstitute.org/discussion/2396/input-files-known-and-reference-have-incompatible-contigs

### will just keep chr16 in header

### put new header on bam file
samtools reheader /seq/vgb-HAL/linda/mota/mota_HPrmchr.sam /seq/vgb-HAL/linda/mota/mota_HP.bam > /seq/vgb-HAL/linda/mota/mota_HPrmchr.bam

samtools index /seq/vgb-HAL/linda/mota/mota_HPrmchr.bam




### now need to delete chr from mota bams

mota_HPallrmchr.sam

samtools view -bS /seq/vgb-HAL/linda/mota/mota_HPallrmchr.sam > /seq/vgb-HAL/linda/mota/mota_HPallrmchr.bam

samtools index /seq/vgb-HAL/linda/mota/mota_HPallrmchr.bam

samtools view -h -o /seq/vgb-HAL/linda/mota/mota_HPallrmchrnew.sam /seq/vgb-HAL/linda/mota/mota_HPallrmchr.bam



##this worked
use Java-1.6
use GATK 3
#### uniquely mapped Mota
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/1kg/reference/human_g1k_v37.fasta  \
   -T UnifiedGenotyper \
   -I /seq/vgb-HAL/linda/mota/mota_HPallrmchr.bam \
   -L /seq/vgb-HAL/linda/mota/mota_HPvar.interval_list \
   -o /seq/vgb-HAL/linda/mota/HPvarsnps.uniquemap.Mota.vcf \
   --read_filter MappingQuality --min_mapping_quality_score 10 \
   --output_mode EMIT_ALL_SITES

#### all Mota
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -R /humgen/1kg/reference/human_g1k_v37.fasta  \
   -T UnifiedGenotyper \
   -I /seq/vgb-HAL/linda/mota/mota_HPallrmchr.bam \
   -L /seq/vgb-HAL/linda/mota/mota_HPvar.interval_list \
   -o /seq/vgb-HAL/linda/mota/HPvarsnps.allreads.Mota.vcf \
   --output_mode EMIT_ALL_SITES

#These are the same and HPR gene conversion isn’t well represented. I think there was lots of filtering done by manica group


Northern short-tailed shrew






########### October 4th #########
adding population expansion/contraction to coalescent simulations
### this gets us 2.95 as the 95% CI
/seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/msdir/ms 240 1000 -t 4189 -G 9.5 -r 279 2793000 | /seq/vgb-HAL/linda/bal_sel/coal_sim/scanms-2.02/scanms 2793000 2000 50 > /seq/vgb-HAL/linda/bal_sel/coal_sim/myout_humanrecombexpand







###### october 6, 2015 #######

### get wild mus musculus individuals from http://genome.cshlp.org/content/early/2015/07/02/gr.187187.114.full.pdf
# I’ve chosen the Iranian ancestral population because it is the most diverse ~22x average coverage
AH15
AH23
JR11
JR15
JR2-F1C
JR5-F1C 
JR7-F1C
JR8-F1A  

# I’m downloading these fastq files to the cheaper shortage folder and will later align them to the mus musculus genome

/seq/vgb/linda/bal_sel/mus
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2766_AH15_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2766_AH15_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2765_AH23_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2765_AH23_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2763_JR11_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2763_JR11_1_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2764_JR15_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2764_JR15_1_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640089_2759_JR2-F1C_1_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640089_2759_JR2-F1C_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2760_JR5-F1C_1_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2760_JR5-F1C_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2761_JR7-F1C_1_2_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2761_JR7-F1C_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2762_JR8-F1A_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2762_JR8-F1A_1_2_sequence.fq.gz 

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org -N getchimp \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/wgetchimp_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/wgetchimp_er \
 /wga/scr4/vgbgrp/linda/bal_sel/wget_restchimps.sh

# moving some to performance node to see if it runs faster
rsync -va /seq/vgb/linda/bal_sel /seq/vgb-ce/linda

rsync -va /seq/vgb-HAL/linda/bal_sel/mus_bams/AH15-pe.sam /wga/scr4/vgbgrp/linda/bal_sel/mus_bams

rsync -va /seq/vgb/linda/bal_sel/mus/SN7640093_2765_AH23_1_sequence.fq.gz /seq/vgb-HAL/linda/bal_sel/mus_fastq


rsync -va /seq/vgb/linda/bal_sel/mus/SN7640093_2765_AH23_2_sequence.fq.gz /seq/vgb-HAL/linda/bal_sel/mus_fastq

rsync -va /seq/vgb/linda/bal_sel/mus /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq

A short write-up of our analysis of differences between the findings is attached to the cover letter. 
########## run angst for chimps #########

## index chimp pantro2 reference
samtools faidx chimpHg19.fa

qsub -S /bin/bash -v chr=chr22 -q vert -M boettger@broadinstitute.org -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr21 -q vert -M boettger@broadinstitute.org -N chr21tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr20 -q vert -M boettger@broadinstitute.org -N chr20tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org -N chr19tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr18 -q vert -M boettger@broadinstitute.org -N chr18tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr17 -q vert -M boettger@broadinstitute.org -N chr17tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr16 -q vert -M boettger@broadinstitute.org -N ch16tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr2a -q vert -M boettger@broadinstitute.org -N ch2atajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr2b -q vert -M boettger@broadinstitute.org -N ch2btajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr15 -q vert -M boettger@broadinstitute.org -N ch15tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr14 -q vert -M boettger@broadinstitute.org -N ch14tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh
qsub -S /bin/bash -v chr=chr13 -q vert -M boettger@broadinstitute.org -N ch13tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_oracle.sh


### new version on chimp
qsub -S /bin/bash -v chr=chr2a -q vert -M boettger@broadinstitute.org -N chp2atajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr2b -q vert -M boettger@broadinstitute.org -N chp2btajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org -N chp1tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr3 -q vert -M boettger@broadinstitute.org -N chp3tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr4 -q vert -M boettger@broadinstitute.org -N chp4tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr5 -q vert -M boettger@broadinstitute.org -N chp5tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr6 -q vert -M boettger@broadinstitute.org -N chp6tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr7 -q vert -M boettger@broadinstitute.org -N chp7tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr8 -q vert -M boettger@broadinstitute.org -N chp8tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr9 -q vert -M boettger@broadinstitute.org -N chp9tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh
qsub -S /bin/bash -v chr=chr10 -q vert -M boettger@broadinstitute.org -N chp10tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh


qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chp19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chp19_er \
 -N chp19tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_oracle.sh

run 21, 22, 20



qsub -S /bin/bash -v chr=chr22 -q vert -M boettger@broadinstitute.org -N chp22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_eoffilter_oracle.sh




######### look at 28-byte hex string on last line of baffle


###### look at last line of sam
samtools view in.bam > out.bam
samtools view /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam | tail -1

WTCHG_1151:4:37:11023:8004#0    129     chr17   83374173        9       19M1I18M8I5M    chrX    5836588 0       CGCCCTGGCTCATCCCGGGTGAAGAGGCTGCTGTCTGAACTGATGACAGTG    7189999:9:9::9992;:99:;9:9:9:9589863015.899940/.159     PQ:i:622        SM:i:22 UQ:i:88
        MQ:i:0  XQ:i:265        RG:Z:WTCHG_1151 OQ:Z:CCCCCCCCCCCCCCCCCDCBCBCCCCBCCC<:A?@.1.007@>@606+0-A
33.488u 6.736s 0:48.91 82.2%    0+0k 7504400+0io 1pf+0w

… wtf chrx?????????????

tail -c -2 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam


tail -1 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam | hexdump

tail -1 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam | hexdump
0000000 5457 4843 5f47 3131 3135 343a 333a 3a37
0000010 3131 3230 3a33 3038 3430 3023 3109 3932
0000020 6309 7268 3731 3809 3333 3437 3731 0933
0000030 0939 3931 314d 3149 4d38 4938 4d35 6309
0000040 7268 0958 3835 3633 3835 0938 0930 4743
0000050 4343 5443 4747 5443 4143 4354 4343 4747
0000060 5447 4147 4741 4741 4347 4754 5443 5447
0000070 5443 4147 4341 4754 5441 4147 4143 5447
0000080 0947 3137 3938 3939 3a39 3a39 3a39 393a
0000090 3939 3b32 393a 3a39 393b 393a 393a 393a
00000a0 3835 3839 3336 3130 2e35 3938 3939 3034
00000b0 2e2f 3531 0939 5150 693a 363a 3232 5309
00000c0 3a4d 3a69 3232 5509 3a51 3a69 3838 4d09
00000d0 3a51 3a69 0930 5158 693a 323a 3536 5209
00000e0 3a47 3a5a 5457 4843 5f47 3131 3135 4f09
00000f0 3a51 3a5a 4343 4343 4343 4343 4343 4343
0000100 4343 4343 4443 4243 4243 4343 4343 4342
0000110 4343 3a3c 3f41 2e40 2e31 3030 4037 403e
0000120 3036 2b36 2d30 0a41                    
0000128

tail -1 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam | hexdump

xxd -u -ps -c 28 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.bam > /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.DumpFile.hex
egrep ' DF|DF ' /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr17/PtLAchr17.DumpFile.hex

result: 4.165u 8.517s 1:15.51 16.7%     0+0k 15272832+0io 0pf+0w



mybam=/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr22/PtYOchr22.bam

/wga/scr4/vgbgrp/linda/bal_sel/checkeof.sh mybam=/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chrchr22/PtYOchr22.bam


##### try new script that checks if bam is complete ###
 

angsd_bychr_checkeof_oracle.sh


samtools flagstat /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr8/NA18489_chr8.bam

samtools flagstat /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr20/NA18934_chr20.bam

samtools flagstat /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr18/NA18934_chr18.bam


qsub -S /bin/bash -v chr=8 -q vert -M boettger@broadinstitute.org -N chr8tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

qsub -S /bin/bash -v chr=7 -q vert -M boettger@broadinstitute.org -N chr7tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

qsub -S /bin/bash -v chr=6 -q vert -M boettger@broadinstitute.org -N chr6tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

qsub -S /bin/bash -v chr=5 -q vert -M boettger@broadinstitute.org -N chr5tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

qsub -S /bin/bash -v chr=4 -q vert -M boettger@broadinstitute.org -N chr4tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh
qsub -S /bin/bash -v chr=3 -q vert -M boettger@broadinstitute.org -N chr3tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh
qsub -S /bin/bash -v chr=2 -q vert -M boettger@broadinstitute.org -N chr2tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

qsub -S /bin/bash -v chr=1 -q vert -M boettger@broadinstitute.org -N chr1tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh


qsub -S /bin/bash -v chr=9 -q vert -M boettger@broadinstitute.org \
	-o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr9_out \
	-e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr9_er \
	-N chr9tajd \
	/wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh



qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr22_er \
 -N chr22tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

works:
qsub -S /bin/bash -v chr=7 -q vert -M boettger@broadinstitute.org -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr7_out -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/chr7_er -N chr7tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh

/var/spool/sge/vert04/job_scripts/5086761: line 36: [: too many arguments

##### problem with chr1 and chr2
/var/spool/sge/vert01/job_scripts/5084747: line 36: [: too many arguments
[E::hts_open] fail to open file 'ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/data/NA18486/alignment/NA18486.mapped.ILLUMINA.bwa.YRI.low_coverage.20101
123.bam'
[bam_idxstats] fail to open BAM.




### new fixed, this checks against idx file with flagstat to confirm number of reads
## it also uses the filtering requirements suggested by angst
qsub -S /bin/bash -v chr=8 -q vert -M boettger@broadinstitute.org -N chr8tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_bychr_checkeof_oracle.sh









########## maybe should have run with filters ??? ########
I ran above using emperical Bayes (EB) method
“Remember that you will need to supply the ancestral state for the SFS Estimation, and you should try to remove the worst data by -minMapQ and -minQ”



http://popgen.dk/angsd/index.php/SFS_Estimation
We always recommend that you filter out the bad qscore bases and meaningless mapQ reads. eg -minMapQ 1 -minQ 20. So the above analysis with these filters can be written as:
./angsd -bam bam.filelist -doSaf 1 -out small -anc chimpHg19.fa -GL 2 -P 4 -minMapQ 1 -minQ 20







######### November 12 2015 #########

#### below is sample of aligning reads and cleaning
### I think I only want paired end
-q means the trim quality
-I means The input is in the Illumina 1.3+ read format (quality equals ASCII-64)

#align good paired ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq > new_align/NA11993_1.sai
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > new_align/NA11993_2.sai

./bwa sampe -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta ../new_align/NA11993_1.sai ../new_align/NA11993_2.sai ../new_splitfastq/NA11993_1d1d.sortedpairs_1.fastq ../new_splitfastq/NA11993_1d1d.sortedpairs_2.fastq > ../new_align/NA11993_pe_aln.sam


samtools view -bS NA11993_pe_aln.sam > NA11993_pe_aln.bam

## align bad single ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_sortedpairs/NA11993_bad.fastq > new_align/NA11993_se.sai

bwa-0.5.9/bwa samse -r '@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993' /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta new_align/NA11993_se.sai new_sortedpairs/NA11993_bad.fastq > new_align/NA11993_se_aln.sam

samtools view -bS NA11993_se_aln.sam > NA11993_se_aln.bam

### merge the bamflies
samtools merge NA11993_all.aln.bam NA11993_se_aln.bam NA11993_pe_aln.bam

#### check read groups:
samtools view -H NA11993_all.aln.bam | grep '^@RG'
samtools view NA11993_all.aln.bam | grep 'RG:Z'


### Picard -  clean Sam
java -jar CleanSam.jar INPUT=../new_align/NA11993_all.aln.bam OUTPUT=../new_align/NA11993_all_clean.aln.bam

### sort
java -jar SortSam.jar INPUT=../new_align/NA11993_all_clean.aln.bam OUTPUT=../new_align/NA11993_all_clean_sorted.aln.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=LENIENT

## mark dups
java -jar MarkDuplicates.jar INPUT=../new_align/NA11993_all_clean_sorted.aln.bam OUTPUT=../new_align/NA11993_all_clean_mkdup_sorted.aln.bam METRICS_FILE=../new_align/NA11993_mrkdup_metrics VALIDATION_STRINGENCY=LENIENT

#index
samtools index NA11993_all_clean_mkdup_sorted.aln.bam

### check it
samtools flagstat NA11993_all_clean_mkdup_sorted.aln.bam
677974 in total
0 QC failure
197085 duplicates
340826 mapped (50.27%)
553400 paired in sequencing
276700 read1
276700 read2
167298 properly paired (30.23%)
207984 with itself and mate mapped
19254 singletons (3.48%)
1840 with mate mapped to a different chr
793 with mate mapped to a different chr (mapQ>=5)

### will need to realign around indels ###
############### code to realign areas around indels and remove PCR duplicates ###############
##NA19238
#get indels intervals to realign
java -jar ~/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
    -T RealignerTargetCreator \
    -I bams/NA19238_clean.sorted.mrkdup.aln.bam \
    -R /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    --intervals 16:71900000-72260000 \
    --excludeIntervals 16:72094702-72111503 \
    -o bams/NA19238.realign.intervals 


######## from  paper ######
The reads were mapped onto the mouse reference genome
(mm9) using BWA (Li and Durbin 2009). PCR duplicates were
removed using SAMtools (Li et al. 2009). The final average coverage
was ∼20× for the mainland populations and 10× for the
Heligoland samples (see Supplemental Table S1 for read mapping
statistics).

#align good paired ends
bwa-0.5.9/bwa aln -I -q 15 /seq/references/Mus_musculus_assembly9/v0/Mus_musculus_assembly9.fasta SN7640093_2766_AH15_1_sequence.fq.gz > align/AH15_1.sai


bwa mem /seq/references/Mus_musculus_assembly9/v0/Mus_musculus_assembly9.fasta /seq/vgb/linda/bal_sel/mus/SN7640093_2766_AH15_1_sequence.fq.gz /seq/vgb/linda/bal_sel/mus/SN7640093_2766_AH15_2_sequence.fq.gz > AH15-pe.sam

samtools sort AH15-pe.sam -o AH15-pe.sorted.bam 


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org -N ah15aln /seq/vgb/linda/bal_sel/mus/Mus_bwa.sh
Mus_bwa.sh

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org -N ah23aln /seq/vgb-HAL/linda/bal_sel/Mus_bwanew.sh


####### looking for adaptor sequences.. I think they were trimmed off
ACACTCTTTCCCTACACGACGCTCTTCCGATCT

zgrep 'ACACTCTTTCCCTACACGACGCTCTTCCGATCT' SN7640093_2764_JR15_1_1_sequence.fq.gz 
AGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCCATAGGGGGTGGTGATATTTGGGTGGGGGCGCCTATGAGAGAGAGATAGTGGGGGCGAGTC
TCTACACTCTTTCCCTACACGACGCTCTTCCGATCTGTCTCACCTGCTGCAGGGCCCAGGTATGAGTTCAACCTCACACTGCAGCAGGTGAGACAGATCGG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTACATATCACCATTATCGAACTCAACGCCCTGCATACGAAAAGACAGAATCTCTTCCAAGAGCTTGATG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTTATTTGTCTCCAGCCACTTAAGTGAGGTGATTTATGTTTGGTGCTATTGCTGGCGACAAATCAAGAT
TGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTTGTGAGATTTATAATAGTGTAGCAGTTACCTTCTGTCAGTGTAGCGAATG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTCTTTGTTCCTGAGCATGGCACTATGTTTACTCTTGCGCTTGTTCAGGAACAAAGAAGATCGGAAGAG
ATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTGTATCTTTGCTCAACCAGTGAGCAAAGATACAGATCGGAAGAGCACACGTCTGAACTCCAGTCA
TCTACACTCTTTCCCTACACGACGCTCTTCCGATCTTATCAGTATGAACTTGAACTTCAAGGTCTTTTGCACAGGAGTTAATTCTCAGATGAATCCCCAGT
AAGAGAAAGAAAAAAAAGTGAATGGAGTTCAGACGTGTGCTCTTCCGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTAGATCGGAAGAGCACAC
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTGTGAGGATTTTATAGAGTATTTTTGCATCGATATTTATAAGGGAAATTGCTCTGAAGTGCTTTTTTT
ACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTACACCTCTCTTAGTACATAATAATTTGTTAATCAATCTCCCTTTAATTT
ATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCGGAAAATGAGAAATACACACTTTAGGACGTGAAAAATGACGAAATCACTGAAAAACGTGGAAA
ACACTCTTTCCCTACACGACGCTCTTCCGATCTGTGGACATTTCTATATTTTCCAAATTTTTTAGTGTTCCTCTACATATTTTATGCACTAAAGTTTGTAT
ATTTACACTCTTTCCCTACACGACGCTCTTCCGATCTTTTTGGAAATCCGTTCATCAAGACAAAGAAGACCAGGCTGAGGGAATATGAGGGGCTAGTCACG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTATGGTCAATATAACCAGCAGTGTTAACAGTCGGGAGAGGAGTGGCATTAACACTGCTGGTTATATTGA
CTGATACGGCGACCACCGAGNTCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCGTGTTGTTGCTTGTCGGTGGAGGCCTGGGGAATAAAAGGAAGG

… that’s it

and RC
zgrep 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT' SN7640093_2764_JR15_1_1_sequence.fq.gz 



###### rerunning chimps on the already downloaded files -start this when last one finishes!!!!!!!!!

qsub -S /bin/bash -v chr=chr22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chr22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chr22_er \
 -N chr22tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_on_oracle.sh 


qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chr1_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chr1_er \
 -N chr1tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_on_oracle.sh 



### make sam for other mice
qsub -S /bin/bash -v indv=SN7640089_2759_JR2-F1C \
 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR2_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR2_er \
 -N JR2mem \
 /wga/scr4/vgbgrp/linda/bal_sel/Mus_bwall.sh



SN7640090_2760_JR5-F1C
qsub -S /bin/bash -v indv=SN7640090_2760_JR5-F1C \
 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR5_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR5_er \
 -N JR5mem \
 /wga/scr4/vgbgrp/linda/bal_sel/Mus_bwall.sh


SN7640090_2762_JR8-F1A
qsub -S /bin/bash -v indv=SN7640090_2762_JR8-F1A \
 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR8_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR8_er \
 -N JR8mem \
 /wga/scr4/vgbgrp/linda/bal_sel/Mus_bwall.sh


qsub -S /bin/bash -v indv=SN7640093_2763_JR11 \
 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR11_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR11_er \
 -N JR11mem \
 /wga/scr4/vgbgrp/linda/bal_sel/Mus_bwall.sh

qsub -S /bin/bash -v indv=SN7640093_2764_JR15 \
 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR15_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR15_er \
 -N JR15mem \
 /wga/scr4/vgbgrp/linda/bal_sel/Mus_bwall.sh


rsync -va /seq/vgb-HAL/linda/bal_sel/mus_bams/AH23-pe.sam /wga/scr4/vgbgrp/linda/bal_sel/mus_bams


indv=SN7640093_2765_AH23

##find java environment variables
echo $CLASSPATH 
 


qsub -S /bin/bash -v indv=AH15-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH15_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH15_fer \
 -N JR5filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads_ending.sh

ERROR: Header version: 1.3 does not match expected version: 1.0
ERROR: Read groups is empty

java -Xmx2G -jar $PICARD_dir/AddOrReplaceReadGroups.jar INPUT=AH15-pe.bam OUTPUT=AH15-peRG.bam RGLB=Muslib RGPL=Illumina RGPU=1 RGSM=$indv RGDS=AD

qsub -S /bin/bash -v indv=AH23-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH23_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH23_fer \
 -N AH23filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads.sh


qsub -S /bin/bash -v indv=JR15-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR15_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR15_fer \
 -N JR15filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads_ending.sh


JR11-pe


####### add read group
'@RG\tID:Run1_NA11993\tPL:ILLUMINA\tLB:Lib1\tSM:NA11993'
ID = id name for the readgroup
SM = sample name
LB = label? dunno about this one
PL = platform





samtools view -b -o MUSah15_region.bam AH15-pe_realign_mkdup.sorted.bam chr8:109574116-109580183 



######## Dec 17, 2015 Run angsd on mus
## they have chromosomes 1-19 labels include “chr” i.e. “chr1”

qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -N chr19tajd \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/out19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/out19_err \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd.sh

mus_angsd_noHWE.sh

qsub -S /bin/bash -v chr=chr18 -q vert -M boettger@broadinstitute.org \
 -N chr18tajd \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/out18_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/out18_err \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_noHWE.sh


####### test script to do human liftovers ####

qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_err \
 -N humlift22 \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover.sh


############# I should filter on HWE before running the program I think — decided not to do this ############
-hwe_pval 1 (look up real value) 1e-2

The HWE filtered test on Mus mud chr19 is skewed positive by a lot 
I think that the HWE filter is getting rid of more rare snaps and this skewed the values

This is what was done in other papers:
http://mbe.oxfordjournals.org/content/26/12/2755.full

The data are described in Bustamante et al. (2005), and a strict bioinformatics pipeline ensured true homology and the use of only well-supported SNPs, as described in Boyko et al. (2008). Substantial effort was taken to avoid biological and technical confounding factors. The original bioinformatics pipeline involved reciprocal Blast searches to avoid misalignments and required a unique high-quality match to the public human chimpanzee sequence PanTro2 (Chimpanzee Sequence and Analysis Consortium 2005) (supplementary Methods, Supplementary Material online). Also, only genes with unique products with in silico polymerase chain reaction (http://genome.ucsc.edu) were used. This process checks for multiple genomic matches of the amplification primers and detects cases of putative nonspecific amplification. Finally, extreme (significant) genes were extensively checked for the presence of close paralogs, including segmental duplications, through BLAT searches of the March 2006 Human Genome Sequence Assembly and test of involvement in segmental duplications (Human Segmental Duplication Database [Cheung et al. 2003]). Fixed differences with respect to chimpanzee and ancestral state of human SNPs were assessed by comparison with PanTro2 chimpanzee reference sequence (Chimpanzee Sequence and Analysis Consortium 2005).

1.8 for filter2.8 for no filter


I should get strand bias, HWE, and depth of coverage stats for each snp and plot against TajD for each window. Should I filter out all known transposons etc?



############# January 4 2015 - need to do liftovers ####################

human leftovers, only 22 is done

qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/lift21_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/lift21_err \
 -N humlift21 \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover.sh



#only 19 is done
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift1_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift1_err \
 -N muslift1 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover.sh





#### chimp leftovers, only 22 is done
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/lift1_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/lift1_err \
 -N chlift1 \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover.sh




	!!!!!!!!!!! TO DO!!!!!!!! —— what about stuff not in chromosome????



NEED TO RUN TAJD AND LIFTOVERS FOR SMALLER CONTIGS FOR CHIMP AND MOUSE

########## Jan 11 2016 ###
ones I already ran were  SN:chr19
### chromosomes left to do for mus
@SQ     SN:chr1_random  LN:1231697
@SQ     SN:chr3_random  LN:41899
@SQ     SN:chr4_random  LN:160594
@SQ     SN:chr5_random  LN:357350
@SQ     SN:chr7_random  LN:362490
@SQ     SN:chr8_random  LN:849593
@SQ     SN:chr9_random  LN:449403
@SQ     SN:chr13_random LN:400311
@SQ     SN:chr16_random LN:3994
@SQ     SN:chr17_random LN:628739
@SQ     SN:chrUn_random LN:5900358

qsub -S /bin/bash -v chr=chrUn_random -q vert -M boettger@broadinstitute.org \
 -N chrUNrtajd \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/outUnr_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/outUnr_err \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_noHWE.sh

### do liftovers ###
qsub -S /bin/bash -v chr=chr8 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift8_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift8_err \
 -N muslift8 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover.sh




### other chimp chromosomes ###
samtools idxstats /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/PtRG_rmdup_recal.bam | more

all chromosomes with “_random” except for chr21
e.g. “chr22_random”
chr2a_random


chr6_hla_hap1
chrUn


qsub -S /bin/bash -v chr=chrUn -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chrunr_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/chrunr_er \
 -N chruntajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_on_oracle.sh 



qsub -S /bin/bash -v chr=chr22_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/lift22r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out/out/lift22r_err \
 -N chlift22r \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover.sh


qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift19_err \
 -N muslift19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_lastlift.sh


##### liftover all mus
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_lastlift.sh
done < mus_chr.txt

##### test run with echo
while read c; do
  qsub_str="qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_lastlift.sh"
  echo $qsub_str
done < mus_chr.txt



while read p; do
  echo $p
done <peptides.txt

### liftover 
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_err \
   -N YRIlift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt


13-22 are already running…

#### human liftovers removing stuff that doesn’t lift back to right spot




########## download final leftovers to hg19 to my computer #########

### combine human files

cat * > ../YRI_allchr_chimp.bed

####### especially chr1 has problems
## many of the windows don’t lift back to their original position 
### I’m going to run it again




############### re-running with 500 bp step not 50 !!!!


qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_err \
   -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_oracle.sh


#### angst on all human chr ———————> to run!!!!!!!!!!!
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_err \
   -N YRIangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_oracle.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt






####### chimp test 21
qsub -S /bin/bash -v chr=chr21 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr21_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr21_er \
 -N chr21tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_on_oracle.sh 


#### angst on all chimp chr 
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_err \
   -N chimpangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_on_oracle.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt



##### mus angsd on chr19
qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out500/out/chr19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out500/out/chr19_er \
 -N chr19tajd \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_noHWE.sh


#### angst on all mus chr 
## for this one, the window size was change dot 500, but the folder wasn’t changed to 500
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out500/out/angsd${c}_err \
   -N musangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_noHWE.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt




### liftover 
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_err \
   -N YRIlift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt

### combine human files

cat * > ../YRI_allchr_chimp.bed




### liftover chimp
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_err \
   -N chimplift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt

cat * > combined/chimp_allchr_humlift.bed



### test mus liftover
### do liftovers ###
qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift19_err \
 -N muslift19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover.sh

while read c; do
 qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt




#################### Jan 20 fixing liftovers #################

### realizing that it doesn’t have to leftover in both directions
# can’t do anyway, SUPER small files for mus
I won’t leftover human at all, mus and chimp will be lifted once onto human


### liftover chimp
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_err \
   -N chimplift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt

cat * > combined/chimp_allchr_lifted1.bed


while read c; do
 qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt

cat * > combined/mus_allchr_lifted1.bed


while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_err \
   -N YRIlift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_over1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt


/wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/YRI_out_over
cat * > combined/YRI_allchr.bed



######## chimpanzee
chimp.bed <- read.table("/Users/boettger/postdoc/bal_sel/TajD/liftovers_bn10/chimp_allchr_lifted1.bed")
chimp.bed <- chimp.bed[,-4]
colnames(chimp.bed) <- c("chr", "start", "stop", "TajD")
chimp.merge <- my.range.merge(chimp.bed)
chimp.merge$length <- chimp.merge$stop - chimp.merge$start
sum(chimp.merge$length)



#################### next time ##################

I’m unsure how much filtering was done on the chimp files. I just looked at a portion in IGV, and it seems to be filtered.

I may want to do more filtering on mus (or on everything to make the filters consistent).

do filtering more like this:

ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/README.phase1_alignment_data


include recalibration of quality scores









################# Jan 27, 2016, looking at quality metrics in top 1% or 5% vs overall genome ########


use BEDTools
bamfolder=/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_chr22
topsfolder=/wga/scr4/vgbgrp/linda/bal_sel/check_tops


### doesn’t work with multiple input barflies 
coverageBed -abam $bamfolder/PtYO_chr22.bam $bamfolder/PtSU_chr22.bam \
 $bamfolder/PtRN_chr22.bam -b $topsfolder/chimp_top5_on22.bed > \
 $topsfolder/chr22_outchimp

bedtools coverage -d -abam $bamfolder/PtRN_chr22.bam \
 -b $topsfolder/chimp_top5_on22.bed > \
 $topsfolder/chr22_outchimp

samtools view $bamfolder/PtYO_chr22.bam chr22:24048500-50123500 > $topsfolder/myreg_chr22_outchimp.bam

samtools sort -o $topsfolder/PtRN_chr22.sorted.bam $bamfolder/PtRN_chr22.bam



### average coverage is 10x in pan map
#### apparently this  won’t open the bamfle???
samtools bedcov $topsfolder/chimp_top5_on22.bed $bamfolder/PtRN_chr22.bam > $topsfolder/chr22_outchimp


### this gets each base separately, but it does work… actually, maybe I want per base
samtools depth -b $topsfolder/chimp_top5_on22.bed -f $bamfolder/chimpchr22.bamfilelist > $topsfolder/chr22_outchimp




### look at read depth in chimps

installing new version of angsd so I can use unique-only funciton
I was using angsd version: 0.902-98
I am getting angsd0.910

new version won’t install using wget or on github
g++ -c  -O3 -D__WITH_POOL__  -I/seq/vgb/linda/bin/htslib prep_sites.cpp
prep_sites.cpp: In function 'void filt_gen(const char*, int, int)':
prep_sites.cpp:435: error: 'unlink' was not declared in this scope
make: *** [prep_sites.o] Error 1

## seems to be a  compiler problem
I have gcc version 4.4.7



angsd -bam bam.filelist -doDepth 1 -out strict -doCounts 1 minMapQ 30 -minQ 20 -unique_only -remove_bads 1 -only_proper_pairs 1 -minInd 7

parentpath='/wga/scr4/vgbgrp/linda/bal_sel'
bampath=$parentpath'/chimp_bams/chimp_bams_'$chr
outpath=$parentpath'/chimp_out500/read_depth'


“argument  -unique_only is unknown will exit”
- maxDepth [int]
Defaults to 100. Sites with more than maxDepth reads are counted as having 100 reads.

## I need to set the maxdepth to something higher
## shouldn’t the sample numbers add to the global??
http://popgen.dk/angsd/index.php/Depth

set maxdepth to 250 (more than double what we expect for 10 individuals with 10x coverage each
/seq/vgb/linda/bin/angsd/angsd -bam $bampath/chimp$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -minMapQ 30 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 7 \
    -maxDepth 250 \
    -out $outpath/chimpfilter_$chr \


/seq/vgb/linda/bin/angsd/angsd -bam $bampath/chimp$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -minMapQ 1 -minQ 20 \
    -out $outpath/chimpdirty_$chr \


######## should do BAQ with samtools for mice 

“BAQ was applied to the original BAM files using SAMtools (Version 0.1.12a).” for chimp

humans were previously run with GATK IndelRealigner using known human indels
ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/historical_data/former_toplevel/README.alignment_data.md

## just use BAQ for mus
“2. Base alignment quality (BAQ) computation is turned on by default.”
BAQ is a phred-like score representing the probability that a read base is mis-aligned; it lowers the base quality score of mismatches that are near indels. 

http://massgenomics.org/2012/03/5-things-to-know-about-samtools-mpileup.html


### what are my read depth cutoffs for mus and human???


######### test new filter script on chimp #########

#### angst on all chimp chr 
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_err \
   -N cangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt

…. should re-align around indels before running this again!!!

also     -doQsDist 1 \ allows me to do -uniqueOnly


######### angsd filtering ########




### chimp read depth ### —— first I need to do local re-alignment around indels!!!
need to re-write some of this code, right now is by individual, not by chromosome

chr=chr1
outpath='/wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_'$chr

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/chimp$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 30 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 7 \
    -uniqueOnly 1 \
    -maxDepth 250 \
    -GL 2 \
    -baq 1 \
    -ref /seq/vgb/references/chimp/panTro2.fasta \
    -out $outpath/chimpfilternew_$chr






## figure out mus depth
 ~22x average coverage

outpath='/wga/scr4/vgbgrp/linda/bal_sel/mus_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/mus_bams/mus_bams_'$chr

### “new” has no unique only 
###this was not available: got rid of short scaffolds <2kb (-minChunkSize 2000)

#set maxdepth to 360 (more than double what we expect for 8 individuals with 22x coverage each)

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/mus$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 30 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 5 \
    -uniqueOnly 0 \
    -maxDepth 360 \
    -GL 2 \
    -baq 1 \
    -ref /seq/references/Mus_musculus_assembly9/v1/Mus_musculus_assembly9.fasta \
    -out $outpath/musfilternew_$chr


#### human depth
#set maxdepth to 1000 (more than double what we expect for 120 individuals with 4x coverage each)

outpath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr'$chr

should I put min imdv as 70???? not really sure

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/YRIrentschr1.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 30 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 70 \
    -uniqueOnly 0 \
    -maxDepth 1000 \
    -baq 1 \
    -ref /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    -out $outpath/YRIfilternew_$chr


#February 8th, chimp realign around indels, re-split, make non-filtered angsd file

qsub -S /bin/bash -v indv=PtYO -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtYO_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtYO_er \
 -N PtYO \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_reindel.sh

qstat -j 5797505 | grep error #there was no dictionary file

##

myfolder='/seq/vgb/references/chimp'
picard='/home/unix/boettger/bin/picard-tools-2.0.1'
java -jar $picard/picard.jar CreateSequenceDictionary R= $myfolder/panTro2.fasta O= $myfolderpanTro2.dict

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/dict_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/dict_er \
 -N make.dict \
 /wga/scr4/vgbgrp/linda/bal_sel/make_dict.sh


### hard to realine around indels
MESSAGE: Input files reads and reference have incompatible contigs: Relative ordering of overlapping contigs differs, which is unsafe.
##### ERROR   reads contigs = [EBV_g, chr1, chr10, chr10_random, chr11, chr11_random, chr12, chr12_random, chr13, chr13_random, chr14, chr14_random, chr15, chr15_random, chr16, chr16_random, chr17, chr17_random, chr18, chr
18_random, chr19, chr19_random, chr1_random, chr20, chr20_random, chr21, chr22, chr22_random, chr2a, chr2a_random, chr2b, chr2b_random, chr3, chr3_random, chr4, chr4_random, chr5, chr5_random, chr6, chr6_hla_hap1, chr6_ran
dom, chr7, chr7_random, chr8, chr8_random, chr9, chr9_random, chrM, chrUn, chrX, chrX_random, chrY, chrY_random]
##### ERROR   reference contigs = [chr1, chr1_random, chr10, chr10_random, chr11, chr11_random, chr12, chr12_random, chr13, chr13_random, chr14, chr14_random, chr15, chr15_random, chr16, chr16_random, chr17, chr17_random, 
chr18, chr18_random, chr19, chr19_random, chr20, chr20_random, chr21, chr22, chr22_random, chr2a, chr2a_random, chr2b, chr2b_random, chr3, chr3_random, chr4, chr4_random, chr5, chr5_random, chr6, chr6_random, chr7, chr7_ra
ndom, chr8, chr8_random, chr9, chr9_random, chrM, chrUn, chrX, chrX_random, chrY, chrY_random]


### EBV wasn’t there
Exception in thread "main" picard.PicardException: New reference sequence does not contain a matching contig for EBV_g  Epstein_Barr_virus_B95-8 is on /seq/references
Reference Sequence NC_007605.1 is the one they used

sriram did this
We used the command “bwa aln -q15”, which removes the low-quality ends
of reads

I downloaded EBV genome from http://www.ncbi.nlm.nih.gov/nuccore/82503188


cat /seq/vgb/references/chimp/panTro2.fasta /wga/scr4/vgbgrp/linda/bal_sel/references/EBV_g.fa > /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBV.fasta


myfolder='/wga/scr4/vgbgrp/linda/bal_sel/references'
picard='/home/unix/boettger/bin/picard-tools-2.0.1'
java -jar $picard/picard.jar CreateSequenceDictionary R= $myfolder/panTro2_EBV.fasta O= $myfolder/panTro2_EBV.dict


bwa index $myfolder/panTro2_EBV.fasta


#Exception in thread "main" picard.PicardException: New reference sequence does not contain a matching contig for chr6_hla_hap1

### I think I just need to download the original fastq files and start over

downloaded pantro2 
http://hgdownload.cse.ucsc.edu/goldenPath/panTro2/bigZips/panTro2.2bit


### this is the link to pan map filtering:
http://science.sciencemag.org/content/sci/suppl/2012/03/14/science.1216872.DC1/Auton.SOM.pdf


get pantro2 fasta from 2bit file

http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/twoBitToFa
usage info: https://genome.ucsc.edu/goldenpath/help/blatSpec.html#twoBitToFaUsage

/seq/vgb/linda/bin/twoBitToFa /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2.2bit /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2.fa

cat /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2.fa /wga/scr4/vgbgrp/linda/bal_sel/references/EBV_g.fa > /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBV.fasta

myfolder='/wga/scr4/vgbgrp/linda/bal_sel/references'
picard='/home/unix/boettger/bin/picard-tools-2.0.1'
java -jar $picard/picard.jar CreateSequenceDictionary R= $myfolder/panTro2_EBV.fasta O= $myfolder/panTro2_EBV.dict
samtools faidx $myfolder/panTro2_EBV.fasta

### panmap fastq
http://science.sciencemag.org/content/sci/suppl/2012/03/14/science.1216872.DC1/Auton.SOM.pdf
 500bp paired end reads from Western Chimps (9 female + 1 male)
“ The chimpanzee
pseudoautosomal region (PAR1), comprising 2.6Mb of the short arm telomere of
the sex chromosomes, was masked out on the Y chromosome.”



qsub -S /bin/bash -v indv=PtYO -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtYO_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtYO_er \
 -N PtYO \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_reindel.sh

##### calling SNPs in non-model taxa
https://gist.github.com/brantfaircloth/4315737


### I’m choosing to realign over each sample individually due to this advice:
http://gatkforums.broadinstitute.org/gatk/discussion/2747/indelrealignment-on-sample-level-bams-or-giant-project-level-merged-bam


     -I  PtAC_C4.bam \
       -I  PtFR_C4.bam \
       -I  PtGI_C4.bam \
       -I  PtLA_C4.bam \
       -I  PtLI_C4.bam \
       -I  PtPE_C4.bam \
       -I  PtRG_C4.bam \
       -I  PtRN_C4.bam \
       -I  PtSU_C4.bam \
       -I  PtYO_C4.bam \


qsub -S /bin/bash -v indv=PtAC -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtAC_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/PtAC_er \
 -N PtAC \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_reindel.sh




############ February 9th, Running angsd on chromosome 19/22 to look at distribution ###
# This will not be useful at looking for overlap (will liftover to other chromosomes), but I”ll understand if it 
# is closer to the coalescence simulations for that organism


## mus has not done BAQ recalibration, but I think angsd does it anyway


## figure out mus depth
 ~22x average coverage


### “new” has no unique only 
###this was not available: got rid of short scaffolds <2kb (-minChunkSize 2000)

#set maxdepth to 360 (more than double what we expect for 8 individuals with 22x coverage each)
## not doing unique only


#methods from here: https://github.com/mfumagalli/WoodsHole/blob/master/Files/filtering.md
#look at quality and depth before filtering

chr=chr1
outpath='/wga/scr4/vgbgrp/linda/bal_sel/mus_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/mus_bams/mus_bams_'$chr

## didn’t need to do GL here since we calculate them later
#-minInd 5

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/mus$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -remove_bads 1 \
    -only_proper_pairs 1  \
    -uniqueOnly 0 \
    -maxDepth 360 \
    -C 50 \
    -baq 1 \
    -ref /seq/references/Mus_musculus_assembly9/v1/Mus_musculus_assembly9.fasta \
    -out $outpath/musResults_$chr.qc


#### human depth
#set maxdepth to 1000 (more than double what we expect for 120 individuals with 4x coverage each) #says 87 samples.. I should look at that

chr=1
outpath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr'$chr

should I put min imdv as 70???? not really sure

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/YRIrentschr1.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -remove_bads 1 \
    -only_proper_pairs 1 \
    -uniqueOnly 0 \
    -maxDepth 1000 \
    -C 50 \
    -baq 1 \
    -ref /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    -out $outpath/YRIResults_$chr.qc


### chimp
/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/reindel

## then separate by chromosome
qsub -S /bin/bash -v chr=chr21 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr21_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr21_er \
 -N chr21 \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_sep_chr.sh 


#### I think I just need to download the fast files
http://przeworski.c2b2.columbia.edu/index.php/softwaredata/
The sequence data (in BAM file format), variant calls (in VCF file format), genetic maps, and sequenced PRDM9 alleles are available for download over anonymous FTP from ftp://birch.well.ox.ac.uk/. The BAM files are available from the Short Read Archive,

SUBMISSION_ID	STUDY_ACCESSION	STUDY_ALIAS	RELEASE_DATE
ERA191030	ERP002171	PanMap	25-Mar-2013


http://www.ncbi.nlm.nih.gov/sra/?term=ERP002171

cd /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225035/ERR225035.sra

get these ERR225027 to ERR225036


outdir=/wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq
wget -O /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225027/ERR225027.sra
wget -O ERR225028.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225028/ERR225028.sra
wget -O ERR225029.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225029/ERR225029.sra
wget -O ERR225030.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225030/ERR225030.sra
wget -O ERR225031.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225031/ERR225031.sra
wget -O ERR225032.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225032/ERR225032.sra
wget -O ERR225033.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225033/ERR225033.sra
wget -O ERR225034.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225034/ERR225034.sra
wget -O ERR225035.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225035/ERR225035.sra
wget -O ERR225036.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR225/ERR225036/ERR225036.sra


/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225027.sra --gzip

/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 outdir/ERR225027.sra --gzip --outdir ./split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225028.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225029.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225030.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225031.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225032.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225033.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225034.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225035.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/split-3











  --split-3                        Legacy 3-file splitting for mate-pairs: 
                                   First biological reads satisfying dumping 
                                   conditions are placed in files *_1.fastq and 
                                   *_2.fastq If only one biological read is 
                                   present it is placed in *.fastq Biological 
                                   reads and above are ignored. 

Rm /wga/scr4/vgbgrp/linda/bal_sel/chimpdown.out
qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimpdown.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_down.er \
 -N sra \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_download.sh 


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimpfast.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_fast.er \
 -N cnvt \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastqconvert.sh 


cat /seq/vgb/references/chimp/panTro2.fasta 









### convert .sra to .fastq
cd /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225027.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225028.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225029.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225030.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225031.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225032.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225033.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225034.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225035.sra --gzip
/seq/vgb/software/ncbi/bin/fastq-dump -I --split-files ERR225036.sra --gzip


###### mask pseudoautosomal before alignment
### not doing this for now, will do it later if I decide to look at the X chromosome.
Probably less balancing selection on X because many are homozygous. 

sequence of pseudoatosomal is found here: This region will be hard masked in the reference  (turned to N)
http://www.ncbi.nlm.nih.gov/nuccore/AY296088.1



panmap filtering
http://science.sciencemag.org/content/sci/suppl/2012/03/14/science.1216872.DC1/Auton.SOM.pdf

using what molly did 1x10-6 for humans

Hardy weinberg p-values for mouse									Genotypes	Observed #	Expected #			Homozygote reference:	0	2.0			Heterozygote:	8	4.0			Homozygote variant:	0	2.0				^Put your values here^				Var allele freq:	0.50									C2 = 	8				C2 test P value = 	0.004678	with 1 degree of freedom.	


p-value of .005 will make sure not everyone is heterozygous for an allele frequency of 0.5


For chimps:				Genotypes	Observed #	Expected #	Homozygote reference:	0	2.5	Heterozygote:	10	5.0	Homozygote variant:	0	2.5		^Put your values here^		Var allele freq:	0.50					C2 = 	10		C2 test P value = 	0.001565	with 1 degree of freedom.


p-value of .002 will make sure not everyone is heterozygous for an allele frequency of 0.5



### test chromosome 22 with new filtering ##
qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_err \
   -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter.sh
#### this resulted in a bunch of nans… I guess no data?

I”ll loosen the filters

qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_err \
   -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter_test.sh
just these:
    -minMapQ 20 \
    -minQ 20 \




qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/lift21_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out/out/lift21_err \
 -N humlift21 \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover_feb11.sh



qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_err \
 -N mus19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh
### this looks bad, all TjaD around 1.4

#### testing with few filters
qsub -S /bin/bash -v chr=chr17_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/an17r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/an17r_err \
 -N mus17r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter_test.sh
looks fine, adding more….
adding depth, proper pairs and rm bads
looks fine
adding baq, fine
HWE etc P=24


chr17_random looks fine run with mus_angsd_filter.sh

running this again
qsub -S /bin/bash -v chr=chr9_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_err \
 -N mus9r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh
… chr 19 still bad


trying chr19 again


### running humans again with min of only 20 individuals min depth 100 max depth 700



#####I need to be able to test options quickly on small bits of data from different chromosomes, 
## I need to figure out how to index these (why samtools gives an error)

samtools sort -o AH15_chr19.sorted.bam AH15_chr19.bam
samtools index AH15_chr19.sorted.bam


### added sort and index as last part of alignment filtering

qsub -S /bin/bash -v indv=AH15-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH15_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH15_fer \
 -N AH15filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads.sh

AH15
AH23
JR11
JR15
JR2-F1C
JR5-F1C 
JR7-F1C
JR8-F1A  

qsub -S /bin/bash -v indv=AH23-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH23_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/AH23_fer \
 -N AH23filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads.sh


qsub -S /bin/bash -v indv=JR8-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR8_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR8_fer \
 -N JR8filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads.sh





qsub -S /bin/bash -v indv=JR2-pe -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR2_fout \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/out/JR2_fer \
 -N JR2filt \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_filterreads.sh

AH15
AH23
JR11
JR15
JR2-F1C
JR5-F1C 
JR7-F1C
JR8-F1A  



### sort and index human bans ###

qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_err \
 -N index22 \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_sort_index.sh

## run on all YRI chromosomes
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/index${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/index${c}_err \
   -N index${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_sort_index.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt


######## testing 
running this again
qsub -S /bin/bash -v chr=chr9_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_err \
 -N mus9r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh
… chr 19 still bad


qsub -S /bin/bash -v chr=chr9_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd9r_err \
 -N mus9r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_sort_index.sh


while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N musindex${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_sort_index.sh
done < mus_chr.txt


######## February 15, troubleshooting human angsd ####

### test chromosome 22 with new filtering ##
qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_err \
   -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter.sh
#### this resulted in a bunch of nans… I guess no data? decreasing number of required individuals to 1/4 because it is very low coverage — 22 individuals required

NAN, 0s here with these parameters
-doSaf 1 \
    -doCounts 1 \
    -ref /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    -anc /seq/vgb/linda/bal_sel/angsd_test/chimpHg19.fa \
    -GL 2 \
    -P 24 \
    -C 50 \
    -minInd 22 \
    -domaf 1 \
    -doMajorMinor 1 \
    -hwe_pval 1e-6 \  ### this is not really a filter, it excludes everything
    -baq 1 \
    -remove_bads 1 \
    -only_proper_pairs 1 \
    -uniqueOnly 0 \
    -setMinDepth 100 \
    -setMaxDepth 700 \
    -minMapQ 20 \
    -minQ 20 \
    -out $outpath/YRIrentsoutFold_$chr \
    -fold 1



http://yangjl.com/en/notes/2015/05/27/angsd/
https://github.com/mfumagalli/WoodsHole/blob/master/Files/filtering.md


##### the -hwe-pval is clearly my problem. I will just output p-values but not filter on them.

checking HWE
ond to 6.634897 likelihood units
 -> HWE-filter using a pvalue: 1.0000e-06 correspond to 23.9281 likelihood units (used 1e-6)
 -> Parsing 87 number of samples 
 -> Region lookup 1/1

 -> We have now allocated approximately 10 Mega
keep getting segmentation fault


######## February 16, back to mus #########

qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_err \
 -N mus19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh



### got rid of HWE and chr19 still is all 1.3-1.4 vale for tajd

qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd19_err \
 -N mus19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh

qsub -S /bin/bash -v chr=chr8_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/ang8r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/ang8r_err \
 -N mus8r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh

qsub -S /bin/bash -v chr=chr16_random -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd16r_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/angsd16r_err \
 -N mus16r \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter_test.sh




I have learned that the HWE filter doesn’t work and that the files are appended, not overwritten
these parameters also mess it up:
    -doSnpStat 1 \
    -snp_pval 1e-6 \





###### I don’t have time, I’m going to assume the bans I have are okay for now…

qsub -S /bin/bash -v chr=chr22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/index22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/index22_err \
 -N c22 \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_sort_index.sh


while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/index${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/index${c}_err \
   -N index${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_sort_index.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt


qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_err \
   -N chr21tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter.sh


### get a small portion of chromosome 1 to use as test for liftover
qsub -S /bin/bash -v chr=1 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd1_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd1_err \
   -N chr1htest /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter_test.sh

#### test liftover
qsub -S /bin/bash -v chr=1 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd1_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd1_err \
   -N chr1htest /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover_1dir.sh




###### YRI_angsd_musmimmic.sh
works on small region     -r 1:20000785-20060785 \

testing on smallest chromosome

qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd22_err \
   -N chr22tajd /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_filter_musmimic.sh

qsub -S /bin/bash -v chr=22 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift22_err \
   -N chr22lift /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover_1dir.sh


look at new outputs mus chromosome 18 and human chromosome 22

### try with same ref
qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_err \
   -N chr21tajd /wga/scr4/vgbgrp/linda/bal_sel/angsd_YRI_filter.sh … seg falut

qsub -S /bin/bash -v chr=21 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd21_err \
   -N chr21tajd /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_filter_musmimic.sh

## run all human, started Feb 18 with 2kb windows
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_err \
   -N YRIangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_filter_musmimic.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt




qsub -S /bin/bash -v chr=chr18 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift18_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/lift18_err \
 -N lift18 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh

### sticking with 2kb windows. 3kb windows is only about 60% of the data

################ 
# look at read depth again

chr=chr22
outpath='/wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/chimp_bams_'$chr

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/chimp$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 20 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 5 \
    -uniqueOnly 1 \
    -maxDepth 300 \
    -GL 2 \
    -baq 1 \
    -ref /seq/vgb/references/chimp/panTro2.fasta \
    -out $outpath/chimpfilterfeb18_$chr



# figure out mus depth
 ~22x average coverage

outpath='/wga/scr4/vgbgrp/linda/bal_sel/mus_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/mus_bams/mus_bams_'$chr

### “new” has no unique only 
###this was not available: got rid of short scaffolds <2kb (-minChunkSize 2000)

#set maxdepth to 360 (more than double what we expect for 8 individuals with 22x coverage each)

chr=chr19
outpath='/wga/scr4/vgbgrp/linda/bal_sel/mus_out/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/mus_bams/mus_bams_'$chr

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/mus$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 20 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 4 \
    -uniqueOnly 0 \
    -maxDepth 360 \
    -GL 2 \
    -baq 1 \
    -ref /seq/references/Mus_musculus_assembly9/v1/Mus_musculus_assembly9.fasta \
    -out $outpath/musfilterfeb18_$chr


#### human depth
#set maxdepth to 1000 (more than double what we expect for 120 individuals with 4x coverage each)

chr=22
outpath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/read_depth'
bampath='/wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/YRI_bams_chr'$chr

/seq/vgb/linda/bin/angsd/angsd -bam $bampath/YRIrentschr22.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 20 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 22 \
    -uniqueOnly 0 \
    -maxDepth 1000 \
    -baq 1 \
    -ref /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta \
    -out $outpath/YRIfilterfeb18_$chr



####################### Filter and align chimpanzee reads ################### February 18, 2016

From Panmap:
DNA samples, library preparation, and sequencing
DNA was obtained from EBV-immortalized cell lines of 10 unrelated Western
chimpanzees (Pan troglodytes verus) housed at the Biomedical Primate Research
Centre. The sample consisted of 9 females and one male (Table S1). Shotgun
paired-end libraries were prepared for the Illumina chemistry using adaptive
focused acoustics (Covaris, Massachusetts) for DNA fragmentation. Samples
were fragmented to 500bp and size selected with a 450bp insert size. Libraries
were subsequently sequenced on the Illumina Genome Analyzer II platform
using a combination of v2 paired end cluster generation kits (1.4mm flow cell)
with v3 cycle sequencing kit and v6 GA recipe and v4 paired end cluster
generation kits with v4 cycle sequencing kit and v7 GA recipe. Initial data
processing was conducted using the default Illumina software.


#########Illumina Oligonucleotide Sequences for Paired End DNA (https://support.illumina.com/content/dam/illumina-support/documents/documentation/chemistry_documentation/experiment-design/illumina-adapter-sequences_1000000002694-00.pdf)

PE Adapters
5' P-GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG <-  
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT <- fwd aka P5


P5_ADAPTER——FWD_PRIMER|———————insert———————|REV_PRIMER—P7_PRIMER



PE PCR Primer 1.0
5' AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
PE PCR Primer 2.0
5' CAAGCAGAAGACGGCATACGAGATCGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT
PE Read 1 Sequencing Primer
5' ACACTCTTTCCCTACACGACGCTCTTCCGATCT
PE Read 2 Sequencing Primer
5' CGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT



R1A=======================================R2A
   >>>>>>>>
                                 <<<<<<<<<

  >      <
R1A======R2A
   >>>>>>>>
<<<<<<<<<



##################

sample individual:
/wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_1.fastq.gz
/wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_2.fastq.gz

### check for adapters
zgrep 'ACACTCTTTCCCTACACGACGCTCTTCCGATCT' /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_2.fastq.gz

zgrep 'GAGATCGGAAGAGC' /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_2.fastq.gz

# this sequence appears in the fwd read: GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG
zgrep GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_1.fastq.gz
# this sequence appears in the rev read: ACACTCTTTCCCTACACGACGCTCTTCCGATCT
zgrep ACACTCTTTCCCTACACGACGCTCTTCCGATCT /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_2.fastq.gz

use Python-2.7
# fwd read
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_1.fastq.gz | \
	cutadapt -a GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG - \
		--discard-untrimmed \
		--discard-trimmed &
# rev read
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225036_2.fastq.gz | \
	cutadapt -a ACACTCTTTCCCTACACGACGCTCTTCCGATCT - \
		--discard-untrimmed \
		--discard-trimmed \
		--info-file=/home/unix/boettger/cut_adapt_info2.txt &



align to:

/wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBV.fasta



########## for each individual, trim reads and align to reference ####

ERR225027_1.fastq.gz*  ERR225029_1.fastq.gz*  ERR225031_1.fastq.gz*  ERR225033_1.fastq.gz*  ERR225035_1.fastq.gz*
ERR225027_2.fastq.gz*  ERR225029_2.fastq.gz*  ERR225031_2.fastq.gz*  ERR225033_2.fastq.gz*  ERR225035_2.fastq.gz*
ERR225028_1.fastq.gz*  ERR225030_1.fastq.gz*  ERR225032_1.fastq.gz*  ERR225034_1.fastq.gz*  ERR225036_1.fastq.gz*
ERR225028_2.fastq.gz*  ERR225030_2.fastq.gz*  ERR225032_2.fastq.gz*  ERR225034_2.fastq.gz*  ERR225036_2.fastq.gz*

ERR225036 is already running on interactive node. Finished, but these errors at end:
[M::process] read 3141568 sequences (160000007 bp)...
[M::mem_process_seqs] Processed 3141618 reads in 1515.779 CPU sec, 187.978 real sec
[E::sam_parse1] SEQ and QUAL are of different length
[W::sam_read1] parse error at line 327099509
[main_samview] truncated file.




ERR225027 sent to vert scheduler, but there were errors?
qsub -S /bin/bash -v indiv=ERR225027 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign_err \
   -N ch27aln /wga/scr4/vgbgrp/linda/bal_sel/chimp_trim_bwa.sh

W::bseq_read] the 1st file has fewer sequences.
[M::mem_process_seqs] Processed 1594264 reads in 1126.348 CPU sec, 79.039 real sec
[W::bseq_read] the 1st file has fewer sequences.
[main] Version: 0.7.12-r1039
[main] CMD: bwa mem -t 16 /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBV.fasta /dev/fd/63 /dev/fd/62
[main] Real time: 13401.213 sec; CPU: 196701.988 sec
close failed in file object destructor:
sys.excepthook is missing
lost sys.stderr



############################## mus check ###################################
####### looking for adaptor sequences.. I think they were trimmed off
ACACTCTTTCCCTACACGACGCTCTTCCGATCT

zgrep 'ACACTCTTTCCCTACACGACGCTCTTCCGATCT' /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/mus/SN7640093_2764_JR15_1_1_sequence.fq.gz 
AGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCCATAGGGGGTGGTGATATTTGGGTGGGGGCGCCTATGAGAGAGAGATAGTGGGGGCGAGTC
TCTACACTCTTTCCCTACACGACGCTCTTCCGATCTGTCTCACCTGCTGCAGGGCCCAGGTATGAGTTCAACCTCACACTGCAGCAGGTGAGACAGATCGG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTACATATCACCATTATCGAACTCAACGCCCTGCATACGAAAAGACAGAATCTCTTCCAAGAGCTTGATG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTTATTTGTCTCCAGCCACTTAAGTGAGGTGATTTATGTTTGGTGCTATTGCTGGCGACAAATCAAGAT
TGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTTGTGAGATTTATAATAGTGTAGCAGTTACCTTCTGTCAGTGTAGCGAATG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTCTTTGTTCCTGAGCATGGCACTATGTTTACTCTTGCGCTTGTTCAGGAACAAAGAAGATCGGAAGAG
ATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTGTATCTTTGCTCAACCAGTGAGCAAAGATACAGATCGGAAGAGCACACGTCTGAACTCCAGTCA
TCTACACTCTTTCCCTACACGACGCTCTTCCGATCTTATCAGTATGAACTTGAACTTCAAGGTCTTTTGCACAGGAGTTAATTCTCAGATGAATCCCCAGT
AAGAGAAAGAAAAAAAAGTGAATGGAGTTCAGACGTGTGCTCTTCCGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTAGATCGGAAGAGCACAC
ACACTCTTTCCCTACACGACGCTCTTCCGATCTTGTGAGGATTTTATAGAGTATTTTTGCATCGATATTTATAAGGGAAATTGCTCTGAAGTGCTTTTTTT
ACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTACACCTCTCTTAGTACATAATAATTTGTTAATCAATCTCCCTTTAATTT
ATCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCGGAAAATGAGAAATACACACTTTAGGACGTGAAAAATGACGAAATCACTGAAAAACGTGGAAA
ACACTCTTTCCCTACACGACGCTCTTCCGATCTGTGGACATTTCTATATTTTCCAAATTTTTTAGTGTTCCTCTACATATTTTATGCACTAAAGTTTGTAT
ATTTACACTCTTTCCCTACACGACGCTCTTCCGATCTTTTTGGAAATCCGTTCATCAAGACAAAGAAGACCAGGCTGAGGGAATATGAGGGGCTAGTCACG
ACACTCTTTCCCTACACGACGCTCTTCCGATCTATGGTCAATATAACCAGCAGTGTTAACAGTCGGGAGAGGAGTGGCATTAACACTGCTGGTTATATTGA
CTGATACGGCGACCACCGAGNTCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCGTGTTGTTGCTTGTCGGTGGAGGCCTGGGGAATAAAAGGAAGG
… that’s it

but this has a lot….
zgrep 'GAGATCGGAAGAGC' /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/mus/SN7640093_2764_JR15_1_1_sequence.fq.gz


zgrep 'GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG' /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/mus/SN7640093_2764_JR15_1_1_sequence.fq.gz
 

grep -c "^GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG" *.fastq
grep -c "GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG$" *.fastq
grep -c "GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG" *.fastq

# Pull out ~500 reads that have the adaptor (GATACGG....) and get their read IDs, so we can grep for them in the BAM.

# -B1 gets the line directly above, which has the ID. the grep -Po grabs the part that matches the perl regular expression
zgrep -B1 GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG /wga/scr4/vgbgrp/linda/bal_sel/mus_fastq/mus/SN7640093_2764_JR15_1_1_sequence.fq.gz \
    | grep -Po ‘^@.*?\s’ \
    | head -1000 > \
    ~/mus_rev_adapter_fwd_read_ids.txt
# now grep for these read IDs in the bam file
use Samtools
samtools view JR15-pe.bam | awk '{print $1}' | grep -f ~/mus_rev_adapter_fwd_read_ids.txt > ~/mus_rev_adapter_fwd_read_sam.txt &



############# get ML estimate of SFS for chr1 in mus ###########

### i commented out portions of code that don’t relate to getting ML estimate
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/ML1_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/ML1_err \
 -N ML1 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh




!!!!!!!!!!!!!!!!!!!!!!!!!!! did this work?, start other chromosomes !!!!!!!!!!!!!!

while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mus${c}_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mus${c}_err \
 -N mus${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt


!!!!!!!!!!!!!!!!!!!!!!!!!!!

while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mlift_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mlift_err \
 -N mlift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt


### combine mus files
cd /wga/scr4/vgbgrp/linda/bal_sel/mus_out/mus_out_lifts1
cat * > ../mus_allliftchr.bed







######## 2016.02.20 Separately trim chimp files using GridEngine Jobs
qsub -S /bin/bash \
    -v indiv=ERR225027 \
    -v read=1 \
    -v adapter=GATCGGAAGAGCGGTTCAGCAGGAATGCCGAG \
    -q vert -M boettger@broadinstitute.org \
    -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chtrim_r1_out \
    -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chtrim27_r1_err \
    -N ERR225036_r1_trim /wga/scr4/vgbgrp/linda/bal_sel/chimp_cutadapt_single.sh
   
qsub -S /bin/bash \
    -v indiv=ERR225027 \
    -v read=2 \
    -v adapter=ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
    -q vert -M boettger@broadinstitute.org \
    -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chtrim_r2_out \
    -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chtrim27_r2_err \
    -N ERR225027_r2_trim /wga/scr4/vgbgrp/linda/bal_sel/chimp_cutadapt_single.sh



ERR225027_1.fastq.gz*  ERR225029_1.fastq.gz*  ERR225031_1.fastq.gz*  ERR225033_1.fastq.gz*  ERR225035_1.fastq.gz*
ERR225027_2.fastq.gz*  ERR225029_2.fastq.gz*  ERR225031_2.fastq.gz*  ERR225033_2.fastq.gz*  ERR225035_2.fastq.gz*
ERR225028_1.fastq.gz*  ERR225030_1.fastq.gz*  ERR225032_1.fastq.gz*  ERR225034_1.fastq.gz*  ERR225036_1.fastq.gz*
ERR225028_2.fastq.gz*  ERR225030_2.fastq.gz*  ERR225032_2.fastq.gz*  ERR225034_2.fastq.gz*  ERR225036_2.fastq.gz*

!!!!!!!! check length before running bwa 
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_1.trim.fastq.gz | wc -l > ~/trim1len.txt
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_2.trim.fastq.gz | wc -l > ~/trim2len.txt

/wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign_err

qsub -S /bin/bash \
    -v indiv=ERR225027 \
    -q vert -M boettger@broadinstitute.org \
    -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign_out \
    -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign27_err \
    -N algnERR27 /wga/scr4/vgbgrp/linda/bal_sel/chimp_bwa_trimmed.sh
ERROR:
[mem_sam_pe] [mem_sam_pe] paired reads have different names: "ERR225027.340334278", "ERR225027.340334277"
paired reads have different names: "ERR225027.340334276", "ERR225027.340334275"

grep "paired reads have different names"  /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chalign_err
[mem_sam_pe] paired reads have different names: "ERR225036.308030421", "ERR225036.308030433"
[mem_sam_pe] paired reads have different names: "ERR225034.192044046", "ERR225034.192044036"
[mem_sam_pe] paired reads have different names: "ERR225035.330671413", "ERR225035.330671412"
[mem_sam_pe] paired reads have different names: "ERR225029.356801337", "ERR225029.356801323"
[mem_sam_pe] paired reads have different names: "ERR225033.368196972", "ERR225033.368196959"
[mem_sam_pe] paired reads have different names: "ERR225030.285131595", "ERR225030.285131590"
[mem_sam_pe] paired reads have different names: "ERR225031.315315602", "ERR225031.315315598"
e] paired reads have different names: "ERR225028.314723263", "ERR225028.314723240"
[mem_sam_pe] paired reads have different names: "ERR225035.330671415", "ERR225035.330671414"
[mem_sam_pe] paired reads have different names: "ERR225029.356801316", "ERR225029.356801309"
[mem_sam_pe] paired reads have different names: "ERR225033.368196950", "ERR225033.368196947"





also 33
the 1st file has fewer sequences.
[mem_sam_pe] paired reads have different names: "ERR225033.368196950", "ERR225033.368196947"


zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_1.fastq.gz | wc -l
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_2.fastq.gz | wc -l

zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_1.trim.fastq.gz | wc -l
zcat /wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/ERR225027_2.trim.fastq.gz | wc -l


ERR225027_1.trim.fastq.gz



“Input file /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams_new/ERR225028.sortedRG.bam is not coordina
te sorted.” I think I need to add read group info before I sort. sorting is now last step before mark duplicates
qsub -S /bin/bash \
    -v indv=ERR225029 \
    -q vert -M boettger@broadinstitute.org \
    -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chfilter_out \
    -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chfilter29_err \
    -N filt29 /wga/scr4/vgbgrp/linda/bal_sel/chimp_filterreads.sh

Korneliussen
###### error 

on add or replace read groups step:
Exception in thread "main" htsjdk.samtools.SAMFormatException: SAM validation error: ERROR: Record 2724745, Read name ERR225028.286625334, Zero-length read without FZ, CS or CQ tag
http://gatkforums.broadinstitute.org/gatk/discussion/1922/how-can-i-fix-an-arrayindexoutofboundsexception-how-can-i-fix-the-bam-file
“To resolve this problem, we ran the bam file through "grep -v null" removing all the lines with 'null' in them.”


samtools view ERR225028.sorted.bam | grep ERR225028.286625334

while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/lift${c}_err \
 -N humlift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_liftover_1dir.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt

#cat chromosome files
cd /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/YRI_out_lifts/chimp_comp
cat * > ../YRI_allchimplift.bed



cd /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/YRI_out_lifts/mus_comp
cat * > ../YRI_allmuslift.bed


############# don’t lift over human sequence ########## get output from windows

while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_err \
 -N humnolift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_nolift_output.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt

cd /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/YRI_out_unlifted
cat * > ../YRI_unlifted.bed



gunzip -t ERR225028_2.fastq.gz



path="/wga/scr4/vgbgrp/linda/bal_sel/chimp_fastq/"
indivs=$(ls -al $path/ERR*.fastq.gz | perl -pe 's/.*(ERR\d+).*/$1/' | uniq)
reads="1 2"

for indv_i in $indivs; do
    for read_i in $reads; do
        echo "Checking line count for FASTQ $indv_i $read_i"
        qsub -S /bin/bash \
            -v indv=$indv_i -v read=$read_i\
            -q vert -M boettger@broadinstitute.org \
            -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/${indv_i}_${read_i}_wc_out \
            -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/${indv_i}_${read_i}_wc_err \
            -N wc_$indv_i /wga/scr4/vgbgrp/linda/bal_sel/check_fastq_len.sh
    done
done


/wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/ERR225029_1_wc_err


############# get ML estimate of SFS for chr22 in chimp ###########

### i commented out portions of code that don’t relate to getting ML estimate
qsub -S /bin/bash -v chr=chr22 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/ML22_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/ML22_err \
 -N ML22chimp \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh


### i commented out portions of code that don’t relate to getting ML estimate
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/ML1_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/ML1_err \
 -N ML1chimp \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh


## run all chromosomes
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_err \
   -N ch_angsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt


/wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsdchr16_err



while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_err \
   -N ch_angsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt



cat pt2* > all/chimp_lift_allchr.bed





############### get CNV calls for my YRI individuals ################
use Tabix
use VCFtools


cd /wga/scr4/vgbgrp/linda/bal_sel/CNV
wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase3/integrated_sv_map/ALL.wgs.integrated_sv_map_v2.20130502.svs.genotypes.vcf.gz

wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase3/integrated_sv_map/ALL.wgs.integrated_sv_map_v2.20130502.svs.genotypes.vcf.gz.tbi


####### get only YRI, variable sites, pass filter
vcftools --gzvcf ALL.wgs.integrated_sv_map_v2.20130502.svs.genotypes.vcf.gz --keep /wga/scr4/vgbgrp/linda/bal_sel/CNV/YRI_1kg.txt --maf 0.004 --remove-filtered-all --recode --out ALL.wgs.integrated_sv_map_v2.20130502.svs.genotypes_YRI.vcf


downloaded start and stop locations for 1kg SV
1KG_phase3_all_bkpts.v5.txt


will get start and end locations, only take stuff longer than 50bp




panel file:ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/integrated_call_samples_v3.20130502.ALL.panel


#### also should filter out stuff shorter than read length


-remove YRI CNVs
- overlapping regions, shuffle tajD, how many overlap>?
- average regions size ?
- how many overlap genes? vs 
- plot a few interesting regions
- regions overlapping cercadian rhythm SNPs
http://www.nature.com/ncomms/2016/160202/ncomms10448/full/ncomms10448.html




###############
1. Try coalescence simulations a few times
2. If that doesn’t work, go back to gene overlap

29691116
33054976




####### March 21 2016

My sample size is a bit small for Taj D

Here is a stat independent of sample size
http://www.genetics.org/content/186/1/353

balancing selection with small sample size

There is a simple scaling that does not suffer from this problem. The recipe is to write the weights as functions of the frequency f = i/n instead of the allele count i. These weight functions ω(f), ω′(f) should not depend explicitly on n. Then these functions can be easily normalized to obtain the weights

### this may be useful for telling correlation between signals in the genome
http://genometricorr.sourceforge.net/GenometriCorr.pdf



######## March 22
cat /seq/vgb/references/chimp/panTro2.fasta /wga/scr4/vgbgrp/linda/bal_sel/references/EBV_g.fa

using the reference that vgb already has (this better matched molly’s one before)
cat /seq/vgb/references/chimp/panTro2.fasta /wga/scr4/vgbgrp/linda/bal_sel/references/EBV_g.fa > /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBVnew.fasta

#use Picard-Tools
picard='/home/unix/boettger/bin/picard-tools-2.0.1'


java -jar CreateSequenceDictionary.jar R= /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBVnew.fasta O= /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBVnew.dict

java -jar $picard/picard.jar CreateSequenceDictionary R= /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBVnew.fasta O= /wga/scr4/vgbgrp/linda/bal_sel/references/panTro2_EBVnew.dict
---> bleh, something is still wrong here.. 

### I want to map to Pantro2 to stay consistent with pan map

grep ">" /seq/references/Homo_sapiens_assembly19_1000genomes_decoy/v1/Homo_sapiens_assembly19_1000genomes_decoy.fasta
NC_007605
the v1 in /seq/references has the human decoy sequence and EBV http://www.ncbi.nlm.nih.gov/nuccore/82503188




########## get baboon fastq
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1515160/SRR1515160.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1515161/SRR1515161.sra need
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1515162/SRR1515162.sra need
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1515159/SRR1515159.sra need

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1516196/SRR1516196.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1516197/SRR1516197.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1516198/SRR1516198.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1516199/SRR1516199.sra


Pacbio:
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR203/SRR2032667/SRR2032667.sra

pacbio from SRS661352
ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR170/SRR1700532/SRR1700532.sra
ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR170/SRR1700533/SRR1700533.sra need


/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq/SRR1516199.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq

/seq/vgb/software/ncbi/bin/fastq-dump -I --split-3 /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq/SRR1700532.sra --gzip --outdir /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq

http://www.homolog.us/blogs/blog/2013/10/28/bwa-mem-good-blasr-aligning-pacbio-reads-part-2/

###### these files are pretty scattered and half are pacbio... it will be time consuming analysis



######## march 28th, 2016
I still may want to mark duplicates with chimp, looking at strand bias they do look like maybe dups weren’t removed???

# Right now I’m going to concentrate on filtering strand bias and HWE from human and mouse

### maybe best idea is to remove problem alleles from the thetas file then re-calculate sliding windows




########## April 15, 2016
Getting code for HP paper to give other labs
below is what was used.... I should confirm the input file is the same as what was given to NG

################# march 23 2015 #################

Allpop_spiderinput_1kg_20hkb.phasedpastel.ap23colfix.txt was saved as HP_Fig4_data.txt
plot_spidergram_paper_Hpr_smalldots.py was saved as HP_Fig4.py


#April 19 2016, test HWE and SB code filtering for mus

qsub -S /bin/bash -v chr=chr19 -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/HWESB_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/HWESB_err \
 -N filtmus19 \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh


### run on all mus chr
while read c; do
 qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mfilt_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mfilt_err \
   -N mfilt${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_angsd_filter.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt



##then redo liftover
while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mlift_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/mlift_err \
 -N mlift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/mus_chr.txt


### combine filtered mus files
cd /wga/scr4/vgbgrp/linda/bal_sel/mus_out/mus_out_lifts1
cat * > ../mus_filteredliftchr.bed


# problem with human reference
Reading fasta: /seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta
        -> fai index file: '/seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta.fai' looks older than corresponding fastafile: '/seq/references/Homo_sapiens_assembly19/v1/Homo_sapiens_assembly19.fasta'.
        -> Please reindex fasta file

now using /seq/references/Homo_sapiens_assembly19_1000genomes_decoy/v1/Homo_sapiens_assembly19_1000genomes_decoy.fasta
it’s the same, just with EBV genome


#### I’m getting SNP stats and saf for chr22 in humans
## after that I should be ready 

## checking one
qsub -S /bin/bash -v chr=20 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd20_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd20_err \
   -N chr20tajd /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_filter_musmimic.sh


running all

while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/angsd${c}_err \
   -N YRIangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_filter_musmimic.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt


while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_err \
 -N humnolift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_nolift_output.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt

cd /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/YRI_out_unlifted
cat * > ../YRI_unlifted.bed




#### do HWE and SB filtering for chimp
## I’m sticking with molly’s bams for now. They have already called SNPs this way and done trans-species poly like this

while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd${c}_err \
   -N cangsd${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt



### liftover chimp
while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift${c}_err \
   -N chimplift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt

cat * > combined/chimp_mostchr_lifted1.bed


local qscore recalibration with the BAQ model

## get number of windows in mouse genome (this -30 for the header lines)
wc -l mus_out_*/musfiltered_*.thetasWindow.gz.pestPG

4848187


wc -l chimp_out_*/chimpfiltered_*.thetasWindow.gz.pestPG



######## checking what percent lifts over at what length



qsub -S /bin/bash -v bp=50 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/50bp_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/50bp_err \
   -N mus50bp /wga/scr4/vgbgrp/linda/bal_sel/mus_Xbp.sh


qsub -S /bin/bash -v bp=100 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/100bp_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/100bp_err \
   -N mus100bp /wga/scr4/vgbgrp/linda/bal_sel/mus_Xbp.sh

qsub -S /bin/bash -v bp=1000 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/1000bp_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/1000bp_err \
   -N mus1000bp /wga/scr4/vgbgrp/linda/bal_sel/mus_Xbp.sh

qsub -S /bin/bash -v bp=2000 -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/2000bp_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/2000bp_err \
   -N mus2000bp /wga/scr4/vgbgrp/linda/bal_sel/mus_Xbp.sh


qsub -S /bin/bash -v bp=4k_2kstep -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/m4k_2k_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/m4k_2k_err \
   -N m4k_2k /wga/scr4/vgbgrp/linda/bal_sel/mus_4kb_2kbstep.sh


############ 50bp still only gets me 1/3 of the genome 

It looks like there are some leftover options
-multiple option which allows the use of multiple chains. This then allows you to also use the minSizeT, minSizeQ, minChainT, minChainQ, and chainTable options 

http://redmine.soe.ucsc.edu/forum/index.php?t=msg&goto=17412&S=5d97f8086591b7b5f1543ad7d8b054e3


## determine parameters for mus
### must and human are about 33% diverged
X -minMatch=0.67... this only gets average and above
-minmatch=0.6

but minMatch actually filters for how much
of the query sequence is successfully mapped to the new target species,
even if that mapping involves mismatched bases. As one of our engineers
describes it, the minMatch parameter is about coverage rather than identity.

http://genome.soe.ucsc.narkive.com/ZDea3cVH/liftover-mm9-to-hg19-is-only-30-mappable
they do mismatch is 0.1

### allow multiple output regions
-multiple

## minimum mapping size in target
-minSizeT 200

## minimum mapping size in query
-minSizeQ 200



############# April 27 2016
Based on test runs with mis, I have decided to use minMatch=0.1, and a window length of 4kb (1kb step). This should get about 78% mapped for mus, and the shortest segment will be 400bp (10% must match)

Find best liftover length for mus	total 	lifted 	percent		unmapped4000 bp				minMatch=0.1	100088	78049	0.779803773	shortest is 400bp


## I will delete everything on the server past the window step and re-run for human, chimp and mus



##!!!!!!!!!!!!!! OMG, I just noticed chimp 2a and 2b are not there, I had it listed as chr2!!!!
# I will worry about this later, for now I will do analysis just on chromosome 1 and chromosome 6 (HLA)



qsub -S /bin/bash -v chr=chr2a -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr2_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr2a_er \
 -N chr2a \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_sort_index.sh 


qsub -S /bin/bash -v chr=chr2b -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr2b_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/chr2b_er \
 -N chr2b \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_sort_index.sh  



### get sliding window TajD for 2a and 2b

qsub -S /bin/bash -v chr=chr2a -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd2a_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd2a_err \
   -N cangsd2a \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh


qsub -S /bin/bash -v chr=chr2b -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd2b_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/angsd2b_err \
   -N cangsd2b \
   /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_filter_musmimic.sh




### liftover 2a and 2b

  qsub -S /bin/bash -v chr=chr2a -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift2a_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift2a_err \
   -N lift2a \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh

qsub -S /bin/bash -v chr=chr2b -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift2b_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500/out/lift2b_err \
   -N lift2b \
   /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh


cat * > combined/chimp_ALLchr_lifted1.bed



#### june 16, 2016, make PCAs for each species ###



########## Get Gorilla sequence ########

outdir=/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams
wget -O /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/Dian1.sra ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748197/SRR748197.sra

Western_lowland_gorillas_download.sh


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla.er \
 -N gorilla \
 /wga/scr4/vgbgrp/linda/bal_sel/Western_lowland_gorillas_download.sh








/seq/vgb/software/ncbi/bin/sam-dump /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/Dian1.sra

This was not submitted as an aligned BAM
HWI-ST700660_66:7:1:12843:17426	4	*	0	0	*	*	0	0	TCTCTTAGGCCCCACTGAAAGGTATCTGATACCTCTGTAGCAAAACACAGAGCAAAGAAAGGAGGAGAGAGGAAGAAAATCTGAAAATTACTCTAAATTT	GGGGGGGGGGGGGGGEGGGFEE;BEEEEBDGF=DFEFCFCCGCEA??@FC?EF>D7AA##########################################
HWI-ST700660_66:7:1:12944:17428	4	*	0	0	*	*	0	0	CAACAAATCAAAGCTTTGTCTGACTCCACATTGTCACTAGACCAGTGATTATTGTCCTGACTCAGGTCAGTACTATCCTGGTAGCAAAAGCTGGCTGTAA	HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHFHHHFFEHHFFFEEE:EEEBEEFFFFE9BED5CB@BEED=CA;CED>5@############
HWI-ST700660_66:7:1:12965:17433	4	*	0	0	*	*	0	0	TGCCACCAGGTAGCCTCAAAATTCTGAGCAAGTTCCTTAGCCTTTCAAAATGTTATTCCGCTCACAGATTTGTAACAAAxGATCAAACGAGAATGTATGAA	HHEHHHHHHDEGDGGGGFGGHGGHF<FAFFGGEBGGGFEGHHFDHHGDHBHEAFHFEGBHEFEFH@E3<D

I should get the Fastqs and align them


#### look at baboon bams?? #######
/seq/vgb/software/ncbi/bin/sam-dump /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq/SRR1516197.sra > /wga/scr4/vgbgrp/linda/bal_sel/baboon_fastq/SRR1516197.sam 

won’t dump as sam...

/seq/vgb/software/
use Java-1.8
java -Xmx1000m -jar beagle.16Jun16.7e4.jar







########## download brown rats ###########
http://mbe.oxfordjournals.org/content/32/10/2547.full.pdf+html
http://www.ebi.ac.uk/ena/data/view/ERP001276&display=html


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/ratdown.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/ratdown.er \
 -N sra \
 /wga/scr4/vgbgrp/linda/bal_sel/brownrat_download.sh




######## align gorillas to reference #######

while read c; do
  qsub_str="qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_lastlift.sh"
  echo $qsub_str
done < gorilla_indivs.txt



###### get gorilla reference ######
## all gorillas from great ape genome project are source from blood, so just the gorilla genome is fine withot a viral genome

## prep reference 
#http://gatkforums.broadinstitute.org/gatk/discussion/1601/how-can-i-prepare-a-fasta-file-to-use-as-reference

use Java-1.8
picard='/home/unix/boettger/bin/picard-tools-2.0.1'
java -jar $picard/picard.jar CreateSequenceDictionary R= /seq/vgb/references/gorilla/gorGor4.fa O= /seq/vgb/references/gorilla/gorGor4.dict


samtools faidx gorGor4.fa 


Kowali1.sra

qsub -S /bin/bash -q vert -v indv=Kowali1.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor1 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh

qsub -S /bin/bash -q vert -v indv=Kowali2.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor2 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh

qsub -S /bin/bash -q vert -v indv=Kowali3.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor3 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh

qsub -S /bin/bash -q vert -v indv=Kowali4.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor4 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh


### run gorillas in groups so not to overwhelm server
## gorilla_indvs2-5
while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/${c}_err \
   -N ${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/gorilla_indvs5.txt


qsub -S /bin/bash -v indv=Choomba4new.sra -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/Choomba4new_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/Choomba4new_err \
   -N Choombanew4 \
   /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh


Choomba4.sra


### combine the bams by individual and filter them 
qsub -S /bin/bash -q vert -v indv=Kowali -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/Kocomb.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/Kocomb.er \
 -N Kowali \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_combine_filter.sh





### combine the bams by individual and filter them 
#test new on Bulera
qsub -S /bin/bash -q vert -v indv=Bulera -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gorcomb.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gorcomb.er \
 -N Bulerafilt \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_combine_filternew.sh


Finished or running: Kowali, Bulera, Azizi, Suzie, Kokamo, Banjo, Mimi (through indvs2), Dian, Delphi, Sandra, Coco, Kolo, Amani, Abe, Tzambo, Akiba, Paki
Do Choomba once .sra is done!!!
qsub -S /bin/bash -q vert -v indv=KatieB -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/KatieBcomb.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/KatieBcomb.er \
 -N KatieBfilt \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_combine_filternew.sh

folder: /seq/vgb/linda/admixture/10xg
/seq/vgb/linda/admixture/10xg/dogs_meet_Ollie_and_Ruby
tar -xvzf 20160627_ollie_ollie_ruby_asm.tar.gz
tar -xvf Cuishle_domestic_canine_assembly.tar



### align Cuishle to genome
bwa mem -t 8 -x intractg /mnt/opt/refdata_new/hg19-2.0.0/fasta/genome.fa NA12878_megabubbles.fasta > Cuishle-aln.sam



qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/admixture/10xg/out/Cuishlie.out \
 -e /seq/vgb/linda/admixture/10xg/err/Cuishlie.er \
 -N Cuishlie \
 /seq/vgb/linda/admixture/10xg/scripts/Align_10x.sh

##### to call SNPs
#https://www.biostars.org/p/74721/
#http://gatkforums.broadinstitute.org/gatk/discussion/comment/7086#Comment_7086
glm BOTH -minIndelCnt 1 -indelGOP 80 -stand_call_conf 0 -stand_emit_conf 0

PLINK
[mem_sam_pe] [mem_sam_pe] paired reads have different names: "Kowali1.5.1", "Kowali1.5.2"

[mem_sam_pe] paired reads have different names: "Kowali1.4.1", "Kowali1.4.2"


############### getting dog breed reference data ###########
plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine --dog --recode --noweb --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine

/seq/vgb/linda/admixture/boyko_2016

## we have 50 poodles and 304 GR
### get Golden Retrievers
plink --file cornell_canine --dog --keep Poodles.txt --recode vcf-iid --include-alt --out Poodles.vcf
### actually only 26 poodles in this dataset
plink --file cornell_canine --dog --keep Golden_Retrievers.txt --recode vcf-iid --include-alt --out Golden_Retrievers
#274 golden retrievers

### problem... plink to vcc drops the alternate allele when a variant is fixed. Instead i’ll go from Plink to vcf and then do it by breed
plink --file cornell_canine --dog --recode vcf-iid --out cornell_canine

vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

$vcftools --vcf cornell_canine.vcf --keep Poodles_forvcf.txt --recode --out /seq/vgb/linda/admixture/boyko_2016/Poodles.vcf

$vcftools --vcf cornell_canine.vcf --keep Golden_Retrievers_forvcf.txt --recode --out /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers.vcf


Poodles_forvcf.txt

java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar window=200000 overlap=50000 gt=$datafold/Poodles.vcf.recode.vcf out=Poodles_phased


#vcftools preserves phase
https://sourceforge.net/p/vcftools/mailman/message/29918548/

## to t-ped
$vcftools --vcf Poodles_phased.vcf --plink-tped --out Poodles_phased
#Error: Flag Type must have 0 entries: ID=IMP,Number=1,Type=Flag,Description="Imputed marker">
#I should look back at Boyko paper to determine if I want to keep the imputed markers
### maybe remove info tags
http://genome.sph.umich.edu/wiki/Vt#Remove_info_tags

/seq/vgb-HAL/linda/bin/vt/vt rminfo Poodles_phased.vcf -t IMP -o Poodles_phased_rminfo.vcf.....this didn’t work!!! but I just removed the header line on my own

$vcftools --vcf Poodles_phased_rminfo.vcf --plink-tped --out Poodles_phased

java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar window=200000 overlap=50000 gt=$datafold/Golden_Retrievers.vcf.recode.vcf out=Golden_Retrievers_phased

$vcftools --vcf Golden_Retrievers_phased_rminfo.vcf --plink-tped --out Golden_Retrievers_phased


Poodles.vcf.recode.vcf




### Phase breed reference files ####
use Java-1.8
datafold=/seq/vgb/linda/admixture/boyko_2016
java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar gt=$datafold/Poodles.vcf out=$datafold/Poodles_vcf_phased






######## look at brown rat bams, are they ready?
samtools index $mypath/bams/$indiv_id'_out.sorted.bam'


#when 9736_7_sample_52.bam is done, can start browndown1

browndown2.sh

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/ratdown2.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/ratdown2.er \
 -N ebi1 \
 /wga/scr4/vgbgrp/linda/bal_sel/browndown1.sh




### looking at Ginger’s beagle stuff, June 28 #######
mydir='/seq/vgb/ielvers/projects/imputation_Beagle/201606_chr5_Sequenom_GWAS/2_29Mb_33Mb'

/seq/vgb/ielvers/software/plink2 --file $mydir/merge_comb_usaonly_filt_nohomoz_IHSA_IBLSA_Ictrl_QC_29Mb --flip-scan --allow-no-sex --pheno $mydir/flipscan_phenos.txt --out $mydir/merge_comb_usaonly_filt_nohomoz_IHSA_IBLSA_Ictrl_QC_29Mb

### they look fine.. no strand issues

### genotype probabilities aren’t there though

### I don’t think she used the right version of beagle.... this doesn’t work for v4
in_dir=/seq/vgb/ielvers/projects/imputation_Beagle/201606_chr5_Sequenom_GWAS/2_29Mb_33Mb
out_dir=/seq/vgb/ielvers/projects/imputation_Beagle/201606_chr5_Sequenom_GWAS/3_29Mb_33Mb_Beagle4/linda
use Java-1.8
java -Xmx1000m -jar /seq/vgb/ielvers/software/beagle4.jar \
	unphased=$in_dir/merge_comb_usaonly_filt_nohomoz_IHSA_IBLSA_Ictrl_QC_29Mb.ped.bgl \
	markers=$in_dir/merge_comb_usaonly_filt_nohomoz_IHSA_IBLSA_Ictrl_QC_29Mb.map.markers.bgl \
	missing="0" \
	gprobs=true \
	out=$out_dir/merge_comb_usaonly_filt_nohomoz_IHSA_IBLSA_Ictrl_QC_29Mb_bgl



########## combine and filter brown rat bams
using rn5.fa.gz downloaded Sept. 24, 2012 from ftp hgdownload.cse.ucsc.edu, directory goldenPath/rn5/bigZips

Build info from Santa Cruz:
UCSC Genome Browser assembly ID: rn5
Sequencing/Assembly provider ID: RGSC Rnor_5.0
Assembly date: Mar. 2012
GenBank accession ID: GCA_000001895.3
NCBI Genome information: NCBI genome/73 (Rattus norvegicus)
NCBI Assembly information: NCBI genome/assembly/363128 (RGSC Rnor_5.0)
BioProject information: NCBI Bioproject: 16219

File re-ordered to Karyotypic order via line numbers, input and output files the same size:
-rw-rw-r--   1 hensonc seqrefgrp 2967955278 Sep 27 06:51 Rattus_norvegicus.fasta
-rw-rw-r--   1 hensonc seqrefgrp 2967955278 Sep 24 11:48 rn5.fa

Fri Sep 28 03:09:01 2012
Normalized Fasta and BFA file and FAI file and BWA file and sequence dictionary being generated from /seq/references/drop_
box/Rattus_norvegicus.fasta (user hensonc, version 0). Database being updated (including Headers MD5)

/seq/references/Rattus_norvegicus/v0/Rattus_norvegicus.fasta


##### combine brown rat bams, sample_56 is fully downloaded
indv=sample_56
#test on sample_56
Need 48 through 59
I have started 
qsub -S /bin/bash -q vert -v indv=sample_59 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/out/sample_59.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/err/sample_59new.er \
 -N rat_59filt \
 /wga/scr4/vgbgrp/linda/bal_sel/Rat_combine_filter.sh



##### the chromosomes are not the same even though both called rn5!!!!! The version from the broad has many more anchored chromosomes


### download fasts 1-19
qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/out/browndown.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/err/browndown.er \
 -N rat19down \
 /wga/scr4/vgbgrp/linda/bal_sel/fastbrowndown_19.sh


# check that i have 340 when done!!!






myfolder=/wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams
java -jar $picard/picard.jar ValidateSamFile \
     INPUT=$myfolder/9753_1_sample_59.sorted.bam \
     OUTPUT=$myfolder/9753_1_sample_59.sorted_val \
     MODE=SUMMARY

picard='/home/unix/boettger/bin/picard-tools-2.0.1'
myfolder=/wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams
java -jar $picard/picard.jar ValidateSamFile \
     INPUT=$myfolder/sample_59_merged.bam \
     OUTPUT=$myfolder/sample_59_merged_val \
     MODE=SUMMARY









Rat running or finished or problem
[Fri Jul 01 15:36:20 EDT 2016] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 170.54 minutes.
Runtime.totalMemory()=20471873536
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.FileTruncatedException: Premature end of file
 at htsjdk.samtools.util.BlockCompressedInputStream.readBlock(BlockCompressedInputStream.java:382)
 at htsjdk.samtools.util.BlockCompressedInputStream.available(BlockCompressedInputStream.java:127)
 at htsjdk.samtools.util.BlockCompressedInputStream.read(BlockCompressedInputStream.java:252)
 at java.io.DataInputStream.read(DataInputStream.java:149)
 at htsjdk.samtools.util.BinaryCodec.readBytesOrFewer(BinaryCodec.java:404)
 at htsjdk.samtools.util.BinaryCodec.readBytes(BinaryCodec.java:380)
 at htsjdk.samtools.util.BinaryCodec.readBytes(BinaryCodec.java:366)
 at htsjdk.samtools.BAMRecordCodec.decode(BAMRecordCodec.java:199)
 at htsjdk.samtools.BAMFileReader$BAMFileIterator.getNextRecord(BAMFileReader.java:661)
 at htsjdk.samtools.BAMFileReader$BAMFileIterator.advance(BAMFileReader.java:635)
 at htsjdk.samtools.BAMFileReader$BAMFileIterator.next(BAMFileReader.java:629)
 at htsjdk.samtools.BAMFileReader$BAMFileIterator.next(BAMFileReader.java:599)
 at htsjdk.samtools.SamReader$AssertingIterator.next(SamReader.java:545)
 at htsjdk.samtools.SamReader$AssertingIterator.next(SamReader.java:519)
 at picard.sam.markduplicates.MarkDuplicates.buildSortedReadEndLists(MarkDuplicates.java:303)
 at picard.sam.markduplicates.MarkDuplicates.doWork(MarkDuplicates.java:139)
 at picard.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:209)
 at picard.cmdline.PicardCommandLine.instanceMain(PicardCommandLine.java:95)
 at picard.cmdline.PicardCommandLine.main(PicardCommandLine.java:105)


This could be related to the observed monotonic, non-linear relationship between the haplotype effects on expression of the short transcript and their effects on levels of haptoglobin and non-HDL cholesterol (Fig. 1).



######### separate gorilla by chromosome and start angsd ######

need to add these once done:
/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/finished_bams/Banjo_out.sorted.bam
/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/finished_bams/Sandra_out.sorted.bam
/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/finished_bams/Amani_out.sorted.bam
/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/finished_bams/Delphi_out.sorted.bam

##### sort on 8 cores!!! 
qsub -S /bin/bash -q vert -v indv=Banjo -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/Banjo.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/Banjo.er \
 -N Banjofilt \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_combine_filternew.sh


test a small chromosome---> i have like 40k chromosomes!!
## this works!!! add the other gorillas when done.. test and run on all 40k
qsub -S /bin/bash -q vert -v chr=chr22 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/sort.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/sort.er \
 -N gorsort22 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_sort_index.sh

## haven’t done 2A and 2B
### have started 1, 2A, 2B, 3-12, 22
qsub -S /bin/bash -q vert -v chr=chr21 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/sort.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/sort.er \
 -N sort21 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_sort_index.sh


#### run this to check read depth!!!
qsub -S /bin/bash -q vert \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/check.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/check.er \
 -N gordepth \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_checkdepth.sh


qsub -S /bin/bash -q vert -v chr=chr1 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsd.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd.er \
 -N chr1angsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_musmimic.sh


##rerun chr22?, don’t think it got all the right filters, 1 and 22 run with this one...
qsub -S /bin/bash -q vert -v chr=chr22 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdnot1.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd1anot1.er \
 -N chr22angsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_notchr1.sh



Through 6, 2A and 2B didn’t work
qsub -S /bin/bash -q vert -v chr=chr2B \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdnot1.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd2Bchr.er \
 -N chr2Bangsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_allchr.sh


#11 is first one run with binary thing commented
qsub -S /bin/bash -q vert -v chr=chr21 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdnot1.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd21chr.er \
 -N chr21angsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_allchr.sh




### check all jobs on vert jobs all users
 qstat -u "*" | grep vert 

### check state of queue
qhost -q
## reason for error state
qstat -explain E

queue vert marked QERROR as result of job 7244676's failure at host vert01.broadinstitute.org
vert@vert02.broadinstitute.org BIP   0/0/16         1.12     lx-amd64      E
	queue vert marked QERROR as result of job 7244676's failure at host vert02.broadinstitute.org
vert@vert03.broadinstitute.org BIP   0/0/48         0.01     lx-amd64      E
	queue vert marked QERROR as result of job 7244676's failure at host vert03.broadinstitute.org
vert@vert04.broadinstitute.org BIP   0/0/48         0.04     lx-amd64      E
	queue vert marked QERROR as result of job 7244676's failure at host vert04.broadinstitute.org


chr10 thetas stopped:
chr10	755914	-10.431633	-12.148889	-Inf	-Inf	-Inf
chr10	755915	-10.702944	-12.437128	-Inf	-Inf	-Inf
chr10	755916	-10.686566	-12.419790	-Inf	-Inf	-Inf
chr10	755917	-10.628828	-12.358706	-Inf	-Inf	-Inf
chr10	755918	-10.524708	-12.248339	-Inf	-Inf	-Inf
chr10	755919	-10.647367	-12.378390	-Inf	-Inf	-Inf
chr10	755920	-10.552924	-12.278376	-Inf	-Inf	-Inf
chr10	755921	-10.579215	-12.304916	-Inf	-Inf	-Inf
chr10	755922	-10.313898	-12.023038	-Inf	-Inf	-Inf
chr10	755923	-10.6

old chr10 err file: /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd10chr.er


rerun second part of chr10, 8 2B, 5

qsub -S /bin/bash -q vert -v chr=chr5 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdnot1.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd5.er \
 -N chr5angsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_notchr1.sh



### I need to run fist and last for 2A

qsub -S /bin/bash -q vert -v chr=chr2A \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdnot1.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd2Anewchr.er \
 -N chr2Aangsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_firstlast.sh






################## DO LiFTOVERS OF FINISHED CHROMOSOMES AND IMPORT THEM INTO R #####################

#test chr22 -- worked!!!
qsub -S /bin/bash -q vert -v chr=chr21 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/lift.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/lift.er \
 -N lift21 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /wga/scr4/vgbgrp/linda/bal_sel/gor_liftover1.sh

### BROAD vpn is called anyconnect, for remote access , access at home 


#### arguments for core dump and priority
 -wd /core dump dir
 -p -9


### get other chromosomes that are small, but larger than 4kb 
/wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/finished_bams/40692 gorgor4_chrlen2.txt

sed ’s/LN://’

awk ' $3 >= 4000 ' gorgor4_chrlen2.txt > gorgor4_4kbormore.txt


split on colon then awk for length
http://serverfault.com/questions/307723/grep-or-sed-to-find-a-integer-value-above-a-given-amount




### look at coverage once I run chromosome 1
/seq/vgb/linda/bin/angsd/angsd -nThreads 8 -bam bam.filelist -doDepth 1 -out strict -doCounts 1 minMapQ 30 -minQ 20 -unique_only -remove_bads 1 -only_proper_pairs 1 -minInd 7





###### new rat alignment
qsub -S /bin/bash -q vert -v indv=ERR319183_rat_59 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/out/rataln.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/err/rataln.er \
 -N rat_59 \
 /wga/scr4/vgbgrp/linda/bal_sel/Brown_Rat_bwa.sh


### this file contains all fastq sequences except for the tester ERR319183_rat_59

while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/out/${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/err/${c}_err \
   -N ${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/Brown_Rat_bwa.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/brownrat_fastqs_grp3.txt



### to delete many jobs that are waiting
qdel $(qstat | grep qw | grep -Po '^\d+' | perl -pe 's/\n/ /')

get seq of numbers

### by job id using seq
seq 7199795 7199843 | perl -pe 's/\n/ /'

qdel $(seq 7199775 7199794 | perl -pe 's/\n/ /')

qdel $(seq 7199775 7199794 | perl -pe 's/\n/ /‘)

last one I’m deleting: 7199795 0.50013 ERR316471_ boettger     r     07/08/2016 07:36:31 vert@vert04.broadinstitute.org     1   

####### July 8, 2016 do IBS using angsd and make IBD/mds plot

/seq/vgb/linda/bin/angsd_912/angsd/angsd -doIBS \

### run for chromosome 20 on YRI population

qsub -S /bin/bash -q vert -v chr=22 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/ibs22.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/ibs22.er \
 -N ibs_22 \
 /wga/scr4/vgbgrp/linda/bal_sel/get_ibs.sh
	





######### Broad Help Afterhours ############ after hours broad institute

One of the servers I normally can access doesn't respond, and I'm pretty sure it's a server-side issue. How do I report this?
By emily on Mon, 06/15/2009 - 10:55
For all computing emergencies (physical plant, major network problem, major server outage, or any other problem affecting a major production process or group) call the Systems Emergency line at 8888 for assistance. (From outside: 617-714-8888). This number is available 24/7. When the number is called, a message is played which gives a status update if a server or service is known to be down.








######## Gorilla small cars ###

#test
qsub -S /bin/bash -q vert -v chr=chrUn_CABD030164085v1 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/sort.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/sort.er \
 -N shortsort \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_sort_index_smallchrs.sh

#chrUn_CABD030164085v1 deleated from file 


### run rest

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/sort.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/sort.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_sort_index_smallchrs.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/gorgor4_chrswith_4kbormore.txt



##### test angsd
qsub -S /bin/bash -q vert -v chr=chrUn_CABD030164085v1 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/shortangsd.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/shortangsd.er \
 -N shortang \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_shortchr.sh


### test with 500

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdBsmall.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsdBsmall.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_shortchr.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/gorgor4_chrwith_4kbormoreB.txt


many of these failed 
find /path/to/dest -type f -empty -name *.EXTENSION
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -empty -name thetasWindow.gz.pestPG | head


### combine large gorilla files
cd /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/final_lifts
cat * > ../liftedtohg19_largechr_gorilla.bed


########## many of them failed 
# find searches recursively for files (-type f) with name (-name) 
# and runs the command `stat -c%s {}` which prints the file size
# for each one (using -exec). The ;\ ends the exec.
# All the output is written to a new file called sizes.txt
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -name *thetasWindow.gz.pestPG -exec stat -c%s {} \; > sizes.txt

# Sort numerically, then take uniques lines with counts (-c)
sort -n sizes.txt | uniq -c 

# Smallest is 139, occurs 3959 times. Print only those with 139 bytes
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -name *thetasWindow.gz.pestPG -size 139c 

# Cat one of them to see if it has any data lines ( it doesn’t!)
cat /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS/gorilla_out_chrUn_CABD030169911v1/gorillafiltered_chrUn_CABD030169911v1.thetasWindow.gz.pestPG 

# List column lengths for each line for each file
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -name *thetasWindow.gz.pestPG -exec awk '{print NF}' {} | sort -nu | head -n 1\;

# confirm all files have exactly 14 columns for each line
sort -n line_sizes.txt | head


###files greater than (not empty)
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -name *thetasWindow.gz.pestPG -size +139c 

find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/gorilla_SMALL_CHRS_OUTS -type f -name *thetasWindow.gz.pestPG -size +139c > correct_small_gor.txt

#### get rid of final leftover files that are empty
find /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out/final_lifts/SMALL_LIFTS -type f -empty -delete


cat * > ../liftedtohg19_largechr_gorilla_smallchr.bed


### rerun some failures

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsdBsmall.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsdBsmall.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_shortchr.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/failed_chrs.txt


chrUn_CABD030159309v1


while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/shortlift.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/shortlift.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/gor_small_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/correct_smallgor.txt

## running more rats
while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/out/${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/err/${c}_err \
   -N ${c} \
   -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
   -p -10 \
   /wga/scr4/vgbgrp/linda/bal_sel/Brown_Rat_bwa.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/brownrat_fastqs_grp5.txt


put gorilla files together
cat liftedtohg19_largechr_gorilla.bed liftedtohg19_gorilla_smallchr.bed > liftedtohg19_gorilla_ALLchr.bed





############# Process cuishlie ########

/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly
she was aligned to /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta

samtools sort Cuishle-aln.bam Cuishle_aln.sorted

samtools view -b -o Cuishle-aln_tester.bam Cuishle-aln.bam chr14:1-60966679

samtools sort -T /tmp/Cuishle.sorted -o Cuishle_aln.sorted.bam Cuishle-aln.bam




############# align with Mummer then make vcf from that 
https://www.biostars.org/p/74721/
https://github.com/douglasgscofield/bioinfo/blob/master/scripts/mummer2Vcf.pl



###### make very small Cuishlie file for testing purposes #####
### this file contains 9 megabubbles
head -197 20160701_cuishle_assembly_megabubbles.fasta > cuishle_testerMegabubbles.fasta

###
use MUMmer

#This command will find all maximal unique matches (-mum) between the reference and query on both the forward and reverse strands (-b) and report all the match positions relative to the forward #strand (-c). Output is to stdout, so we will redirect it into a file named mummer.mums. This file lists all of the MUMs of the default length or greater between the two input sequences.

mummer -mum -b -c /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_testerMegabubbles.fasta > cuishle_testerMegabubbles_mummer

nucmer -maxmatch -c 100 -p nucmer /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_testerMegabubbles.fasta

### my fasta sequence is to long 
# reading input file "nucmer.ntref" of length 2410980143
# construct suffix tree for sequence of length 2410980143
# (maximum reference length is 536870908)
# (maximum query length is 4294967295)
# process 24109801 characters per dot
/broad/software/free/Linux/redhat_6_x86_64/pkgs/mummer_3.22/mummer: suffix tree construction failed: textlen=2410980143 larger than maximal textlen=536870908
ERROR: mummer and/or mgaps returned non-zero

###### i’ll download a new version in my folder and compile it for longer alignments

wget https://sourceforge.net/projects/mummer/files/mummer/3.23/MUMmer3.23.tar.gz/download
tar -xvzf download
make check
make install
make clean
make CPPFLAGS="-O3 -DSIXTYFOURBITS"


/seq/vgb/linda/bin/MUMmer3.23/nucmer -maxmatch -c 100 -p cuishle_tester /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_testerMegabubbles.fasta
#....... this is very slow


cuishle_tester.mgaps is empty
cuishle_tester.ntref seems to be a copy of the reference file



Advice to speed it up:
https://sourceforge.net/p/mummer/mailman/message/32387279/
1. Run nucmer in mum-reference mode to ignore repetitive alignment seeds
> 2. Increase the minimum match length and minimum cluster length (this will
> reduce sensitivity to low-identity alignments)
> 3. Run delta-filter with the -l and -i options to filter alignments by
> length and identity (these filters are quick, compared to -1/-m/-r/-q which
> all require a dynamic programming step)
>
>  Once you have a filtered delta file using the above recommendations, you
> can pass it directly to dnadiff using the -d option and it will skip the
> alignment phase and process your delta filter directly--hopefully faster
> than before.



### this will create an output file with the coordinates 
show-coords -r -c -l nucmer.delta > nucmer.coords

# -c is Minimum cluster length

/seq/vgb/linda/bin/MUMmer3.23/nucmer --minmatch 300 --mincluster 1000 --mumreference -p cuishle_testernew /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_testerMegabubbles.fasta

... This is still very slow



### try the wrapper dnadiff
/seq/vgb/linda/bin/MUMmer3.23/dnadiff /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_testerMegabubbles.fasta > cuishle_tester_out

#... the same thing.. only one dot is made 

### looking at Mauve
Mauve requires about 16 bytes of memory per nt to compute genome alignments. Alignments of two bacteria can be computed in a few minutes, drosophila in an hour or so, and mammalian genome alignments can be computed in a day or two provided a computer with adequate memory resources.




####### make fastq file from fasta file with fake quality scores (40)

## FASTA to fastq
perl /seq/vgb/linda/bin/fasta_to_fastq.pl /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_testerMegabubbles.fasta > /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_testerMegabubbles.fq


## fastq to bam
bwa mem -t 8 -x intractg /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_testerMegabubbles.fq | samtools view -@ 2 -bS > /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_fakeqs.bam 

####### make fake read groups #######
java -Xmx2G -jar /home/unix/boettger/bin/picard-tools-2.0.1/picard.jar AddOrReplaceReadGroups \
    INPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_fakeqs.bam \
    OUTPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_fakeqsRG.bam RGLB=doglib \
    VALIDATION_STRINGENCY=LENIENT \
    RGPL=Illumina RGPU=1 RGSM=Cuishle RGDS=AD



samtools sort -T /tmp/Cuishle_fakeqsRG.sorted -o Cuishle_aln_fakeqsRG.sorted.bam Cuishle_aln_fakeqsRG.bam
samtools index Cuishle_aln_fakeqsRG.sorted.bam

samtools view Cuishle_aln_fakeqsRG.sorted.bam 

### what chromosomes do I have?
samtools idxstats Cuishle_aln_fakeqsRG.sorted.bam | head -n 3

## chr 35 has three seqs aligned to it


### call snps
http://gatkforums.broadinstitute.org/gatk/discussion/comment/7086#Comment_7086

### call both indels and SNPs, 1 read required to call indel, gap open penalty at 80, call and emit all sites (not just those with high confidence), 
-glm BOTH -minIndelCnt 1 -indelGOP 80 -stand_call_conf 0 -stand_emit_conf 0 


Java-1.8
version 3.3-0-g37228af of GATK
java -jar /seq/vgb/linda/bin/GenomeAnalysisTK.jar -T UnifiedGenotyper --intervals chr35 -glm BOTH -minIndelCnt 1 -indelGOP 80 -stand_call_conf 0 -stand_emit_conf 0 -I Cuishle_aln_fakeqsRG.sorted.bam -R /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta -o Cuishle_aln_fakeqsRG.vcf



#########I need to make separate bams for each megabubble so that they will be called distinctly in the VCF

### make fasta files for the first two entries
head -22 20160701_cuishle_assembly_megabubbles.fasta > cuishle_0.fasta
sed -n '23,42p;43q' 20160701_cuishle_assembly_megabubbles.fasta > cuishle_1.fasta


head -42 20160701_cuishle_assembly_megabubbles.fasta > megabubbles_tester.fasta


###fasta to fastq
perl /seq/vgb/linda/bin/fasta_to_fastq.pl cuishle_0.fasta > cuishle_0.fq
perl /seq/vgb/linda/bin/fasta_to_fastq.pl cuishle_1.fasta > cuishle_1.fq

### make bams
bwa mem -t 8 -x intractg /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_0.fq | samtools view -@ 2 -bS > cuishle_0.bam
bwa mem -t 8 -x intractg /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta cuishle_1.fq | samtools view -@ 2 -bS > cuishle_1.bam


### get location from mapped read
samtools view cuishle_1RG_sorted.bam | awk '{print "_" $3 "_" $4 "_" $4+length($10)-1}' > cuishle_1RG_sorted.loc
samtools view cuishle_0RG_sorted.bam | awk '{print "_" $3 "_" $4 "_" $4+length($10)-1}' > cuishle_0RG_sorted.loc


###add read groups, name the individual for location of mapped read
java -Xmx2G -jar /home/unix/boettger/bin/picard-tools-2.0.1/picard.jar AddOrReplaceReadGroups \
    INPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_1.bam \
    OUTPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_1RG.bam RGLB=doglib \
    VALIDATION_STRINGENCY=LENIENT \
    RGPL=Illumina RGPU=1 RGSM=cuishle_1_chr16_13858891_13860395 RGDS=AD

java -Xmx2G -jar /home/unix/boettger/bin/picard-tools-2.0.1/picard.jar AddOrReplaceReadGroups \
    INPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_0.bam \
    OUTPUT=/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/cuishle_0RG.bam RGLB=doglib \
    VALIDATION_STRINGENCY=LENIENT \
    RGPL=Illumina RGPU=1 RGSM=cuishle_0_chr16_54129606_54131211 RGDS=AD

## sort and index
samtools sort -T /tmp/cuishle_1RG.sorted -o cuishle_1RG_sorted.bam cuishle_1RG.bam
samtools index cuishle_1RG_sorted.bam

samtools sort -T /tmp/cuishle_0RG.sorted -o cuishle_0RG_sorted.bam cuishle_0RG.bam
samtools index cuishle_0RG_sorted.bam


######## call variants ## next time use -glm SNP (no indels on dog arrays)
java -jar /seq/vgb/linda/bin/GenomeAnalysisTK.jar -T UnifiedGenotyper --intervals intervals_cuishle.intervals -glm SNP -minIndelCnt 1 -indelGOP 80 -stand_call_conf 0 -stand_emit_conf 0 -I cuishle_0RG_sorted.bam -I cuishle_1RG_sorted.bam -R /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta -o Cuishle_aln_test2locationsSNPs.vcf



###### output as plink and as plink tped
--plink 
--plink-tped 

use VCFtools

vcftools --vcf Cuishle_aln_test2locations.vcf --plink --out Cuishle_aln_test2locations
### both seqs are blank for the first 4 SNPs...?


/seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly
/seq/vgb/linda/admixture/boyko_2016
java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar gt=$datafold/Poodles.vcf out=$datafold/Poodles_vcf_phased

######## need to change SNP names in ancestral files to chromosomal locations for canfam3!!!!!!!!!!!!!!!!!!!!!!!
“All positions are listed in canFam3.1” says Boyko paper





############### getting dog breed reference data ###########
plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine --recode --dog --noweb --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine


#### replace SNP names with locations

awk '{print $1, "chr" $1 ":" $4, $3, $4}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map > /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.map

## make matching ped file
cp /seq/vgb/linda/admixture/boyko_2016/cornell_canine.ped /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.ped

use PLINK2
plink --file cornell_canine_loc --noweb --dog --recode vcf-iid --out cornell_canine_loc

### fixed badly merged SNPs in cornell_canine_loc_SNPfix.vcf



### remove chr 39 (hemizygous chrx)
grep "^39" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc_SNPfix.vcf | head -10
grep -v “^39” cornell_canine_loc_SNPfix.vcf > cornell_canine_loc_SNPfix_no39.vcf
grep "^39" cornell_canine_loc_SNPfix_no39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf
grep -v "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf > cornell_canine_loc_SNPfix_nochr39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_nochr39.vcf
rm cornell_canine_loc_SNPfix_no39.vcf


vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

## _loc.vcf has a prob for chr39, not everyone has two alleles
$vcftools --vcf cornell_canine_loc_SNPfix_nochr39.vcf --keep Poodles_forvcf.txt --max-missing 0.1 --maf 0.01 --recode --out /seq/vgb/linda/admixture/boyko_2016/Poodles.vcf

$vcftools --vcf cornell_canine_loc_SNPfix_nochr39.vcf --keep Golden_Retrievers_forvcf.txt --recode --out /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers.vcf


Poodles_forvcf.txt

############### THERE IS A PROBLEM WHERE THE SAME SNP APPEARS TWICE, I FIXED IT BY HAND, BUT I’LL NEED TO DO A BETTER JOB LATER #############
grep "chr8:33825304" $datafold/Poodles.vcf.recode.vcf          
8	33825304	chr8:33825304	C	G	.	.	.	GT	0/1	0/1	1/1	0/1	1/1	0/0	0/0	0/1	0/1	1/1	1/1	0/1	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.
8	33825304	chr8:33825304	C	G	.	.	.	GT	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	0/1	0/1	0/0	0/1	0/1	0/1	0/1	0/0	0/1	0/1	1/1	0/1	0/0	0/1

### this SNP is the other one with an issue:
2 chr11:60627269


####### print all duplicate markers ######

awk '{print $3}’ $datafold/Poodles.vcf.recode.vcf > $datafold/Boyko_marker_list.txt

sort $datafold/Boyko_marker_list.txt | uniq -c > Boyko_counts.txtawk '{print $1, $4}' /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.tmp > \
  /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.txt


above SNPs have been fixed in cornell_canine_loc_SNPfix.vcf

########## get rid of alleles that are completely missing

java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar window=200000 overlap=50000 gt=$datafold/Poodles.vcf.recode.vcf out=Poodles_phased
gunzip Poodles_phased.vcf.gz


java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar window=200000 overlap=50000 gt=Golden_Retrievers.vcf.recode.vcf out=Golden_Retrievers_phased
gunzip Golden_Retrievers_phased.vcf.gz

### remove Imputed marker flag
grep -v "Imputed marker" Poodles_phased.vcf > Poodles_phased_rminfo.vcf; mv Poodles_phased_rminfo.vcf Poodles_phased.vcf
grep -v "Imputed marker" Golden_Retrievers_phased.vcf > Golden_Retrievers_phased_rminfo.vcf; mv Golden_Retrievers_phased_rminfo.vcf Golden_Retrievers_phased.vcf



### convert to tped
$vcftools --vcf Poodles_phased.vcf --plink-tped --out Poodles_phased
$vcftools --vcf Golden_Retrievers_phased.vcf --plink-tped --out Golden_Retrievers_phased





####### RUN SUPPORTMIX #######
/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix --chromosome=chr16 --window=3 -s /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_test2locations_supportmix /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers_phased.tped /seq/vgb/linda/admixture/boyko_2016/Poodles_phased.tped /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_test2locations.tped 

##### copy files to high performance folder
cp /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers_phased.tped /seq/vgb-HAL/linda/ancestry/breeds/Golden_Retrievers_phased.tped
cp /seq/vgb/linda/admixture/boyko_2016/Poodles_phased.tped /seq/vgb-HAL/linda/ancestry/breeds/Poodles_phased.tped


cp /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/20160701_cuishle_assembly_megabubbles.fasta /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles.fasta


cp /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/megabubbles_tester.fasta /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_tester_assembly_megabubbles.fasta



##### submit to vert
qsub -S /bin/bash -q vert -v megabubbles_fasta=20160701_cuishle_assembly_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/convert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/convert.err \
 -N shortsort \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles_to_vcf.sh


##### test new script with python base convert code
qsub -S /bin/bash -q vert -v megabubbles_fasta=20160701_tester_assembly_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/testconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/testconvert.err \
 -N testvcf \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf.sh


## start again with cushily
qsub -S /bin/bash -q vert -v megabubbles_fasta=20160701_cuishle_assembly_megabubbles_base.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/testconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/testconvert.err \
 -N cuishbase \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf.sh





######## looking for best macaque population #######
http://www.ncbi.nlm.nih.gov/sra/ERX697461[accn] 6 individuals mauritious

http://www.ncbi.nlm.nih.gov/sra/SRX1022644[accn] pacbio


perl /seq/vgb/linda/bin/fasta_to_fastq.pl $parentpath/$megabubbles_fasta > $parentpath/20160701_tester_assembly_megabubblesold.fastq


#########getting orangutan sequence ######

# 5 samples from here 
http://www.pnas.org/content/110/39/15764.full.pdf, http://www.ncbi.nlm.nih.gov/bioproject/PRJEB1675

# 5 samples from great ape genome project
http://biologiaevolutiva.org/greatape/samples.html


######### longer windows for angsd #####

qsub -S /bin/bash -q vert -v chr=chr20 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsd10.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd10.er \
 -N chr20angsd \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_10kb.sh

### ch20 has an issue... it’s blank but no errors /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsdchr20.er

/seq/vgb/linda/bin/angsd/misc/thetaStat make_bed $outpath/gorillafiltered_$chr.thetas.gz

###### move ollie and ruby to the correct folder #####

cp /seq/vgb/linda/admixture/10xg/dogs_meet_Ollie_and_Ruby/ollie/output/distribute/canine_ollie_megabubbles.fasta /seq/vgb-HAL/linda/ancestry/megabubbles/canine_ollie_megabubbles.fasta


cp /seq/vgb/linda/admixture/10xg/dogs_meet_Ollie_and_Ruby/ruby/output/distribute/canine_ruby_megabubbles.fasta /seq/vgb-HAL/linda/ancestry/megabubbles/canine_ruby_megabubbles.fasta


qsub -S /bin/bash -q vert -v megabubbles_fasta=canine_ollie_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/ollieconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/ollieconvert.err \
 -N olliebase \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf.sh



qsub -S /bin/bash -q vert -v megabubbles_fasta=canine_ruby_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/rubyconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/rubyconvert.err \
 -N rubybase \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf.sh


####### Liftover chimp 10kb intervals ###



#chr20 has an issue, was blank angsd with no errors.... 
qsub -S /bin/bash -q vert -v chr=chr1 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/lift.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/lift.er \
 -N lift1 \
 -p -10 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /wga/scr4/vgbgrp/linda/bal_sel/gor_liftover1.sh


## start chr20 again
qsub -S /bin/bash -q vert -v chr=chr20 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsd20chr.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd20chr.er \
 -N chr20angsd \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_filter_allchr.sh







######!!!!!!!!!! MOST SNPS DON’T HAVE AN OUTPUT BECAUSE THERE IS NO SNP AT THAT LOCATION #########
## start again with cushily, this time with just the bases on the SNP chip
qsub -S /bin/bash -q vert -v megabubbles_fasta=20160701_cuishle_assembly_megabubbles_base.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/intconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/intconvert.err \
 -N cuiint1 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf_intervals1.sh




### that looks good. Start all with just the SNPs I need
qsub -S /bin/bash -q vert -v megabubbles_fasta=20160701_cuishle_assembly_megabubbles_base.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/allconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/allconvert.err \
 -N cuishall \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf_allintervals.sh


megabubbles_to_vcf_allintervals.sh


###### ERROR MESSAGE: Badly formed genome loc: Contig 'chr41' does not match any contig in the GATK sequence dictionary derived from the reference; are y
ou sure you are using the correct reference fasta file?
#I will call chr41 -> chrX


### that looks good. Start all with just the SNPs I need
qsub -S /bin/bash -q vert -v megabubbles_fasta=canine_ruby_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/allconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/allconvert.err \
 -N rubyall \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf_allintervals.sh


### that looks good. Start all with just the SNPs I need
qsub -S /bin/bash -q vert -v megabubbles_fasta=canine_ollie_megabubbles.fasta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/allconvert.out \
 -e /seq/vgb-HAL/linda/ancestry/err/allconvert.err \
 -N ollieall \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/megabubbles_to_vcf_allintervals.sh






### convert to tped
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

$vcftools --vcf 20160701_cuishle_assembly_megabubbles_base_intervals1.vcf --plink-tped --out 20160701_cuishle_assembly_megabubbles_base_intervals1



####### RUN SUPPORTMIX #######
running on screen -dr 261
/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix --chromosome=chr1 --window=1 -s /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_test2locations_supportmix /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers_phased.tped /seq/vgb/linda/admixture/boyko_2016/Poodles_phased.tped 20160701_cuishle_assembly_megabubbles_base_intervals1.tped 



######### MAYBE I NEED TO USE THIS??? ##########
https://github.com/pomo-dev/PoMo/blob/master/scripts/FastaToVCF.py
https://bitbucket.org/steelea/16genometoolkit/wiki/fastaToVCF


#### OR I COULD RUN EACH SEPARATELY ###
samtools view -bhR  readids_for_sample_A.txt  File.bam > File_A.bam 





######## run parallel for dogs from bam to support mix ###

qsub -S /bin/bash -q vert \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N cuishsup \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -10 \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh 20160701_cuishle_assembly_megabubbles_base_sorted


qsub -S /bin/bash -q vert -v indiv_name=20160701_cuishle_assembly_megabubbles_base_sorted \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N cuishsup \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh



### to run script but not submit to scheduler
bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh 20160701_cuishle_assembly_megabubbles_base_sorted





####### human 10kb 

qsub -S /bin/bash -q vert -v chr=21 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/out/angsd.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams/err/angsd.er \
 -N chr21YRI \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -11 \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_angsd_10kb.sh


##don’t leftover, just cat YRI 10kb files
cd /wga/scr4/vgbgrp/linda/bal_sel/YRI_out10/gorilla_out_1
cat /wga/scr4/vgbgrp/linda/bal_sel/YRI_out10/*/* > ../YRI_allchr_10kb.bed


##chimp 10kb, this worked, submit all him chrs
qsub -S /bin/bash -q vert -v chr=chr21 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/out/angsd.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/err/angsd.er \
 -N chr21ch \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -11 \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_10kb.sh


while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/out/angsd.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/err/angsd.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -11 \
 /wga/scr4/vgbgrp/linda/bal_sel/angsd_chimp_10kb.sh
done < //wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt

### make sure all files are larger than 139 bytes (just header)
just chimp_out_chr6_hla_hap1/chimpfiltered_chr6_hla_hap1.thetasWindow.gz.pestPG has a problem, but it’s small and I don’t expect any necessarily


### chimp 10kb liftovers 
qsub -S /bin/bash -q vert -v chr=chr20 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/out/lift.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/err/lift.er \
 -N chr20ch \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -11 \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/out/lift.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams/err/lift.er \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 -p -11 \
 /wga/scr4/vgbgrp/linda/bal_sel/chimp_liftover1.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/chimp_chr.txt


### cat chimp
cd /wga/scr4/vgbgrp/linda/bal_sel/chimp_out10/chimp_out_lifts1
cat * > ../chimp_allchr_10kb.bed


grep “#(indexStart,indexStop)”


grep -v "#(indexStart,indexStop)" YRI_allchr_10kb.bed > YRI_allchr_10kb_noheader.bed


grep "#(indexStart,indexStop)" YRI_allchr_10kb_noheader.bed 





############ STRAND FLIPPING ADAM BOYKO’S DATASET ####
http://www.nature.com/ncomms/2016/160122/ncomms10460/full/ncomms10460.html
Genotyping was done using the Illumina 173k CanineHD array12, with the addition of 12,143 custom markers (see PLINK files deposited in Dryad). These custom markers were SNPs that were identified from whole-genome sequence data40, variants listed in Online Mendelian Inheritance in Animals (OMIA, http://omia.angis.org.au/home/), and markers that were designed to cover gaps in the existing array (including mitochondrial DNA and the Y chromosome). In total, 4,224 samples were genotyped (44 plates) at 185,805 markers at the Cornell University core facility. All positions are listed in canFam3.1.

The real trick was realizing that the dataset with all dogs was in
dbsnp format and not TOP/BOT format. If you're having problems with
this as well this is a good page to read:
http://www.openbioinformatics.org/gengen/tutorial_allele_coding.html#ilmnab
 ......and their convert_bim_allele.pl seems to do the trick.


###  command I previously used to flip strands for greyhounds
perl convert_bim_allele.pl grey_osa_pedsex_nodups.bim greyhounds.snptable -intype ilmn12 -outtype dbsnp -outfile OSAgrey_dbsnp.bim



/seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc_SNPfix_nochr39.vcf


### product file from Illumina which has TOP/BOT designations
cd /seq/vgb/linda/admixture/Illumina
wget ftp://webdata2:webdata2@ussd-ftp.illumina.com/downloads/ProductFiles/CanineHD/CanineHD_B.csv


IlmnID,Name,IlmnStrand,SNP,AddressA_ID,AlleleA_ProbeSeq,AddressB_ID,AlleleB_ProbeSeq,GenomeBuild,Chr,MapInfo,Ploidy,Species,Source,SourceVersion,SourceStrand,SourceSeq,TopGenomicSeq,BeadSetID,Exp_Clusters,Intensity_Only
BICF2G630100019-0_T_R_1585665956,BICF2G630100019,TOP,[A/G],0025732300,TTTTGGTGAATGTCTGCAAAGAGCAGCGACAGCACATTCTGTTACAATTA,,,3.1,25,31558578,diploid,Canis familiaris,CanFam,2,BOT,AATTGATTGGTGGCATGCAATTTGCCAGGACACTTTAGATATGATCTTAATATTTTGTTC[T/C]TAATTGTAACAGAATGTGCTGTCGCTGCTCTTTGCAGACATTCACCAAAACCCTTGTCGC,GCGACAAGGGTTTTGGTGAATGTCTGCAAAGAGCAGCGACAGCACATTCTGTTACAATTA[A/G]GAACAAAATATTAAGATCATATCTAAAGTGTCCTGGCAAATTGCATGCCACCAATCAATT,215,3,0

## I need cols 2, 4, 3, 16
awk -F',' -v OFS='\t' '{ print $2, $4, $3, $16}' CanineHD_B.csv > CanineHD.snptable

## delete first 7 lines of junk
sed -i 1,7d CanineHD.snptable

## header edited by hand


SNPtable file:
/seq/vgb/linda/admixture/Illumina/CanineHD.snptable

### make SNPtable file with SNP locations (not SNP names)
## I need cols 2, 4, 3, 16,,,,,, 10 and 11
awk -F',' -v OFS='\t' '{ print $2, $4, $3, $16}' CanineHD_B.csv > CanineHD.snptable




/seq/vgb/linda/admixture/Illumina/CanineHD_B.csv


awk -F',' -v OFS='\t' '{ print $10”:”$11, $4, $3, $16}' CanineHD_B.csv > CanineHD_loc.snptable
## this isn’t that useful becase many of the SNPs don’t have a location chromosome and bp position both listed as “0”. Probably  not all SNPs are there because of filtering???



### get perl script for conversion
wget http://www.openbioinformatics.org/gengen/download/convert_bim_allel


/seq/vgb/linda/admixture/Illumina $ awk 'NF==4' /seq/vgb/linda/admixture/Illumina/CanineHD.snptable | wc -l
173662
boettger@vert02:/seq/vgb/linda/admixture/Illumina $ wc -l /seq/vgb/linda/admixture/Illumina/CanineHD.snptable 
173664 /seq/vgb/linda/admixture/Illumina/CanineHD.snptable


Error: the SNP chr01_3412455 in bimfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim is not annotated in SNPTable file

### get only SNPs that are on the IlluminaHD array
awk -F'\t' 'NR==FNR{a[$2]++;next} (a[$1])' /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim /seq/vgb/linda/admixture/Illumina/CanineHD.snptable | awk '{print $1}' > array_SNPs.txt

plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs.txt \
 --make-bed \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs


## inside A but not in B
## is in cornell, not in array_SNPs
#compare file 1 and file 2 using their first columns and remove the entire line 
##or row from file 2 where they match in file 1. I'd also like to save the results to a 3rd file, file #3

awk 'FNR==NR{a[$1];next};!($1 in a)' /seq/vgb/linda/admixture/Illumina/array_SNPs.txt /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim > /seq/vgb/linda/admixture/Illumina/sequence_SNPs.txt


awk -F”\t” 'NR==FNR{a[$0]++;next}a[$2]' /seq/vgb/linda/admixture/Illumina/array_SNPs.txt /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim > /seq/vgb/linda/admixture/Illumina/sequence_SNPs.txt

## above attempts didn’t work, but I got /seq/vgb/linda/admixture/Illumina/seq_SNPs.txt from R 

plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine \
 --extract /seq/vgb/linda/admixture/Illumina/seq_SNPs.txt \
 --make-bed \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_seqSNPs





 Error: the SNP TIGRP2P277_rs8525603 top allele is annotated as 'A G' in snptable file, but is shown as 'C T' in BIM file

grep 'TIGRP2P277_rs8525603' /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim # it is G/A SNP which is correct

grep 'TIGRP2P277_rs8525603' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs.bim #is a G/A SNP


#### OMFG THAT WORKED!!!
perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHD.snptable \
 -intype top \
 -outtype dbsnp \
 -outfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim



### check if the converted SNP strands are the same as the ones in the sequence data!!!!
## then merge with other SNPs, first check if they are 



### check the snps we called from seq data
samtools view /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted.bam chr37 | grep "Jd_chr37_6678174_6792978" | head -1 | bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_single_bubble.sh /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted -

#to run above I commented
rm $tmp_path/$stdin_fn.* in run single bubble.sh



### grep in flipped file
grep '6699894' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim


 /seq/vgb-HAL/linda/ancestry/megabubbles/tmp/Jc_chr37_2137676_2289879.sm.tped



####### checking strand flipping
37	chr37:6699894	0	6699894	G	G GOOD(AG)   T/B C[T/C]G
37	chr37:6713215	0	6713215	C	C BAD(TG)    B/B T[T/G]C
37	chr37:6721654	0	6721654	A	A GOOD(AG)   T/T G[A/G]A
37	chr37:6729194	0	6729194	G	G GOOD(AG)   T/B T[T/C]G 
37	chr37:6750202	0	6750202	C	C BAD(AG)    T/T C[A/G]C
37	chr37:6752091	0	6752091	T	T GOOD(TC)   B/T C[A/G]T
37	chr37:6755673	0	6755673	T	T BAD(AG)    T/T T[A/G]T
37	chr37:6765009	0	6765009	G	G BAD(TC)    B/T M[A/G]G 
37	chr37:6777146	0	6777146	A	A BAD(AG)    T/B C[T/C]A
37	chr37:6787585	0	6787585	G	G WRONG(A/T) B/B (AT for cornell) (T is before) C[A/T]G

awk -F',' '{if ($10 == 37) {print $0}}' /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv | sort -t',' -k11 | perl -pe 's/,/\t/g' | less -S -x41

37	chr37:6699894	0	6699894	C	C BAD T/B 
37	chr37:6713215	0	6713215	G	G GOOD B/B
37	chr37:6721654	0	6721654	G	G GOOD T/T
37	chr37:6729194	0	6729194	C	C BAD T/B
37	chr37:6750202	0	6750202	A	A GOOD T/T
37	chr37:6752091	0	6752091	A	A BAD B/T
37	chr37:6755673	0	6755673	A	A GOOD T/T
37	chr37:6765009	0	6765009	A	A BAD B/T
37	chr37:6777146	0	6777146	C	C BAD T/B
37	chr37:6787585	0	6787585	T	T ??? B/B


######## get only sequenced SNPs (not ones that needed flipping) 




### check that these don’t need flipping ###
qsub -S /bin/bash -q vert -v indiv_name=20160701_cuishle_assembly_megabubbles_base_sorted \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N cuishsup \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh 20160701_cuishle_assembly_megabubbles_base_sorted


more /seq/vgb-HAL/linda/ancestry/megabubbles/tmp/Jc_chr37_2137676_2289879.sm.tped

samtools view /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted.bam chr37 | grep "Jc_chr37_2137676_2289879" | head -1 | bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_single_bubble.sh /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted -



####### WTF IT SAYS 12 SNPS BUT ONLY ONE IN TPED !!!
10:59am boettger@vert02 /seq/vgb-HAL/linda/ancestry/megabubbles/outputs $ samtools view /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted.bam chr37 | grep "Jc_chr37_2137676_2289879" | head -1 | bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_single_bubble.sh /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted -

WARNING!: The genetic map distances are VERY small at 0 cM/Mb!!!
Jc_chr37_2137676_2289879	chr37	2280278	2155492	12	1	1	2155492	2280278	1	0.918
13.084u 1.648s 0:15.04 97.8%	0+0k 63672+344io 0pf+0w
11:01am boettger@vert02 /seq/vgb-HAL/linda/ancestry/megabubbles/outputs $ 
11:01am boettger@vert02 /seq/vgb-HAL/linda/ancestry/megabubbles/outputs $ more /seq/vgb-HAL/linda/ancestry/megabubbles/tmp/Jc_chr37_2137676_2289879.tped
37 chr37:2155492 0 2155492 1 1

more /seq/vgb-HAL/linda/ancestry/megabubbles/tmp/1iG_chr37_30229970_31408498.tped

1iG_chr37_30229970_31408498


#### seq SNPs don’t appear to be on the forward strand

cornell:
37	BICF2G630135551	52.2567	30248102	G	A This is a T on  confab 3.1
37	BICF2G630135578	52.2598	30312625	G	A This is a C in Canfam 3.1

 more /seq/vgb-HAL/linda/ancestry/megabubbles/tmp/1iG_chr37_30229970_31408498.tped
37	chr37:30248102	0	30248102	T	T *** This is a T on  confab 3.1
37	chr37:30261851	0	30261851	G	G G on canfam
37	chr37:30270871	0	30270871	G	G A on canfam
37	chr37:30279759	0	30279759	T	T A on canfam--- check!!
37	chr37:30298204	0	30298204	C	C T on canfam is c/t snap though
37	chr37:30312625	0	30312625	T	T *** This is a C in Canfam 3.1
37	chr37:30314412	0	30314412	G	G
37	chr37:30336095	0	30336095	C	C
37	chr37:30343470	0	30343470	A	A
37	chr37:30357872	0	30357872	C	C
37	chr37:30363309	0	30363309	T	T
37	chr37:30375397	0	30375397	C	C
37	chr37:30387759	0	30387759	G	G
37	chr37:30400875	0	30400875	A	A

grep “30312625” /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim  ## not there
grep “30312625” /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs.bim

grep "30312625" /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim
37	BICF2G630135578	52.2598	30312625	G	A

grep "30279759" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim
37	BICF2G630135565	52.257	30279759	A	T

grep "30279759" /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim
37	BICF2G630135565	52.257	30279759	T	A

grep "30298204" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim

############ just keeping SNPs on array (151985/160727) ~95% of SNPs



grep “30248102” /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv -- yes, this is not in the file from illumine 



/seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim

## copied bed and fam files to this name “converted”

### check double location snps
grep "chr8:33825304" $datafold/Poodles.vcf.recode.vcf          
8	33825304	chr8:33825304	C	G	.	.	.	GT	0/1	0/1	1/1	0/1	1/1	0/0	0/0	0/1	0/1	1/1	1/1	0/1	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.
8	33825304	chr8:33825304	C	G	.	.	.	GT	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	./.	0/1	0/1	0/0	0/1	0/1	0/1	0/1	0/0	0/1	0/1	1/1	0/1	0/0	0/1

### this SNP is the other one with an issue:
2 chr11:60627269


grep "60627269" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim

neither is there

### chr39 and 41 are there though

grep "^39" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim | awk -F"\t" "{print $2}"

### remove chr39 
plink --file data --exclude mysnps.txt

grep "^39" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted.bim | awk -F"\t" '{print $2}' > chr39SNPS.txt

plink --bfile cornell_canine_CanHDSNPs_converted --dog --exclude chr39SNPS.txt --make-bed --out cornell_canine_CanHDSNPs_converted_no39


##replace 41 with “X” ---> plink hates x change it later!!
sed -i -E "s/^41/X/" cornell_canine_CanHDSNPs_converted_no39.bim

148277 SNPS
###change SNP names to locations
plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39 --recode --dog --noweb --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39


#### replace SNP names with locations

/seq/vgb/linda/admixture/boyko_2016/cornell_canine

awk '{print $1, "chr" $1 ":" $4, $3, $4}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39.map > /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc.map

## make matching ped file
cp /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39.ped /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc.ped


####convert to vcf
plink --file cornell_canine_CanHDSNPs_converted_no39_loc --noweb --dog --recode vcf-iid --out cornell_canine_chrfix_flipped_loc



use PLINK2
plink --file cornell_canine_loc --noweb --dog --recode vcf-iid --out cornell_canine_loc

### fixed badly merged SNPs in cornell_canine_loc_SNPfix.vcf

### remove chr 39 (hemizygous chrx)
grep "^39" cornell_canine_loc_SNPfix.vcf | head -10
grep -v “^39” cornell_canine_loc_SNPfix.vcf > cornell_canine_loc_SNPfix_no39.vcf
grep "^39" cornell_canine_loc_SNPfix_no39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf
grep -v "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf > cornell_canine_loc_SNPfix_nochr39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_nochr39.vcf
rm cornell_canine_loc_SNPfix_no39.vcf


vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

## _loc.vcf has a prob for chr39, not everyone has two alleles
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf cornell_canine_chrfix_flipped_loc.vcf --keep Poodles_forvcf.txt --recode --out /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed.vcf

$vcftools --vcf cornell_canine_loc_SNPfix_nochr39.vcf --keep Golden_Retrievers_forvcf.txt --recode --out /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers.vcf


### phase new poodle file
java -Xmx1000m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar gt=/seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed.vcf.recode.vcf out=/seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased

$vcftools --vcf /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased.vcf --plink-tped --out Poodles_fixed_phased

grep -v "ID=IMP" /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased.vcf > /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased_noIMP.vcf

$vcftools --vcf /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased_noIMP.vcf --plink-tped --out /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased

sed "s/^41.*chr41:/X\tchrX:/" /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixed_phased.tped > /seq/vgb/linda/admixture/boyko_2016/breed_vcfs/Poodles_fixedchr_phased.tped



### make new intervals file with just SNPs we flipped

/seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc.map
now is cornell_CanHDSNPs_flipped_fixed.intervals


### test with new snap list
qsub -S /bin/bash -q vert -v indiv_name=20160701_cuishle_assembly_megabubbles_base_sorted \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N cuishsup \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh


### no SNPs##

## test one megabubble
samtools view /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted.bam chr37 | grep "Jc_chr37_2137676_2289879" | head -1 | bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_single_bubble.sh /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted -



### get megabubbles without header lines
cd /seq/vgb-HAL/linda/ancestry/megabubbles


#remove newlines from fasta entries 
sed ':a; $!N; /^>/!s/\n\([^>]\)/\1/; ta; P; D' 20160701_cuishle_assembly_megabubbles_base.fasta > cuishle_nonewline.fa

grep -v ">" 20160701_cuishle_assembly_megabubbles_base.fasta > bubble_length.fasta






### curate other breed pops

qsub -S /bin/bash -q vert -v thispop=Poodle \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -N Poodle \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/Dog_breed_curation.sh



mk_chr1_16472869_16499332

samtools view /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted.bam chr1 | grep "mk_chr1_16011659_16119375" | head -1 | bash /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_single_bubble.sh /seq/vgb-HAL/linda/ancestry/megabubbles/20160701_cuishle_assembly_megabubbles_base_sorted -


stdin_fn='mk_chr1_16435168_16469204'


####################### problem gorilla chromosome
## start chr20 again
qsub -S /bin/bash -q vert -v chr=chr20 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsd20chr.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd20chrnew.er \
 -N chr20angsd \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_10kb.sh


qsub -S /bin/bash -q vert -v chr=chr19 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/err/er \
 -N mus_lift19 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh


while read c; do
  qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/mus_out/out/llift${c}_err \
   -N muslift${c} \
   -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
   /wga/scr4/vgbgrp/linda/bal_sel/mus_liftover1.sh
done < mus_chr.txt


### cat mus lifts
/wga/scr4/vgbgrp/linda/bal_sel/mus_out10/mus_out_lifts1

cat * > ../mus_allchr_10kb.bed


while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500/out/nolift${c}_err \
 -N humnolift${c} \
 /wga/scr4/vgbgrp/linda/bal_sel/YRI_nolift_output.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/YRI_chr.txt

cat * > ../YRI_allchr_10kb.bed

cat * > ../Gorilla_mostchr_no20_10kb.bed
cd /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out10/final_lifts





### curate other breed pops, now phasing in 2mb

qsub -S /bin/bash -q vert -v thispop=Yorkshire_Terrier  \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -N Yorkshire_Terrier  \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/Dog_breed_curation.sh




### test support mix with one poodle
qsub -S /bin/bash -q vert \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N testSM \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb/linda/admixture/boyko_2016/test_SM/test_supportmix.sh



##### run with newly phased populations, mult variables
qsub -S /bin/bash -q vert -v chr=chr1 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N chr1 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles.sh




qsub -S /bin/bash -q vert -v chr=chr1 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N chr1 \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles_mutilalign.sh


## run rest of dog cars

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/supportmix_cuish \
 -e /seq/vgb-HAL/linda/ancestry/err/supportmix_cuish.err \
 -N ${c} \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/run_parallel_bubbles_mutilalign.sh
done < /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/rest_dogchrs.txt


Scally & Durbin 2012





#CURATE ALL 42 BREEDS!!! 
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/Dog_breed_curation.sh
done < /seq/vgb/linda/admixture/boyko_2016/breed_files/MY_BREED_LIST.txt



##### august 9th, GRASP

grep “Immune-related” | grep 

grep "word1" FILE | grep "word2"


awk '{ if ($11 <= 5e-5) print }' GRASP2fullDataset | grep "Immune" > all_genome_immune_5E5all.txt
# I’m only getting like 900, and all seem to be blood related as well
/seq/vgb/linda/GRASP


DAVID Gene Functional Classification 





######## move files back go vgb that I’m not currently using

rsync -va /seq/vgb-ce/linda/bal_sel/chains /seq/vgb-HAL/linda/bal_sel

rsync -va /seq/vgb-HAL/linda/ancestry /seq/vgb/linda/dog_ancestry



Possible new statistics instead of TajD: Tajima’s D other balancing selection statistics

T1 and T2
http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004561

http://www.personal.psu.edu/mxd60/Manual_BALLET_v1.0.pdf


tar -xzvf ballet_v1.0.tar.gz

use GSL
gcc ballet_v1_0.c –o BALLET –lm –lgsl -lgslcblas
gcc ballet_v1_0.c \342\200\223o BALLET \342\200\223lm \342\200\223lgsl -lgslcblas
gcc: –o: No such file or directory
gcc: BALLET: No such file or directory
gcc: –lm: No such file or directory
gcc: –lgsl: No such file or directory



gcc ballet_v1_0.c –o BALLET –lm –lgsl -lgslcblas


For creating polymorphism file:
http://popgen.dk/angsd/index.php/Allele_Frequencies
use -doMajorMinor 5 to use ancestral allele as major
“You can force the major allele according to your ancestral states if you have defined those -anc”

#get human ancestral sequence
wget http://popgen.dk/software/download/angsd/hg19ancNoChr.fa.gz
mv hg19ancNoChr.fa.gz chimpHg19.fa.gz
samtools faidx chimpHg19.fa.gz







#for chimp genetic map: http://panmap.uchicago.edu/data.html



############# September 7th, looking for coyote/wolf admixture in mutt dogs ##############

##mutts
based on the bam header, they were aligned to /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta

/seq/karlsson/MendelsMutts/vcfs/
and the plink bed file in /seq/karlsson/MendelsMutts/plink/




### golden

https://docs.google.com/spreadsheets/d/1X-WERplChOFfEhE3dTLsKiTdV150uOzR-szKSVAIBTM/edit?ts=57d033ae#gid=0

/seq/picard_aggregation/G12710/MB2A11_Normal




#### illumina canineHD array #####

/seq/vgb/linda/admixture/Illumina

### do by snap location
awk -F',' -v OFS='\t' '{ print $10”:”$11, $4, $3, $16}' CanineHD_B.csv > CanineHD_loc.snptable
## some SNPs don’t have a location chromosome and bp position both listed as “0”. These are not useful for comparing to genomic locations

cat CanineHD_B.csv  | cut -f10 -d , | sort | uniq
## this has chrs 1:38 and chrx 

## how many snaps don’t have a location?
grep '0:0' CanineHD_loc.snptable | wc -l
919


## get rid of SNPs with 0:0 location
grep -v '0:0' CanineHD_loc.snptable > CanineHD_loc_no0.snptable

## remove the first 7 lines
sed -i -e ‘1,7d' CanineHD_loc_no0.snptable

## get list of SNPs that were on the Illumina HD array
/seq/vgb/linda/admixture/Illumina
awk ‘{ print $1 }’ CanineHD_loc_no0.snptable > array_SNPs_loc.txt

## remove the first 8 lines
sed -i -e '1,8d' array_SNPs_loc.txt

## change X to 41
sed -i -E "s/^X/41/“ array_SNPs_loc.txt





############################## WHY I MERGED BY SNP NAME ######################

###### cornell data #######


/seq/vgb/linda/admixture/boyko_2016


### get cornell canine SNPs converted into locations

/seq/vgb/linda/admixture/boyko_2016/cornell_canine.bim


awk '{ print $1, $1”:”$4, $3, $4, $5, $6}’ cornell_canine.bim > cornell_canine_loc.bim

### replace X chromosome!! -- not doing this, plink hates it
sed -i -E "s/^41/X/" cornell_canine_loc.bim

sed -i -E "s/41:/X:/“ cornell_canine_loc.bim


plink --bed /seq/vgb/linda/admixture/boyko_2016/cornell_canine.bed \
 --bim /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.bim \
 --fam /seq/vgb/linda/admixture/boyko_2016/cornell_canine.fam \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs_loc.txt \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_loc

Duplicate marker name found: [ 8:33825304 ]
Duplicate marker name found: [ 11:60627269 ]
After frequency and genotyping pruning, there are 147955 SNPs

148277 SNPs in /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc.map
that i merged with SNP names... I’ll use this one

#I found 151985 CanineHD SNPs in the Boyko dataset previouslywhen merging by SNP name. I will just stick with that merging

sed -n '160158,160160p' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.bim


## these were the SNPs that appeared twice
chr8:33825304
chr11:60627269

above SNPs have been fixed in cornell_canine_loc_SNPfix.vcf

/seq/vgb/linda/admixture/boyko_2016



########### check snaps in flipped boyko dataset #########
cornell_canine_CanHDSNPs_converted_no39_loc.map
cornell_canine_CanHDSNPs_converted_no39_loc.ped


awk 'x[$2]++ == 1 { print $2 " is duplicated"}' cornell_canine_CanHDSNPs_converted_no39_loc.map



#90% genotyping rate, at least 1% MAF, up to 10% missing per individual, shouldn’t filter on HWE this way.. should be done by population
--geno 0.1 --mind 0.1 --hwe .001 --maf 0.01


plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc \
 --geno 0.1 \
 --mind 0.1 \
 --hwe .001 \
 --maf 0.01 \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc_filt

### this has clearly already been filtered
0 of 4342 individuals removed for low genotyping ( MIND > 0.1 )
27683 markers to be excluded based on HWE test ( p <= 0.001 )
	7543 markers failed HWE test in cases
	27683 markers failed HWE test in controls
Total genotyping rate in remaining individuals is 1
0 SNPs failed missingness test ( GENO > 0.1 )
125 SNPs failed frequency test ( MAF < 0.01 )





########## look at breed separation September 12, 2016 #########

https://www.cog-genomics.org/plink2/input#within


/seq/vgb/linda/admixture/boyko_2016/within_list.txt  #this list has dogs from each breed with at least 15 dogs per breed, 58 pops


use PLINK2
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc \
	--noweb \
	--dog \
	--within /seq/vgb/linda/admixture/boyko_2016/within_list.txt \
	--fst \
	--out /seq/vgb/linda/admixture/boyko_2016/out_15cutoffpop_fst

########## this looks at the total average instead of pairwise


############ look at IBS clustering
use PLINK2
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc \
	--dog \
	--within /seq/vgb/linda/admixture/boyko_2016/within_list.txt \
	--cluster \
	--keep-clusters breeds_min15dogs.txt \
	--mds-plot 5 by-cluster \
	--pca \
	--pca-clusters breeds_min15dogs.txt \
	--out /seq/vgb/linda/admixture/boyko_2016/out_15cutoffpop_clust


## need to use --keep-clusters (one cluster name per line)

--keep-clusters breeds_min15dogs.txt
--mds-plot


#### make the phenotypes the breeds 

### Einor’s phenotype list is missing 143 dogs from the Boyko dataset

## maybe in here:
https://datadryad.org/bitstream/handle/10255/dryad.99044/ShannonBoyko_All.nopheno.txt?sequence=1



### for now just get the dogs from the breeds that we want
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc \
	--dog \
	--recode \
	--keep /seq/vgb/linda/admixture/boyko_2016/within_list.txt \
	--out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15



############ look at IBS clustering, REDO WITH ONLY 15 RANDOM DOGS PER BREED!!!
use PLINK2
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc \
	--dog \
	--keep /seq/vgb/linda/admixture/boyko_2016/mydogs.15each.txt \
	--within /seq/vgb/linda/admixture/boyko_2016/within_list.txt \
	--cluster \
	--keep-clusters /seq/vgb/linda/admixture/boyko_2016/breeds_min15dogs.txt \
	--mds-plot 5 by-cluster \
	--pca \
	--out /seq/vgb/linda/admixture/boyko_2016/out_15cutoffpopchoose15_clust





# file A dogs.bigset.breeds.txt
NR==FNR{a[$2]=$3;next} => This is true when the fileA is processed. An associative array is formed where the index is the 2nd column with the 3rd column as its value.

## file B is cornell_canine_CanHDSNPs_converted_no39_loc.ped (tester.ped)
{$6=a[$3];} => When the second file is processed, Replace the 6th column with the appropriate value stored in the array.


awk 'NR==FNR{a[$2]=$3;next}{$6=a[$1];}1’ dogs.bigset.breeds.txt tester10.ped > out.test.txt


awk 'NR==FNR{a[$2]=$3;next}{$6=a[$1];}1' dogs.bigset.breeds.txt cornell_canine_CanHDSNPs_converted_no39_loc.ped > cornell_canine_CanHDSNPs_breed.ped


awk 'NR==FNR{a[$2]=$3;next}{$6=a[$1];}1' dogs.bigset.breeds.txt cornell_canine_breedmin15.ped > cornell_canine_breedmin15_breed.ped



### did all the breeds get added in?
cut -d' ' -f1-10 cornell_canine_breedmin15_breed.ped > cornell_canine_CanHDSNPs_breed10.ped

####change chr41 to X
##replace 41 with “X” ---> plink hates x change it later!!
sed -i -E "s/^41/X/" cornell_canine_CanHDSNPs_converted_no39.bim
41 chr41:6537056 30.2813 6537056


## how many variants on each chromosome?
awk '{A[$1]++}END{for(i in A)print i,A[i]}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_converted_no39_loc.map





########## doing PCA and Fst values with EIGENSOFT #########
 wget https://data.broadinstitute.org/alkesgroup/EIGENSOFT/EIG-6.1.4.tar.gz

fatalx:
idnames too long A1-HUC17-FEMALE-2356 A1-HUC17-FEMALE-2356 ll: 41 limit: 39
Aborted (core dumped)


### remove dash from the ped file 
sed -e 's/-/ /g' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.ped > /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_rmdash.ped


fatalx:
snpord overflow
Aborted (core dumped)
## maybe this relates to chr41 instead of ChrX ?????????


sed -i -E "s/^41/X/" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map
sed -i -E "s/chr41/chrX/" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map


snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   38 327572 17065892
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23     0  7402
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23    99 54039
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23   251 78962
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   38 327588 17068892
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23   292 103278
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23   299 11685
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23   355 174609
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/cornell_canine_breedmin15_breed.map (processing continues)   23   374 207967

#17068892 snap is repeated
#17065892 is repeated


snpord overflow
Aborted (core dumped)

/seq/vgb/linda/bin/EIG-6.1.4/bin/smartpca -p /seq/vgb/linda/admixture/Eigensoft/param_file.txt


awk -F " " '{print $2}’ cornell_canine_breedmin15_breed.map | sort | uniq | wc -l

awk 'a[$1] == "" { a[$1]="X" } END { print length(a) }' cornell_canine_breedmin15_breed.map



####################### why do I have different number of SNPs, and why sometimes have more repeats ???????################

downloaded from http://datadryad.org/resource/doi:10.5061/dryad.266k4

plink --bfile /seq/vgb/linda/admixture/boyko_2016/cornell_canine --recode --noweb --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine







###### chr39 is homozygous and was removed, chr41 is considered chromosome X




#################################### Boyko data , fixing############################################################################################################

/seq/vgb/linda/admixture/boyko_2016

From Methods: “All positions are listed in canFam3.1”

################# using SNP names ##############

cornell_canine.map
cornell_canine.ped

## how many variants on each chromosome?
awk '{A[$1]++}END{for(i in A)print i,A[i]}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map
## has chrs 1-39, 41
39 4087


### just get SNPs on the HD array ###
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs.txt \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_Sept14

“there are 151985 SNPs”
151985 cornell_canine_CanHDSNPs_Sept14.bim


### now convert these to locations, which ones aren’t in the true location conversion???
awk '{print $1, $1 ":" $4, $3, $4, $5, $6, $2}’ cornell_canine_CanHDSNPs_Sept14.bim > cornell_canine_CanHDSNPs_Sept14_toloc.bim





################# using SNP location ##############
#### replace SNP names with locations
awk '{print $1, $1 ":" $4, $3, $4}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map > /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.map


awk '{A[$1]++}END{for(i in A)print i,A[i]}' /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.map
## has chrs 1-39, 41
39 4087


## make matching ped file
cp /seq/vgb/linda/admixture/boyko_2016/cornell_canine.ped /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc.ped


### just get SNPs on the HD array ###
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs_loc.txt \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/cornell_canine_CanHDSNPs_loc_Sept14

 *** WARNING *** DUPLICATE MARKERS FOUND ***
Duplicate marker name found: [ 8:33825304 ]
Duplicate marker name found: [ 11:60627269 ]

“there are 147955 SNPs”
147955 cornell_canine_CanHDSNPs_loc_Sept14.bim   (4030 fewer SNPs with this method)


### fixed badly merged SNPs chr8:33825304, chr11:60627269
 in cornell_canine_loc_SNPfix.vcf

### remove chr 39 (hemizygous chrx)
grep "^39" cornell_canine_loc_SNPfix.vcf | head -10
grep -v “^39” cornell_canine_loc_SNPfix.vcf > cornell_canine_loc_SNPfix_no39.vcf
grep "^39" cornell_canine_loc_SNPfix_no39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf
grep -v "contig=<ID=39" cornell_canine_loc_SNPfix_no39.vcf > cornell_canine_loc_SNPfix_nochr39.vcf
grep "contig=<ID=39" cornell_canine_loc_SNPfix_nochr39.vcf
rm cornell_canine_loc_SNPfix_no39.vcf



########## which snaps do we not get by merging by location ??????? #############

awk 'NR==FNR{c[$2]++;next};c[$2] == 0' cornell_canine_CanHDSNPs_loc_Sept14.bim cornell_canine_CanHDSNPs_Sept14_toloc.bim > missing_SNPs.txt

4030 missing_SNPs.txt


head -10  missing_SNPs.txt
1 1:25004053 18.4573 25004053 A G BICF2P859065
1 1:25019806 18.6202 25019806 C A BICF2P1347877
1 1:25034144 18.6921 25034144 A T BICF2P295909
1 1:25044771 18.6979 25044771 G A BICF2P3694
1 1:25049946 18.6991 25049946 A G BICF2P1042202
1 1:25051093 18.6994 25051093 A T BICF2P1042201
1 1:25074448 18.7048 25074448 G A BICF2S23016234
1 1:25085967 18.7171 25085967 A G BICF2P532348
1 1:25102777 18.7324 25102777 A G TIGRP2P18250_rs9019380
1 1:25150177 18.8055 25150177 A G BICF2P680416




### compare for missing_SNPs.txt
/seq/vgb/linda/admixture/Illumina/CanineHD.name.loc
/seq/vgb/linda/admixture/boyko_2016/cornell_canine.map


## join the files by SNP name
sort -k2 /seq/vgb/linda/admixture/Illumina/CanineHD.name.loc > /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc

##remove first 18 lines
sed -i 1,18d CanineHD.namesort.loc

## remove last 5 lines
head -n -5 CanineHD.namesort.loc > CanineHD.namesort.loc2

sort -k2 /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map > /seq/vgb/linda/admixture/boyko_2016/cornell_caninenamesort.map




join -j 2 -o 1.2,1.1,2.1,1.3,2.4 /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc2 /seq/vgb/linda/admixture/boyko_2016/cornell_caninenamesort.map > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_merge.txt


## look for bp differences

awk 'NR == 1 { $6 = "diff." } NR >= 3 { $6 = $4 - $5 } 1' </seq/vgb/linda/admixture/Illumina/Illum_Boyko_merge.txt > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_merge2.txt

awk ' $6 > 0 ' /seq/vgb/linda/admixture/Illumina/Illum_Boyko_merge2.txt > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiff.txt


sort -k 6 /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiff.txt > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort.txt

## rm last line, which is fine
head -n -1 /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort.txt > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort2.txt


I am removing these SNPs because they are super far away from the actual confab 3.1 location;
Name	      chr chr Illum   Boyko    Difference
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418


### make table to use for changing bp positions

##rm last two large ones
head -n -2 /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort2.txt \
  > /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.tmp

awk '{print $1, $4}' /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.tmp > \
  /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.txt






grep BICF2P859065 /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv
grep BICF2P859065 /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map

BICF2P859065
chr1:25004055 according to Illumina
chr1:25004053 according to Boyko


BICF2P1347877
grep BICF2P1347877 /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv
grep BICF2P1347877 /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map

chr1:25019808 Illumina
chr1:25019806 Boyko


#################################### SNPtable data ########################################################################

Genome build: “3.1”

/seq/vgb/linda/admixture/Illumina

######### making the HD SNPtable , originally has chromosome X (not chr39)


173693 CanineHD_B.csv




################# using SNP names ##############
## I need cols 2, 4, 3, 16
awk -F',' -v OFS='\t' '{ print $2, $4, $3, $16}' CanineHD_B.csv > CanineHD.snptable

## I need cols 2, 4, 3, 16
awk -F',' -v OFS='\t' '{ print $10, $2, $11}' CanineHD_B.csv > CanineHD.name.loc

## delete first 8 lines of junk
sed -i 1,8d CanineHD.name.loc
sed -i -E "s/^X/41/" CanineHD.name.loc

## delete first 7 lines of junk
sed -i 1,7d CanineHD.snptable

173686 CanineHD.snptable

## get SNP list
awk '{ print $1 }' CanineHD.snptable > array_SNPs.txt

173686  array_SNPs.txt

## dont’ need to remove 0:0 SNPs or change X to 41 because not using locations

################# using SNP location ##############

#### THIS IS THE MOST CURRENT SNPTABLE BY LOCATION, IT CONTAINS EXTRA SNPS THAT HAVE A LOCATION IN THE BOYKO DATASET: CanineHD_locplus.snptable



awk -F',' -v OFS='\t' '{ print $10”:”$11, $4, $3, $16}' CanineHD_B.csv > CanineHD_loc.snptable #has crap at bottome

## delete first 7 lines of junk
sed -i 1,7d CanineHD_loc.snptable

173686 CanineHD_loc.snptable

### add in locations from Boyko dataset that are absent from Illumina
edits_file=/seq/vgb/linda/admixture/Illumina/my00.txt
orig_file=/seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt

173680 /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt
173662 /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable, difference is 18 lines of junk


join -a1 -1 2 -2 1 -o 1.2 1.3 1.4 1.5 1.6 2.1 2.2 -e NA \
    <(sort -k2 $orig_file) <(sort -k1 $edits_file) \
    | awk '{if ($7 != "NA"){$2 = $7}; print $1, $2, $3, $4, $5;}' \
    > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt

#get rid of first 18 lines of junk
sed -i 1,18d /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt

### it is 895 lines longer than CanineHD_loc_no0.snptable (+19 for extra junk and header in CanineHD_loc_no0.snptable) = 914 (within 5 of 0:0 SNP number 919, I’m moving on

awk '{print $2, $3, $4, $5}' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt \
  > /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.tmp

## thishas 751 0:0 that are not in boyko
grep -v '0:0' CanineHD_locplus.tmp > CanineHD_locplus.snptable

### add first header line
sed -i "1i $(head -n 1 CanineHD_loc_no0.snptable)" CanineHD_locplus.snptable


## replaced spaces with tabs







awk ‘{print $2, $3, $4, $5}’ /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt \
  > /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable

sed -i -E "s/^X/41/" /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable


grep -v '0:0' CanineHD_loc.snptable > CanineHD_loc_no0.snptable

## change X to 41
sed -i -E "s/^X/41/“ CanineHD_loc_no0.snptable
## get SNP list
awk ‘{ print $1 }’ CanineHD_loc_no0.snptable > array_SNPs_loc.txt

172767 array_SNPs_loc.txt (has 919 fewer SNPs, these have no known location)

awk -F ":" '{A[$1]++}END{for(i in A)print i,A[i]}' array_SNPs_loc.txt
## has chrs 1-38, 41


######### print array SNP names and locations

awk -F',' -v OFS='\t' '{ print $10, $2, $10":"$11, $4, $3, $16}' CanineHD_B.csv > CanineHD_names_loc.txt

## rm 8 lines of junk
sed -i 1,8d CanineHD_names_loc.txt
/seq/vgb/linda/admixture/Illumina/CanineHD_names_loc.txt

## rm last 5 of junk
Non-Specific Binding
        Non-Specific Binding
        Non-Specific Binding
        Non-Specific Binding
        Target Removal  

grep -v "Non-Specific Binding" /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc.txt > /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc.tmp

grep -v "Target Removal" /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc.tmp > /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt



########### Fixing the Boyko dataset #########

“These files contain 160,727 SNPs”

#1 Fix the two repeat SNPs
chr8:33825304
chr11:60627269

#2 Remove the two SNPs where the locations are very different between Illumina and Boyko
Name	      chr chr Illum   Boyko    Difference
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418

#3 For SNPs that have the same name, replace the position with that of the Illumina array
#There are 170 SNPs that are 1-2 bps off from what Illumina says, and 2 that are far away 
#/seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort2.txt
# This is the file that has SNP names and new locations: /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.txt

#4 Remove chr39 (hemizygous)

#5 Remove SNPs with no position info

#6 Change name of chr41 to chrX



#1 Fix the two repeat SNPs
chr8:33825304
chr11:60627269

/seq/vgb/linda/admixture/boyko_2016

cornell_canine.map
cornell_canine.ped

plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine \
 --extract /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Boyko_repeat_snps.txt \
 --recode \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_repeats \


### get file without repeats, (no individual contained calls for both SNPs
plink --file /seq/vgb/linda/admixture/boyko_2016/cornell_canine \
 --exclude /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Boyko_repeat_snps.txt \
 --recode \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats

## merge file with fixed repeat snaps, and remove the diff position snaps
plink --file /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats \
 --merge /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_repeats_fixed.ped \
 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_repeats_fixed.map \
 --recode \
 --dog \
 --exclude /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/rm_diff_pos.txt \
 --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats_rmdiffpos_merged

#2 Remove the two SNPs where the locations are very different between Illumina and Boyko
Name	      chr chr Illum   Boyko    Difference
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418


------- At this point I have 160,727 - 4 = 160,723 SNPs ---------


#3 For SNPs that have the same name, replace the position with that of the Illumina array
#There are 170 SNPs that are 1-2 bps off from what Illumina says, and 2 that are far away 
#/seq/vgb/linda/admixture/Illumina/Illum_Boyko_bpdiffsort2.txt
# This is the file that has SNP names and new locations: /seq/vgb/linda/admixture/Illumina/Illum_Boyko_bp_edits.txt


join -a1 -1 2 -2 1 -o 1.1 1.2 2.2 1.3 1.4 -e NA \
    <(sort -k2 $orig_file) <(sort -k1 $edits_file) \
    | awk '{if ($3 != "NA"){$5 = $3}; print $1, $2, $4, $5;}' \
    > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/test.map


BICF2P859065
chr1:25004055 according to Illumina
chr1:25004053 according to Boyko


### reorder SNPs like original map file
f1='/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/test.map'
f2='/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats_rmdiffpos_merged.map'


awk 'NR==FNR{o[FNR]=$2; next} {t[$2]=$0} END{for(x=1; x<=FNR; x++){y=o[x]; print t[y]}}' $f2 $f1 \
  > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map

------- At this point I still have 160,723 SNPs ---------


# Remove chr39 (hemizygous)
#verified chr39 is homozygous with grep "^39" /seq/vgb/linda/admixture/boyko_2016/cornell_canine_loc_SNPfix.vcf | head -10


# Remove SNPs with no position info (but there don’t seem to be any of those) 
## do some SNPs not have a location on Illumina array, but do have location in the boyko dataset?

/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map
/seq/vgb/linda/admixture/Illumina/CanineHD_names_loc.txt


join -j 2 -o 1.1,1.2,1.3,1.4,2.1,2.2,2.3,2.4,2.5,2.6 -e NA <(sort -k2 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map) <(sort -k2 /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt) > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt

## there are 172 SNPs where Boyko has a location, but Illumina does not list a location ##
grep " 0 " /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt | wc -l   
172
grep " 0 " /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt | awk '{print $2, $1 ":" $4}' > my00.txt

#replace chr39 with 41
sed -i -E “s/39:/41:/“ my00.txt


### add these Boyko locations to the Illumina SNP table (done above)


join -a1 -1 2 -2 1 -o 1.1 1.2 2.2 1.3 1.4 -e NA \
    <(sort -k2 $snptable_file) <(sort -k1 $boyko_file) \
    | awk '{if ($3 != "NA"){$5 = $3}; print $1, $2, $4, $5;}' \
    > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/test.map


## get rid of chr39 in boyko (chr39 is homozygous )


### current best datasets
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats_rmdiffpos_merged.ped
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map


## get rid of chr39

grep "^39" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map | awk '{print $2}' > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/chr_39_snps.txt

plink --ped /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_norepeats_rmdiffpos_merged.ped \
 --map /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_orderfix.map \
 --exclude /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/chr_39_snps.txt \
 --recode \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39

Reading list of SNPs to exclude [ /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/chr_39_snps.txt ] ... 4087 read
Before frequency and genotyping pruning, there are 156636 SNPs
After frequency and genotyping pruning, there are 156636 SNPs


### then look for number of SNP overlaps by SNP name and by SNP location...


## make new maple with location names
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.map


awk ‘{$1, $1 “:” $4, $3, $4}’ /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.map > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map


#### merge and count lines ###
## merge by col 2
map_loc=/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map
map_name=/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.map

## merge by col 1
snptab_loc=/seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable
snptab_name=/seq/vgb/linda/admixture/Illumina/CanineHD.snptable

## by loc
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) | wc -l 
148273

## by name
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) | wc -l 
148275

I am missing 2 SNPs

join -1 2 -2 1 -o 1.1 1.2 1.4 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) > overlap.loc.txt

join -1 2 -2 1 -o 1.1 1.2 1.4 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) > overlap.name.txt

awk '{print $2, $1 ":" $3}' overlap.name.txt > overlap.name2.txt


join -a1 -1 2 -2 2 -o 1.1 1.2 2.2 -e NA \
    <(sort -k2 overlap.name2.txt) <(sort -k2 overlap.loc.txt) > findmissing.txt

## these are the 2 remaining extra snaps when merged by name
BICF2G630812899 16:40340938 NA... here in illumina 16,40340937   16:40340937
BICF2S23230162 37:7636941 NA... here in illumina 37,7636940   37:7636940

## I will manually fix these two SNPs in cornell_canine_fixed_loc_no39.map and in cornell_canine_fixed_name_no39.map

## by loc
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) | wc -l 
148275


join -1 2 -2 1 -o 1.2 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) > snps_on_array.txt

## by name
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) | wc -l 
148275

YAY!!



I originally had 160,727 SNPs
4 were removed (two for being duplicates, two for being in and extremely wrong location)
4087 were removed for being homozygous, leaving 156636 SNPs 
8361 SNPs were not on the genotyping array leaving 148275 SNPs


#### the reason I previously didn’t get as many SNPs when I merged by location was
1. I hadn’t removed the chr39 from the named SNPs
2. There were Boyko snaps that were in a slightly different location
3. There were two Boyko snaps in a very different location, I removed these
3. There were SNPs that have a location according to Boyko, but had no location according to Illumina



#### now Flip SNPs!!

#make bed and only keep SNPs we know how to flip

plink --ped /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.ped \
 --map /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map \
 --make-bed \
 --extract /seq/vgb/linda/admixture/Illumina/snps_on_array.txt \
 --dog \
 --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_CanHD_fixed_loc_no39

we go from 156636 markers to 148275 here (8361 are not on the array and will need to be done with LD patterns)

perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_CanHD_fixed_loc_no39.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable \
 -intype top \
 -outtype dbsnp \
 -outfile /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39_CanHDflipped.bim



################## try to do Eigenstrat with full dataset (pre-flipped) ##############################


/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_CanHD_fixed_loc_no39


### Einor’s phenotype list is missing 143 dogs from the Boyko dataset

## maybe in here:
https://datadryad.org/bitstream/handle/10255/dryad.99044/ShannonBoyko_All.nopheno.txt?sequence=1 -> Dryad_breeds.txt 

/seq/karlsson/elinor/dogs.bigset.breeds.txt

cat /seq/vgb/linda/admixture/boyko_2016/dogs.bigset.breeds.txt /seq/vgb/linda/admixture/boyko_2016/Dryad_breeds.txt > /seq/vgb/linda/admixture/boyko_2016/more_breeds.txt

.... still missing breeds for 66 dogs when I include both lists

## missing some, like PFZ41D05

####### just get dogs that are in 15 dogs per breed set

use PLINK2
plink --ped /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.ped \
      --map /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map \
      --dog \
      --keep /seq/vgb/linda/admixture/boyko_2016/mydogs.15each.txt \
      --recode \
      --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen

Performing single-pass .bed write (156636 variants, 4342 dogs)




# add in breeds 

awk 'NR==FNR{a[$2]=$3;next}{$6=a[$1];}1' /seq/vgb/linda/admixture/boyko_2016/dogs.bigset.breeds.txt /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.ped > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen.ped


### did all the breeds get added in?
cut -d' ' -f1-10 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen.ped > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/TESTcornell_canine_fixed_BREED_no39.txt


### SMART PCA
/seq/vgb/linda/bin/EIG-6.1.4/bin/smartpca -p /seq/vgb/linda/admixture/Eigensoft/param_file.txt


fatalx:
idnames too long A1-HUC17-FEMALE-2356 A1-HUC17-FEMALE-2356 ll: 41 limit: 39
Aborted (core dumped)


### remove dash from the ped file 
sed -e 's/-//g' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen.ped > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen_rmdash.ped


fatalx:
snpord overflow
Aborted (core dumped)
## maybe this relates to chr41 instead of ChrX ?????????


sed -i -E "s/^41/X/" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map
sed -i -E "s/41:/X:/" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map


#17068892 snap is repeated
#17065892 is repeated


snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   38 335046 17621952 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23     0  7402 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23    99 54039 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23   251 78962 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   38 335100 17636562 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23   292 103278 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23   299 11685 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23   355 174609 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map (processing continues)   23   374 207967 



## may be a problem with different lengths
 awk '{printf “\t%.5d", $2,$3,$4}' db.txt
Output:

|00021|00078|00084|
|00023|00056|00058|
|00025|00021|00038|
|00025|00087|00097|
|00024|00055|00030|


printf "%09.6f\n" 23.00
#field width is 9 and 6 places after decimal

awk '{printf "%s %s %09.6f %s\n",$1, $2, $3, $4}' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map


snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   38 335046 17621952 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23     0  7402 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23    99 54039 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23   251 78962 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   38 335100 17636562 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23   292 103278 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23   299 11685 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23   355 174609 
snp order check fail (gdis order != physdis order): /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map (processing continues)   23   374 207967 


grep 23:7402 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen1.map




## it expects X to be numchrom +1 
sed -i -E "s/^X/39/" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map
sed -i -E "s/X:/39:/" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map


awk '{A[$1]++}END{for(i in A)print i,A[i]}' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map



######## convert to Eigenstrat format, still problem with snpord overflow#######

/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb/linda/admixture/Eigensoft/param_file_convert.txt



1:40pm boettger@vert02 /seq/vgb/linda/bin/EIG-6.1.4/bin $ /seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb/linda/admixture/Eigensoft/param_file_convert.txt
parameter file: /seq/vgb/linda/admixture/Eigensoft/param_file_convert.txt
ggenotypename: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen_rmdash.ped
snpname: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map
indivname: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen_rmdash.ped
outputformat: EIGENSTRAT
genooutfilename: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.eigenstratgeno
snpoutfilename: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.snp
indoutfilename: /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.ind

*** warning.  genetic distances are in cM not Morgans
1	1:120903967	100.066	120903967

fatalx:
snpord overflow
Abort (core dumped)
62.970u 1.139s 1:04.34 99.6%	0+0k 480+0io 1pf+0w



### check number of columns in file
awk '{print NF; exit}' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen_rmdash.ped
313278
		## the first 6 ccolumns are about the individual, then the rest are SNPs (313272/2 = 156,636 SNps expected)

##frommap file 

wc -l /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39_forEigen.map
156636



### did all the breeds get added in?
cut -d' ' -f1-10 /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_BREED_no39_forEigen_rmdash.ped > look.txt





### SMART PCA
/seq/vgb/linda/bin/EIG-6.1.4/bin/smartpca -p /seq/vgb/linda/admixture/Eigensoft/param_file.txt

norm used

fatalx:
(getsnps) null snpname
Abort (core dumped)

## maybe it hates the :

sed -i -E "s/:/_/" /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.snp

sed -i -E “s/_/_/“ /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.snp



############### look at Amy’s software for admixture simulation

https://github.com/williamslab/admix-simu/blob/master/README.md

wget https://github.com/williamslab/admix-simu/archive/master.zip


/seq/vgb/linda/bin/admix-simu-master



### test on English setter and Bull Terrier

## must duplicate column
awk ‘{print $1, $1}’ /seq/vgb/linda/admixture/boyko_2016/breed_files/English_Setter.txt>  /seq/vgb/linda/admixture/boyko_2016/breed_files_plink/English_Setter.txt

awk '{print $1, $1}' /seq/vgb/linda/admixture/boyko_2016/breed_files/Bull_Terrier.txt > /seq/vgb/linda/admixture/boyko_2016/breed_files_plink/Bull_Terrier.txt


### Convert to VCF
##removing family IDs in the process
use PLINK2

plink --ped /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.ped \
      --map /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map \
      --dog \
      --recode vcf-iid \
      --out /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase

156636 variants and 4342 dogs pass filters and QC.
Among remaining phenotypes, 53 are cases and 85 are controls.  (4204 phenotypes
are missing.)
--recode vcf-iid to
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase.vcf


## phase everything together with Beagle V4
“All individuals were combined in the imputation and phasing analysis. This had two purposes. First, BEAGLE performs better with a larger sample size, although its performance in simultaneous analysis of individuals from multiple populations has not been examined in detail. Second, if the imputation and haplotype phase inference were performed separately for each population, this could bias the inferred results to further separate the populations, potentially leading to inference of differences between populations when none exist. In contrast, when all populations are analyzed simultaneously, the bias is toward the average of all populations, which is of less serious consequence.” from Brian Browning
use Java-1.8

## Beagle 4 assumes the map is in the cM scale
### the Boyko dataset is in Morgans (I compared to a human file known to be in cM)

## I’m not using a map file here

cp /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase.vcf /seq/vgb-HAL/linda/mutts/boyko/



java -Xmx2048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=20000 \
    nthreads=4 \
    gt=/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase.vcf \
    out=/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_phased.vcf

## is okay in this file 1	2038666	1:2038666	G	A

### do this with script
qsub -S /bin/bash -q vert \
 -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/out.txt \
 -e /seq/vgb-HAL/linda/mutts/err.txt \
 -N muttphase \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /seq/vgb-HAL/linda/mutts/boyko/phase_dogs.sh


#The above is taking forever. It is the correct way to do it, but I’ll do a subset just to start testing admix-simu. I will want to go back later and use the above. 

## not subsetting in plink because of minor allele not present it gets dropped
plink --ped /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_name_no39.ped \
      --map /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_loc_no39.map \
      --keep /seq/vgb-HAL/linda/mutts/boyko/mydogs.subsetted.15eachforvcf.txt \
      --dog \
      --recode vcf-iid \
      --out /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_tmp

238 variants removed due to minor allele threshold(s)

## subset to just 6 breeds in vcftools, filter on frees that beagle will work
use VCFtools
/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools --vcf /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase.vcf \
    --keep /seq/vgb-HAL/linda/mutts/boyko/mydogs.subsetted.15eachforvcf.txt \
    --recode \
    --out /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_tophase

grep 1:13518974 /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_tophase.vcf

vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

$vcftools --vcf /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_fixed_no39_tophase.vcf \
   --keep /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/mydogs.15eachSEPT.txt \
   --recode --out /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_tophaseSEPT23 \


grep 1:13518974 /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_tophasenew.recode.vcf



After filtering, kept 90 out of 4342 Individuals
After filtering, kept 152149 out of a possible 156636 Sites


After filtering, kept 90 out of 4342 Individuals
After filtering, kept 154112 out of a possible 156636 Sites

java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=20000 \
    nthreads=4 \
    gt=/seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_tophaseSEPT23.recode.vcf \
    out=/seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subsetSEPT23_phased



#convert phased vcf to ped

$vcftools --vcf /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_phased.vcf \
    --plink \
    --out /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_phased


###### by population ####
$vcftools --vcf /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_phased.vcf \
    --plink \
    --keep /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle15.txt \
    --out /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased

Error: Flag Type must have 0 entries: ID=IMP,Number=1,Type=Flag,Description="Imputed marker">

$vcftools --vcf /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_phased.vcf \
    --plink \
    --keep /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussellTerrier15.txt \
    --out /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased


### now ped to eigenstrat 


## Beagle 4 assumes the map is in the cM scale
### the Boyko dataset is in Morgans (I compared to a human file known to be in cM)

From Eigenstrat: “*** warning.  genetic distances are in cM not Morgans” - does this mean my distances are cM and they shouldn’t be? or that Eigenstrat interprets cM while other programs usually interpret Morgans???

/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb-HAL/linda/mutts/boyko/pops/param_file_convert_ToyPoodle.txt
/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb-HAL/linda/mutts/boyko/pops/param_file_convert_JackRussell.txt

all individuals set ignore.  Likely input problem (col 6)
resetting all individual...
genotype file processed
numvalidind:     15  maxmiss: 15001
eigenstrat output


## convert ped to Eigenstrat using previous map file from before phasing

“The English Bulldog also known as the Bulldog (by AKC)” - http://bulldogtypes.webs.com/

http://dogdimension.com/2008PopularityStats.html


## changed name JackRussell_subset_phased.phgeno  to JackRussell.phgeno


## 25% JRT, 75% Toy poodle
/seq/vgb/linda/bin/admix-simu-master/simu-mix.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackPoo.dat \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased.snp \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo \
    -ToyPoodle /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle.phgeno \
    -JackRussell /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell.phgeno \
    > /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/myRands.txt


## create bp ancestry
/seq/vgb/linda/bin/admix-simu-master/bp2anc.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo.bp \
    > Jackpoo.hanc


Average number of break points per individual: 71.1428571428571
### this isa  file of 0s and 1s

tr -d -c '0\n' < /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc | awk '{ print length; }'

0
0
58795
0
0
0
0
0
0
82887
65452
0
0
87440


71 recomb events/genome
156,000 SNPs/71
F1 - no breaks
F2 - 2206 avg hap
F3 - 30 SNps avg hap




##  some individuals are completely composed of one breed, I’m going to only simulate 1 haplotype


### Let’s lookat all JRT, all ToyPood, etc and what do we call?

qsub -S /bin/bash -v thispop=Schipperke -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/mutts/err/breed_cur.err \
 -N Schipperke \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_SEPT.sh









## curate breeds
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_SEPT_my14.sh
done < /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/Breed_list_15.txt


Weimaraner


qsub -S /bin/bash -v thispop=Weimaraner -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -N Weimaraner \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_SEPT_my14.sh



$vcftools --vcf /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subset_phased.vcf \
    --plink-tped \
    --keep /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle15.txt \
    --out /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased



qsub -S /bin/bash -v thisdog=PFZ44B11___Siberian_Husky -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/SHusky_100.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_sm.err \
 -N SHusky100 \
 /seq/vgb-HAL/linda/mutts/scripts/Supportmix_testers_switch100.sh




qsub -S /bin/bash -v thispop=Jack_Russell_Terrier -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -N JRT \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_SEPT_my14switch.sh



########### run all breeds with windows of 100 SNPs and 10 SNPs
while read c; do
qsub -S /bin/bash -v thisdog=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur30_${c}.out \
 -e /seq/vgb-HAL/linda/ancestry/err/newbreed_cur.err \
 -p -10 \
 -N thir_${c} \
 /seq/vgb-HAL/linda/mutts/scripts/Supportmix_testers30.sh
done < /seq/vgb-HAL/linda/mutts/boyko/pop_lists_14/my15th_testers.txt



supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix

$supportmix \
    --chromosome=$(awk -v chr=$stdin_chr 'BEGIN {print substr(chr,4)}') \
    --window=$num_snps \
    --generations=0 \
    --save $tmp_path/$stdin_fn.sm \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Australian_Shepherd_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Basenji_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Basset_Hound_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Beagle_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Bernese_Mountain_Dog_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Bichon_Frise_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Border_Collie_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Border_Terrier_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Boston_Terrier_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Boxer_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Bull_Terrier_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Cavalier_King_Charles_Spaniel_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Cocker_Spaniel_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Dachshund_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Doberman_Pinscher_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/English_Bulldog_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/English_Cocker_Spaniel_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/English_Setter_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/English_Springer_Spaniel_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/French_Bulldog_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/German_Shepherd_Dog_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Golden_Retriever_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Gordon_Setter_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Havanese_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Irish_Wolfhound_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Jack_Russell_Terrier_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Labrador_Retriever_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Maltese_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Mastiff_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Miniature_Schnauzer_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Newfoundland_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Papillon_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Poodle_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Rottweiler_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Saint_Bernard_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Schipperke_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Scottish_Terrier_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Shetland_Sheepdog_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Shih_Tzu_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Vizsla_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Weimaraner_fixedchr_phased.tped \
    /seq/vgb/linda/admixture/boyko_2016/breed_tpeds/Yorkshire_Terrier_fixedchr_phased.tped \
    $tmp_path/$this_bubble'_merged.tped' > /dev/null



seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix --chromosome=chr16 --window=3 -s /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_test2locations_supportmix /seq/vgb/linda/admixture/boyko_2016/Golden_Retrievers_phased.tped /seq/vgb/linda/admixture/boyko_2016/Poodles_phased.tped /seq/vgb/linda/admixture/10xg/Cuishle_domestic_canine_assembly/Cuishle_aln_test2locations.tped 


### maybe rid 
sed -i -E "s/(\d+)\:/chr$1\:/" /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subsetSEPT23_phasedchr.vcf
gsub(“\d+:”, “chr$1:”, x)



gsub(“(\d+)\:”, "chr$1\:”, /seq/vgb-HAL/linda/mutts/boyko/cornell_canine_fixed_no39_subsetSEPT23_phasedchr.vcf)





############ Sept 28th, troubleshooting admix-simu #########

## Beagle 4 assumes the map is in the cM scale
### the Boyko dataset is in Morgans (I compared to a human file known to be in cM)


## 25% JRT, 75% Toy poodle
/seq/vgb/linda/bin/admix-simu-master/simu-mix.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackPoo.dat \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased.snp \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo \
    -ToyPoodle /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle.phgeno \
    -JackRussell /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell.phgeno


## create bp ancestry
/seq/vgb/linda/bin/admix-simu-master/bp2anc.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo.bp \
    > /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc


Average number of break points per individual: 71.1428571428571
### this isa  file of 0s and 1s

tr -d -c '0\n' < /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc | awk '{ print length; }'



######### can I simulate with one dog from each breed? ########




## multiply by 100 to convert from morgans to cM

/seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased.snp

!!!# this isn’t correct, admix-simu uses morgans, not cM!!!!! 
see this from their input file:
0.023900         2389972 G A (we expect ~1cM/Mb), so if this were in cM, we would have expected 2.3, but it is 0.023 suggesting morgans


awk '{$3=$3*100;print}' /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased.snp > /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_cM.snp


/seq/vgb/linda/bin/admix-simu-master/simu-mix.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackPoo.dat \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased.snp \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo \
    -ToyPoodle /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle.phgeno \
    -JackRussell /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell.phgeno

## create bp ancestry
/seq/vgb/linda/bin/admix-simu-master/bp2anc.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo.bp \
    > /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc

tr -d -c '0\n' < /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc | awk '{ print length; }'


## it simulates many more individuals than I ask for
Simulating: Generation:  3, Admixed: 0.500 JackRussell: 0.000 ToyPoodle: 0.500 
Simulated all 10000 individuals in generation 3            

Done simulating break point locations.
Producing haplotypes using breakpoints file
Average number of break points per individual: 73.05
Error: used all 15 haplotypes in pop ToyPoodle (ind 21, marker 0)
523.773u 0.158s 8:44.11 99.9%	0+0k 40+312io 0pf+0w
...... but it can’t print out more than n-1 the individuals I give it..?

Simulating: Generation:  3, Admixed: 0.500 JackRussell: 0.000 ToyPoodle: 0.500 
Simulated all 10000 individuals in generation 3            

Done simulating break point locations.
Producing haplotypes using breakpoints file
Average number of break points per individual: 80.9285714285714
done.



I’m confused about why I’m getting chromosomes with single ancestry composition from a population that last contributed 3 generations ago. 

I think  it’s because this is simulating populations rather than individuals, and sometimes you’ll get some individuals that never have any ancestry from breed2 

....> I could just take individuals with 75/25 etc. 

3 generations:
77488
0
0
67363
0
59846
0
75891
90673
156636
0
0
0
0

2 generations:
0
0
0
156636
156636
156636
0
0
0
0
156636
156636
0
0


##2 generations, try 2
156636
0
0
156636
156636
156636
156636
0
156636
156636
156636
0
156636
0


2 generations, try 3:
156636
156636
156636
156636
0
0
0
0
156636
0
156636
0
0
0


### 4 generations
0
0
0
0
0
0
0
41570
0
0
42538
0
0
0


##### 4 generations
81802
0
46575
0
0
0
39927
0
0
0
0
39261
0
0




############ what happens if I simulate with only 1 ind. from each breed?

genooutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased_one.phgeno
snpoutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased_one.snp
indoutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased_one.ind


genooutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_one.phgeno
snpoutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_one.snp
indoutfilename: /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_one.ind


/seq/vgb/linda/bin/admix-simu-master/simu-mix.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackPoo.dat \
    /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_one.snp \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo \
    -ToyPoodle /seq/vgb-HAL/linda/mutts/boyko/pops/ToyPoodle_subset_phased_one.phgeno \
    -JackRussell /seq/vgb-HAL/linda/mutts/boyko/pops/JackRussell_subset_phased_one.phgeno

“Average number of break points per individual: 101
Average number of break points per individual: 58


## create bp ancestry
/seq/vgb/linda/bin/admix-simu-master/bp2anc.pl \
    /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/JackPoo.bp \
    > /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc

tr -d -c '0\n' < /seq/vgb-HAL/linda/mutts/boyko/pops/simu_output/Jackpoo.hanc | awk '{ print length; }'



## result
36098



##################################### Data Filtering with data from Jess >1% freq SNPs, Boyko data ################################


### what about the known duplicated SNPs??? (They are each only found once in this dataset)

 *** WARNING *** DUPLICATE MARKERS FOUND ***
Duplicate marker name found: [ 8:33825304 ]
Duplicate marker name found: [ 11:60627269 ]



They are fine here:
 grep 33825304 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim
8       chr08_36824560  20.9889 33825304        G       C

grep 60627269 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim
11      chr11_63626153  41.0892 60627269        C       G

dir:  /seq/vgb-HAL/linda/mutts/boyko_allSNPs

### how many snps are <1% freq

--maf 0.01
plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.fam \
 --maf 0.01 \
 --make-bed \
 --hardy \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/tmp


## they use ratio of observed and expected heterozygotes

## 180117 markers to be included from [ /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim ]
“In total, 180,117 SNPs remained after filtering, with an overall call rate of >99.8%” ---> SO this data has already been filtered for HWE!!!



## for MAF 0.01
We have 2167 males, 2164 females, and 8 of unspecified sex = 4339 dogs!!! 4342 dogs in cornell_canine.fam
18718 SNPs failed frequency test ( MAF < 0.01 )
After frequency and genotyping pruning, there are 161399 SNPs (remove Mitochondrial 161399 - 406 =160993
## with <0.01 freq removed we had 160727 /seq/vgb/linda/admixture/boyko_2016/cornell_canine.map SNPs
## maybe this relates to chr40 and 0? 0 had 286 variants, 120 on chr40 = 406 SNPs

### It looks like I have pre-filtered dataset. I have 160993 when imitating the 1%freq data, when I was expecting 160727.

## what about dogs?



### ~15k SNPs are invariant, 657 in less than 5 dogs, 2126 SNPs are in more than 5 dogs, but less than 1% freq
18,718 SNPs failed frequency test ( MAF < 0.01 )
16,592 SNPs failed frequency test ( MAF < 0.001 )
15,935 SNPs failed frequency test ( MAF < 1e-05 ) # invariant




### get rid of chromosomes we don’t need (39 is hemizygous X, 40 is Y, 0 is mitochondria) 


grep '^0\|^39\|^40' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim | awk '{print $2}' > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_hemiChrs.txt  (6245 lines)

0 748
39 5196
40 301
6245 SNPs expected to be removed

plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.fam \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_hemiChrs.txt \
 --make-bed \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs

After frequency and genotyping pruning, there are 173872 SNPs


################## how many SNPs match Affy by name? (164,677)


173686 /seq/vgb/linda/admixture/Illumina/array_SNPs.txt

plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs.fam \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs.txt \
 --make-bed \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names

After frequency and genotyping pruning, there are 164677 SNPs


plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.fam \
 --recode \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names




 ################## how many SNPs match Affy by location? (164,131)
#change to location
awk '{print $1, $1 ":" $4, $3, $4, $5, $6}' boyko_rmchrs.bim > boyko_rmchrs_toloc.bim


172767 /seq/vgb/linda/admixture/Illumina/array_SNPs_loc.txt - there are this many SNPs, but only 164131 overlap


plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_toloc.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs.fam \
 --extract /seq/vgb/linda/admixture/Illumina/array_SNPs_loc.txt \
 --make-bed \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_loc

After frequency and genotyping pruning, there are 164131 SNPs


##### what chromosomes do I have? ######

awk '{print $1}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim_toloc.bim | sort | uniq | wc -l

cut -f1 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim_toloc.bim | sort | uniq

cut -f 1 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim_toloc.bim | sort | uniq

awk '{A[$1]++}END{for(i in A)print i,A[i]}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/geno_data_pre_updated.bim



##### I am missing 164,677 - 164,131 = 546 SNPs 
########## which snps do we not get by merging by location ??????? #############

awk '{print $1, $1 ":" $4, $3, $4, $5, $6, $2}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.bim > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmergtoloc.bim


awk 'NR==FNR{c[$2]++;next};c[$2] == 0' boyko_rmchrs_CanHD_loc.bim boyko_rmchrs_CanHD_namesmergtoloc.bim > missing_SNPs.txt

wc -l missing_SNPs.txt
546



### compare for missing_SNPs.txt
/seq/vgb/linda/admixture/Illumina/CanineHD.name.loc
/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.map


## join the files by SNP name
sort -k2 /seq/vgb/linda/admixture/Illumina/CanineHD.name.loc > /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc

##remove first 18 lines
sed -i 1,18d /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc

## remove last 5 lines
head -n -5 /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc > /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc2

sort -k2 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.map > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namessort.map


join -j 2 -o 1.2,1.1,2.1,1.3,2.4 /seq/vgb/linda/admixture/Illumina/CanineHD.namesort.loc2 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namessort.map > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_merge.txt


## look for bp differences

awk 'NR == 1 { $6 = "diff." } NR >= 3 { $6 = $4 - $5 } 1' </seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_merge.txt > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_merge2.txt

awk ' $6 > 0 ' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_merge2.txt > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiff.txt

193 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiff.txt

sort -k 6 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiff.txt > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiffsort.txt

two really bad ones: 
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418

## rm last line, which is fine
head -n -1 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiffsort.txt > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiffsort2.txt


I am removing these SNPs because they are super far away from the actual confab 3.1 location;
Name	      chr chr Illum   Boyko    Difference
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418


### make table to use for changing bp positions

##rm last two large ones
head -n -2 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bpdiffsort2.txt \
  > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bp_edits.tmp

awk '{print $1, $4}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bp_edits.tmp > \
  /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bp_edits.txt

orig_file=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.map
edits_file=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bp_edits.txt


join -a1 -1 2 -2 1 -o 1.1 1.2 2.2 1.3 1.4 -e NA \
    <(sort -k2 $orig_file) <(sort -k1 $edits_file) \
    | awk '{if ($3 != "NA"){$5 = $3}; print $1, $2, $4, $5;}' \
    > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmoved.map


### reorder SNPs like original map file
f1='/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmoved.map'
f2='/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.map'


awk 'NR==FNR{o[FNR]=$2; next} {t[$2]=$0} END{for(x=1; x<=FNR; x++){y=o[x]; print t[y]}}' $f2 $f1 \
  > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmovedfixed.map

## I have 164677 SNPs


################## Look for SNPs with boyko location an no Illumina location ##########

/seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt

join -j 2 -o 1.1,1.2,1.3,1.4,2.1,2.2,2.3,2.4,2.5,2.6 -e NA <(sort -k2 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmovedfixed.map) <(sort -k2 /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt) > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt

## there are 172 SNPs where Boyko has a location, but Illumina does not list a location ##
grep " 0 " /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt | wc -l   
356
grep " 0 " /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/look_for_00.txt | awk '{print $2, $1 ":" $4}' > my00.txt


### add in locations from Boyko dataset that are absent from Illumina
edits_file=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/my00.txt
orig_file=/seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt  
(has 919 0:0)


join -a1 -1 2 -2 1 -o 1.2 1.3 1.4 1.5 1.6 2.1 2.2 -e NA \
    <(sort -k2 $orig_file) <(sort -k1 $edits_file) \
    | awk '{if ($7 != "NA"){$2 = $7}; print $1, $2, $3, $4, $5;}' \
    > /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt


(has 751 0:0)

#get rid of first 18 lines of junk
sed -i 1,18d /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt

awk '{print $2, $3, $4, $5}' /seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt \
  > /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable


#### merge and count lines ###

awk '{print $1, $1 ":" $4, $3, $4}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmovedfixed.map \
> /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_locmovedfixed.map


## merge by col 2
map_loc=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_locmovedfixed.map
map_name=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmovedfixed.map

## merge by col 1
snptab_loc=/seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable
snptab_name=/seq/vgb/linda/admixture/Illumina/CanineHD.snptable

## by loc
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) | wc -l 
164675

## by name
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) | wc -l 
164677

## now I’m 2 SNps off...

### I’m still 5 Snps off(2 snaps yet to remove I’m 3 off!!!
##### I was missing 164,677 - 164,131 = 546 SNPs 

## There were 190 where bp pos fixed in boyko 190 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/Illum_Boyko_bp_edits.txt
## There were 172 that had no location in Illumina, but did in boyko 172 /seq/vgb/linda/admixture/Illumina/my00.txt


join -1 2 -2 1 -o 1.1 1.2 1.4 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) > overlap.loc.txt

join -1 2 -2 1 -o 1.1 1.2 1.4 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) > overlap.name.txt

awk '{print $2, $1 ":" $3}' overlap.name.txt > overlap.name2.txt


join -a1 -1 2 -2 2 -o 1.1 1.2 2.2 -e NA \
    <(sort -k2 overlap.name2.txt) <(sort -k2 overlap.loc.txt) > findmissing.txt

grep NA findmissing.txt
BICF2G63027171 11:8978200 NA X
BICF2G630812899 16:40340938 NA
BICF2S23755960 17:64239564 NA X
BICF2G630645172 21:28025326 NA
BICF2S23230162 37:7636941 NA


BICF2G630812899 16:40340938 NA should be 16:40340937
BICF2G630645172 21:28025326 NA should be 21:28025325
BICF2S23230162 37:7636941 NA should be 37:7636940

### fixed by hand in /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_locmovedfixed.map


grep in /seq/vgb/linda/admixture/Illumina/CanineHD_names_loc2.txt  


I am removing these SNPs because they are super far away from the actual confam 3.1 location;
Name	      chr chr Illum   Boyko    Difference
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418


grep NA findmissing.txt | wc -l 
5


grep NA findmissing.txt | awk '{print $1, $2}' > current_missing.txt


### join missing with SNPtable file


snptab_name=/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/Illumina_snoconv_addedpos.txt

missing=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/current_missing.txt

join -a1 -1 1 -2 1 -o 1.1 1.2 1.3 2.1 2.2 -e NA \
    <(sort -k1 $snptab_name) <(sort -k1 $missing) \
    > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/wtf.txt



### get rid of these SNPS
BICF2G63027171 11:8978200 NA X
BICF2S23755960 17:64239564 NA X

... locations put in far_away.txt

## remove these snps
plink --map /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_namesmovedfixed.map \
 --ped /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs_CanHD_names.ped \
 --recode \
 --dog \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/far_away.txt \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_namesFIXED


awk ‘{print $1, $1 ":" $4, $3, $4}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_namesFIXED.map > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFIXED.map


### current files
map_loc=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFIXED.map
map_name=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_namesFIXED.map

## merge by col 1
snptab_loc=/seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable
snptab_name=/seq/vgb/linda/admixture/Illumina/CanineHD.snptable


## by loc
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) | wc -l 
164675


join -1 2 -2 1 -o 1.2 \
    <(sort -k2 $map_loc) <(sort -k1 $snptab_loc) > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/snps_on_array_loc.txt


join -1 2 -2 1 -o 1.2 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/snps_on_array_name.txt

## by name
join -1 2 -2 1 -o 1.2 2.1 \
    <(sort -k2 $map_name) <(sort -k1 $snptab_name) | wc -l 
164675 YAY!!!





########################## FLIP SNPS

#### now Flip SNPs!!

#make bed 
plink --ped /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_namesFIXED.ped \
 --map /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFIXED.map \
 --make-bed \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFIXED


perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFIXED.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable \
 -intype top \
 -outtype dbsnp \
 -outfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFLIPPED



########### get File of non-array SNPs

### using the allsnps file after I removed cars we don’t want
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs
After frequency and genotyping pruning, there are 173872 SNPs


## this has list of array snaps: /seq/vgb-HAL/linda/mutts/boyko_allSNPs/snps_on_array_name.txt, to it I’m adding the two wrong location snps (I also want to get rid of these)


plink --bfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/boyko_rmchrs \
 --make-bed \
 --dog \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/snps_on_array_name.txt \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs
Reading list of SNPs to exclude [ /seq/vgb-HAL/linda/mutts/boyko_allSNPs/snps_on_array_name.txt ] ... 164677 read
Before frequency and genotyping pruning, there are 9195 SNPs
4339 founders and 0 non-founders found
Total genotyping rate in remaining individuals is 0.862818
2167 males, 2164 females, and 8 of unspecified sex

## How many of these 9195 additional SNPs are intermediate frequency (MAF >20%) A/T or G/C SNPs???

plink --bfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs \
 --freq \
 --dog \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs_freq

########## NOTE THESE ARE THE SNPS I WILL NEED TO COME BACK AND FLIP !!!!!!!!!!!!!!!!!!!!

plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs.fam \
 --dog \
 --recode \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc



plink --bed /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs.bed \
 --bim /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.bim \
 --fam /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs.fam \
 --dog \
 --maf 0.0001 \
 --recode \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPslocmaf
610 variants removed due to minor allele threshold(s)


plink --file /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPslocmaf \
  --dog \
  --freq \
  --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPslocmafFREQ



#487 A/T SNPs, 201 at >20% MAF
grep -E "\s+(A|T)\s+(A|T)\s+(0\.0|0\.1)" /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPslocmafFREQ.frq | wc -l
201


#575 G/C SNPs, 232 at >20% MAF
grep -E "\s+(G|C)\s+(G|C)\s+(0\.0|0\.1)" /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPslocmafFREQ.frq | wc -l
232


######################### MERGE THE FLIPPED ARRAY SNPS and the UNFLIPPED SNPs for temporary file to work with in VCF format #################

NOTE: these files were moved here
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation

######################## also get rid of invariant SNPs with maf=0.0001 (19076 variants removed)
### 21397 variants removed due to minor allele threshold(s) with maf of 0.01 (so we have an extra 11000 SNPs beyod public data

awk '{print $1, $1 ":" $4, $3, $4, $5, $6}' /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPs.bim > /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.bim

ERROR: REF field is not a sequence of A, C, T, G, or N characters at 9:1544373 [I]
### remove SNps “I/D” I guess these are indels?



plink --bfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFLIPPED \
 --merge /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.ped /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/mydogs.15eachSEPTforvcf_fromped.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each


--exclude: 173853 variants remaining.
--keep: 869 dogs remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 869 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate in remaining samples is 0.973278.
14977 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
158876 variants and 869 dogs pass filters and QC.

## moving files
mv /seq/vgb-HAL/linda/mutts/boyko_allSNPs/data_curation/* /seq/vgb/linda/mutts/boyko_allSNPs/data_curation

############## 

### get mutt data in same format as our ref (remove chr before chromosome number and add in SNP name (chr:loc) to third column
cp /seq/karlsson/MendelsMutts/vcfs/MuttsWGS-snps.vcf /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snps.vcf

#get rid of the “chr”
sed -i 's/chr//g' /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snps.vcf


### just get variable loci on canHD 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED \
 --dog \
 --maf 0.0001 \
 --keep /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mydogs.15eachSEPTforvcf_fromped.txt \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --recode \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPED_VAR




## get list of SNPs we want to keep
awk -F “\t” '{print $1, $4}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED_VAR.bim > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPloclist.txt

150665 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED_VAR.bim

#output just the SNPs we need
vcftools  --positions <filename> (tab separated chr position)





/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --vcf /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snps.vcf \
    --positions /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPloclist.txt \
    --plink \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD

plink --ped /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD.ped \
 --map /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD.map \
 --dog \
 --maf 0.0001 \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_keepsnps.txt \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt

Error: Variant '1:25004055' is not biallelic. To obtain a full list of merge

After filtering, kept 21 out of 21 Individuals
Outputting VCF file...

After filtering, kept 145387 out of a possible 14700731 Sites

--extract: 144766 variants remaining.


#### merge reference and mutts 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPED_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_ref15_ourmutts

Error: 139 variants with 3+ alleles present.







#with myvcftools in v1.12
Error: VCF version must be v4.0, v4.1 or v4.2:
You are using version VCFv4.2  ##fileformat=VCFv4.2:

#remove second format tagg
##fileformat=VCFv4.2  ##fileformat=VCFv4.2:

sed 's/^##fileformat=VCFv4.2  ##fileformat=VCFv4.2:/##fileformat=VCFv4.2/' /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit.vcf > /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit2.vcf


remove the first line of the vcf file 
##fileformat=VCFv4.2  ##fileformat=VCFv4.2:

tail -n +2 /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit.vcf > /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit2.vcf


screen -dr 487
/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools --vcf /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit2.vcf \
    --snps /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPlist.txt \
    --recode \
    --out /seq/vgb-HAL/linda/mutts/mutt_vcfs/MuttsWGS-snpsedit2_CanHD.vcf

“After filtering, kept 0 out of 0 Individuals”


screen -dr 548
#getting 10xg vcfs
 wget https://s3-us-west-2.amazonaws.com/10x.outbound/bab100437e5f0d91/Dog_Long_Ranger_data.tar (2 day estimated download time)


#CHROM POS #CHROM:POS REF ALT QUAL FILTER INFO FORMAT D131 D132 D157 D158_2 D181_2 D182 D183 D184 D198 D199 DX01 DX02 DX03 DX04 DX05 DX06 DX07 DX08 DX09 DX10 DX11


#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	435	1107	3166

# combine with our mutts 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/mydogs.15eachSEPTforvcf_fromped.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each







data for mutts:
chr1	4782	.	A	G	1003.43	HardFilter	AC=11;AF=0.262;AN=42;BaseQRankSum=0.431;ClippingRankSum=0.00;DP=203;ExcessHet=10.7378;FS=192.397;InbreedingCoeff=-0.3816;ML
EAC=11;MLEAF=0.262;MQ=44.36;MQRankSum=-1.973e+00;QD=8.96;ReadPosRankSum=0.00;SOR=7.784	GT:AD:DP:GQ:PGT:PID:PL	0/1:4,2:6:36:.:.:36,0,94	0/0:6,0:6:15:.:.:0,15,225	0/0:7,0:7:2
1:.:.:0,21,192	0/1:7,4:11:77:.:.:77,0,168	0/0:1,0:1:3:.:.:0,3,28	0/0:4,0:4:6:.:.:0,6,90	0/1:8,3:11:50:.:.:50,0,190	0/0:12,0:12:36:.:.:0,36,314	0/0:13,0:13:33:.:.:0,33,495
	0/1:7,6:13:99:.:.:127,0,157	0/1:2,3:5:42:0|1:4782_A_G:96,0,42	0/0:11,0:11:33:.:.:0,33,318	0/1:4,12:16:57:.:.:278,0,57	0/1:19,6:25:99:0|1:4782_A_G:141,0,1032	0/1
:1,2:3:19:.:.:46,0,19	0/0:16,0:16:45:.:.:0,45,675	0/0:2,0:2:6:.:.:0,6,60	0/1:1,3:4:15:0|1:4782_A_G:86,0,15	0/0:7,0:7:21:.:.:0,21,179	0/1:8,4:12:86:.:.:86,0,187	0/1
:3,3:6:62:.:.:64,0,62
chr1	4800	.	G	A	551.19	HardFilter	AC=11;AF=0.306;AN=36;BaseQRankSum=0.413;ClippingRankSum=0.00;DP=189;ExcessHet=6.9049;FS=178.569;InbreedingCoeff=-0.3315;MLE
AC=12;MLEAF=0.333;MQ=47.21;MQRankSum=-2.212e+00;QD=5.57;ReadPosRankSum=0.492;SOR=6.993	GT:AD:DP:GQ:PGT:PID:PL	0/1:6,2:8:30:.:.:30,0,162	0/0:1,0:1:3:.:.:0,3,13	0/0:9,0:9:27:.:.:0,
27,242	0/1:10,3:13:25:.:.:25,0,262	./.:0,0:0:.:.:.:0,0,0	0/0:4,0:4:0:.:.:0,0,48	0/1:11,2:13:16:.:.:16,0,273	0/0:13,0:13:0:.:.:0,0,272	0/0:13,0:13:11:.:.:0,11,275	0/1
:7,5:12:99:.:.:103,0,159	1/1:0,1:1:3:1|1:4782_A_G:45,3,0	0/0:10,0:10:17:.:.:0,17,235	0/1:4,10:14:63:.:.:229,0,63	0/1:20,3:23:66:0|1:4782_A_G:66,0,1067	./.:1,0:1:.:.:.:0,0
,0	0/0:15,0:15:45:.:.:0,45,406	./.:0,0:0:.:.:.:0,0,0	0/1:3,1:4:14:0|1:4782_A_G:14,0,95	0/0:7,0:7:21:.:.:0,21,192	0/1:8,2:10:26:.:.:26,0,192	0/1:3,3:6:62:.:.:68
,0,62
chr1	5003	.	G	T	361.14	HardFilter	AC=3;AF=0.071;AN=42;BaseQRankSum=0.730;ClippingRankSum=0.00;DP=325;ExcessHet=0.3141;FS=0.000;InbreedingCoeff=0.4224;MLEAC=3
;MLEAF=0.071;MQ=37.83;MQRankSum=0.140;QD=12.04;ReadPosRankSum=-1.122e+00;SOR=0.512	GT:AD:DP:GQ:PL	0/0:11,0:11:30:0,30,450	0/0:1,0:1:3:0,3,28	0/0:21,0:21:49:0,49,575	0/0:8,0:8:0
:0,0,166	0/0:6,0:6:18:0,18,159	0/0:4,0:4:12:0,12,112	0/0:34,0:34:99:0,99,1485	0/0:19,0:19:39:0,39,492	0/0:30,0:30:52:0,52,791	0/0:8,0:8:24:0,24,225	0/0:3,0:3:9:0,9,870/1:12,11:23:99:228,0,255	0/0:8,0:8:9:0,9,175	0/0:32,0:32:90:0,90,1350	0/0:8,0:8:24:0,24,229	0/0:37,0:37:99:0,105,1040	0/0:7,0:7:21:0,21,184	0/0:18,0:18:48:0,48
,720	0/0:12,0:12:36:0,36,345	0/0:25,0:25:72:0,72,1080	1/1:0,7:7:21:192,21,0
chr1	5105	.	G	A	927.79	HardFilter	AC=3;AF=0.075;AN=40;BaseQRankSum=-6.470e-01;ClippingRankSum=0.00;DP=387;ExcessHet=0.1797;FS=4.497;Inb


ref data: 
1	249580	1:249580	A	G	.	.	PR	GT	0/0	0/0	0/0	0/0	0/0	0/0	0/0	./.	0/0	0/0	0/0	0/0	0/0	0/0
	0/0	0/0	0/0	0/0	0/0	0/0	0/0	1/1	1/1	1/1	1/1	1/1	1/1	1/1	1/1	1/1	0/0	0/0	0/0	0/1	0/1	0/0	0/0
	0/1	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	./.	0/0
	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	1/1	0/0	0/1	0/0	0/0	0/1	0/1	0/1	0/0
	0/0	0/0	0/0	0/0	1/1	1/1	0/1	1/1	0/0	0/0	1/1	1/1	1/1	0/1	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0
	0/1	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/1	0/1	0/0	1/1	0/0	0/1	0/1	0/0
	1/1	0/1	1/1	0/0	0/1	0/1	1/1	0/0	0/0	0/1	0/0	1/1	0/0	0/0	0/0	0/0	0/0	1/1	1/1	0/1	0/0	0/0	0/0
	0/0	0/0	0/1	0/1	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	1/1	0/0	0/1	0/0	0/1	0/0	0/0
	0/0	0/0	0/0	1/1	0/0	0/0	0/0	0/0	0/0	0/0	0/0	0/0	1/1	0/0	0/0	0/0	0/0	0/1	0/0	0/0	0/1	0/1	0/0






#### phase these SNPs ##############


java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=20000 \
    nthreads=4 \
    gt=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each.vcf \
    out=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each_PHASED


### convert to phased tped/tfam 

parentpath=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/
poplist=/seq/vgb-HAL/linda/mutts/boyko/pop_lists_14/$thispop.txt
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

# get indvs in this breed
$vcftools --vcf $parentpath/merged_someflipped_15each_PHASED.vcf \
	--plink-tped \
	--out $parentpath/$thispop/merged_someflipped_15each_PHASED



thispop=Toy_Poodle

#### convert to tpeds


vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

############### phase using 12 dogs per breed, 87 breeds with 12 dogs/breed ##################

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED \
 --merge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_nonarraySNPsloc.ped /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_nonarraySNPsloc.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mydogs.12eachNov.txt \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each


159013 variants and 1044 dogs pass filters and QC.
Among remaining phenotypes, 12 are cases and 16 are controls.  (1016 phenotypes
are missing.)
--make-bed to
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each.bed
+
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each.bim
+
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each.fam
... done.
--recode vcf-iid to
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each.vcf
... done.


 running on screen -dr 519
use Java-1.8
#I was phasing with only 20kb before!!! I should really be phasing with at least a quarter of the window overlap
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=500000 \
    nthreads=4 \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_someflipped_12each_PHASED



No genetic map is specified: using 1 cM = 1 Mb **** could use genetic map next time



############################### leave one out/in for this breed ##############

while read c; do
qsub -S /bin/bash -v thisbreed=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/boyko_allSNPs/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/mutts/boyko_allSNPs/err/newbreed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_bybreed.sh
done < /seq/vgb-HAL/linda/mutts/boyko_allSNPs/breed_lists/listofbreeds.txt


Your job 8700704 ("Miniature_Schnauzer") has been submitted
qsub: ERROR! argument to -N option must not contain / 
Your job 8700705 ("Dachshund") has been submitted
Your job 8700706 ("Newfoundland") has been submitted
Your job 8700707 ("Dalmatian") has been submitted
Your job 8700708 ("Nova_Scotia_Duck_Tolling_Retriever") has been submitted
Your job 8700709 ("Doberman_Pinscher") has been submitted
Your job 8700710 ("Papillon") has been submitted



while read c; do
qsub -S /bin/bash -v thisbreed=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/boyko_allSNPs/out/breed_cur30_${c}.out \
 -e /seq/vgb-HAL/linda/mutts/boyko_allSNPs/err/newbreed_cur.err \
 -p -10 \
 -N cur_${c} \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_bybreed.sh
done < /seq/vgb-HAL/linda/mutts/boyko_allSNPs/breed_lists/listofbreeds.txt



qsub -S /bin/bash -v thisbreed=Labrador_Retriever \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/boyko_allSNPs/out/breed_Labrador_Retriever.out \
 -e /seq/vgb-HAL/linda/mutts/boyko_allSNPs/err/newbreed_cur.err \
 -p -10 \
 -N Labrador_Retriever \
 /seq/vgb-HAL/linda/mutts/scripts/Dog_breed_curation_bybreed.sh




mv D* /seq/vgb/linda/mutts/mendels_mutts

mv /seq/vgb-HAL/linda/mutts/boyko_allSNPs/breed_lists/* /seq/vgb/linda/mutts/mendels_mutts/breed_lists



### my current files
test_simulated_admixture.sh
dog_breed_curation_bybreed.sh



mv /seq/vgb-HAL/linda/ancestry/megabubbles/scripts/* /seq/vgb/linda/admixture/10xg/scripts

mv /seq/vgb-HAL/linda/ancestry/megabubbles/outputs/* /seq/vgb/linda/admixture/10xg/outputs

##moving things from oracle to here /seq/vgb/linda/bal_sel/from_oracle

mkdir /seq/vgb/linda/bal_sel/from_oracle/chimp_bams


keeping gorilla individual bams as well as chr bams because

# problem gorilla chromosome
## start chr20 again
qsub -S /bin/bash -q vert -v chr=chr20 \
 -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/angsd20chr.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/angsd20chrnew.er \
 -N chr20angsd \
 -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_angsd_10kb.sh



X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/chimp_bams /seq/vgb/linda/bal_sel/from_oracle/

X done rsync -va /wga/scr4/vgbgrp/linda/bal_sel/mus_bams /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/YRI_bams /seq/vgb/linda/bal_sel/from_oracle/

X mv /wga/scr4/vgbgrp/linda/bal_sel/brown_rat_bams/new_bams/*sorted.bam /seq/vgb/linda/bal_sel/from_oracle/brown_rat_bams

checking on #606 rsync -va /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/references /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/chains /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/YRI_out500 /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/chimp_out500 /seq/vgb/linda/bal_sel/from_oracle/

/ 606 -- > so many files long to check, rsync -va /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/chimp_out10 /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/mus_out /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/mus_out10 /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/YRI_out10 /seq/vgb/linda/bal_sel/from_oracle/

X rsync -va /wga/scr4/vgbgrp/linda/bal_sel/gorilla_out10 /seq/vgb/linda/bal_sel/from_oracle/


/Users/boettger/postdoc/mutts/breed_data/complete_tped/test_recomb/out.tped.dt changed to recomb.tped


mus_bams and gorilla_bams are left



############# test support mix with recombinant ind.

/seq/vgb/linda/mutts/boyko_allSNPs/testing_SM

other breed files 
/seq/vgb-HAL/linda/mutts/boyko_allSNPs/breed_tpeds/general_use_tpeds


parentpath=/seq/vgb-HAL/linda/mutts/boyko_allSNPs
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
## run supportmix with ancestral populations 14 per breed
  $supportmix \
    --chromosome=35 \
    --save /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/out \
    --window=20 \
    /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/ref.Labrador_Retriever.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Newfoundland.tped \
    /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/ref.German_Shepherd_Dog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Golden_Retriever.tped \
    /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/ref.Rottweiler.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Basenji.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Boxer.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Belgian_Tervuren.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Beagle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bernese_Mountain_Dog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Border_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Brittany.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Cocker_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Dalmatian.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Doberman_Pinscher.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Bulldog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bull_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Gordon_Setter.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Greyhound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Jack_Russell_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Nova_Scotia_Duck_Tolling_Retriever.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cairn_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Saint_Bernard.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Shetland_Sheepdog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Siberian_Husky.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Boston_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_French_Bulldog.tped \
    /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/ref.Havanese.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Pomeranian.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Vizsla.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bichon_Frise.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Australian_Shepherd.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Miniature_Schnauzer.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Maltese.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Poodle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Tibetan_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Yorkshire_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Pug.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Shih_Tzu.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Dachshund.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cocker_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Setter.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Lhasa_Apso.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Weimaraner.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Toy_Poodle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Basset_Hound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Border_Collie.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Springer_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Scottish_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Great_Dane.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Irish_Wolfhound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Papillon.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cavalier_King_Charles_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_West_Highland_White_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Miniature_Pinscher.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Mastiff.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Chinese_Shar-pei.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Schipperke.tped \
    /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/recomb.tped


## same problem even without last file:


Traceback (most recent call last):
  File "/usr/local/python26/lib/python2.6/site-packages/cx_Freeze/initscripts/Console.py", line 27, in <module>
  File "SupportMix", line 344, in <module>
    
  File "SupportMix", line 344, in <lambda>
    
  File "SupportMix", line 92, in runSVM
    
  File "SupportMix", line 65, in openFiles
    Kf??NK
IndexError: list index out of range

Potential things: 
genetic map?
tabs vs spaces?

How long does it take if I put many admixed dogs in the admixedFIle?


######## testing with just reference files
ERROR: No SNPs found in specified chromosome when is double digit chr
start at 5:16, not finished at 5:35, window = 20
 $supportmix \
    --chromosome=9 \
    --save /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/out \
    --window=20 \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Labrador_Retriever.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Newfoundland.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_German_Shepherd_Dog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Golden_Retriever.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Rottweiler.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Basenji.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Boxer.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Belgian_Tervuren.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Beagle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bernese_Mountain_Dog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Border_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Brittany.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Cocker_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Dalmatian.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Doberman_Pinscher.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Bulldog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bull_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Gordon_Setter.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Greyhound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Jack_Russell_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Nova_Scotia_Duck_Tolling_Retriever.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cairn_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Saint_Bernard.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Shetland_Sheepdog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Siberian_Husky.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Boston_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_French_Bulldog.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Havanese.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Pomeranian.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Vizsla.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Bichon_Frise.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Australian_Shepherd.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Miniature_Schnauzer.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Maltese.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Poodle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Tibetan_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Yorkshire_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Pug.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Shih_Tzu.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Dachshund.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cocker_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Setter.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Lhasa_Apso.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Weimaraner.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Toy_Poodle.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Basset_Hound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Border_Collie.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_English_Springer_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Scottish_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Great_Dane.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Irish_Wolfhound.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Papillon.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Cavalier_King_Charles_Spaniel.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_West_Highland_White_Terrier.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Miniature_Pinscher.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Mastiff.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Chinese_Shar-pei.tped \
    $parentpath/breed_tpeds/general_use_tpeds/general_use_14_Schipperke.tped \








######### test with new tepees, oct 16 ##############

supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb-HAL/linda/mutts/boyko_allSNPs/ref_recomb_tpeds
## run supportmix with ancestral populations, 14 per breed
  $supportmix \
    --save /seq/vgb-HAL/linda/mutts/boyko_allSNPs/SM_outputs/out_chrall \
    --window=50 \
    $datapath/out.ref.Labrador_Retriever.tped \
    $datapath/out.ref.Newfoundland.tped \
    $datapath/out.ref.German_Shepherd_Dog.tped \
    $datapath/out.ref.Golden_Retriever.tped \
    $datapath/out.ref.Rottweiler.tped \
    $datapath/out.ref.Basenji.tped \
    $datapath/out.ref.Boxer.tped \
    $datapath/out.ref.Belgian_Tervuren.tped \
    $datapath/out.ref.Beagle.tped \
    $datapath/out.ref.Bernese_Mountain_Dog.tped \
    $datapath/out.ref.Border_Terrier.tped \
    $datapath/out.ref.Brittany.tped \
    $datapath/out.ref.English_Cocker_Spaniel.tped \
    $datapath/out.ref.Dalmatian.tped \
    $datapath/out.ref.Doberman_Pinscher.tped \
    $datapath/out.ref.English_Bulldog.tped \
    $datapath/out.ref.Bull_Terrier.tped \
    $datapath/out.ref.Gordon_Setter.tped \
    $datapath/out.ref.Greyhound.tped \
    $datapath/out.ref.Jack_Russell_Terrier.tped \
    $datapath/out.ref.Nova_Scotia_Duck_Tolling_Retriever.tped \
    $datapath/out.ref.Cairn_Terrier.tped \
    $datapath/out.ref.Saint_Bernard.tped \
    $datapath/out.ref.Shetland_Sheepdog.tped \
    $datapath/out.ref.Siberian_Husky.tped \
    $datapath/out.ref.Boston_Terrier.tped \
    $datapath/out.ref.French_Bulldog.tped \
    $datapath/out.ref.Havanese.tped \
    $datapath/out.ref.Pomeranian.tped \
    $datapath/out.ref.Vizsla.tped \
    $datapath/out.ref.Bichon_Frise.tped \
    $datapath/out.ref.Australian_Shepherd.tped \
    $datapath/out.ref.Miniature_Schnauzer.tped \
    $datapath/out.ref.Maltese.tped \
    $datapath/out.ref.Poodle.tped \
    $datapath/out.ref.Tibetan_Spaniel.tped \
    $datapath/out.ref.Yorkshire_Terrier.tped \
    $datapath/out.ref.Pug.tped \
    $datapath/out.ref.Shih_Tzu.tped \
    $datapath/out.ref.Dachshund.tped \
    $datapath/out.ref.Cocker_Spaniel.tped \
    $datapath/out.ref.English_Setter.tped \
    $datapath/out.ref.Lhasa_Apso.tped \
    $datapath/out.ref.Weimaraner.tped \
    $datapath/out.ref.Toy_Poodle.tped \
    $datapath/out.ref.Basset_Hound.tped \
    $datapath/out.ref.Border_Collie.tped \
    $datapath/out.ref.English_Springer_Spaniel.tped \
    $datapath/out.ref.Scottish_Terrier.tped \
    $datapath/out.ref.Great_Dane.tped \
    $datapath/out.ref.Irish_Wolfhound.tped \
    $datapath/out.ref.Papillon.tped \
    $datapath/out.ref.Cavalier_King_Charles_Spaniel.tped \
    $datapath/out.ref.West_Highland_White_Terrier.tped \
    $datapath/out.ref.Miniature_Pinscher.tped \
    $datapath/out.ref.Mastiff.tped \
    $datapath/out.ref.Chinese_Shar-pei.tped \
    $datapath/out.ref.Schipperke.tped \
    $datapath/out.test.tped

######## send job to scheduler ####### This started at 12:55pm (1pm) on Oct 17, finished Oct 19 at 1am ~36 hours
qsub -S /bin/bash -v this_iter=iter_1 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/mutts/out/SM.out \
 -e /seq/vgb-HAL/linda/mutts/err/SM.err \
 -p -10 \
 -N SM_allchr \
 /seq/vgb-HAL/linda/mutts/scripts/run_supportmix.sh

## started with window=100, at 10:30 on Oct 20, done at 5:50am on oct 21


#### run with window=20


################################ ABBA BABA TEST DATA #######################################################

############# Start downloading wolves/coyotes for abba baba test Oct 21 ################

/seq/vgb/linda/abba_baba/wolf

# Yellowstone 3, read names are the same
# paired reads have different names: "SRR1518532.1.1", "SRR1518532.1.2"
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518532/SRR1518532.sra

screen -dr 606


#Alaskan wolf
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR396/SRR3960582/SRR3960582.sra
-------> THIS INDIVIDUAL IS SINGLE END --> come back to this!!!

# Alabama Coyote
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518488/SRR1518488.sra


# California Coyote
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR357/SRR3574870/SRR3574870.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518487/SRR1518487.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518486/SRR1518486.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518485/SRR1518485.sra


#Mexican wolf --"SAMN02921314” screen -dr 548
 screen -dr 958
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518521/SRR1518521.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518520/SRR1518520.sra


###### make fastq and align

### replied script and start rest

qsub -S /bin/bash -v myfile=SRR1518532.sra \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/SRR.out \
 -e /seq/vgb/linda/abba_baba/err/SRR.err \
 -wd /seq/vgb/linda/abba_baba/err \
 -p -10 \
 -N SRR1518532.sra \
 /seq/vgb/linda/abba_baba/sra_align_canids.sh

##SRR3960582.fastq.gz --> this was only split into one file!!!!




qsub -S /bin/bash -v myfile=SRR1518521.sra \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/SRR.out \
 -e /seq/vgb/linda/abba_baba/err/SRR.err \
 -wd /seq/vgb/linda/abba_baba/err \
 -p -10 \
 -N SRR1518521.sra \
 /seq/vgb/linda/abba_baba/sra_align_canids.sh


########	THE ABOVE HAD A NON-SPECIFIC REGEX THAT WAS FUCKING THINGS UP for some files, ITS FIXED BELOW ########

/seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


#yellowstone
qsub -S /bin/bash -v myfile=SRR1518532.sra \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/SRR1518532.out \
 -e /seq/vgb/linda/abba_baba/err/SRR1518532.err \
 -wd /seq/vgb/linda/abba_baba/err \
 -p -10 \
 -N SRR1518532.sra \
 /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


qsub -S /bin/bash -v myfile=SRR1518521.sra \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/SRR1518521.sra.out \
 -e /seq/vgb/linda/abba_baba/err/SRR1518521.sra.err \
 -wd /seq/vgb/linda/abba_baba/err \
 -p -10 \
 -N SRR1518521.sra \
 /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh



###	shoot! I overwrote the above files... remaking the fastqs now!!!!!!

qsub -S /bin/bash -v myfile=SRR1518520.sra \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/SRR1518520.sra.out \
 -e /seq/vgb/linda/abba_baba/err/SRR1518520.sra.err \
 -wd /seq/vgb/linda/abba_baba/err \
 -p -10 \
 -N SRR1518520.sra \
 /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh















## I’m currently checking myfile=SRR1518532.sra on a screen -dr 471

SRR1518488.sra and all others sent to scheduler, now running SRR1518532.sra on scheduler as well

## there is still a read name problem. I am checking the number of lines of the fastq 

zcat SRR1518532_edit_2.fastq.gz | wc -l
598329072

zcat $mypath/fastq/$sra_id'_edit_1.fastq.gz' | wc -l 
598329072

but there is an error “ paired reads have different names: "SRR1518532.1323883", "SRR1518532.1323881””

zcat SRR1518532_edit_2.fastq.gz | awk 'NR==1323883'
SRR1518532.330971

zcat SRR1518532_edit_1.fastq.gz | awk 'NR==1323883'
SRR1518532.330971

zcat SRR1518532_edit_1.fastq.gz | awk 'NR==1323983'
+SRR1518532.330996 330996 length=100

zcat SRR1518532_edit_2.fastq.gz | awk 'NR==1323983'
+SRR1518532.330996 330996 length=100


zcat SRR1518532_edit_1.fastq.gz | tail -10

+SRR1518532.149582266 149582266 length=100
=?@DDDD,2=CF22A+2@AFGGF)111*1@?))0*0)07?A-5=@).;(..7?ED,;=?#########################################
@SRR1518532.149582267 149582267 length=100
ATAAGTTCTTTGTGTGGTTTGTTTGAGTGTGATTTTATGTTTTTGTGGTTTTTGTTGTTTTTATGTTCGTTTGTGTTGTGTTTTTTCTTTTTATTTTTGT
+SRR1518532.149582267 149582267 length=100
+:=AA=2,3=22<ACEECFFC33<C2<221:**11:*1*11?DD090?0?BD################################################
@SRR1518532.149582268 149582268 length=100
TATTGCAATGCAAAACATTAATGGGCATTTTATTATTGCTTTGTCATTTTTATTTTTTGCTTTATTATATTTTGTTTTCTCTTTTTCTTCTTTTTTATTT
+SRR1518532.149582268 149582268 length=100
4:?DD,2,4=222+2++24+33<+<+222<924@*1CC*11:?D**0?0:00100BDDI#########################################



####### get fastqs for mutts
while read c; do
qsub -S /bin/bash -v sample=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/bam_to_fastq_canids.sh
done < /seq/vgb/linda/mutts/mendels_mutts/mutt_list.txt


zcat D131_2.fastq.gz | wc -l
1167703568

zcat D131_1.fastq.gz | wc -l
1167703568

testing sort on screen -dr 487 and -dr 548 ---------
sample=D132

“sort: write failed: /tmp/sortgvOtNC: No space left on device”

df -h /seq/vgb

## sutmit test to scheduler
 sample=D132

qsub -S /bin/bash -v sample=TangoA \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/TangoAerr \
 -p -10 \
 -N TangoA \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox.sh


qsub -S /bin/bash -v sample=VulLag \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/VulLagerr \
 -p -10 \
 -N VulLag \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox.sh



while read c; do
qsub -S /bin/bash -v sample=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox.sh
done < /seq/vgb/linda/mutts/mendels_mutts/mutt_list.txt



“ more /seq/vgb/linda/mutts/mendels_mutts/err/err
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[W::bseq_read] the 2nd file has fewer sequences.
“

### breed controls
#https://docs.google.com/spreadsheets/d/1X-WERplChOFfEhE3dTLsKiTdV150uOzR-szKSVAIBTM/edit?ts=57d033ae#gid=0
## golden 2135 is published and is a control
# unaffected PWC Missouri ID 68622 Tango healthy at age 13.9, Corgi
#The bam files for the 3 Corgis are here: /seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/



################### run Tango (Corgi)
use Samtools
parentpath=/seq/vgb/linda/mutts/mendels_mutts
# get fastq from from bams for mutts and breed dogs
samtools bam2fq /seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/Tango_A.realign.marked.recalibrated.bam > $parentpath/fastq/TangoA.fastq 
being gzipped


#http://www.metagenomics.wiki/tools/samtools/converting-bam-to-fastq
zcat TangoA.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > TangoA_r1.fastq.gz
zcat TangoA.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > TangoA_r2.fastq.gz

finished though perhaps not paired end? some orphans??
checking on  screen -dr 487 and  screen -dr 548

zcat TangoA_r1.fastq.gz | wc -l
683504728




screen -dr 548
samtools bam2fq /seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/Tango_B.realign.marked.recalibrated.bam > $parentpath/fastq/TangoB.fastq 
zcat TangoB.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > TangoB_r1.fastq.gz
zcat TangoB.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > TangoB_r2.fastq.gz

finished, but different sizes

### run Golden Retriever Comet (2135)
screen -dr 547
samtools bam2fq /seq/picard_aggregation/G31854/2135/v3/2135.bam > $parentpath/fastq/2135_Comet.fastq

zcat 2135_Comet.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > Comet_r1.fastq.gz
zcat 2135_Comet.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > Comet_r2.fastq.gz


### THEN GET A FOX TO USE
 screen -dr 606
samtools bam2fq /seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam > $parentpath/fastq/VulLag.fastq
processed 339358526 reads, being gzipped

zcat VulLag.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > VulLag_r1.fastq.gz
zcat VulLag.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > VulLag_r2.fastq.gz

##############################################################################################################
# ARG 1
  data.path <- '/Users/boettger/postdoc/mutts/'
  
  # ARG 2
  # the number of crosses we are doing for each admixed individual
  num.max.admix.gen <- 15 #(N)

  # ARG 3
  # the number of admixed individuals we are generating
  num.admixed.indiv <- 100 #(M) ''

  # ARG 4
  # number of subdirectories to make with trials.
  num_trials <- 1




###### run admiture code on server 
 use R-3.3
Rscript /seq/vgb-HAL/linda/mutts/simu_crosses/Rscripts/recomb_run.R /seq/vgb-HAL/linda/mutts/simu_crosses 20 200 5

screen -dr 546



######## run support mix for different window sizes (iterations 1-5)

#10XG PhaseBlock N50 is 4.3Mb, so on average there will be 250 SNPs in a megabubble
#but contain N50 for cnafam 3.1 is 167kb, averaging 8 SNPs per mapped megabubble


while read c; do
qsub -S /bin/bash -v sim=sim_005,win_size=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N sim5_${c} \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix.sh
done < /seq/vgb-HAL/linda/mutts/simu_crosses/win_size_list.txt

sim001-sim005 are running


### need to finish flipping snaps
none of Boyko dogs were also sequenced
http://journals.plos.org/plosgenetics/article/asset?unique&id=info:doi/10.1371/journal.pgen.1003984.s015


## phase everything together with Beagle V4
“All individuals were combined in the imputation and phasing analysis. This had two purposes. First, BEAGLE performs better with a larger sample size, although its performance in simultaneous analysis of individuals from multiple populations has not been examined in detail. Second, if the imputation and haplotype phase inference were performed separately for each population, this could bias the inferred results to further separate the populations, potentially leading to inference of differences between populations when none exist. In contrast, when all populations are analyzed simultaneously, the bias is toward the average of all populations, which is of less serious consequence.”

map=[file] specifies a PLINK format genetic map on the cM scale. H




####### looks like the snptable doesn’t work all the time ###########
#### merge reference and mutts 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPED_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_ref15_ourmutts

Error: 139 variants with 3+ alleles present.

I checked the snptable, and our snaps were flipped according to it

merged_ref15_ourmutts-merge.missnp



plink --file data --flip list.txt --recode

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPED_VAR \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --flip /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_ref15_ourmutts-merge.missnp \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain_VAR


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts

Error: 23 variants with 3+ alleles present.
#I looked at them and there is an issue other than flipping. Jesse’s calls are C/T, but I have C/A etc
#just exclude them

plink --ped /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD.ped \
 --map /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHD.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts-merge.missnp \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_keepsnps.txt \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts-merge.missnp \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts

150353 markers loaded from
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain_VAR.bim.
143807 markers to be merged from
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim.
Of these, 0 are new, while 143807 are present in the base dataset.



/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf

for beagle 
map=[file] specifies a PLINK format genetic map on the cM scale, get from here: merged_Boykoref15_ourmutts.bim

#get rid of last two columns
merged_Boykoref15_ourmutts.bim


awk '{print $1,$2,$3,$4}' merged_Boykoref15_ourmutts.bim > merged_Boykoref15_ourmutts_geneticmap.txt

/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt


###################################### Phasing ref panels and our mutts ######################################
screen -dr 273
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=500000 \
    nthreads=6 \
    map=merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED


## get rid if imputed sign
grep -v "ID=IMP" /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED.vcf > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_noIMP.vcf

## separate the breeds into files, test pug
qsub -S /bin/bash -v thispop=Boxer -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N Pug \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_breed_curation_NOV.sh

## separate the breeds into files
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_breed_curation_NOV.sh
done < /seq/vgb/linda/mutts/mendels_mutts/breed_lists/breed_lists_15_Nov7/Breed_list_15.txt


screen -dr 273
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/ourmutts_firstlook_Nov7 \
    --window=80 \
    	$datapath/Labrador_Retriever.tped \
	$datapath/Basenji.tped \
	$datapath/Boxer.tped \
	$datapath/Belgian_Tervuren.tped \
	$datapath/Beagle.tped \
	$datapath/Bernese_Mountain_Dog.tped \
	$datapath/Border_Terrier.tped \
	$datapath/Brittany.tped \
	$datapath/English_Cocker_Spaniel.tped \
	$datapath/Dalmatian.tped \
	$datapath/English_Bulldog.tped \
	$datapath/Gordon_Setter.tped \
	$datapath/Greyhound.tped \
	$datapath/Jack_Russell_Terrier.tped \
	$datapath/Bull_Terrier.tped \
	$datapath/Nova_Scotia_Duck_Tolling_Retriever.tped \
	$datapath/Cairn_Terrier.tped \
	$datapath/Doberman_Pinscher.tped \
	$datapath/Saint_Bernard.tped \
	$datapath/Shetland_Sheepdog.tped \
	$datapath/Boston_Terrier.tped \
	$datapath/French_Bulldog.tped \
	$datapath/Pomeranian.tped \
	$datapath/Bichon_Frise.tped \
	$datapath/Australian_Shepherd.tped \
	$datapath/Havanese.tped \
	$datapath/Poodle.tped \
	$datapath/Tibetan_Spaniel.tped \
	$datapath/Maltese.tped \
	$datapath/Miniature_Schnauzer.tped \
	$datapath/Pug.tped \
	$datapath/Dachshund.tped \
	$datapath/Shih_Tzu.tped \
	$datapath/Lhasa_Apso.tped \
	$datapath/Weimaraner.tped \
	$datapath/Cocker_Spaniel.tped \
	$datapath/Siberian_Husky.tped \
	$datapath/Rottweiler.tped \
	$datapath/Toy_Poodle.tped \
	$datapath/Basset_Hound.tped \
	$datapath/Vizsla.tped \
	$datapath/English_Springer_Spaniel.tped \
	$datapath/Scottish_Terrier.tped \
	$datapath/Yorkshire_Terrier.tped \
	$datapath/Great_Dane.tped \
	$datapath/Irish_Wolfhound.tped \
	$datapath/English_Setter.tped \
	$datapath/German_Shepherd_Dog.tped \
	$datapath/Newfoundland.tped \
	$datapath/Golden_Retriever.tped \
	$datapath/Papillon.tped \
	$datapath/Cavalier_King_Charles_Spaniel.tped \
	$datapath/West_Highland_White_Terrier.tped \
	$datapath/Miniature_Pinscher.tped \
	$datapath/Mastiff.tped \
	$datapath/Chinese_Shar-pei.tped \
	$datapath/Border_Collie.tped \
	$datapath/Schipperke.tped \
	$datapath/Mendels_Mutts.tped






######### prep 10x genomics vcfs #######
mypath=/seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs
use Tabix
use VCFtools

tabix -p vcf $mypath/Ollie_snpindel.vcf.gz on  screen -dr 262
tabix -p vcf $mypath/Cuishle_snpindel.vcf.gz on  screen -dr 487
tabix -p vcf $mypath/Ruby_snpindel.vcf.gz on  screen -dr 548

vcf-merge $mypath/Cuishle_snpindel.vcf.gz $mypath/Ollie_snpindel.vcf.gz $mypath/Ruby_snpindel.vcf.gz | bgzip -c > $mypath/mutts_10xg.vcf.gz

Using column name '24499' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/Cuishle_snpindel.vcf.gz:24499
Using column name '24462' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/Ollie_snpindel.vcf.gz:24462
Using column name '24458' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/Ruby_snpindel.vcf.gz:24458


zcat mutts_10xg.vcf.gz | awk '{print $1}' | sort | uniq

#CHROM
NC_002008.4
NC_006583.3
NC_006584.3
NC_006585.3
NC_006586.3
NC_006587.3
NC_006588.3
NC_006589.3
NC_006590.3
NC_006591.3
NC_006592.3
NC_006593.3
NC_006594.3
NC_006595.3
NC_006596.3
NC_006597.3
NC_006598.3
NC_006599.3
NC_006600.3
NC_006601.3
NC_006602.3
NC_006603.3
NC_006604.3
NC_006605.3
NC_006606.3
NC_006607.3
NC_006608.3
NC_006609.3
NC_006610.3
NC_006611.3
NC_006612.3
NC_006613.3
NC_006614.3
NC_006615.3
NC_006616.3
NC_006617.3
NC_006618.3
NC_006619.3
NC_006620.3
NC_006621.3
decoy_0
decoy_1
decoy_2
decoy_3
decoy_4



###################### Nov 10, 2016
mypath=/seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs
use Tabix
use VCFtools
chr_name_change.txt


mutts_10xg.vcf.gz


## replace strange chr names with numeric values
sed -i -e 's/NC_006583.3/1/g' mutts_10xg.vcf
sed -i -e 's/NC_006584.3/2/g' mutts_10xg.vcf
sed -i -e 's/NC_006585.3/3/g' mutts_10xg.vcf
sed -i -e 's/NC_006586.3/4/g' mutts_10xg.vcf
sed -i -e 's/NC_006587.3/5/g' mutts_10xg.vcf
sed -i -e 's/NC_006588.3/6/g' mutts_10xg.vcf
sed -i -e 's/NC_006589.3/7/g' mutts_10xg.vcf
sed -i -e 's/NC_006590.3/8/g' mutts_10xg.vcf
sed -i -e 's/NC_006591.3/9/g' mutts_10xg.vcf
sed -i -e 's/NC_006592.3/10/g' mutts_10xg.vcf
sed -i -e 's/NC_006593.3/11/g' mutts_10xg.vcf
sed -i -e 's/NC_006594.3/12/g' mutts_10xg.vcf
sed -i -e 's/NC_006595.3/13/g' mutts_10xg.vcf
sed -i -e 's/NC_006596.3/14/g' mutts_10xg.vcf
sed -i -e 's/NC_006597.3/15/g' mutts_10xg.vcf
sed -i -e 's/NC_006598.3/16/g' mutts_10xg.vcf
sed -i -e 's/NC_006599.3/17/g' mutts_10xg.vcf
sed -i -e 's/NC_006600.3/18/g' mutts_10xg.vcf
sed -i -e 's/NC_006601.3/19/g' mutts_10xg.vcf
sed -i -e 's/NC_006602.3/20/g' mutts_10xg.vcf
sed -i -e 's/NC_006603.3/21/g' mutts_10xg.vcf
sed -i -e 's/NC_006604.3/22/g' mutts_10xg.vcf
sed -i -e 's/NC_006605.3/23/g' mutts_10xg.vcf
sed -i -e 's/NC_006606.3/24/g' mutts_10xg.vcf
sed -i -e 's/NC_006607.3/25/g' mutts_10xg.vcf
sed -i -e 's/NC_006608.3/26/g' mutts_10xg.vcf
sed -i -e 's/NC_006609.3/27/g' mutts_10xg.vcf
sed -i -e 's/NC_006610.3/28/g' mutts_10xg.vcf
sed -i -e 's/NC_006611.3/29/g' mutts_10xg.vcf
sed -i -e 's/NC_006612.3/30/g' mutts_10xg.vcf
sed -i -e 's/NC_006613.3/31/g' mutts_10xg.vcf
sed -i -e 's/NC_006614.3/32/g' mutts_10xg.vcf
sed -i -e 's/NC_006615.3/33/g' mutts_10xg.vcf
sed -i -e 's/NC_006616.3/34/g' mutts_10xg.vcf
sed -i -e 's/NC_006617.3/35/g' mutts_10xg.vcf
sed -i -e 's/NC_006618.3/36/g' mutts_10xg.vcf
sed -i -e 's/NC_006619.3/37/g' mutts_10xg.vcf
sed -i -e 's/NC_006620.3/38/g' mutts_10xg.vcf
sed -i -e 's/NC_006621.3/41/g' mutts_10xg.vcf


#convert to plink format and only keep snaps on our array
vcftools --vcf /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/mutts_10xg.vcf \
    --positions /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPloclist.txt \
    --plink \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHD

#prints out 0 for some chr labels

After filtering, kept 126425 out of a possible 11253120 Sites... I need my positions not a vcc!!!!

# merge with reference data
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain_VAR \
 --merge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHD.map \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHD.ped \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts-merge.missnp \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen




##################### filtering SRA aligned canids #############

# Yellowstone 3, read names are the same
# paired reads have different names: "SRR1518532.1.1", "SRR1518532.1.2"
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518532/SRR1518532.sra


#Alaskan wolf
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR396/SRR3960582/SRR3960582.sra
-------> THIS INDIVIDUAL IS SINGLE END --> come back to this!!!

# Alabama Coyote
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518488/SRR1518488.sra


# California Coyote
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR357/SRR3574870/SRR3574870.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518487/SRR1518487.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518486/SRR1518486.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518485/SRR1518485.sra


#Mexican wolf --"SAMN02921314”
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518521/SRR1518521.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518520/SRR1518520.sra


I am going to change the name of each sorted BAM so that it contains the name of the individual 



cd /seq/vgb/linda/abba_baba/bams

#Yellowstone 3
mv SRR1518532.sorted.bam yellow_wolf.sorted.bam

# Alabama Coyote
mv SRR1518488.sorted.bam al_coy.sorted.bam

# California Coyote
mv SRR3574870.sorted.bam cal_coy_1.sorted.bam
mv SRR1518487.sorted.bam cal_coy_2.sorted.bam
mv SRR1518486.sorted.bam cal_coy_3.sorted.bam
mv SRR1518485.sorted.bam cal_coy_4.sorted.bam

#Mexican wolf
mv SRR1518521.sorted.bam mex_wolf_1.sorted.bam
mv SRR1518520.sorted.bam mex_wolf_2.sorted.bam



qsub -S /bin/bash -v indv=mex_wolf -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/mexwolf.out \
 -e /seq/vgb/linda/abba_baba/err/mexwolf.err \
 -p -10 \
 -N mexwolf \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh

qsub -S /bin/bash -v indv=yellow_wolf -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/yellow_wolf.out \
 -e /seq/vgb/linda/abba_baba/err/yellow_wolf.err \
 -p -10 \
 -N yellow_wolf \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh


qsub -S /bin/bash -v indv=al_coy -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/al_coy.out \
 -e /seq/vgb/linda/abba_baba/err/al_coy.err \
 -p -10 \
 -N al_coy \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh

qsub -S /bin/bash -v indv=cal_coy -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/cal_coy.out \
 -e /seq/vgb/linda/abba_baba/err/cal_coy.err \
 -p -10 \
 -N cal_coy \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh




yellow_wolf
al_coy
cal_coy
mex_wolf


######### another try at 10x genomics vcfs######


######### prep 10x genomics vcfs #######
mypath=/seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/newvcfs
use Tabix
use VCFtools

on  screen -dr 606
gunzip $mypath/cuishle_vcf_withX.vcf.gz
bgzip $mypath/cuishle_vcf_withX.vcf
tabix -p vcf $mypath/cuishle_vcf_withX.vcf.gz 

gunzip $mypath/ollie_vcf_withX.vcf.gz
bgzip $mypath/ollie_vcf_withX.vcf
tabix -p vcf $mypath/ollie_vcf_withX.vcf.gz 


gunzip $mypath/ruby_vcf_withX.vcf.gz
bgzip $mypath/ruby_vcf_withX.vcf
tabix -p vcf $mypath/ruby_vcf_withX.vcf.gz 


vcf-merge $mypath/cuishle_vcf_withX.vcf.gz $mypath/ollie_vcf_withX.vcf.gz $mypath/ruby_vcf_withX.vcf.gz | bgzip -c > $mypath/mutts_10xg.vcf.gz

Using column name '24499' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/newvcfs/cuishle_vcf_withX.vcf.gz:24499
Using column name '24462' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/newvcfs/ollie_vcf_withX.vcf.gz:24462
Using column name '24458' for /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/newvcfs/ruby_vcf_withX.vcf.gz:24458

zcat mutts_10xg.vcf.gz | awk '{print $1}' | sort | uniq



## replace strange chr names with numeric values
sed -i -e 's/NC_006583.3/1/g' mutts_10xg.vcf
sed -i -e 's/NC_006584.3/2/g' mutts_10xg.vcf
sed -i -e 's/NC_006585.3/3/g' mutts_10xg.vcf
sed -i -e 's/NC_006586.3/4/g' mutts_10xg.vcf
sed -i -e 's/NC_006587.3/5/g' mutts_10xg.vcf
sed -i -e 's/NC_006588.3/6/g' mutts_10xg.vcf
sed -i -e 's/NC_006589.3/7/g' mutts_10xg.vcf
sed -i -e 's/NC_006590.3/8/g' mutts_10xg.vcf
sed -i -e 's/NC_006591.3/9/g' mutts_10xg.vcf
sed -i -e 's/NC_006592.3/10/g' mutts_10xg.vcf
sed -i -e 's/NC_006593.3/11/g' mutts_10xg.vcf
sed -i -e 's/NC_006594.3/12/g' mutts_10xg.vcf
sed -i -e 's/NC_006595.3/13/g' mutts_10xg.vcf
sed -i -e 's/NC_006596.3/14/g' mutts_10xg.vcf
sed -i -e 's/NC_006597.3/15/g' mutts_10xg.vcf
sed -i -e 's/NC_006598.3/16/g' mutts_10xg.vcf
sed -i -e 's/NC_006599.3/17/g' mutts_10xg.vcf
sed -i -e 's/NC_006600.3/18/g' mutts_10xg.vcf
sed -i -e 's/NC_006601.3/19/g' mutts_10xg.vcf
sed -i -e 's/NC_006602.3/20/g' mutts_10xg.vcf
sed -i -e 's/NC_006603.3/21/g' mutts_10xg.vcf
sed -i -e 's/NC_006604.3/22/g' mutts_10xg.vcf
sed -i -e 's/NC_006605.3/23/g' mutts_10xg.vcf
sed -i -e 's/NC_006606.3/24/g' mutts_10xg.vcf
sed -i -e 's/NC_006607.3/25/g' mutts_10xg.vcf
sed -i -e 's/NC_006608.3/26/g' mutts_10xg.vcf
sed -i -e 's/NC_006609.3/27/g' mutts_10xg.vcf
sed -i -e 's/NC_006610.3/28/g' mutts_10xg.vcf
sed -i -e 's/NC_006611.3/29/g' mutts_10xg.vcf
sed -i -e 's/NC_006612.3/30/g' mutts_10xg.vcf
sed -i -e 's/NC_006613.3/31/g' mutts_10xg.vcf
sed -i -e 's/NC_006614.3/32/g' mutts_10xg.vcf
sed -i -e 's/NC_006615.3/33/g' mutts_10xg.vcf
sed -i -e 's/NC_006616.3/34/g' mutts_10xg.vcf
sed -i -e 's/NC_006617.3/35/g' mutts_10xg.vcf
sed -i -e 's/NC_006618.3/36/g' mutts_10xg.vcf
sed -i -e 's/NC_006619.3/37/g' mutts_10xg.vcf
sed -i -e 's/NC_006620.3/38/g' mutts_10xg.vcf
sed -i -e 's/NC_006621.3/41/g' mutts_10xg.vcf


#convert to plink format and only keep snaps on our array
vcftools --vcf /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/newvcfs/mutts_10xg.vcf \
    --plink \
    --positions /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPloclist.txt \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHDlist


#
plink --file /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHD \
  --dog \
  --extract /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPlist.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHDsnplist


Unrecognized values used for CHROM: 23 - Replacing with 0.....

Fixed chr23-41 by hand

Error: Variant '1:25004055' is not biallelic. To obtain a full list of merge
failures, convert your data to binary format and retry the merge.


# merge with reference data
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain2_VAR \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen-merge.missnp \
 --dog \
 --maf 0.0001 \
 --make-bed \
 --recode \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR




plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHDsnplist.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHDsnplist.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/mutts_10xg_CanHDsnplist.fam \
 --dog \
 --maf 0.0001 \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen

## YAY, this file has my ref dataset and the 10x Genomics data merged


use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=150000 \
    overlap=10000 \
    nthreads=6 \
    map=merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED


from beagle, number of markers not bp!!!
 window=[positive integer] specifies the number of markers to include in each sliding
window (default: window=50000). The window parameter must be at least twice as large
as the overlap parameter. The window parameter controls the amount of memory used in
the analysis. For human data, I recommend that the window parameter be greater than or
equal to the typical number of markers in 5 cM.
 overlap=[positive integer] specifies the number of markers of overlap between sliding
windows (default: overlap=3000). For human data, I recommend that the overlap be set to
the typical number of markers in 0.5 cM (when ibd=false) or 2.0 cM (when ibd=true).



awk '{print $1}' /seq/karlsson/Affymetrix/DARWIND1AX/clusterA.vcf | sort | uniq

## get the darwin’s dogs data to add 
vcftools --vcf /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsorted.vcf \
    --plink \
    --positions /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_SNPloclistDD.txt \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDlist


Warning - file contains entries with the same position. These entries will be processed separately.


# rm chr and convert chr names


## let x an y be chr41
sed -i -e 's/chrX:/chr41:/g' /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsorted.vcf

sed -i -e 's/chrY:/chr41:/g' /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsorted.vcf

## get rid of the “chr”
sed -i -e 's/chr//g' /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsorted.vcf





## for now pick arbitrary snap 
grep '#' clusterAsorted.vcf > /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsortednodup.vcf

grep -v '#' clusterAsorted.vcf | awk 'BEGIN {last="NA"} {if (last!=$2) {print $0;} last=$2;}' >> /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsortednodup.vcf


643652 /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsorted.vcf
439214 /seq/vgb/linda/mutts/Darwins_Dogs/clusterAsortednodup.vcf


## THIS IS THE CODE TO FIX THE SHITTY VCF ISSUES WITH THE DUPLICATES AND DOTS:
cd /seq/vgb/linda/mutts/Darwins_Dogs/
grep '#' clusterAsorted.vcf > clusterA_nodup_natsort.vcf
vcf-sort -c clusterAsorted.vcf  | grep -v '#' \
	| awk 'BEGIN {last="NA"} {if ((last != $2) && ($2 != ".") ) {print $0;} last=$2;}' \
	>> clusterA_nodup_natsort.vcf

## make snp names the location
grep '#' my.vcf > my_locations.vcf
grep -v '#' my.vcf | awk -F '\t' 'BEGIN {OFS = FS} {$3 = $1":"$2; print $0;}' >> my_locations.vcf



## make snp names the location
grep '#' clusterA_nodup_natsort.vcf > clusterA_nodup_natsort_loc.vcf
grep -v '#' clusterA_nodup_natsort.vcf | awk -F '\t' 'BEGIN {OFS = FS} {$3 = $1":"$2; print $0;}' >> clusterA_nodup_natsort_loc.vcf


## let x an y be chr41
sed -i -e 's/^X/41/g' clusterA_nodup_natsort_loc.vcf
sed -i -e 's/^Y/41/g' clusterA_nodup_natsort_loc.vcf



vcftools --vcf /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.vcf \
    --plink \
    --snps /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR.snps \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHD


After filtering, kept 439201 out of a possible 439201 Sites
Unrecognized values used for CHROM: 23 - Replacing with 0.... etc

## when we only keep the snps in the ref file
awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR.map > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR.snps
After filtering, kept 149672 out of a possible 439201 Sites
THIS IS MISSING ALL THE HOMOZYGOUS SNPS!!! BUT WE NEED TO MOVE ON	


### remove the missteps 
plink --file /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHD \
 --dog \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs-merge.missnp \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt

149672 variants loaded from .bim file.
--exclude: 149600 variants remaining.


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/CanHD_15perbreed_locFLIPPEDagain3_VAR \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.fam \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs-merge.missnp \
 --dog \
 --maf 0.0001 \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs

############## now start phasing!!! ###############

screen -dr 6066
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=150000 \
    overlap=10000 \
    nthreads=6 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs_PHASED












##### many of these don’t have exactly the same call
85795 dup_markers_calls_clusterA
202065 dup_markers_clusterA

Looking at the duplicate locations more closely, only about 65k of the 202k duplicates have exactly the same call for every individual. However, there are usually only minor differences between the call sets. We should come back to this later and try to pick the better of the two, but for now my plan is to pick an arbitrary one so we can have results more quickly. 



###### print the snap names

awk 'NR==FNR{c[$1$2]++;next};c[$1$2] > 0' dup_markers_clusterA clusterAsorted.vcf | awk '{print $3}' > dup_markersSNPnames_clusterA

## more than double,so some even have 3 designs
406505 dup_markersSNPnames_clusterA



There are empty snps on “chr2147483648”. Any idea what this is?

looks like it’s unsorted


cp /seq/karlsson/Affymetrix/DARWIND1AX/clusterA.vcf /seq/vgb/linda/mutts/Darwins_Dogs/clusterA.vcf

vcf-sort clusterA.vcf > clusterAsorted.vcf

Does anyone know why about 200k SNPs on the affy array have duplicate locations with different SNP names? I’m getting this from our /seq/karlsson/Affymetrix/DARWIND1AX/clusterA.vcf

Let me know if anyone has more info on the array (like a list of SNPs). 



#I removed 184 from list (already running)
while read c; do
qsub -S /bin/bash -v sample=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox.sh
done < /seq/vgb/linda/mutts/mendels_mutts/mutt_list.txt


#run others from beginning
qsub -S /bin/bash -v sample=TangoB \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/TangoBerr \
 -p -10 \
 -N TangoB \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_full.sh


remaining_list.txt

while read c; do
qsub -S /bin/bash -v sample=$c \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out_${c} \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err_${c} \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_full.sh
done < /seq/vgb/linda/mutts/mendels_mutts/remaining_list.txt





################ differences between Affy and illumina

## has illumine locations and also those that had location in Boyko with the same name
/seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable

173095 /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable

## put locations in new file
awk '{print $1}' /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snptable > /seq/vgb/linda/mutts/Darwins_Dogs/Illumina_locations.txt

#remove first line (header)
sed -i 1d Illumina_locations.txt

awk '{print $1":"$2}' /seq/vgb/linda/mutts/Darwins_Dogs/clusterA.vcf > /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_positions.txt 

## remove the first 11 lines of junk
sed -i -e '1,11d' clusterA_positions.txt

## get rid of the “chr”
sed -i -e 's/chr//g' clusterA_positions.txt

## let x an y be chr41
sed -i -e 's/X:/41:/g' clusterA_positions.txt

sed -i -e 's/Y:/41:/g' clusterA_positions.txt


#### find matching and non-matching locations in clusterA_positions.txt and Illumina_locations.txt

#sort 
sort clusterA_positions.txt > clusterA_positions_sorted.txt
sort Illumina_locations.txt > Illumina_locations_sorted.txt 

/seq/vgb/linda/mutts/Darwins_Dogs/Illumina_locations_sorted.txt

/seq/vgb/linda/mutts/Darwins_Dogs/Illumina_locations_sorted.txt

sed -e 's/:/\t/g' /seq/vgb/linda/mutts/Darwins_Dogs/Illumina_locations_sorted.txt > /seq/vgb/linda/mutts/Darwins_Dogs/Illumina_locations_sorted_tab.txt


## left only
comm -23 Illumina_locations_sorted.txt clusterA_positions_sorted.txt > Illumina_only.txt 

comm -12 Illumina_locations_sorted.txt clusterA_positions_sorted.txt > Illumina_and_clusterA.txt 


172883 Illumina_and_clusterA.txt

10:10009069
10:10013675
10:10027102
10:10035774
10:10054401
10:10057434
10:100589
10:10078787
10:10080300
10:1009466
10:10100066
10:10105789
10:10113772
10:10135860
10:10160059
10:10181023
10:10189684
10:10197344
10:10220403
10:10239173
10:10241298
10:10257483
10:10274554
10:10283611
10:1028683
10:10294754
10:10300967
10:10314707
10:10324166
10:10344569
10:10356263
10:10378225
10:10380490
10:10408724
10:10422798
10:10430080
10:10437784
10:10450852
10:10454774



awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_unique_loc.map > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_unique_loc.txt

grep 10:10009069 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_unique_loc.txt



################### separate into breed files for 10xG and darwin’s dogs


grep -v "ID=IMP" /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED.vcf > /seq/vgb/linda/mutts/boyko_allSNPs/merged_Boykoref15_10xGen_PHASED_noimp.vcf

mv /seq/vgb/linda/mutts/boyko_allSNPs/merged_Boykoref15_10xGen_PHASED_noimp.vcf /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED_noimp.vcf







## separate the breeds into files
parentpath=/seq/vgb/linda/mutts
poplist=$parentpath/mendels_mutts/breed_lists/breed_lists_15_Nov7/Indvlist_10xGen
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
map=$parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt


#get indvs in this breed/mutt list
$vcftools --vcf $parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED_noimp.vcf \
	--keep $poplist \
	--plink-tped \
	--out $parentpath/breed_tpeds/Mutts_10xGen


#add genetic map (col 3 of /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt)
echo "$(awk 'FNR==NR{a[NR]=$3;next}{$3=a[FNR]}1' $map $parentpath/breed_tpeds/Mutts_10xGen.tped)" > $parentpath/breed_tpeds/Mutts_10xGen.tped

# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' $parentpath/breed_tpeds/Mutts_10xGen.tped)" > $parentpath/breed_tpeds/Mutts_10xGen.tped


## to get a bim file
$vcftools --vcf $parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED_noimp.vcf \
	--keep $poplist \
	--plink \
	--out $parentpath/breed_tpeds/Mutts_10xGen


plink --file /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new --make-bed --out /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new



########### this time only keep snps that are in our reference sets ####

#get second
awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
 > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/keep_snps.txt


#get indvs in this breed/mutt list
$vcftools --vcf $parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED_noimp.vcf \
	--keep $poplist \
	--plink-tped \
	--snps /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/keep_snps.txt \
	--out $parentpath/breed_tpeds/Mutts_10xGen_new

Keeping individuals in 'keep' list
After filtering, kept 3 out of 872 Individuals
Writing PLINK TPED file ... Writing PLINK TFAM file ... Done.
After filtering, kept 150330 out of a possible 150353 Sites


###### get bim file for this #########

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen \
 --dog \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/keep_snps.txt \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/10xGen_forbim




#add genetic map (col 3 of /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt)
echo "$(awk 'FNR==NR{a[NR]=$3;next}{$3=a[FNR]}1' $map $parentpath/breed_tpeds/Mutts_10xGen_new.tped)" > $parentpath/breed_tpeds/Mutts_10xGen_new.tped

# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' $parentpath/breed_tpeds/Mutts_10xGen_new.tped)" > $parentpath/breed_tpeds/Mutts_10xGen_new.tped




screen -dr 548
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds

$supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/mutts_10xGen_new \
    --window=80 \
    	/seq/vgb/linda/mutts/breed_tpeds/Labrador_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Basenji.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Boxer.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Belgian_Tervuren.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Beagle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bernese_Mountain_Dog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Border_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Brittany.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Cocker_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Dalmatian.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Bulldog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Gordon_Setter.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Greyhound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Jack_Russell_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bull_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Nova_Scotia_Duck_Tolling_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cairn_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Doberman_Pinscher.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Saint_Bernard.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Shetland_Sheepdog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Boston_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/French_Bulldog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Pomeranian.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bichon_Frise.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Australian_Shepherd.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Havanese.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Poodle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Tibetan_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Maltese.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Miniature_Schnauzer.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Pug.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Dachshund.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Shih_Tzu.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Lhasa_Apso.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Weimaraner.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cocker_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Siberian_Husky.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Rottweiler.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Toy_Poodle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Basset_Hound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Vizsla.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Springer_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Scottish_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Yorkshire_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Great_Dane.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Irish_Wolfhound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Setter.tped \
	/seq/vgb/linda/mutts/breed_tpeds/German_Shepherd_Dog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Newfoundland.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Golden_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Papillon.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cavalier_King_Charles_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/West_Highland_White_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Miniature_Pinscher.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Mastiff.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Chinese_Shar-pei.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Border_Collie.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Schipperke.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new.tped




##### get bim file
use PLINK 
plink --tfile /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new --recode --out /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new
plink --file /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new --make-bed --out /seq/vgb/linda/mutts/breed_tpeds/Mutts_10xGen_new



############ ERROR ##############
Traceback (most recent call last):
  File "/usr/local/python26/lib/python2.6/site-packages/cx_Freeze/initscripts/Console.py", line 27, in <module>
  File "SupportMix", line 344, in <module>

  File "SupportMix", line 344, in <lambda>

  File "SupportMix", line 117, in runSVM

  File "/usr/local/python26/lib/python2.6/site-packages/numpy/core/numeric.py", line 230, in asarray
ValueError: setting an array element with a sequence.


#### may relate to the fact there are more SNPs in the 10x gen thing

# filter for just snps in ref pop

$vcftools --vcf $parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_10xGen_PHASED_noimp.vcf \
	--keep $poplist \
	--plink-tped \
	--out $parentpath/breed_tpeds/Mutts_10xGen

parentpath=/seq/vgb/linda/mutts
poplist=$parentpath/mendels_mutts/breed_lists/breed_lists_15_Nov7/Indvlist_10xGen
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
map=$parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt





######### Darwin’s dogs


grep -v "ID=IMP" /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs_PHASED.vcf > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs_PHASED_noimp.vcf




## separate the breeds into files
parentpath=/seq/vgb/linda/mutts
poplist=$parentpath/mendels_mutts/breed_lists/breed_lists_15_Nov7/Darwins_dogs.txt
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
map=$parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt


#get indvs in this breed/mutt list
$vcftools --vcf $parentpath/boyko_allSNPs/data_curation/merged_Boykoref15_darwins_dogs_PHASED_noimp.vcf \
	--keep $poplist \
	--plink-tped \
	--out $parentpath/breed_tpeds/darwins_dogs


#add genetic map (col 3 of /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt)
echo "$(awk 'FNR==NR{a[NR]=$3;next}{$3=a[FNR]}1' $map $parentpath/breed_tpeds/darwins_dogs.tped)" > $parentpath/breed_tpeds/darwins_dogs.tped

# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' $parentpath/breed_tpeds/darwins_dogs.tped)" > $parentpath/breed_tpeds/darwins_dogs.tped


supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix


screen -dr 273
$supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/darwins_dogs \
    --window=80 \
    	/seq/vgb/linda/mutts/breed_tpeds/Labrador_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Basenji.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Boxer.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Belgian_Tervuren.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Beagle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bernese_Mountain_Dog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Border_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Brittany.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Cocker_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Dalmatian.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Bulldog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Gordon_Setter.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Greyhound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Jack_Russell_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bull_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Nova_Scotia_Duck_Tolling_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cairn_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Doberman_Pinscher.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Saint_Bernard.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Shetland_Sheepdog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Boston_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/French_Bulldog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Pomeranian.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Bichon_Frise.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Australian_Shepherd.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Havanese.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Poodle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Tibetan_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Maltese.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Miniature_Schnauzer.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Pug.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Dachshund.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Shih_Tzu.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Lhasa_Apso.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Weimaraner.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cocker_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Siberian_Husky.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Rottweiler.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Toy_Poodle.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Basset_Hound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Vizsla.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Springer_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Scottish_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Yorkshire_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Great_Dane.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Irish_Wolfhound.tped \
	/seq/vgb/linda/mutts/breed_tpeds/English_Setter.tped \
	/seq/vgb/linda/mutts/breed_tpeds/German_Shepherd_Dog.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Newfoundland.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Golden_Retriever.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Papillon.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Cavalier_King_Charles_Spaniel.tped \
	/seq/vgb/linda/mutts/breed_tpeds/West_Highland_White_Terrier.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Miniature_Pinscher.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Mastiff.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Chinese_Shar-pei.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Border_Collie.tped \
	/seq/vgb/linda/mutts/breed_tpeds/Schipperke.tped \
	/seq/vgb/linda/mutts/breed_tpeds/darwins_dogs.tped


Mean window size: 1151786+/-305113 bp, 1.3+/-0.83 cM






############# Dec 2nd move files and start combine filter #######

cp /seq/vgb/linda/mutts/mendels_mutts/bams/TangoA.sorted.bam /seq/vgb/linda/abba_baba/bams/TangoA.sorted.bam
cp /seq/vgb/linda/mutts/mendels_mutts/bams/TangoB.sorted.bam /seq/vgb/linda/abba_baba/bams/TangoB.sorted.bam

##### both the fox, Tango and Comet are way to small!! I think at this point I need to use the broad’s alignments....

# comet is here:
/seq/picard_aggregation/G31854/2135/v3/2135.bam > $parentpath/fastq/2135_Comet.fastq

###### use finished bams for Tango - need to combine and sort!!

Tango in here:
/seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams


### fox
/seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam


### move and start Skyler ######

-dr 262
cp /seq/vgb/linda/mutts/mendels_mutts/bams/D184.sorted.bam /seq/vgb/linda/abba_baba/bams/D184.sorted.bam

-dr 546
cp /seq/vgb/linda/mutts/mendels_mutts/bams/DX09.sorted.bam /seq/vgb/linda/abba_baba/bams/DX09.sorted.bam

cp /seq/vgb/linda/mutts/mendels_mutts/bams/VulLag.sorted.bam /seq/vgb/linda/abba_baba/bams/VulLag.sorted.bam

cp /seq/vgb/linda/mutts/mendels_mutts/bams/DX09.sorted.bam /seq/vgb/linda/abba_baba/bams/DX09.sorted.bam

qsub -S /bin/bash -v indv=D184 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/D184.out \
 -e /seq/vgb/linda/abba_baba/err/D184.err \
 -p -10 \
 -N Skyler \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh


qsub -S /bin/bash -v indv=DX09 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/DX09.out \
 -e /seq/vgb/linda/abba_baba/err/DX09.err \
 -p -10 \
 -N DX09 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter.sh


while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/comb${c}_out \
   -e /seq/vgb/linda/abba_baba/err/comb${c}_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh
done < /seq/vgb/linda/mutts/mendels_mutts/scripts/mendells_mutts_minustesters.txt


### DX01 not finished aligning, so I stopped those jobs

## this one apparently isn’t appended with _2
qsub -S /bin/bash -v indv=D181 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/D181.out \
 -e /seq/vgb/linda/abba_baba/err/D181.err \
 -p -10 \
 -N D181 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh


## starting DX01
qsub -S /bin/bash -v indv=DX01 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/DX01.out \
 -e /seq/vgb/linda/abba_baba/err/DX01.err \
 -p -10 \
 -N DX01 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh





# fox
on 546 and 262 checking lines
127697251 VulLag_order_2.fastq.gz


zcat VulLag_order_1.fastq.gz | wc -l
678717052

zcat VulLag_order_2.fastq.gz | wc -l
678717052

# they have the same number of lines!!


zcat VulLag_order_1.fastq.gz | grep "^@" | wc -l
179909379

zcat VulLag_order_2.fastq.gz | grep "^@" | wc -l
181154273

678717052/4 = 169679263

zcat VulLag_order_1.fastq.gz | grep "^@SN" | wc -l
169679263

zcat VulLag_order_2.fastq.gz | grep "^@SN" | wc -l
169679263





screen -dr 262
gzip --test VulLag_order_1.fastq.gz VulLag_order_2.fastq.gz (looks fine)



[mem_sam_pe] paired reads have different names: "SN7001335:208:HTMGNBCXX:1:1101:10000:2948", "SN7001335:208:HTMGNBCXX:1:1101:10000:35136"





################ what was done with fox?
samtools bam2fq /seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam > $parentpath/fastq/VulLag.fastq
processed 339358526 reads, being gzipped

screen -dr 11646
zcat VulLag.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > VulLag_1.fastq.gz


screen -dr 12046
zcat VulLag.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > VulLag_2.fastq.gz


## what if we try bra on the original files r1 and r2?




running bwa on screen -dr 519
same error message

[M::bwa_idx_load_from_disk] read 0 ALT contigs
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 12 sequences (3012 bp)...
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 2 sequences (502 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 5, 0, 0)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] skip orientation FR as there are not enough pairs
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 12 reads in 0.065 CPU sec, 0.068 real sec
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 40 sequences (9789 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 0, 0, 0)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] skip orientation FR as there are not enough pairs
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[mem_sam_pe] paired reads have different names: "SN7001335:208:HTMGNBCXX:1:1101:10000:2948", "SN7001335:208:HTMGNBCXX:1:1101:10000:35136"


###### check those lines
zcat VulLag_order_1.fastq.gz | grep -n SN7001335:208:HTMGNBCXX:1:1101:10000:2948
29:@SN7001335:208:HTMGNBCXX:1:1101:10000:2948

zcat VulLag_order_2.fastq.gz | grep -n SN7001335:208:HTMGNBCXX:1:1101:10000:2948
29:@SN7001335:208:HTMGNBCXX:1:1101:10000:2948



zcat VulLag_order_2.fastq.gz | grep -n SN7001335:208:HTMGNBCXX:1:1101:10000:35136
33:@SN7001335:208:HTMGNBCXX:1:1101:10000:35136

zcat VulLag_order_1.fastq.gz | grep -n SN7001335:208:HTMGNBCXX:1:1101:10000:35136
33:@SN7001335:208:HTMGNBCXX:1:1101:10000:35136

## this warning message is in some way wrong ---wtf!!!!

zcat VulLag_order_1.fastq.gz | head -132 | gzip > VulLag_1_short.fastq.gz

zcat VulLag_order_2.fastq.gz | head -132 | gzip > VulLag_2_short.fastq.gz



zcat DX08_order_1.fastq.gz | head -132 | gzip > DX08_1_short.fastq.gz

zcat DX08_order_2.fastq.gz | head -132 | gzip > DX08_2_short.fastq.gz

#looks like there are no @ in the qs

screen -dr 262
zcat DX08_order_1.fastq.gz | grep "^@" | wc -l
392673508


screen -dr 487
zcat DX08_order_2.fastq.gz | grep "^@" | wc -l
392673508

#an example of one that worked with no @ in the QS



use GATK3
use BWA
use Samtools
picard='/home/unix/boettger/bin/picard-tools-2.0.1'

mypath='/seq/vgb/linda/mutts/mendels_mutts'
ref='/seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta' 


bwa mem $ref $mypath/fastq/VulLag_1_short.fastq.gz \
     $mypath/fastq/VulLag_2_short.fastq.gz \
     | samtools view -bS \
    > $mypath/bams/$sample'-pe_short.bam'


[M::bwa_idx_load_from_disk] read 0 ALT contigs
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 12 sequences (3012 bp)...
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 2 sequences (502 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 5, 0, 0)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] skip orientation FR as there are not enough pairs
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 12 reads in 0.065 CPU sec, 0.068 real sec
[W::bseq_read] the 2nd file has fewer sequences.
[M::process] read 40 sequences (9789 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 0, 0, 0)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] skip orientation FR as there are not enough pairs
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[mem_sam_pe] paired reads have different names: "SN7001335:208:HTMGNBCXX:1:1101:10000:2948", "SN7001335:208:HTMGNBCXX:1:1101:10000:35136"


bwa mem $ref \
   $mypath/fastq/VulLag_1_short.fastq.gz \
   $mypath/fastq/VulLag_2_short.fastq.gz |
   > $mypath/fastq/

screen -dr 546
bwa mem $ref \
   <(zcat $mypath/fastq/VulLag_order_1.fastq.gz | head -132) \
   <(zcat $mypath/fastq/VulLag_order_2.fastq.gz | head -132) \
   > $mypath/fastq/test.bam

screen -dr 546
bwa mem $ref \
   <(zcat $mypath/fastq/VulLag_order_1.fastq.gz | head -112) \
   <(zcat $mypath/fastq/VulLag_order_2.fastq.gz | head -112) \
   > $mypath/fastq/test.bam

/seq/vgb/linda/bin/bwa mem $ref \
   <(zcat $mypath/fastq/VulLag_order_1.fastq.gz | head -132) \
   <(zcat $mypath/fastq/VulLag_order_2.fastq.gz | head -132) \
   > $mypath/fastq/test.bam


screen -dr 471
grep “@SN7001335:208:HTMGNBCXX:1:1101:10001:20914” /seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam

## check if this is in the original bam
samtools view /seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam | awk '{if (length($10) != length($11)) {print}}'


zcat VulLag_order_1.fastq.gz | head -132 > VulLag_1_short.fastq

zcat VulLag_order_2.fastq.gz | head -132 > VulLag_2_short.fastq



zcat VulLag_1.fastq.gz  | head -132 | gzip > VulLagtest_1.fastq.gz

zcat VulLag_2.fastq.gz  | head -132 | gzip > VulLagtest_2.fastq.gz


## submit the test files to the server




### testing fastqs with fixed qual score line lengths (added - to full length)

bwa mem $ref \
   $mypath/fastq/VulLag_order_1_head132.fastq \
   $mypath/fastq/VulLag_order_1_head132.fastq \
   > $mypath/fastq/test.bam



qsub -S /bin/bash -v sample=VulLagtest \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/foxtestout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/foxtesterr \
 -p -10 \
 -N VulLagtest \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh


qsub -S /bin/bash -v sample=VulLag \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/foxnewout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/foxnewerr \
 -p -10 \
 -N VulLag \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh




####### what happened with these?
 screen -dr 606
samtools bam2fq /seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam > $parentpath/fastq/VulLag.fastq



###### split the other dogs
screen -dr 11646
zcat TangoA.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > TangoA_1.fastq.gz
zcat TangoA.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > TangoA_2.fastq.gz


screen -dr 12046
zcat TangoB.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > TangoB_1.fastq.gz
zcat TangoB.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > TangoB_2.fastq.gz

screen -dr 26214
zcat 2135_Comet.fastq.gz | grep '^@.*/1$' -A 3 --no-group-separator | gzip > Comet_1.fastq.gz
zcat 2135_Comet.fastq.gz | grep '^@.*/2$' -A 3 --no-group-separator | gzip > Comet_2.fastq.gz


#### run this in a few hours:

qsub -S /bin/bash -v sample=Comet \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/Cometnewout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/Cometnewerr \
 -p -10 \
 -N Comet \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh


qsub -S /bin/bash -v sample=TangoA \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/Tangonewout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/Tangonewerr \
 -p -10 \
 -N TangoA \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh

qsub -S /bin/bash -v sample=TangoB \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/TangoBnewout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/TangoBnewerr \
 -p -10 \
 -N TangoB \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh



######## run test breed dogs and fox
qsub -S /bin/bash -v indv=VulLag -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/VulLag.out \
 -e /seq/vgb/linda/abba_baba/err/VulLag.err \
 -p -10 \
 -N VulLag \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh


qsub -S /bin/bash -v indv=Tango -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/Tango.out \
 -e /seq/vgb/linda/abba_baba/err/Tango.err \
 -p -10 \
 -N Tangofilt \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh


# copy to right dir

screen -dr 95
cp /seq/vgb/linda/mutts/mendels_mutts/bams/TangoB.sorted.bam /seq/vgb/linda/abba_baba/bams/TangoB.sorted.bam


screen -dr 606
cp /seq/vgb/linda/mutts/mendels_mutts/bams/TangoA.sorted.bam /seq/vgb/linda/abba_baba/bams/TangoA.sorted.bam

## run again, deleted the error file before
qsub -S /bin/bash -v indv=Tango -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/Tango.out \
 -e /seq/vgb/linda/abba_baba/err/Tango.err \
 -p -10 \
 -N Tango \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh

## some sort of problem
INFO	2016-12-09 04:28:26	MarkDuplicates	Written   590,000,000 records.  Elapsed time: 03:43:58s.  Time for last 10,000,000:  226s.  Last read position: chr9:19,804,50
8
/var/spool/sge/vert04/job_scripts/9219314: line 54: 23767 Killed                  java -jar $picard/picard.jar MarkDuplicates INPUT=$mypath/bams/$indv'_mergedRG.bam' OUTPUT=$
mypath/bams/$indv'_mkdup.bam' METRICS_FILE=$mypath/bams/$indv'_mkdup.metrics'
[W::bam_hdr_read] EOF marker is absent. The input is probably truncated.
samtools index: "/seq/vgb/linda/abba_baba/bams/Tango_mkdup.bam" is corrupted or unsorted

## to test I will try to sort the merged file!!!

Tango_merged.bam


screen -dr 466
samtools sort -o Tango_merged_sorted.bam Tango_merged.bam


### also trying to markdups

screen -dr 487
java -jar $picard/picard.jar MarkDuplicates \
        INPUT=$mypath/bams/$indv'_mergedRG.bam' \
        OUTPUT=$mypath/bams/$indv'_mkdup2.bam' \
        METRICS_FILE=$mypath/bams/$indv'_mkdup2.metrics'


## send fast tester to scheduler
java -Xms1g -Xmx8g -XX:ParallelGCThreads=15 -jar 


qsub -S /bin/bash -v indv=Tango -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/Tango3.out \
 -e /seq/vgb/linda/abba_baba/err/Tango3.err \
 -N Tangomkdup \
 /seq/vgb/linda/abba_baba/scripts/Tango_mkdup.sh


qsub -S /bin/bash -v indv=Tango -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/abba_baba/out/Tango.out \
 -e /seq/vgb/linda/abba_baba/err/Tangopost3.err \
 -p -10 \
 -N Tango \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh


########### try abba baba for test input ############
“To avoid comparisons between nonhomologous sequences, we excluded sites with coverage in excess of the 95th percentile for each individual. We reduced the impact of coverage variation between samples by downsampling each individual to a single high-quality (base quality ≥ 30 and read mapping quality ≥ 30) base call chosen randomly from all of the high-quality base calls at each site. Such downsampling allows unbiased comparisons between samples of different coverages where either heterozygous site calling or consensus base calling might be biased toward the reference genome, in this case a dog, and therefore potentially introduce bias into admixture estimates.


###### need to get distribution of coverage for each individual
    -setMaxDepth 700 \ (for each individual separately )


screen -dr 487
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/abba_baba_testers.bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/test \
	-doAbbababa \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
   	-minMapQ 30 \
	-uniqueOnly 1 \
	-blockSize 10000000 \
        -minQ 30 \
    	-only_proper_pairs 1 \
	-doCounts 1

# When trying to install 
abcTemplate.cpp:333: warning: deprecated conversion from string constant to 'char*'
bam_likes.cpp:271: error: expected constructor, destructor, or type conversion before '*' token
bam_likes.cpp: In function 'void bam_likes_init()':
bam_likes.cpp:275: error: 'mod' was not declared in this scope
bam_likes.cpp:275: error: 'errmod_init' was not declared in this scope
bam_likes.cpp: In function 'void bam_likes_destroy()':
bam_likes.cpp:280: error: 'mod' was not declared in this scope
bam_likes.cpp:281: error: 'errmod_destroy' was not declared in this scope
bam_likes.cpp: In function 'void call_bam(chunkyT*, double**, int)':
bam_likes.cpp:288: error: 'mod' was not declared in this scope
bam_likes.cpp:292: error: 'mod' was not declared in this scope
bam_likes.cpp:343: error: 'errmod_cal' was not declared in this scope
make: *** [bam_likes.o] Error 1


####### I deleted and am installing new version of angsd ##############

wget http://popgen.dk/software/download/angsd/angsd0.914.tar.gz
tar xf angsd0.914.tar.gz
cd htslib;make;cd ..
cd angsd
make HTSSRC=../htslib
cd ..


-enhance and -uselast aren’t in this version

     
“18 argument     -enhance is unknown will exit” I may need to install a new version






##### get depth of coverage

use BEDTools

#started at 6pm on Dec 6 screen -dr 548

genomeCoverageBed -ibam /seq/vgb/linda/abba_baba/finished_bams/al_coy_out.sorted.bam \
  -g /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta \
  > /seq/vgb/linda/abba_baba/read_depth/al_coy_coverage.txt




#### then make output files that individually filter on depth, new barflies

## then in angsd, do other filters mq 30 etc. 

results like this:
chr1    508     1       122678785       8.15137e-09
chr1    514     2       122678785       1.63027e-08
chr1    515     1       122678785       8.15137e-09
chr1    519     1       122678785       8.15137e-09
chr1    521     5       122678785       4.07568e-08
chr1    522     6       122678785       4.89082e-08
chr1    523     1       122678785       8.15137e-09
chr1    524     4       122678785       3.26055e-08
chr1    525     3       122678785       2.44541e-08
chr1    530     1       122678785       8.15137e-09
chr1    533     1       122678785       8.15137e-09
chr1    553     1       122678785       8.15137e-09
chr1    568     1       122678785       8.15137e-09
chr1    583     1       122678785       8.15137e-09
chr1    593     1       122678785       8.15137e-09
chr1    619     1       122678785       8.15137e-09
chr1    625     1       122678785       8.15137e-09
chr1    637     1       122678785       8.15137e-09
chr1    651     1       122678785       8.15137e-09
chr1    657     1       122678785       8.15137e-09
chr1    663     1       122678785       8.15137e-09
chr1    675     1       122678785       8.15137e-09
chr1    677     1       122678785       8.15137e-09
chr1    684     1       122678785       8.15137e-09
chr1    690     1       122678785       8.15137e-09
chr1    697     1       122678785       8.15137e-09




##################### check read depth in finished individuals

while read c; do
  qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/dp${c}_out \
   -e /seq/vgb/linda/abba_baba/err/dp{c}_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh
done < /seq/vgb/linda/abba_baba/bamlist_fordepth.txt


Dx01, VulLag, Comet are missing from this list !!!!!!!!!!!!!

qsub -S /bin/bash -v indiv=Comet -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/dpComet_out \
   -e /seq/vgb/linda/abba_baba/err/dpComet_err \
   -N Comet_rd \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh


qsub -S /bin/bash -v indiv=VulLag -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/dpfox_out \
   -e /seq/vgb/linda/abba_baba/err/dpfox_err \
   -N fox_rd \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh

qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/DX01_out \
   -e /seq/vgb/linda/abba_baba/err/DX01_err \
   -N depthDX01 \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh



##################### USE ANGSD TO JUST GET SITES <95 PERCENTILE FOR READ DEPTH #############
#get 95tile for canids_read_depth.R

#angsd doens’t seem to do this per individual 

#maybe can do this:
https://www.biostars.org/p/19403/


### for now I’m going to filter on read depth sum (total) for four samples

### or I could filter it myself at the end based on bp position


## make bed with sites below 95%

-setMaxDepth

/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/al_coy_bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/al_coy_depth_filt \
	-setMaxDepth  12 \
	-doCounts 1



##### started at 4:15 on dec 7th 
screen -dr 487
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/abba_baba_testers.bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/test \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  159 \
   	-minMapQ 30 \
	-uniqueOnly 1 \
	-blockSize 10000000 \
        -minQ 30 \
    	-only_proper_pairs 1 \
	-doCounts 1



###### will calculate number of generations since admixture
https://github.com/xyang619/AdmixInfer-fast/blob/master/README
STRUCTURE (Pritchard et al. 2000) and HAPMIX X (Price et al. 2009)
"DOCUMENTATION OF ROLLOFF program:

Given genotype data from an admixed population and two ancestral populations, ROLLOFF computes the time since mixture"

I think that Priya's program will only let me use two ancestral populations!!!





screen -dr 487
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_calcoy_bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/sky_calcoy \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  173 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1

screen -dr 548
#no max depth
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_calcoy_bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/sky_calcoy_noDepthfilt \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1


### everyone, to see what that looks like
#1176 is coverage where everyone is 95th percentile
screen -dr 273

/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/all_current_bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/all_current \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  1000 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1


######## estimate Z score 
use R-3.3

Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/sky_calcoy.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_calcoySHORT.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/sky_calcoySHORT

Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/sky_calcoy_noDepthfilt.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_calcoySHORT.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/sky_calcoySHORT




##### run abba baba 
qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/DX01_out \
   -e /seq/vgb/linda/abba_baba/err/DX01_err \
   -N DX01_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba.sh


qsub -S /bin/bash -v indiv=DX10 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/DX10ab_out \
   -e /seq/vgb/linda/abba_baba/err/DX10ab_err \
   -N DX10_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba.sh



qsub -S /bin/bash -v indiv=D181 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/D181_out \
   -e /seq/vgb/linda/abba_baba/err/D181_err \
   -N D181_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba.sh

## this doesn’t work, but I can’t figure out why
#”Unable to run job: Carriage return not allowed in objectname”
#or it does nothing now.... wtf
## OMFG - it was the list of individuals in the txt - the line endings were bad from excel!!!
while read c; do
qsub -S /bin/bash -v indiv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_${c} \
   -e /seq/vgb/linda/abba_baba/err/err_${c} \
   -N ${c}_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba.sh
done < /seq/vgb/linda/abba_baba/mutts_minusDX01new.txt



##### check on tango filtering and Xwolves SRR1518521 




##### look at a few others!!!
DX07 is only 0.84
DX10 isn’t running!!!

Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/D132_cal_coy.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/D132_cal_coy_Jack.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/looktest_alcoy







######## check skyler with other breed controls (I didn’t align these, it was already done)

screen -dr 116
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_vsotherComet.bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/sky_vsotherComet \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  173 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1

use R-3.3

Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/sky_vsotherComet.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/D132_cal_coy_Jack.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/looktest_alcoy



#wtf!!!!!!
/seq/vgb/linda/bin/angsd/angsd: /lib64/libz.so.1: version `ZLIB_1.2.5.2' not found (required by /seq/vgb/linda/bin/angsd/angsd)


screen -dr 519
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_vs_leo.bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/sky_vs_leo \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  173 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1


Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/sky_vs_leo.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/D132_cal_coy_Jack.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/looktest_alcoy


OMG comet is 6 vs DX06!!!


Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/D181_al_coy.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/D132_cal_coy_Jack.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/looktest_alcoy




###### start skyler vs yellowstone wolf with leo 

###### this doesn't look like a leonburger -- looks like comet
screen -dr 519
/seq/vgb/linda/bin/angsd/angsd \
	-bam /seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_vs_leo_ywolf.bamfilelist \
	-out /seq/vgb/linda/abba_baba/abba_baba_results/sky_vs_leo_ywolf \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  170 \
   	-minMapQ 30 \
	-blockSize 10000000 \
        -minQ 30 \
	-doCounts 1


Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=/seq/vgb/linda/abba_baba/abba_baba_results/sky_vs_leo_ywolf.abbababa \
 indNames=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists/sky_vs_leo_ywolf_JACK.bamfilelist \
 outfile=/seq/vgb/linda/abba_baba/jackKnife_results/looktest_ywolf



####### run wolves with tango

qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/DX01w_out \
   -e /seq/vgb/linda/abba_baba/err/DX01w_err \
   -N DX01_w \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tangowolf.sh


while read c; do
qsub -S /bin/bash -v indiv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outw_${c} \
   -e /seq/vgb/linda/abba_baba/err/errw_${c} \
   -N ${c}_w \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tangowolf.sh
done < /seq/vgb/linda/abba_baba/mutts_minusDX01new.txt




###

screen -dr 487
samtools flagstat Comet_out.sorted.bam
1038464291 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 secondary
920067 + 0 supplementary
16230887 + 0 duplicates
1022451580 + 0 mapped (98.46% : N/A)
1037544224 + 0 paired in sequencing
518772112 + 0 read1
518772112 + 0 read2
1006446006 + 0 properly paired (97.00% : N/A)
1015212250 + 0 with itself and mate mapped
6319263 + 0 singletons (0.61% : N/A)
6261091 + 0 with mate mapped to a different chr
3322927 + 0 with mate mapped to a different chr (mapQ>=5)


screen -dr 548
samtools flagstat D182_out.sorted.bam
0 + 0 secondary
5358174 + 0 supplementary
28068664 + 0 duplicates
825248845 + 0 mapped (97.98% : N/A)
836885448 + 0 paired in sequencing
418442724 + 0 read1
418442724 + 0 read2
797037804 + 0 properly paired (95.24% : N/A)
811960725 + 0 with itself and mate mapped
7929946 + 0 singletons (0.95% : N/A)
12185491 + 0 with mate mapped to a different chr
7200986 + 0 with mate mapped to a different chr (mapQ>=5)


screen -dr 958
samtools flagstat yellow_wolf_out.sorted.bam

 screen -dr 273
samtools flagstat VulLag_out.sorted.bam

373318503 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 secondary
33959977 + 0 supplementary
13908058 + 0 duplicates
370366739 + 0 mapped (99.21% : N/A)
339358526 + 0 paired in sequencing
169679263 + 0 read1
169679263 + 0 read2
295785908 + 0 properly paired (87.16% : N/A)
334516279 + 0 with itself and mate mapped
1890483 + 0 singletons (0.56% : N/A)
35076938 + 0 with mate mapped to a different chr
11731138 + 0 with mate mapped to a different chr (mapQ>=5)





######## get chromosome 37 to look at in IGV

screen -dr 471
samtools view -b Tango_out.sorted.bam chr37 > Tango_chr37.bam


samtools view -b Comet_out.sorted.bam chr37 > Comet_chr37.bam


screen -dr 466
samtools view -b D182_out.sorted.bam chr37 > D182_chr37.bam


screen -dr 519
samtools view -b yellow_wolf_out.sorted.bam chr37 > yellow_wolf_chr37.bam


samtools view -b VulLag_out.sorted.bam chr37 > VulLag_chr37.bam



###### lots of tango and wolf derived
chr37:16,130,786-16,132,859

#sky looks like wolf
chr37:17,437,756-17,439,829

#mutts no var, others derived match
chr37:20,366,844-20,368,917

###### skyler looks like fox
chr37:1,544,627-1,546,700


############### look at different block size
indiv=D182


screen -dr 487
/seq/vgb/linda/bin/angsd/angsd \
	-bam $bamlists/"$indiv"_mex_wolf.bamfilelist \
	-out $outpath/"$indiv"_mex_wolf_block5m \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
	-setMaxDepth  125 \
   	-minMapQ 30 \
	-blockSize 5000000 \
   	-minQ 30 \
	-doCounts 1

# Run Jackknife
Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=$outpath/"$indiv"_mex_wolf_block5m.abbababa \
 indNames=$bamlists/"$indiv"_mex_wolf_Jack.bamfilelist \
 outfile=$jackout/"$indiv"_mex_wolf_block5m
## Z score of 27


######### look at no read depth filter
/seq/vgb/linda/bin/angsd/angsd \
	-bam $bamlists/"$indiv"_mex_wolf.bamfilelist \
	-out $outpath/"$indiv"_mex_wolf_noRD \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-useLast 1 \
   	-minMapQ 30 \
	-blockSize 10000000 \
   	-minQ 30 \
	-doCounts 1

# Run Jackknife
Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=$outpath/"$indiv"_mex_wolf_noRD.abbababa \
 indNames=$bamlists/"$indiv"_mex_wolf_Jack.bamfilelist \
 outfile=$jackout/"$indiv"_mex_wolf_noRD




###### look at skyler, old broad alignment for sky and old Comet 

/seq/vgb/linda/mutts/mendels_mutts/orig_bams/D182.bam

/seq/picard_aggregation/G31854/2135/v3/2135.bam

/seq/vgb/jeremy/200_mammals/read_data/BAMs/VulLag_U066.bam

#Tango
/seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/Tango_A.realign.marked.recalibrated.bam



use R-3.3

###### looks like this didn't run 
/seq/vgb/linda/bin/angsd/angsd \
	-bam $bamlists/oldsky_oldTango_yellowwolf.bamfilelist \
	-out $outpath/oldsky_oldTango_yellowwolf \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-setMaxDepth  125 \
	-useLast 1 \
   	-minMapQ 30 \
	-blockSize 10000000 \
   	-minQ 30 \
	-doCounts 1


Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=$outpath/oldsky_oldTango_yellowwolf.abbababa \
 indNames=$bamlists/"$indiv"_yellow_wolf_Jack.bamfilelist \
 outfile=$jackout/"$indiv"_mex_wolf_noRD


Difference in BAM headers for '/seq/vgb/linda/mutts/mendels_mutts/orig_bams/D182.bam' and '/seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/Tango_A.realign.marked.recalibrated.bam'







########## check sky with other breed dogs ###########

Irish wolfhound
/seq/picard_aggregation/G66920/IW_3543_A



use R-3.3
/seq/vgb/linda/bin/angsd/angsd \
	-bam $bamlists/sky_wolfhound_yellowwolf.bamfilelist \
	-out $outpath/sky_wolfhound_yellowwolf \
	-doAbbababa 1 \
    	-remove_bads 1 \
	-enhance 1 \
	-setMaxDepth  125 \
	-useLast 1 \
   	-minMapQ 30 \
	-blockSize 10000000 \
   	-minQ 30 \
	-doCounts 1


Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
 file=$outpath/sky_wolfhound_yellowwolf.abbababa \
 indNames=$bamlists/D182_yellow_wolf_Jack.bamfilelist \
 outfile=$jackout/D182_yellow_wolf_wolfhound



H1	H2	H3	nABBA	nBABA	Dstat	jackEst	SE	Z	
Tango_out.sorted.bam	mex_wolf_out.sorted.bam	D182_out.sorted.bam	82681	286003	-0.5514804	-0.5514804	0.004520683	-121.9905	
D182_out.sorted.bam	mex_wolf_out.sorted.bam	Tango_out.sorted.bam	110601	286003	-0.4422598	-0.4422598	0.005812152	-76.09226	
D182_out.sorted.bam	Tango_out.sorted.bam	mex_wolf_out.sorted.bam	110601	82681	0.1444521	0.1444521	0.005583467	25.87141





######## check wolves with comet as control ######

while read c; do
qsub -S /bin/bash -v indiv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_${c} \
   -e /seq/vgb/linda/abba_baba/err/err_${c} \
   -N ${c}_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Cometwolf.sh
done < /seq/vgb/linda/abba_baba/mutts_minusDX01new.txt



qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_DX01 \
   -e /seq/vgb/linda/abba_baba/err/err_DX01 \
   -N DX01_ab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Cometwolf.sh






while read c; do
qsub -S /bin/bash -v indiv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_${c} \
   -e /seq/vgb/linda/abba_baba/err/err_${c} \
   -N ${c}_LEab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_LEwolf.sh
done < /seq/vgb/linda/abba_baba/mutts_minusDX01new.txt



qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_DX01LE \
   -e /seq/vgb/linda/abba_baba/err/err_DX01LE \
   -N DX01_LEab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_LEwolf.sh



while read c; do
qsub -S /bin/bash -v indiv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_${c} \
   -e /seq/vgb/linda/abba_baba/err/err_${c} \
   -N ${c}_Tanab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_coyoteTango.sh
done < /seq/vgb/linda/abba_baba/mutts_minusDX01new.txt



qsub -S /bin/bash -v indiv=DX01 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_DX01Tan \
   -e /seq/vgb/linda/abba_baba/err/err_DX0Tan \
   -N DX01_Tanab \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_coyoteTango.sh

D181_2	GusD158_2	KayleeDX09	RudyDX01	SkeeterDX05	RhodaDX07	FinchD183	EsmeD198	SandyD199	ScotchDX04	TuiD132	ClarenceDX08	JaimeD131	HopperD181	Gus *** twice!!D158	Kaylee *** twice !!D182	SkylerDX10	JackD184	LuckyDX06	LilyDX11	Vera-LynnDX02	HunterD157	BeskowDX03	Reily









######################################## the above phasing of the mutts wasn't perfect, as shown in chromosome painting plots
######I"m going to try and improve it

screen -dr 273
use Java-1.8

ORIGINAL:
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=2000000 \
    overlap=500000 \
    nthreads=6 \
    map=merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED

PARAM USED FOR DARWIN'S DOGS:
 window=150000 \
    overlap=10000 \
    nthreads=6 \



There are 7928 markers on chr1 and 561 on chr41.
There are about 200 SNPs in 4Mb on average. I'll go with 200 for the window and an overlap of 100 to make sure there are smooth transitions

When i



NEW without more iterations:
screen -dr 273
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=200 \
    overlap=99 \
    nthreads=12 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_NEW


grep -v "ID=IMP" /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_NEW.vcf > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_NEW_noIMP.vcf





##### separate breeds
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_breed_curation_DEC.sh
done < /seq/vgb/linda/mutts/mendels_mutts/breed_lists/breed_lists_15_Nov7/Breed_list_15.txt




screen -dr 273
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds_NEW
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/NEW_Dec19 \
    --window=80 \
    	$datapath/Labrador_Retriever.tped \
	$datapath/Basenji.tped \
	$datapath/Boxer.tped \
	$datapath/Belgian_Tervuren.tped \
	$datapath/Beagle.tped \
	$datapath/Bernese_Mountain_Dog.tped \
	$datapath/Border_Terrier.tped \
	$datapath/Brittany.tped \
	$datapath/English_Cocker_Spaniel.tped \
	$datapath/Dalmatian.tped \
	$datapath/English_Bulldog.tped \
	$datapath/Gordon_Setter.tped \
	$datapath/Greyhound.tped \
	$datapath/Jack_Russell_Terrier.tped \
	$datapath/Bull_Terrier.tped \
	$datapath/Nova_Scotia_Duck_Tolling_Retriever.tped \
	$datapath/Cairn_Terrier.tped \
	$datapath/Doberman_Pinscher.tped \
	$datapath/Saint_Bernard.tped \
	$datapath/Shetland_Sheepdog.tped \
	$datapath/Boston_Terrier.tped \
	$datapath/French_Bulldog.tped \
	$datapath/Pomeranian.tped \
	$datapath/Bichon_Frise.tped \
	$datapath/Australian_Shepherd.tped \
	$datapath/Havanese.tped \
	$datapath/Poodle.tped \
	$datapath/Tibetan_Spaniel.tped \
	$datapath/Maltese.tped \
	$datapath/Miniature_Schnauzer.tped \
	$datapath/Pug.tped \
	$datapath/Dachshund.tped \
	$datapath/Shih_Tzu.tped \
	$datapath/Lhasa_Apso.tped \
	$datapath/Weimaraner.tped \
	$datapath/Cocker_Spaniel.tped \
	$datapath/Siberian_Husky.tped \
	$datapath/Rottweiler.tped \
	$datapath/Toy_Poodle.tped \
	$datapath/Basset_Hound.tped \
	$datapath/Vizsla.tped \
	$datapath/English_Springer_Spaniel.tped \
	$datapath/Scottish_Terrier.tped \
	$datapath/Yorkshire_Terrier.tped \
	$datapath/Great_Dane.tped \
	$datapath/Irish_Wolfhound.tped \
	$datapath/English_Setter.tped \
	$datapath/German_Shepherd_Dog.tped \
	$datapath/Newfoundland.tped \
	$datapath/Golden_Retriever.tped \
	$datapath/Papillon.tped \
	$datapath/Cavalier_King_Charles_Spaniel.tped \
	$datapath/West_Highland_White_Terrier.tped \
	$datapath/Miniature_Pinscher.tped \
	$datapath/Mastiff.tped \
	$datapath/Chinese_Shar-pei.tped \
	$datapath/Border_Collie.tped \
	$datapath/Schipperke.tped \
	$datapath/Mendels_Mutts.tped






screen -dr 548
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=200 \
    overlap=99 \
    nthreads=12 \
    niterations=10 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_NEW10IT


WORKED!!




########### GET NEW DOGS FOR abba baba###############



SAMN06159689 - Basenji 
SRR5116904
SRR5116905
SRR5116906
SRR5116907
SRR5116908
SRR5116909
SRR5116910
SRR5116911

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR116/SRR116911/SRR116911.sra



SAMN03366708 - Basenji
SRR2149861

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149861/SRR2149861.sra

---------------
SAMN03801690 - Siberian Husky
SRR2095539
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2095539/SRR2095539.sra



SAMN03168379 - Chihuahua
SRR2827564
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR282/SRR2827564/SRR2827564.sra


SAMN03801656 - Chihuahua
SRR2095478
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2095478/SRR2095478.sra


SAMN03801657 -  Chow Chow
SRR2094391
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2094391/SRR2094391.sra


SAMN03801658 - Chow Chow
SRR2094392
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2094392/SRR2094392.sra


SAMN04851103 - Chinese Village Dog
SRR3384063
SRR3384064
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384063/SRR3384063.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384064/SRR3384064.sra



SAMN04851101 - Portugal Village Dog
SRR3384031
SRR3384032
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384031/SRR3384031.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384032/SRR3384032.sra

____

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR282/SRR2827564/SRR2827564.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2095478/SRR2095478.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2094391/SRR2094391.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2094392/SRR2094392.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384063/SRR3384063.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384064/SRR3384064.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384031/SRR3384031.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR338/SRR3384032/SRR3384032.sra




while read c; do
qsub -S /bin/bash -v myfile=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_${c} \
   -e /seq/vgb/linda/abba_baba/err/err_${c} \
   -N ${c}_sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh
done < /seq/vgb/linda/abba_baba/scripts/new_dogs_abba_baba.txt





### move files to canid name,
These worked: BasenjiA and BasenjiB, ChiwawaA, Chinvil, PortVil

mv $mypath/bams/SRR116904.sorted.bam $mypath/bams/BasenjiA_1.sorted.bam
mv $mypath/bams/SRR116905.sorted.bam $mypath/bams/BasenjiA_2.sorted.bam
mv $mypath/bams/SRR116906.sorted.bam $mypath/bams/BasenjiA_3.sorted.bam
mv $mypath/bams/SRR116907.sorted.bam $mypath/bams/BasenjiA_4.sorted.bam
mv $mypath/bams/SRR116908.sorted.bam $mypath/bams/BasenjiA_5.sorted.bam
mv $mypath/bams/SRR116909.sorted.bam $mypath/bams/BasenjiA_6.sorted.bam
mv $mypath/bams/SRR116910.sorted.bam $mypath/bams/BasenjiA_7.sorted.bam
mv $mypath/bams/SRR116911.sorted.bam $mypath/bams/BasenjiA_8.sorted.bam


mv $mypath/bams/SRR2149861.sorted.bam $mypath/bams/BasenjiB.sorted.bam

mv $mypath/bams/SRR2095539.sorted.bam $mypath/bams/Husky.sorted.bam

mv $mypath/bams/SRR2827564.sorted.bam $mypath/bams/ChihuahuaA.sorted.bam

mv $mypath/bams/SRR2095478.sorted.bam $mypath/bams/ChihuahuaB.sorted.bam

mv $mypath/bams/SRR2094391.sorted.bam $mypath/bams/ChowChowA.sorted.bam

mv $mypath/bams/SRR2094392.sorted.bam $mypath/bams/ChowChowB.sorted.bam

mv $mypath/bams/SRR3384063.sorted.bam $mypath/bams/ChineseVill_1.sorted.bam
mv $mypath/bams/SRR3384064.sorted.bam $mypath/bams/ChineseVill_2.sorted.bam

mv $mypath/bams/SRR3384031.sorted.bam $mypath/bams/PortugalVill_1.sorted.bam
mv $mypath/bams/SRR3384032.sorted.bam $mypath/bams/PortugalVill_2.sorted.bam



###### still an issue with the same read

mv /seq/vgb/linda/abba_baba/bams/PortugalVill_2.sorted.bam /seq/vgb/linda/abba_baba/bams/PortugalVill_2.somesame.bam

INFO	2017-01-09 23:25:13	MarkDuplicates	Tracking 337385 as yet unmatched pairs. 517 records in RAM.
[Mon Jan 09 23:25:16 EST 2017] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 30.77 minutes.
Runtime.totalMemory()=20141047808
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  7: 1:21377804
	at htsjdk.samtools.CoordinateSortedPairInfoMap.ensureSequenceLoaded(CoordinateSortedPairInfoMap.java:133)
	at htsjdk.samtools.CoordinateSortedPairInfoMap.remove(CoordinateSortedPairInfoMap.java:86)






##### some above seem to have been deleted...?

$mypath/bams/SRR2095539.sorted.bam is very small... Husky

"fastq-dump.2.5.7 err: name not found while resolving tree within virtual file system module - failed /seq/vgb/linda/abba_baba/sra/SRR2095539.sra

=============================================================
An error occurred during processing.
A report was generated into the file '/home/unix/boettger/ncbi_error_report.xml'.
If the problem persists, you may consider sending the file
to 'sra@ncbi.nlm.nih.gov' for assistance.
"



######### Problems with ChiwawaB chowchowA chowchowB and Husky. The sra files have issues, will need to write them. 


myfile=SRR2095539.sra
/seq/vgb/software/ncbi/bin/vdb-config --restore-defaults SRR2095539.sra

/seq/vgb/software/ncbi/bin/vdb-config --restore-defaults SRR2095539.sra
Fixed default configuration
 /seq/vgb/software/ncbi/bin/fastq-dump --origfmt -I --split-3 $mypath/sra/$myfile --gzip --outdir $mypath/fastq
2016-12-25T21:15:59 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'SRR2095539' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:15:59 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'

2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'SRR2095539' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed /seq/vgb/linda/abba_baba/sra/SRR2095539.sra
2016-12-25T21:16:00 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:16:00 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'


fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software.


$mypath/bams/SRR2095478.sorted.bam .. small chiwawab

SRR2094391 chowchow A very small
SRR2094392 chowchowb small
2016-12-25T21:17:16 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'SRR2095478' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:16 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:16 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'SRR2095478' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:16 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed /seq/vgb/linda/abba_baba/sra/SRR2095478.sra
2016-12-25T21:17:17 fastq-dump.2.5.7 err: error unexpected while resolving tree within virtual file system module - failed to resolve accession 'CM000001.3' - Obsolete software. See https://github.com/ncbi/sra-tools/wiki ( 406 )
2016-12-25T21:17:17 fastq-dump.2.5.7 err: name incorrect while evaluating path within network system module - Scheme is 'https'





YOU MUST UPDATE YOUR SOFTWARE TO 2.8.1 !!!

Versions prior to 2.8.0 cannot access NCBI resources anymore.

https://github.com/ncbi/sra-tools/wiki

SRR2095539.sra $mypath/bams/Husky.sorted.bam
SRR2095478.sra $mypath/bams/ChihuahuaB.sorted.bam
SRR2094391.sra $mypath/bams/ChowChowA.sorted.bam
SRR2094392.sra $mypath/bams/ChowChowB.sorted.bam


qsub -S /bin/bash -v myfile=SRR2094392.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR2094392.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR2094392.sra \
   -N SRR2094392.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


### change to breed names
mypath=/seq/vgb/linda/abba_baba

mv $mypath/bams/SRR2095539.sorted.bam $mypath/bams/Husky.sorted.bam

mv $mypath/bams/SRR2095478.sorted.bam $mypath/bams/ChihuahuaB.sorted.bam

mv $mypath/bams/SRR2094391.sorted.bam $mypath/bams/ChowChowA.sorted.bam

mv $mypath/bams/SRR2094392.sorted.bam $mypath/bams/ChowChowB.sorted.bam


##### now filter these !!!

qsub -S /bin/bash -v indv=ChowChowB -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_ChowChowB \
   -e /seq/vgb/linda/abba_baba/err/errfilt_ChowChowB \
   -N filt_ChowChowB \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh




### combine and filter
while read c; do
qsub -S /bin/bash -v indv=${c} -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_${c} \
   -e /seq/vgb/linda/abba_baba/err/errfilt_${c} \
   -N ${c}_filt \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh
done < /seq/vgb/linda/abba_baba/scripts/new_dogs.txt



qsub -S /bin/bash -v indv=PortugalVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_portone \
   -e /seq/vgb/linda/abba_baba/err/errfilt_portone \
   -N filt_PortugalVill \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


crashed!!!
Husky_filt  looks like it crashed
ChowChowA_
ChowChowB_

9391727 0.49637 BasenjiA_f boettger     r     12/24/2016 16:03:40 vert@vert02.broadinstitute.org     1        
9391728 0.49637 BasenjiB_f boettger     r     12/24/2016 16:03:40 vert@vert02.broadinstitute.org     1        
9391729 0.49637 Husky_filt boettger     r     12/24/2016 16:03:40 vert@vert01.broadinstitute.org     1        
9391730 0.49637 ChihuahuaA boettger     r     12/24/2016 16:03:40 vert@vert01.broadinstitute.org     1        
9391732 0.49637 ChowChowA_ boettger     r     12/24/2016 16:03:40 vert@vert03.broadinstitute.org     1        
9391733 0.49637 ChowChowB_ boettger     r     12/24/2016 16:03:40 vert@vert01.broadinstitute.org     1        
9391734 0.49637 ChineseVil boettger     r     12/24/2016 16:03:40 vert@vert03.broadinstitute.org     1        


9391727 0.49762 BasenjiA_f boettger     r     12/24/2016 16:03:40 vert@vert02.broadinstitute.org     1        
9391728 0.49762 BasenjiB_f boettger     r     12/24/2016 16:03:40 vert@vert02.broadinstitute.org     1        
9391730 0.49762 ChihuahuaA boettger     r     12/24/2016 16:03:40 vert@vert01.broadinstitute.org     1        
9391734 0.49762 ChineseVil boettger     r     12/24/2016 16:03:40 vert@vert03.broadinstitute.org     1        
9391735 0.00000 PortugalVi boettger     qw    12/24/2016 16:06:10                                    1       



######

## problems:
ChineseVill_2
PortugalVill_2



Chinese Village error:
INFO    2016-12-24 18:25:36     MarkDuplicates  Tracking 132922 as yet unmatched pairs. 0 records in RAM.
[Sat Dec 24 18:25:38 EST 2016] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 6.81 minutes.
Runtime.totalMemory()=10637803520
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  1: 1:48610462
        at htsjdk.samtools.CoordinateSortedPairInfoMap.ensureSequenceLoaded(CoordinateSortedPairInfoMap.java:133)
        at htsjdk.samtools.CoordinateSortedPairInfoMap.remove(CoordinateSortedPairInfoMap.java:86)


Portugal Village error:
INFO    2016-12-24 20:22:23     MarkDuplicates  Tracking 337385 as yet unmatched pairs. 517 records in RAM.
[Sat Dec 24 20:22:26 EST 2016] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 12.89 minutes.
Runtime.totalMemory()=20981481472
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  7: 1:21377804
        at htsjdk.samtools.CoordinateSortedPairInfoMap.ensureSequenceLoaded(CoordinateSortedPairInfoMap.java:133)
        at htsjdk.samtools.CoordinateSortedPairInfoMap.remove(CoordinateSortedPairInfoMap.java:86)



Could it be that the files uploaded for each were accidentally done twice and they are the same?
mv $mypath/bams/SRR3384063.sorted.bam $mypath/bams/ChineseVill_1.sorted.bam
mv $mypath/bams/SRR3384064.sorted.bam $mypath/bams/ChineseVill_2.sorted.bam


### Yes, these files appear to be the same!!
boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR3384063_1.fastq.gz | head -10
@1
TCTCTTTTNTTCTGCTTTCTTTTTTCAGGACTTGTNCTTTNTAAAGNNNCCNNGAGAACCAGATGGGTGACGNNNNNNNNNNNNNANNNN
+1
GGGGGACC#AA;?B@GGGGGDGGGGGGFEGDCDDA#:?=>#<??;5###86##=08+4<6BB???CECAA####################
@2
ATTAAAACNAAGGAAAATTTTAAAGCCAGCTCCATNTCCCNTGGCANNNGTNNNACCGTCAAAGAGTACTGCNNNNNNNNNNNNNTNNNN
+2
GGGGGCCC#CCCCCCFGGGGGGGGGEGGGGACBCC#B;B=#==7<?###7?###596;8<G?GDDE8EEB####################
@3
TCAAACAGNAACATGCACATAAAGAATATATGTATNTTTANATTTTNNNTGNNGTTGCCAAGTTGCTTTCCANNNNNNNNNNNNNANNNN
boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR3384064_1.fastq.gz | head -10
@1
TCTCTTTTNTTCTGCTTTCTTTTTTCAGGACTTGTNCTTTNTAAAGNNNCCNNGAGAACCAGATGGGTGACGNNNNNNNNNNNNNANNNN
+1
GGGGGACC#AA;?B@GGGGGDGGGGGGFEGDCDDA#:?=>#<??;5###86##=08+4<6BB???CECAA####################
@2
ATTAAAACNAAGGAAAATTTTAAAGCCAGCTCCATNTCCCNTGGCANNNGTNNNACCGTCAAAGAGTACTGCNNNNNNNNNNNNNTNNNN
+2
GGGGGCCC#CCCCCCFGGGGGGGGGEGGGGACBCC#B;B=#==7<?###7?###596;8<G?GDDE8EEB####################
@3
TCAAACAGNAACATGCACATAAAGAATATATGTATNTTTANATTTTNNNTGNNGTTGCCAAGTTGCTTTCCANNNNNNNNNNNNNANNNN


rm $mypath/bams/ChineseVill_2.sorted.bam
rm ChineseVill_merged.bam
rm ChineseVill_merged.bam.bai
rm ChineseVill_mergedRG.bam


qsub -S /bin/bash -v indv=ChineseVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_chin \
   -e /seq/vgb/linda/abba_baba/err/errfilt_chin \
   -N ChineseVill_filt \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh








######## Portugal village is different

boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR3384031_1.fastq.gz | head -10
@1
CGATTTTTAGAGAAAAAAAGTAAAAACGGAATCAGAGAGGCAGAACTGCCCAAGAGTCAATTCAGGACCAGGGTAGAAACCACCGTATGCAACTCACTCGT
+1
A?A?A################################################################################################
@2
AATGGTGTTGATGGTGGGGGTTATGATCAGACCAATAGATAGAGGAATTATAGATTTACGTTGACGTCAATGCGAAACAGAAACATTAACTTAATTCGGCA
+2
6;@@@;@;-C###########################################################################################
@3
TATTACTAATGAAGATTGAATTTAATGAATAAGACCATGTGAGTGTTAAACCACACAAGCGTGGGTGGCGTTATGATACTAGGTGTTATGAAACAAGACGG
boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR3384032_1.fastq.gz | head -10
@1
GNTTTCAGAAAGAGTCGTGGTCCTGGAACATTAATTATACATTGGGATTGTCTAGTTCATTGAAGGTTAATATGCTCAAGGAGTAATATTATTACTTCAGG
+1
B#AAAEEEEEGHHHFGFEGFDHHHHHEFHEHHHHHHHHEHEHEHHHEHDHBFEBE=EECBAA9><C7A=@=2<<6C?@DC@=A1>@=:AA@C?=;AC?CCE
@2
ANATCTGGTGACTCTGGTCCTCACCTGTGGACCATTATGACCTGGATACTCTGTTCCACACCTGAGCNTCACNTGGANNNNNNGANNNNNGANNNCNTCTG
+2
A#AAADDDDDHHHHHHHFHHHHHHHEH?HHHHHHHHHHHHHHHHFDFEFFHAHCCEHFEFHHE9E>@#?################################
@3
CCCCCAAATTCAAACGCTGAAGTCCTAACTCCTGTTACCTTGGAGTGTGACCCTCTTAGGAGAGTGGGTCTTCACCAATGTAATCAAGTTAAAATTAAGTT


# append the SRR ID onto the read names -- TESTING
add_readname='s/^(@\d{1,15})/$1_SRR3384031/'
sra_id=SRR3384031
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | head -10 | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_short_1.fastq.gz'


###################################### change SRR3384031 read names #############
screen -dr 958
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR3384032/'
sra_id=SRR3384032
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'

screen -dr 548
add_readname='s/^(@\d{1,15})$/$1_SRR3384032/'
sra_id=SRR3384032
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'



x
screen -dr 606
sra_id=SRR3384031
mypath=/seq/vgb/linda/abba_baba
bwa mem -t 26 $ref $mypath/fastq/$sra_id'_edit_1.fastq.gz' \
     $mypath/fastq/$sra_id'_edit_2.fastq.gz' \
     | samtools view -bS \
    > $mypath/bams/$sra_id'-pe.bam'

samtools sort -T $mypath/bams/tmp/$sra_id'.sorted' -o $mypath/bams/$sra_id'.sorted.bam' $mypath/bams/$sra_id'-pe.bam'



###################################### change SRR3384032 read names #############
screen -dr 958
add_readname='s/^(@\d{1,15})/$1_SRR3384032/'
sra_id=SRR3384032
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'

screen -dr 606
add_readname='s/^(@\d{1,15})/$1_SRR3384032/'
sra_id=SRR3384032
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'


screen -dr 958

sra_id=SRR3384032

bwa mem -t 26 $ref $mypath/fastq/$sra_id'_edit_1.fastq.gz' \
     $mypath/fastq/$sra_id'_edit_2.fastq.gz' \
     | samtools view -bS \
    > $mypath/bams/$sra_id'-pe.bam'

samtools sort -T $mypath/bams/tmp/$sra_id'.sorted' -o $mypath/bams/$sra_id'.sorted.bam' $mypath/bams/$sra_id'-pe.bam'






########### then I can re-align these etc......

mypath=/seq/vgb/linda/abba_baba
mv $mypath/bams/SRR3384031.sorted.bam $mypath/bams/PortugalVill_1.sorted.bam
mv $mypath/bams/SRR3384032.sorted.bam $mypath/bams/PortugalVill_2.sorted.bam




############ where I am with the aba babba dogs

---> making fastq and aligning
SRR2095539.sra $mypath/bams/Husky.sorted.bam
SRR2095478.sra $mypath/bams/ChihuahuaB.sorted.bam
SRR2094391.sra $mypath/bams/ChowChowA.sorted.bam... done!
SRR2094392.sra $mypath/bams/ChowChowB.sorted.bam


Chinese village dog is going through filtering---> looks done!


PortugalVill is alligning


##### start other corgis ######

### breed controls
#https://docs.google.com/spreadsheets/d/1X-WERplChOFfEhE3dTLsKiTdV150uOzR-szKSVAIBTM/edit?ts=57d033ae#gid=0
## golden 2135 is published and is a control
# unaffected PWC Missouri ID 68622 Tango healthy at age 13.9, Corgi
#The bam files for the 3 Corgis are here: /seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/





# get fastq from other corgis

running this for MavisA, MavisB, Woody_A, Woody_B


sample=Woody_B
parentpath=/seq/vgb/linda/abba_baba
use Samtools

## /1 or /2 added
samtools bam2fq /seq/vgb/rawData/dog/dog_wgs/missouriWGS_finalbams/$sample'.realign.marked.recalibrated.bam' | gzip > $parentpath/fastq/$sample'.fastq.gz' 


#http://www.metagenomics.wiki/tools/samtools/converting-bam-to-fastq
zcat $parentpath/fastq/$sample'.fastq.gz' | grep '^@.*/1$' -A 3 --no-group-separator | gzip > $parentpath/fastq/$sample'_1.fastq.gz'
zcat $parentpath/fastq/$sample'.fastq.gz' | grep '^@.*/2$' -A 3 --no-group-separator | gzip > $parentpath/fastq/$sample'_2.fastq.gz'


screen -dr 548
screen -dr 606
screen -dr 273
screen -dr 471

qsub -S /bin/bash -v sample=Woody_A -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/meh_out \
   -e /seq/vgb/linda/abba_baba/err/meh_err \
   -N align_Woody_A \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_dogs_fox_fixed.sh


###### read depth

qsub -S /bin/bash -v indiv=ChineseVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N depthCV \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh

qsub -S /bin/bash -v indiv=BasenjiA -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/BA_out \
   -e /seq/vgb/linda/abba_baba/err/BA_err \
   -N depthBA \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh

qsub -S /bin/bash -v indiv=BasenjiB -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/BB_out \
   -e /seq/vgb/linda/abba_baba/err/BB_err \
   -N depthBB \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh

qsub -S /bin/bash -v indiv=ChihuahuaA -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CA_out \
   -e /seq/vgb/linda/abba_baba/err/CA_err \
   -N ChihuahuaA \
   -p -10 \
   /seq/vgb/linda/abba_baba/get_readdepth.sh


check read depth then run run_abba_baba_coyoteTango.sh and run_abba_baba_Tangowolf.sh




######## The Beagle run with the window lengths modified doesn't look better,I'm going to try increasing the window size a little and doing more iterations

#Prevoulsy run as window=2000000 \
    overlap=500000 \

screen -dr 466
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=500 \
    overlap=249 \
    nthreads=12 \
    niterations=10 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_10it_win500



screen -dr 519
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=500 \
    overlap=249 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_25it_win500

#looks like it actually does 35 iterations


## windows are about 20Mb
screen -dr 120
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=1000 \
    overlap=499 \
    nthreads=12 \
    niterations=10 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_10it_win1000


## windows are about 20Mb (this still was worse than the original)
screen -dr 120
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=1000 \
    overlap=499 \
    nthreads=12 \
    niterations=10 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_10it_win1000




I will try phasing all together. There are 7928 SNPs on chr1 
screen -dr 487
use Java-1.8
java -Xmx8048m -jar /seq/vgb/software/beagle/beagle.16Jun16.7e4.jar \
    window=8000 \
    overlap=3999 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_geneticmap.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_25it_win8000



grep -v "ID=IMP" /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_10it_win1000.vcf > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_10it_win1000_noIMP.vcf

sed -i '/ID=IMP/d' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts_PHASED_25it_win8000.vcf



##### separate breeds
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_breed_curation_Jan8.sh
done < /seq/vgb/linda/mutts/mendels_mutts/breed_lists/breed_lists_15_Nov7/Breed_list_15.txt


screen -dr 487
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/Breed_tpeds_Jan8
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/Jan17_25it_win8000 \
    --window=80 \
    	$datapath/Labrador_Retriever.tped \
	$datapath/Basenji.tped \
	$datapath/Boxer.tped \
	$datapath/Belgian_Tervuren.tped \
	$datapath/Beagle.tped \
	$datapath/Bernese_Mountain_Dog.tped \
	$datapath/Border_Terrier.tped \
	$datapath/Brittany.tped \
	$datapath/English_Cocker_Spaniel.tped \
	$datapath/Dalmatian.tped \
	$datapath/English_Bulldog.tped \
	$datapath/Gordon_Setter.tped \
	$datapath/Greyhound.tped \
	$datapath/Jack_Russell_Terrier.tped \
	$datapath/Bull_Terrier.tped \
	$datapath/Nova_Scotia_Duck_Tolling_Retriever.tped \
	$datapath/Cairn_Terrier.tped \
	$datapath/Doberman_Pinscher.tped \
	$datapath/Saint_Bernard.tped \
	$datapath/Shetland_Sheepdog.tped \
	$datapath/Boston_Terrier.tped \
	$datapath/French_Bulldog.tped \
	$datapath/Pomeranian.tped \
	$datapath/Bichon_Frise.tped \
	$datapath/Australian_Shepherd.tped \
	$datapath/Havanese.tped \
	$datapath/Poodle.tped \
	$datapath/Tibetan_Spaniel.tped \
	$datapath/Maltese.tped \
	$datapath/Miniature_Schnauzer.tped \
	$datapath/Pug.tped \
	$datapath/Dachshund.tped \
	$datapath/Shih_Tzu.tped \
	$datapath/Lhasa_Apso.tped \
	$datapath/Weimaraner.tped \
	$datapath/Cocker_Spaniel.tped \
	$datapath/Siberian_Husky.tped \
	$datapath/Rottweiler.tped \
	$datapath/Toy_Poodle.tped \
	$datapath/Basset_Hound.tped \
	$datapath/Vizsla.tped \
	$datapath/English_Springer_Spaniel.tped \
	$datapath/Scottish_Terrier.tped \
	$datapath/Yorkshire_Terrier.tped \
	$datapath/Great_Dane.tped \
	$datapath/Irish_Wolfhound.tped \
	$datapath/English_Setter.tped \
	$datapath/German_Shepherd_Dog.tped \
	$datapath/Newfoundland.tped \
	$datapath/Golden_Retriever.tped \
	$datapath/Papillon.tped \
	$datapath/Cavalier_King_Charles_Spaniel.tped \
	$datapath/West_Highland_White_Terrier.tped \
	$datapath/Miniature_Pinscher.tped \
	$datapath/Mastiff.tped \
	$datapath/Chinese_Shar-pei.tped \
	$datapath/Border_Collie.tped \
	$datapath/Schipperke.tped \
	$datapath/Mendels_Mutts.tped







######### start abba baba for finished purebreds
ChineseVill
ChihuahuaA
BasenjiB
BasenjiA
Comet

qsub -S /bin/bash -v indiv=Comet -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N Comet \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh


Leonburger is running on screen -dr 262


......yellow wolf didn't work for leonburger!!!---> running now



####################### Looking into how to determine accuracy for ancestry assignment ########

#just takes a straight % correct based on a calling threshold "accuracy"
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3740525/#SD1
file:///Users/boettger/Downloads/NIHMS481876-supplement-01.pdf

# show percent correct for multiple calling thresholds
# Show % correct of different window sizes


# We have a choice between undercalling certain breeds and undercalling shorter segments, it may be better to call based on posterior probability. It is important to be able to make a statement about how many gen back breed contribution is and we don't want to bias away from ancient crosses. 

recomb_sm_plots.R 



Current abba baba issues:

1. I should run all mutts through abba baba as well with tango!!!


Mavis and Woody are alignning

Several are filtering


Portugal Village dog Error!!!!!! --> read names being edited again
screen -dr 487
mem_sam_pe] [mem_sam_pe] [mem_sam_pe] paired reads have different names: "103_SRR3384031", "102_SRR3384031"
[mem_sam_pe] paired reads have different names: "102_SRR3384031", "101_SRR3384031"
[mem_sam_pe] [mem_sam_pe] paired reads have different names: "115_SRR3384031", "114_SRR3384031"


mem_sam_pe] [mem_sam_pe] paired reads have different names: "1983_SRR3384032", "1982_SRR3384032"
[mem_sam_pe] [mem_sam_pe] paired reads have different names: "1991_SRR3384032", "1990_SRR3384032"
[mem_sam_pe] paired reads have different names: "1993_SRR3384032", "1992_SRR3384032"




qsub -S /bin/bash -v indv=Mavis -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_chin \
   -e /seq/vgb/linda/abba_baba/err/errfilt_chin \
   -N Mavis_filt \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh



qsub -S /bin/bash -v indv=Woody_ -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_Woody \
   -e /seq/vgb/linda/abba_baba/err/errfilt_Woody_ \
   -N Woody_filt \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh




qsub -S /bin/bash -v indv=PortugalVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt_PortugalVill \
   -e /seq/vgb/linda/abba_baba/err/errfilt_PortugalVill \
   -N PortugalVill_filt \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh



Already done:
ChineseVill
ChihuahuaA
BasenjiB
BasenjiA
Comet

Need to do: running
Xmutts
XChowChowA
X wolfhound or something needs yellow wolf running


waiting on alignments:
Woody
Mavis
ChowChowB
ChihuahuaB
Husky



qsub -S /bin/bash -v indiv=ChowChowA -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_ChowA \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh


## RUN SOON!!
qsub -S /bin/bash -v indiv=Mavis -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_Mavis \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh


qsub -S /bin/bash -v indiv=ChihuahuaB -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_ChihuahuaB \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh




qsub -S /bin/bash -v indiv=Husky -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_Husky \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh


qsub -S /bin/bash -v indiv=PortugalVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_PortugalVill \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh




#I'm running this for mutts with verifide complete bam

while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_ids_withbam.txt


## others that were missing
qsub -S /bin/bash -v indiv=DX10 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_DX10 \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh





while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_breed_curation_Jan8.sh
done < /seq/vgb/linda/mutts/mendels_mutts/breed_lists/breed_lists_15_Nov7/Breed_list_15.txt



########## run mutts that previously had a problem 
qsub -S /bin/bash -v indv=D158 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/combD158_out \
   -e /seq/vgb/linda/abba_baba/err/combD158_err \
   -N filt_D158 \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh

D158 and DX10 are being filtered
qsub -S /bin/bash -v indv=D158 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/combD158_out \
   -e /seq/vgb/linda/abba_baba/err/combD158_err \
   -N filt_D158 \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh




D199, the fastqs didn't get extracted right from this one

qsub -S /bin/bash -v sample=D199 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err_D199 \
 -p -10 \
 -N fastq_D199 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/bam_to_fastq_canids.sh


qsub -S /bin/bash -v sample=D199 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/D199newout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/D199newerr \
 -N aln_D199 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/sra_align_dogs_fox_fixed.sh

## this didn't work before because I was calling it sample
qsub -S /bin/bash -v indv=D199 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/D199filtout \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/D199filterr \
 -N filt_D199 \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Canids_combine_filter_move.sh


################## consolidate the abba baba results (last line of every file in directory ###########

cd /seq/vgb/linda/abba_baba/jackKnife_results/purebreds
tail -q -n1 * | grep -P "\tal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_alabama_coyote.txt
tail -q -n1 * | grep "cal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_california_coyote.txt
tail -q -n1 * | grep "mex_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_mexican_wolf.txt
tail -q -n1 * | grep "yellow_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_yellow_wolf.txt

# remove the middle columns
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_alabama_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_alabama_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_california_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_california_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_mexican_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_mexican_wolf_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_yellow_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_yellow_wolf_e1.txt

# sort by the Z score 
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_alabama_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_alabama_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_california_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_california_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_mexican_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_mexican_wolf_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebred_yellow_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebred_yellow_wolf_e2.txt



############################# AdmixInfer ###########

#### get boost to use with AdmixInfer v1.0.4
#http://www.boost.org/doc/libs/1_58_0/more/getting_started/unix-variants.html#get-boost

wget http://sourceforge.net/projects/boost/files/boost/1.58.0/boost_1_58_0.tar.bz2
tar --bzip2 -xf boost_1_58_0.tar.bz2

# add boost to path
PATH=$PATH:/seq/vgb/linda/bin/boost_1_58_0/

#It still can't find boost to make AdmixInfer
/seq/vgb/linda/bin/AdmixInfer-fast-master/src $ make
g++ -O2 -Wall -fopenmp  -c SegmentData.cpp -o SegmentData.o
In file included from SegmentData.cpp:11:
SegmentData.hpp:15:28: error: boost/random.hpp: No such file or directory

### try moving boost into the same directory --> still doesn't find it!!
cp -R /seq/vgb/linda/bin/boost_1_58_0/boost /seq/vgb/linda/bin/AdmixInfer-fast-master/src/boost


## run test
/seq/vgb/linda/bin/AdmixInfer-fast-master/src/AdmixInfer \
  -i /seq/vgb/linda/bin/AdmixInfer-fast-master/example/sim1.seg \
  -l 0.01 -u 0.5 -a 0.01 \
  -b 100 -p 0.5 

## Skeeter as test input

/seq/vgb/linda/AdmixInfer/inputs

/seq/vgb/linda/bin/AdmixInfer-fast-master/src/AdmixInfer \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11.seg

#Noooooo!!!!!!!!!!
"Reading ancestral tracks from /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11.seg
Tracks from either one population or more than two populations
"
#make everything that isn't sheltie a different breed!!!
/seq/vgb/linda/bin/AdmixInfer-fast-master/src/AdmixInfer \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11_twobreed.seg \
  -l 0.1 -a 0.01 \
  -b 100 -p 0.5 


#thinks it happened 13 generations ago!!
Reference populations: Shetland_Sheepdog, other_breed
Admixture proportions: 0.467063, 0.532937
Optimal-model: HI(44%)
Generation: 13.39, 99% confidence interval: (12.82, 13.95)




########call fox bases at specific locations that we want
screen -dr 606
use Samtools
use Bcftools
samtools mpileup -uBI -l /seq/vgb/linda/ancestral_bases/dog_loci.bed \
 -f /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta \
 /seq/vgb/linda/abba_baba/finished_bams/VulLag_out.sorted.bam \
 | bcftools view - > /seq/vgb/linda/ancestral_bases/VulLag_snpcalls_CanHD.vcf

# was this but it produced an error
 bcftools view -cg
Error: Could not parse --min-ac g



-B seems to be not doing any BAQ filtering
-u flag causes it to compute genotype likelihoods and output a bcf


# I think I need to figure out how to get allelic depth "AD" in the output file





##########get new reference set with 13 dogs per breed

What % of US dogs are in  
[1] labrador_retriever                 newfoundland                      
 [3] german_shepherd_dog                golden_retriever                  
 [5] rottweiler                         basenji                           
 [7] boxer                              cairn_terrier                     
 [9] yorkshire_terrier                  norfolk_terrier                   
[11] tibetan_spaniel                    belgian_tervuren                  
[13] beagle                             bernese_mountain_dog              
[15] border_terrier                     brittany                          
[17] cocker_spaniel                     dalmatian                         
[19] doberman_pinscher                  bulldog_english                   
[21] bull_terrier                       gordon_setter                     
[23] greyhound                          jack_russell_terrier              
[25] nova_scotia_duck_tolling_retriever saint_bernard                     
[27] chihuahua                          english_cocker_spaniel            
[29] pekingese                          shetland_sheepdog                 
[31] siberian_husky                     boston_terrier                    
[33] bulldog_french                     havanese                          
[35] pomeranian                         vizsla                            
[37] bichon_frise                       australian_shepherd               
[39] miniature_schnauzer                maltese                           
[41] poodle                             pembroke_welsh_corgi              
[43] pug                                shih_tzu                          
[45] dachshund                          english_setter                    
[47] lhasa_apso                         weimaraner                        
[49] staffordshire_bull_terrier         poodle_toy                        
[51] basset_hound                       border_collie                     
[53] english_springer_spaniel           scottish_terrier                  
[55] great_dane                         irish_wolfhound                   
[57] chinese_crested                    papillon                          
[59] cavalier_king_charles_spaniel      west_highland_white_terrier       
[61] miniature_pinscher                 leonberger                        
[63] mastiff                            chinese_shar-pei                  
[65] schipperke 

These breeds were added over the 15
my.13[new.breeds]
[1] dalmatian                  chihuahua                  english_cocker_spaniel    
[4] pekingese                  pembroke_welsh_corgi       staffordshire_bull_terrier
[7] chinese_crested            leonberger         


#######these breeds were in the 11 list but not in the 15
my.11[which(my.11 %ni% my.15)]
 [1] chinook                     dalmatian                  
 [3] norwegian_elkhound          finnish_spitz              
 [5] german_shorthaired_pointer  chihuahua                  
 [7] english_cocker_spaniel      keeshond                   
 [9] pekingese                   chesapeake_bay_retriever   
[11] airedale_terrier            fox_terrier_wire           
[13] irish_setter                pembroke_welsh_corgi       
[15] bullmastiff                 staffordshire_bull_terrier 
[17] afghan_hound                borzoi                     
[19] peruvian_inca_orchid        chinese_crested            
[21] leonberger                  akita                      
[23] alaskan_malamute            wirehaired_pointing_griffon 

### these are all the breeds with 11
 [1] chinook                            labrador_retriever                
 [3] newfoundland                       german_shepherd_dog               
 [5] golden_retriever                   rottweiler                        
 [7] basenji                            boxer                             
 [9] cairn_terrier                      yorkshire_terrier                 
[11] norfolk_terrier                    tibetan_spaniel                   
[13] belgian_tervuren                   beagle                            
[15] bernese_mountain_dog               border_terrier                    
[17] brittany                           cocker_spaniel                    
[19] dalmatian                          doberman_pinscher                 
[21] bulldog_english                    bull_terrier                      
[23] norwegian_elkhound                 finnish_spitz                     
[25] gordon_setter                      greyhound                         
[27] jack_russell_terrier               nova_scotia_duck_tolling_retriever
[29] german_shorthaired_pointer         saint_bernard                     
[31] chihuahua                          english_cocker_spaniel            
[33] keeshond                           pekingese                         
[35] shetland_sheepdog                  siberian_husky                    
[37] boston_terrier                     chesapeake_bay_retriever          
[39] bulldog_french                     havanese                          
[41] pomeranian                         airedale_terrier                  
[43] vizsla                             bichon_frise                      
[45] australian_shepherd                miniature_schnauzer               
[47] maltese                            poodle                            
[49] fox_terrier_wire                   irish_setter                      
[51] pembroke_welsh_corgi               pug                               
[53] bullmastiff                        shih_tzu                          
[55] dachshund                          english_setter                    
[57] lhasa_apso                         weimaraner                        
[59] staffordshire_bull_terrier         afghan_hound                      
[61] poodle_toy                         basset_hound                      
[63] border_collie                      english_springer_spaniel          
[65] scottish_terrier                   borzoi                            
[67] peruvian_inca_orchid               great_dane                        
[69] irish_wolfhound                    chinese_crested                   
[71] papillon                           cavalier_king_charles_spaniel     
[73] west_highland_white_terrier        miniature_pinscher                
[75] leonberger                         mastiff                           
[77] chinese_shar-pei                   schipperke                        
[79] akita                              alaskan_malamute                  
[81] wirehaired_pointing_griffon 




Breeds with 12 and village dogs 

 [1] labrador_retriever                 newfoundland                      
 [3] german_shepherd_dog                golden_retriever                  
 [5] rottweiler                         basenji                           
 [7] boxer                              cairn_terrier                     
 [9] yorkshire_terrier                  norfolk_terrier                   
[11] tibetan_spaniel                    belgian_tervuren                  
[13] beagle                             bernese_mountain_dog              
[15] border_terrier                     brittany                          
[17] cocker_spaniel                     dalmatian                         
[19] doberman_pinscher                  bulldog_english                   
[21] bull_terrier                       norwegian_elkhound                
[23] finnish_spitz                      gordon_setter                     
[25] greyhound                          jack_russell_terrier              
[27] nova_scotia_duck_tolling_retriever german_shorthaired_pointer        
[29] saint_bernard                      chihuahua                         
[31] english_cocker_spaniel             pekingese                         
[33] shetland_sheepdog                  siberian_husky                    
[35] boston_terrier                     chesapeake_bay_retriever          
[37] bulldog_french                     havanese                          
[39] pomeranian                         airedale_terrier                  
[41] vizsla                             bichon_frise                      
[43] australian_shepherd                miniature_schnauzer               
[45] maltese                            poodle                            
[47] fox_terrier_wire                   pembroke_welsh_corgi              
[49] pug                                shih_tzu                          
[51] dachshund                          english_setter                    
[53] lhasa_apso                         weimaraner                        
[55] staffordshire_bull_terrier         poodle_toy                        
[57] basset_hound                       border_collie                     
[59] english_springer_spaniel           scottish_terrier                  
[61] borzoi                             village_dog_mexico                
[63] great_dane                         irish_wolfhound                   
[65] chinese_crested                    papillon                          
[67] cavalier_king_charles_spaniel      west_highland_white_terrier       
[69] miniature_pinscher                 leonberger                        
[71] mastiff                            chinese_shar-pei                  
[73] schipperke                         akita                             
[75] alaskan_malamute                   wirehaired_pointing_griffon  








All the dogs I will use are here: /Users/boettger/postdoc/mutts/mydogs.13eachJan.txt

The breed lists are here: /Users/boettger/postdoc/mutts/breed_lists_13_Jan12



plink --bfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFLIPPED \
 --merge /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.ped /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/mydogs.15eachSEPTforvcf_fromped.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each





############# Get new dataset with 12 dogs per breed, will separately phase reference and test populations #######

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED \
 --merge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_nonarraySNPsloc.ped /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_nonarraySNPsloc.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/mydogs.12eachJan.txt \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_someflipped_12each


#### can I get my sampled individuals?
/seq/vgb/linda/mutts/boyko_allSNPs/testing_SM



vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

$vcftools --vcf /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_someflipped_12each.vcf \
--keep /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/sampled_indivs.txt \
--recode \
--out /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/Boyko_someflipped_sampled6


#Run Time = 96.00 seconds


$vcftools --vcf /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_someflipped_12each.vcf \
--remove /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/sampled_indivs.txt \
--recode \
--out /seq/vgb/linda/mutts/boyko_allSNPs/testing_SM/Boyko_someflipped_sampled6



#make new genetic map for 12 dogs per breed Jan testing

awk '{print $1,$2,$3,$4}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_someflipped_12each.bim \
> /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_someflipped_12each_geneticmap.txt



######## get file without flipping for the mutts #####
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/mydogs.12eachJan.txt \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_locFLIPPED_12each


#make new genetic map for 12 dogs per breed Jan testing

awk '{print $1,$2,$3,$4}' /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_locFLIPPED_12each.bim \
> /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_locFLIPPED_12each_geneticmap.txt







## Two Rscripts:
# one for parititioning and phasing vcfs into tped/tfam
# the other for reading the partitioned and phased tped/tfam
# and using it with the simulated crosses.  

Rscript postdoc/mutts/scripts/recomb_phasing_partitions.R







#######
use R-3.3
Rscript /seq/vgb-HAL/linda/mutts/simu_crosses/Rscripts/recomb_phasing_partitions.R \
 /seq/vgb-HAL/linda/mutts/simu_crosses 5


ref_data_path=/seq/vgb-HAL/linda/mutts/simu_crosses/ref_data
simulation_path=/seq/vgb-HAL/linda/mutts/simu_crosses/sim_005
ref_or_test=test
ref_or_test=ref


use GridEngine8
qsub -S /bin/bash \
   -v ref_data_path=/seq/vgb-HAL/linda/mutts/simu_crosses/ref_data,simulation_path=/seq/vgb-HAL/linda/mutts/simu_crosses/sim_005 \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb-HAL/linda/mutts/simu_crosses/out \
   -e /seq/vgb-HAL/linda/mutts/simu_crosses/err \
   -N phasing \
   -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
   /seq/vgb-HAL/linda/mutts/simu_crosses/Rscripts/phase_sim_vcf.sh



qsub -S /bin/bash \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb-HAL/linda/mutts/simu_crosses/out \
   -e /seq/vgb-HAL/linda/mutts/simu_crosses/err \
   -N phasing \
   -wd /wga/scr4/vgbgrp/linda/bal_sel/core_dump \
   /bin/echo "test"

# remove all sim jobs
qdel $(qstat | grep sim | grep -Po '^\d+' | perl -pe 's/\n/ /')


qdel $(qstat | grep Phase | grep -Po '^\d+' | perl -pe 's/\n/ /')





######## get rid of chrx for the abba baba analysis

cp -R /seq/vgb/linda/abba_baba/abba_baba_results/purebreds /seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX/

sed -i '/chrX/d' BasenjiA_al_coy_Tango.abbababa

sed -i '/chrX/d' *

#get rid of chrx
for i in *.abbababa; do
    sed -i '/chrX/d' $i
done


bamlists=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists
jackout=/seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX

## do jackknife
use R-3.3
cd /seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX
for i in *_al_coy_Tango.abbababa; do
    indiv=$(perl -e '$ARGV[0] =~ /(.*)_al_coy_Tango.abbababa/ && print $1' $i)
    Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
    file=/seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX/"$indiv"_al_coy_Tango.abbababa \
    indNames=$bamlists/"$indiv"_al_coy_Jack_Tango.bamfilelist \
    outfile=$jackout/"$indiv"_al_coy_Tango
done


for i in *_cal_coy_Tango.abbababa; do
    indiv=$(perl -e '$ARGV[0] =~ /(.*)_cal_coy_Tango.abbababa/ && print $1' $i)
    Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
    file=/seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX/"$indiv"_cal_coy_Tango.abbababa \
    indNames=$bamlists/"$indiv"_cal_coy_Jack_Tango.bamfilelist \
    outfile=$jackout/"$indiv"_cal_coy_Tango
done

for i in *_mex_wolf.abbababa; do
    indiv=$(perl -e '$ARGV[0] =~ /(.*)_mex_wolf.abbababa/ && print $1' $i)
    Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
    file=/seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX/"$indiv"_mex_wolf.abbababa \
    indNames=$bamlists/"$indiv"_mex_wolf_Jack.bamfilelist \
    outfile=$jackout/"$indiv"_mex_wolf
done

yellow_wolf
for i in *_yellow_wolf.abbababa; do
    indiv=$(perl -e '$ARGV[0] =~ /(.*)_yellow_wolf.abbababa/ && print $1' $i)
    Rscript /seq/vgb/linda/bin/angsd/R/jackKnife.R \
    file=/seq/vgb/linda/abba_baba/abba_baba_results/purebreds_noX/"$indiv"_yellow_wolf.abbababa \
    indNames=$bamlists/"$indiv"_yellow_wolf_Jack.bamfilelist \
    outfile=$jackout/"$indiv"_yellow_wolf
done

#consolodate results
cd /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX
tail -q -n1 * | grep -P "\tal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_alabama_coyote.txt
tail -q -n1 * | grep "cal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_california_coyote.txt
tail -q -n1 * | grep "mex_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_mexican_wolf.txt
tail -q -n1 * | grep "yellow_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_yellow_wolf.txt

# remove the middle columns
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_alabama_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_alabama_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_california_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_california_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_mexican_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_mexican_wolf_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_yellow_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_yellow_wolf_e1.txt

# sort by the Z score 
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_alabama_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_alabama_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_california_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_california_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_mexican_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_mexican_wolf_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_yellow_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/purebreds_noX_summary/purebred_yellow_wolf_e2.txt


### replace with names I want
sed -i -E "s/Comet_out.sorted.bam/Golden_Retriever/" *.txt
sed -i -E "s/Husky_out.sorted.bam/Siberian_Husky/" *.txt
sed -i -E "s/LE_1306_control.bam/Leonberger/" *.txt
sed -i -E "s/Woody_out.sorted.bam/CorgiB/" *.txt
sed -i -E "s/Mavis_out.sorted.bam/CorgiC/" *.txt
sed -i -E "s/PortugalVill_out.sorted.bam/Portugal_Vill/" *.txt
sed -i -E "s/ChineseVill_out.sorted.bam/Chinese_Vill/" *.txt
sed -i -E "s/DX09/mutt_Rudy/" *.txt
sed -i -E "s/DX01/mutt_Skeeter/" *.txt
sed -i -E "s/DX05/mutt_Rhoda/" *.txt
sed -i -E "s/DX07/mutt_Finch/" *.txt
sed -i -E "s/D183/mutt_Esme/" *.txt
sed -i -E "s/D198/mutt_Sandy/" *.txt
sed -i -E "s/DX04/mutt_Tui/" *.txt
sed -i -E "s/D132/mutt_Clarence/" *.txt
sed -i -E "s/DX08/mutt_Jaime/" *.txt
sed -i -E "s/D131/mutt_Hopper/" *.txt
sed -i -E "s/D182/mutt_Skyler/" *.txt
sed -i -E "s/D184/mutt_Lucky/" *.txt
sed -i -E "s/DX06/mutt_Lily/" *.txt
sed -i -E "s/DX11/mutt_Vera-Lynn/" *.txt
sed -i -E "s/DX02/mutt_Hunter/" *.txt
sed -i -E "s/D157/mutt_Beskow/" *.txt
sed -i -E "s/DX03/mutt_Reily/" *.txt

Missing:
Kaylee D158
Kack DX10
Scotch D199

sed -i -E "s/_out.sorted.bam//" *.txt

sed -i -E "s/ /\t/" *.txt


D181_2	GusD158_2	KayleeDX09	RudyDX01	SkeeterDX05	RhodaDX07	FinchD183	EsmeD198	SandyD199	ScotchDX04	TuiD132	ClarenceDX08	JaimeD131	HopperD181	Gus *** twice!!D158	Kaylee *** twice!!D182	SkylerDX10	JackD184	LuckyDX06	LilyDX11	Vera-LynnDX02	HunterD157	BeskowDX03	Reily


Missing:
Kaylee D158
Kack DX10
Scotch D199
 

DX10, D158, D199

run abba baba


## others that were missing
qsub -S /bin/bash -v indiv=D199 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ab_D199 \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_purebredComp.sh







######## run simulations

## this is a new version that should allow a map file

qsub -S /bin/bash -v sim=sim_006,win_size=80 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out12map \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err12map \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N sim6_breed \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix_12perbreed.sh


"ERROR: genetic map folder contains too few or to many files with pattern: *_chrchr01_*, 0 found."



#difference in errors depending on version of python
use Python-2.6 there is a matplotlib issues
use Python-2.7 there is an issue No module named popgen
use Python-3.4 there is a parentheses issue
use Python-3.1 there is a parentheses issue


#There is an error with the python code??
/seq/vgb/linda/bin/supportmix-master $ more /seq/vgb/linda/mutts/mendels_mutts/err/err12map
  File "/seq/vgb/linda/bin/supportmix-master/SupportMix", line 129
    print "Genetic Map Directory:",mapFile
                                 ^
SyntaxError: Missing parentheses in call to 'print'





qsub -S /bin/bash -v sim=sim_006,win_size=80 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out12nomap \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err12nomap \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N nomap_6sim \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix_12perbreed_nomap.sh



# we do a little worse with the map

## this was run without the map
> supportmix.truth.all.winsize.dt[sim=='001', .N, by=correct]
   correct       N
1:    TRUE 1398602
2:   FALSE  266339

#this was run with the map
> supportmix.truth.all.winsize.dt[sim=='002', .N, by=correct]
   correct       N
1:    TRUE 1294452
2:   FALSE  370489



############ Turns out the "one map" one does have a map in the tped file ########## 

### simulate admixture
###### run admixture code on server 
screen -dr 487
 use R-3.3
Rscript /seq/vgb-HAL/linda/mutts/simu_crosses/Rscripts/recomb_run_phase.R /seq/vgb-HAL/linda/mutts/simu_crosses 15 500 5





## running on sim1-5
qsub -S /bin/bash -v sim=sim_005,win_size=80 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out12map \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err12map \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N sim5_breed \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix_12perbreed.sh








## DBG's solution:
use Python-2.7
# use pip, set the PYTHONUSERBASE env variable in bash to set the install for pip
# so it doesn't get angry when you try to install without sudo
export PYTHONUSERBASE=/seq/vgb/linda
mkdir -p /seq/vgb/linda
pip install --user popgen





##### troubleshooting multiwaver install

/seq/vgb/linda/bin/MultiWaver/src

g++ -O2 -Wall -I/seq/vgb/linda/bin/boost_1_58_0 -c Utils.cpp -o Utils.o
g++ -O2 -Wall -I/seq/vgb/linda/bin/boost_1_58_0 -c MultiWaver.cpp -o MultiWaver.o
g++ -O2 -Wall -o MultiWaver ParamExp.o EMExp.o Utils.o MultiWaver.o -L/seq/vgb/linda/bin/boost_1_58_0 
EMExp.o: In function `EMExp::updateLik()':
EMExp.cpp:(.text+0x19b): undefined reference to `std::__throw_out_of_range_fmt(char const*, ...)'
EMExp.o: In function `EMExp::iterate(int, double)':
EMExp.cpp:(.text+0x6f8): undefined reference to `std::__throw_out_of_range_fmt(char const*, ...)'
collect2: ld returned 1 exit status
make: *** [MultiWaver] Error 1

I'm using:
gcc version 4.4.7 20120313 (Red Hat 4.4.7-17) (GCC) 

Need to upgrade to 5.0? https://github.com/BVLC/caffe/issues/4973

use GCC-5.1 --> worked!!!


###### test multiwaver on skeeter
screen -dr 548
/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11.seg \
  -s 

"killed"



# try with only 9 breeds + "other_breed"
/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan24.seg \
  -s

Possible scenario: #1
   48.2327: (0,   0.903302) =========>||<========= (3,  0.0966982) :   10.4556
                                      ||
                                      ||
                                      ||
    10.183: (6,   0.138554) =========>||
                                      ||
                                      ||
                                      ||
                                      ||<========= (9,  0.0732187) :   10.0642
                                      ||
                                      ||
                                      ||
   8.62837: (4,    0.11822) =========>||
                                      ||
                                      ||
                                      ||
                                      ||<========= (1,   0.564835) :   8.32147
                                      ||
                                      ||
                                      ||
   7.53188: (2,  0.0460101) =========>||
                                      ||
                                      ||
                                      ||
   6.82419: (8,   0.024281) =========>||
                                      ||
                                      ||
                                      ||
                                      ||<========= (5,  0.0465192) :   4.46081
                                      ||
                                      ||
                                      ||
                                      ||<========= (7,  0.0793983) :   4.16836
                                      ||
                                      ||
                                      ||

Hint:
0: population-other_breed; 1: population-Shetland_Sheepdog; 2: population-Golden_Retriever; 3: population-Siberian_Husky; 4: population-Labrador_Retriever; 5: population-Pomeranian; 6: population-Jack_Russell_Terrier; 7: population-Rottweiler; 8: population-German_Shepherd_Dog; 9: population-Pug;






qsub -S /bin/bash -v infile=DX01_Jan11.seg \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/AdmixInfer/outputs/out_DX01_Jan11.seg \
 -e /seq/vgb/linda/AdmixInfer/outputs/error_DX01_Jan11.seg \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N multiwaver \
 /seq/vgb/linda/AdmixInfer/inputs/run_multiwaver.sh

version `GLIBCXX_3.4.20' not found (requir
ed by /seq/vgb/linda/bin/MultiWaver/src/MultiWaver)

qsub -S /bin/bash -v infile=DX01_Jan24.seg \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/AdmixInfer/outputs/out_DX01_Jan24.seg \
 -e /seq/vgb/linda/AdmixInfer/outputs/error_DX01_Jan24.seg \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N multiwaverJan24 \
 /seq/vgb/linda/AdmixInfer/inputs/run_multiwaver.sh


/seq/vgb/linda/bin/MultiWaver/src/MultiWaver: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.20' not found (requir
ed by /seq/vgb/linda/bin/MultiWaver/src/MultiWaver)



/seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11_twobreed.seg

/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11_twobreed.seg

#this still says 8 generations ago

Finished scanning for admixture waves.

There is only 1 wave of admixture event detected
-----------------------------------------------------------------------------
                             Results summary

             Parental population            Admixture proportion
               Shetland_Sheepdog                        0.467063
                     other_breed                        0.532937


Possible scenario: #1
   8.15407: (0,   0.467063) =========>||<========= (1,   0.532937) :   27.8869
                                      ||
                                      ||
                                      ||

Hint: 
0: population-Shetland_Sheepdog; 1: population-other_breed; 




/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/DX01_Jan11.seg \
  -l 0.01 -a 0.01 -e 0.0001 \
 -m 5000 


#Look at golden doodle Hubble

/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/Hubble_Jan25.seg \
  -l 0.01 -a 0.01 -e 0.0001 \
  -m 5000 

######################### removing the regions not called as golden or poodle
There is only 1 wave of admixture event detected
-----------------------------------------------------------------------------
                             Results summary

             Parental population            Admixture proportion
                Golden_Retriever                        0.479887
                          Poodle                        0.520113


Possible scenario: #1
   9.72824: (0,   0.479887) =========>||<========= (1,   0.520113) :   9.17332
                                      ||
                                      ||
                                      ||

Hint: 
0: population-Golden_Retriever; 1: population-Poodle; 



##### remove all windows below 0.94
/seq/vgb/linda/bin/MultiWaver/src/MultiWaver \
  -i /seq/vgb/linda/AdmixInfer/inputs/Hubble_Jan25_0.94.seg
 

There is only 1 wave of admixture event detected
-----------------------------------------------------------------------------
                             Results summary

             Parental population            Admixture proportion
                Golden_Retriever                        0.437852
                          Poodle                        0.562148


Possible scenario: #1
   6.58465: (0,   0.437852) =========>||<========= (1,   0.562148) :   7.78186
                                      ||
                                      ||
                                      ||




###### get depth for mutts

GATK3
## needs java 1.6
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar \
   -T DepthOfCoverage \
   -R /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fasta \
   -o /seq/vgb/linda/mutts/mendels_mutts/mutt_coverage \
   -I /seq/vgb/linda/mutts/mendels_mutts/mutt_bams.list




######## Run Mendel's mutts with phasing partitions #######


#first get rid of mexican village dogs
$vcftools = /Users/boettger/postdoc/gen_apps/vcftools_0.1.12b/bin/vcftools


$vcftools --vcf /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_locFLIPPED_12each.vcf \
 --remove /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/village_dog_mexico.txt \
 --recode \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts-merge.missnp \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/Boyko_locFLIPPED_12each_novillage

Excluding individuals in 'exclude' list
After filtering, kept 900 out of 912 Individuals
Outputting VCF file...

After filtering, kept 150396 out of a possible 150426 Sites
Run Time = 151.00 seconds


simulation_path=/seq/vgb-HAL/linda/mutts/MM_ancestry
ref_data_path=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed
vcftools=/seq/vgb/linda/bin/vcftools_0.1.12b/bin/vcftools

### keep some as the reference populations to phase separately
$vcftools --vcf $ref_data_path/Boyko_locFLIPPED_12each_novillage.recode.vcf \
 --keep /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/sampled_indivs.txt \
 --recode \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref


### keep some as individuals to help phase
$vcftools --vcf $ref_data_path/Boyko_locFLIPPED_12each_novillage.recode.vcf \
 --remove /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/sampled_indivs.txt \
 --recode \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test


## convert these to plink and merge with mutts

test.recode.vcf
$vcftools --vcf /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test.recode.vcf \
 --plink \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test


#make reference to flip snps
$vcftools = /Users/boettger/postdoc/gen_apps/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref.recode.vcf \
 --plink \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref


#flip snps onref
plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref \
  --flip /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts-merge.missnp \
  --dog \
  --maf 0.0001 \
  --extract /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps1.txt \
  --out  /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref_reflipped \
  --recode

150127 variants remaining

awk {'print $2'} /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref_reflipped.map > /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps.txt

150127


plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/merged_Boykoref15_ourmutts-merge.missnp \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts


Error: 116 variants with 3+ alleles present.
* If you believe this is due to strand inconsistency, try --flip with
  /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts-merge.missnp.
  (Warning: if this seems to work, strand errors involving SNPs with A/T or C/G
  alleles probably remain in your data.  If LD between nearby SNPs is high,
  --flip-scan should detect them.)


plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test \
  --flip /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts-merge.missnp \
  --recode \
  --maf 0.0001 \
  --dog \
  --out  /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped

#150247 variants

## merge and only keep snps that are in the reference boyko set



plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/MuttsWGS-snpsedit_CanHDfilt.fam \
 --dog \
 --make-bed \
 --extract /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts

"--extract: 150127 variants remaining."




### make genetic map

#first get bim with snps we need
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/allBoyko_CanHD_locFLIPPED \
 --dog \
 --make-bed \
 --extract /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps.txt \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/for_boyko12map


"--extract: 150127  variants remaining"



awk '{print $1,$2,$3,$4}' /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/for_boyko12map.bim > /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/merged_Boykoref12_ourmutts_geneticmap.txt



####### start phasing reference ############

beagle=/seq/vgb/software/beagle/beagle.16Jun16.7e4.jar
use Java-1.8

screen -dr 550 --> running again!!!
java -Xmx8048m -jar $beagle \
    window=8000 \
    overlap=3999 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/merged_Boykoref12_ourmutts_geneticmap.txt \
    gt=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_ourmutts.vcf \
    out=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/PHASED_Boykoref12_ourmutts

my_path=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001




screen -dr 487
java -Xmx8048m -jar $beagle \
This analysis was done with reference panels of 75 breeds. We had 12 dogs per breed total;  6 were used for phasing and 6 were used as the reference panel. #Phasing parameters:    window=8000    overlap=3999    nthreads=12    niterations=25#cutoffs to include breed in figures (otherwise it is set to no call)min.seg <- 2  (2 independent segments in the genome)min.pct <- 0.015 (at least 1.5% of the genome)#omitted segments may have a very high posterior probability, but they are a very small percent of the genome. 
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/merged_Boykoref12_ourmutts_geneticmap.txt \
    gt=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/ref_reflipped.vcf \
    out=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/PHASED_ref


cp $my_path/PHASED_ref.vcf.gz $my_path/PHASED_ref_safe.vcf.gz

####### 
#get rid of "ID=IMP" line "Flag Type must have 0 entries"
cp $my_path/PHASED_ref.vcf.gz $my_path/ref.copy.phased.vcf.gz
gzip -cd $my_path/ref.copy.phased.vcf.gz | grep -v "ID=IMP" \
| gzip > $my_path/PHASED_ref.vcf.gz
rm $my_path/ref.copy.phased.vcf.gz



## separate the breeds into files
qsub -S /bin/bash -v thispop=airedale_terrier -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N beagle \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_Jan29.sh

## separate the breeds into files
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_Jan29.sh
done < /seq/vgb/linda/mutts/mendels_mutts/breed_lists/breed_lists_12/Breed_list_12.txt


############## DARWINS DOGS 12 DOGS PER BREED, 75 BREEDS ###########


plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.fam \
 --dog \
 --make-bed \
 --extract /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_Darwins_dogs




Error: 5 variants with 3+ alleles present.
* If you believe this is due to strand inconsistency, try --flip with
  /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_Darwins_dogs-merge.missnp.

plink --file /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped \
  --flip /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_Darwins_dogs-merge.missnp \
  --dog \
  --make-bed --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped2



plink --bfile /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/test_reflipped2 \
 --bmerge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.bim \
 /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/darwins_dogs_CanHDfilt.fam \
 --dog \
 --make-bed \
 --extract /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/keep_ref_snps.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_Darwins_dogs

--extract: 150127 variants remaining.


150127 variants and 549 dogs pass filters and QC



beagle=/seq/vgb/software/beagle/beagle.16Jun16.7e4.jar
use Java-1.8

#using same map file as for mendel's mutts, same number of snps

screen -dr 550
java -Xmx8048m -jar $beagle \
    window=8000 \
    overlap=3999 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/my_12per_breed/merged_Boykoref12_ourmutts_geneticmap.txt \
    gt=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/merged_Boykoref12_Darwins_dogs.vcf \
    out=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001/PHASED_Boykoref12_Darwins_dogs

my_path=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001






############## START HERE ################

bash 

my_path=/seq/vgb-HAL/linda/mutts/MM_ancestry/sim_001

cp $my_path/PHASED_Boykoref12_ourmutts.vcf.gz $my_path/PHASED_Boykoref12_ourmutts_safe.vcf.gz


#get rid of "ID=IMP" line "Flag Type must have 0 entries"
cp $my_path/PHASED_Boykoref12_ourmutts.vcf.gz $my_path/ref.copy.phased.vcf.gz
gzip -cd $my_path/ref.copy.phased.vcf.gz | grep -v "ID=IMP" \
| gzip > $my_path/PHASED_Boykoref12_ourmutts.vcf.gz
rm $my_path/ref.copy.phased.vcf.gz


qsub -S /bin/bash -v thispop=Mendels_Mutts -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/breed_cur.out \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/breed_cur.err \
 -p -10 \
 -N MM \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/MM_12breed_curation_Jan29.sh




screen -dr 550
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds_12per_Jan29
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/Jan29_12perbreed \
    --window=80 \
    $datapath/bichon_frise.tped \
    $datapath/bernese_mountain_dog.tped \
    $datapath/boxer.tped \
    $datapath/boston_terrier.tped \
    $datapath/borzoi.tped \
    $datapath/border_terrier.tped \
    $datapath/border_collie.tped \
    $datapath/belgian_tervuren.tped \
    $datapath/beagle.tped \
    $datapath/basset_hound.tped \
    $datapath/basenji.tped \
    $datapath/australian_shepherd.tped \
    $datapath/akita.tped \
    $datapath/alaskan_malamute.tped \
    $datapath/brittany.tped \
    $datapath/leonberger.tped \
    $datapath/jack_russell_terrier.tped \
    $datapath/havanese.tped \
    $datapath/greyhound.tped \
    $datapath/fox_terrier_wire.tped \
    $datapath/great_dane.tped \
    $datapath/gordon_setter.tped \
    $datapath/golden_retriever.tped \
    $datapath/german_shorthaired_pointer.tped \
    $datapath/german_shepherd_dog.tped \
    $datapath/english_springer_spaniel.tped \
    $datapath/english_cocker_spaniel.tped \
    $datapath/doberman_pinscher.tped \
    $datapath/dalmatian.tped \
    $datapath/cocker_spaniel.tped \
    $datapath/chinese_shar-pei.tped \
    $datapath/chinese_crested.tped \
    $datapath/chesapeake_bay_retriever.tped \
    $datapath/cavalier_king_charles_spaniel.tped \
    $datapath/cairn_terrier.tped \
    $datapath/bulldog_english.tped \
    $datapath/bull_terrier.tped \
    $datapath/labrador_retriever.tped \
    $datapath/irish_wolfhound.tped \
    $datapath/finnish_spitz.tped \
    $datapath/english_setter.tped \
    $datapath/dachshund.tped \
    $datapath/chihuahua.tped \
    $datapath/bulldog_french.tped \
    $datapath/west_highland_white_terrier.tped \
    $datapath/tibetan_spaniel.tped \
    $datapath/staffordshire_bull_terrier.tped \
    $datapath/scottish_terrier.tped \
    $datapath/schipperke.tped \
    $datapath/yorkshire_terrier.tped \
    $datapath/wirehaired_pointing_griffon.tped \
    $datapath/weimaraner.tped \
    $datapath/vizsla.tped \
    $datapath/siberian_husky.tped \
    $datapath/saint_bernard.tped \
    $datapath/pug.tped \
    $datapath/shih_tzu.tped \
    $datapath/shetland_sheepdog.tped \
    $datapath/poodle_toy.tped \
    $datapath/pekingese.tped \
    $datapath/papillon.tped \
    $datapath/newfoundland.tped \
    $datapath/miniature_pinscher.tped \
    $datapath/maltese.tped \
    $datapath/rottweiler.tped \
    $datapath/poodle.tped \
    $datapath/pomeranian.tped \
    $datapath/pembroke_welsh_corgi.tped \
    $datapath/nova_scotia_duck_tolling_retriever.tped \
    $datapath/norwegian_elkhound.tped \
    $datapath/norfolk_terrier.tped \
    $datapath/miniature_schnauzer.tped \
    $datapath/mastiff.tped \
    $datapath/lhasa_apso.tped \
    $datapath/airedale_terrier.tped \
    $datapath/Mendels_Mutts.tped






########## downsampling just snps on the array for abba baba ########


-r [region]

chr7:123456              \\position 123456 of chr7


-rf  (region file)


#get canineHD snp locations
/seq/vgb/linda/admixture/Illumina/CanineHD_loc.snptable 



#get rid of first line and check that genome has "chr" beofore all loci
awk '{print "chr"$1}' CanineHD_loc_no0.snptable > CanineHD_loc.abbababa.regions

got rid of chr41 (chrX/Y)



while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_CanineHD_SNPs.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt

#then "sort by z score"


qsub -S /bin/bash -v indiv=ChineseVill -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ChineseVill \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_CanineHD_SNPs.sh



bampath=/seq/vgb/linda/abba_baba/finished_bams
bamlists=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists
outpath=/seq/vgb/linda/abba_baba/abba_baba_results/CanineHD_SNPs

##### Tried to run 3 snps on chr25
# took regions I didn't ask for
/seq/vgb/linda/bin/Feb2_angsd/angsd/angsd \
	-bam $bamlists/ChineseVill_cal_coy_Tango.bamfilelist \
	-out $outpath/ChineseVill_cal_coy_Tango \
	-doAbbababa 1 \
        -remove_bads 1 \
        -rf /seq/vgb/linda/admixture/Illumina/test_abbababa.regions \
	-enhance 1 \
	-useLast 1 \
   	-minMapQ 30 \
	-blockSize 1 \
        -minQ 30 \
	-doCounts 1


#I get 762 SNPS in this file (not 3), most are on chr25
 /seq/vgb/linda/abba_baba/abba_baba_results/CanineHD_SNPs/ChineseVill_cal_coy_Tango.abbababa


#just try one SNP with "-r"
/seq/vgb/linda/bin/Feb2_angsd/angsd/angsd \
	-bam $bamlists/ChineseVill_cal_coy_Tango.bamfilelist \
	-out $outpath/ChineseVill_cal_coy_Tango \
	-doAbbababa 1 \
        -r chr17:25505162 \
	-enhance 1 \
	-useLast 1 \
	-blockSize 1 \
	-doCounts 1

### I get 250 SNPs this time, most on chr17




### the above isn't working yet, it grabs other snps

##################

## previous from above, mergeing of array and non-array (now on vgb not hal)
plink --bfile /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_CanHD_locFLIPPED \
 --merge /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.ped /seq/vgb-HAL/linda/mutts/boyko_allSNPs/allBoyko_nonarraySNPsloc.map \
 --dog \
 --maf 0.0001 \
 --exclude /seq/vgb-HAL/linda/mutts/boyko_allSNPs/rm_indels.txt \
 --make-bed \
 --keep /seq/vgb-HAL/linda/mutts/boyko/pop_lists_15/mydogs.15eachSEPTforvcf_fromped.txt \
 --recode vcf-iid \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/merged_someflipped_15each


#This has the names of snps to flip (from Jess in Boyko lab), but I need the locations
/seq/vgb/linda/mutts/boyko_allSNPs/data_curation/snps_to_flip.pfizer.txt


#they used a costum array, not the canineHD, I'm going to flip all the SNPs that she sent me from scratch


Remove two SNPs very far away from their canhd location: 
BICF2G63027171 11 11 11535426 8978200 2557226
BICF2S23755960 17 17 64281982 64239564 42418









########### I put jess' files and her snps to flip here:/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array


################### Do some filtering even before flipping ###############
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --flip /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/snps_to_flip.pfizer.txt \
  --make-bed \
  --noweb \
  --geno 0.1 \
  --mind 0.1 \
  --hardy \
  --maf 0.02 \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_filt \
  --nonfounders

4342 cornell_canine_seqSNPs.fam

582 of 4339 individuals removed for low genotyping ( MIND > 0.1 )
180117 markers to be included
4339 individuals read
162813 markers to be excluded based on HWE test ( p <= 0.001 
After frequency and genotyping pruning, there are 17293 SNP

## this removes a lot of individuals -- bad place to do filtering

rm /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_filt*


--flip

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --flip /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/snps_to_flip.pfizer.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped



### get snps to remove (chr39 hemizygous and no location/mit)
grep "^0\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bim > no_loc_snps.txt
grep "^39\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bim >> no_loc_snps.txt
grep "^40\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bim >> no_loc_snps.txt
awk '{print $2}' no_loc_snps.txt > rm_snps.txt

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped \
 --dog \
 --exclude rm_snps.txt \
 --make-bed \
 --noweb \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped_rmsnps



#### replace SNP names with locations
awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped_rmsnps.bim \
 > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim

cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped_rmsnps.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bed

cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped_rmsnps.fam \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.fam


## look at snps I think are duplicated
grep "chr8:33825304" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim
grep "chr11:60627269" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim
# ------> looks like they are only there once!!!


##################### Filter Boyko dataset without sex chromosomes ########################


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
  --dog \
  --make-bed \
  --noweb \
  --geno 0.1 \
  --mind 0.1 \
  --hardy \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_filt \
  --nonfounders




awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim > Boyko_loc.txt


vcftools --vcf /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.vcf \
    --plink \
    --out /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc


"Unrecognized values used for CHROM: 23 - Replacing with 0." etc.... replacing by hand 
After filtering, kept 439201 out of a possible 439201 Sites
#this file also has X, Y and M... don't need to keep these I changed all X to chr41, some of them aren't hemizhou
#but they won't match the bp location so it's fine

## get list of snps to keep
awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim > analysis_snps.txt

##### try merging with darwin's dogs data, only keep snps in pfizer array
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
 --merge /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.ped \
  /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.map \
 --extract Boyko_loc.txt\
 --dog \
 --noweb \
 --maf 0.0001 \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp
 
"Warning: different genetic position for chr41:6608343"... just has to do with no morgans on one

439201 (of 439201) markers to be merged from [ /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.map ]
Of these, 266455 are new, 172746 already exist
Found 32 SNPs that do not match in terms of allele codes
Might include strand flips, although flipped A/T and C/G SNPs will be undetected)
Writing problem SNPs to [ /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp.missnp ]

#to get rid of indels 
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/rm_indels.txt



### flip snps and get rid of those that are singletons
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp.missnp \
 --dog \
 --noweb \
 --maf 0.0001 \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq

Reading list of SNPs to exclude [ /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp.missnp ] ... 32 read
Before frequency and genotyping pruning, there are 173840 SNPs
4339 founders and 0 non-founders found
Total genotyping rate in remaining individuals is 0.971164
0 SNPs failed missingness test ( GENO > 1 )
14600 SNPs failed frequency test ( MAF < 0.0001 )
After frequency and genotyping pruning, there are 159240 SNPs

rm /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_reflippedFreq*

##### try merging with darwin's dogs data, only keep snps in pfizer array
awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq.bim > Boyko_locfreq.txt


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq \
 --merge /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.ped \
  /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.map \
 --dog \
 --extract Boyko_locfreq.txt \
 --noweb \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp2
 
159240 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq.bim

439201 (of 439201) markers to be merged from [ /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.map ]
Of these, 280875 are new, 158326 already exist
99 individuals merged from [ /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.ped ] 
Of these, 99 were new, 0 were already in current data

#in R 
 dim(snp.overlap)
[1] 158326


Reading list of SNPs to extract [ Boyko_locfreq.txt ] ... 159240 read
Before frequency and genotyping pruning, there are 159240 SNPs
4438 founders and 0 non-founders found
Total genotyping rate in remaining individuals is 0.980846
0 SNPs failed missingness test ( GENO > 1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 159240 SNPs
After filtering, 53 cases, 85 controls and 4300 missing
After filtering, 2167 males, 2164 females, and 107 of unspecified sex
Writing pedigree information to [ /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp2.fam ] 
Writing map (extended format) information to [ /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp2.bim ] 
Writing genotype bitfile to [ /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/tmp2.bed ] 


#These are snps for the Darwin's dog analysis that are in DD and the Boyko dataset
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_overlap.snps.txt


#### extract these snps in both datasets

### get just the SNPs I want and just the 12 dogs I want (no mexican village dogs)
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq \
 --dog \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_overlap.snps.txt \
 --keep /seq/vgb-HAL/linda/mutts/boyko/my_dogs12each_Jan_NoVDM.txt \
 --noweb \
 --make-bed \
 --geno 0.1 \
 --mind 0.1 \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_forDD_12perbreed


########### FILTERING BOYKO DATASET, OVERLAPPING DARWINS DOGS SNPS ONLY #######
######## I may want to go back and only get the list of dogs with a higher genotyping rate
## and only keep snps that have a low missing rate
--geno 0.1 --mind 0.1
45 of 900 individuals removed for low genotyping ( MIND > 0.1 )
Total genotyping rate in remaining individuals is 0.986903
14107 SNPs failed missingness test ( GENO > 0.1 )
0 SNPs failed frequency test ( MAF < 0 )

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flippedFreq \
 --dog \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_overlap.snps.txt \
 --noweb \
 --make-bed \
 --geno 0.1 \
 --mind 0.1 \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_forDD_passFilt

Before frequency and genotyping pruning, there are 158326 SNPs

377 of 4339 individuals removed for low genotyping ( MIND > 0.1 )
178 SNPs failed missingness test ( GENO > 0.1 )

### I should look at how many breeds have 12 or more dogs..... using only these individuals




### simulate admixture
###### run admixture code on server 
screen -dr 487
 use R-3.3
Rscript /seq/vgb-HAL/linda/mutts/simu_crosses/Rscripts/recomb_run_phase.R /seq/vgb-HAL/linda/mutts/simu_crosses 15 500 5


### dbg filtering

# Do we want to remove ~200 samples or ~3000 snps? The former is better
# if we still have at least 12 samples for 75 breeds but the latter otherwise
# is better. The extra boyko snps must have had a lower genotyping rate
# because the darwin's dogs were run  on the illumina, and fewer samples are
# thrown out (~338). In other words, we're throwing out an extra ~200 individuals
# to keep the boyko snps.


#filter genotyping rate of at least 95%
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --make-bed \
  --noweb \
  --geno 0.1 \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_geno_filt \
  --nonfounders

--geno 0.05
Total genotyping rate in remaining individuals is 0.97016
38424 SNPs failed missingness test ( GENO > 0.05 )

--geno 0.10
30053 SNPs failed missingness test ( GENO > 0.1 )
0 SNPs failed frequency test ( MAF < 0 )
After frequency and genotyping pruning, there are 150064 SNPs


# Filter on HWE
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_geno_filt \
  --dog \
  --make-bed \
  --noweb \
  --geno 0.05 \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_geno_filt \
  --nonfounders


# Filter on individual genotyping rate at least 90%








plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --flip /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/snps_to_flip.pfizer.txt \
  --make-bed \
  --noweb \
  --geno 0.1 \
  --mind 0.1 \
  --hardy \
  --maf 0.02 \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_filt \
  --nonfounders

# We go down from 75 to 63 breeds when we do the filtering to get rid individuals with


# geno on filtered flipped boyko
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
 --dog \
 --noweb \
 --make-bed \
 --geno 0.1 \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_passFilt


################## Running SM on simulations 1-5 #####

######## run simulations

## this is a new version that should allow a map file

qsub -S /bin/bash -v sim=sim_005,win_size=80 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out12map \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err12map \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N sim5real_SM \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix_12perbreed.sh


#none of these worked, seems to be a problem with the map and potentially the way the chromsomes are written
WARNING!: The genetic map distances are VERY small at 0.0097 cM/Mb!!!
WARNING!: The genetic map distances are VERY small at 0.0097 cM/Mb!!!

ERROR: No SNPs found in specified chromosome




###### downsampling mutts (this is just testing chr1)

/seq/vgb/jmcclure/scratch/

downsampled bams are kept here:
/seq/vgb/linda/mutts/mendels_mutts/downsample

qsub -S /bin/bash -v dogid=D184,needed_cov=5 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/downsampleD184 \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/downsampleD184 \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N D184_down \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/downsample_reads.sh


# run ofr all mutts at 5x
while read c; do
qsub -S /bin/bash -v dogid=$c,needed_cov=5 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/downsample \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/downsample \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/downsample_reads.sh
done < /seq/vgb/linda/mutts/mendels_mutts/MM_dogids.txt



# run ofr all mutts at 1x
while read c; do
qsub -S /bin/bash -v dogid=$c,needed_cov=1 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/downsample \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/downsample \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/mendels_mutts/scripts/downsample_reads.sh
done < /seq/vgb/linda/mutts/mendels_mutts/MM_dogids.txt



######### to calculate r2, we will use vcftools #####
sites to look at will be combo of 

#33 dogs in total 


/seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf (half of the mutts at a time)
/seq/vgb/jmcclure/resources/Known2.vcf


#prep the known sites
grep -v '#' /seq/vgb/jmcclure/resources/Known2.vcf > /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2.txt

awk '{print $1, $2}' /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2e.txt

#there are 19million snps
19112081 /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2e.txt


#--remove /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_1.txt (11 individuals) 33-11=12 1/24 = 0.04 polymorphic >.001
#--remove /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_2.txt (10 individuals) 33-10=13 1/26 = 0.03 is polymorphic >.001
#--maf 0.01


get output that keeps and excludes half the mutts (11)

screen -dr 471
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf \
   --remove /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_1.txt \
   --recode \
   --min-alleles 2 \
   --maf 0.001 \
   --max-alleles 2 \
   --remove-indels \
   --out /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2 

Excluding individuals in 'exclude' list
After filtering, kept 35 out of 46 Individuals
Outputting VCF file...
After filtering, kept 13693121 out of a possible 21306255 Sites




screen -dr 273
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf \
   --remove /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_2.txt \
   --recode \
   --min-alleles 2 \
   --maf 0.001 \
   --max-alleles 2 \
   --remove-indels \
   --out /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1 

Excluding individuals in 'exclude' list
After filtering, kept 36 out of 46 Individuals
Outputting VCF file...
After filtering, kept 14021961 out of a possible 21306255 Sites
Run Time = 3678.00 seconds




mydir=/seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use
#thishalf=var_in_halfofMutts_2.recode.vcf #screen -dr 606
thishalf=var_in_halfofMutts_1.recode.vcf  #screen -dr 390

#get rid of header, get cols we want, replace with tabs
grep -v '#' $mydir/$thishalf > $mydir/$thishalf'.txt'
awk '{OFS="\t"} {print $1, $2, $4, $5}' $mydir/$thishalf'.txt' > $mydir/$thishalf'e.txt'


#combine with known variants
#cat $mydir/$thishalf'e.txt' /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2e.txt > $mydir/$thishalf'plus.txt'
#36218725

#sort and get unique entries
#sort -u $mydir/$thishalf'plus.txt' > $mydir/$thishalf'plussort.txt'

#14021961 /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1.recode.vcfe.txt
#13693121 /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2.recode.vcfe.txt

#combine with known variants
#cat /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1.recode.vcfplussort.txt /seq/vgb/linda/mutts/#mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2.recode.vcfplussort.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/#variants_to_use/var_in_allof.recode.vcfplus.txt

#53826686

#sort and get unique entries
#sort -u /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_allof.recode.vcfplus.txt > /seq/vgb/linda/mutts/#mendels_mutts/downsample/variants_to_use/var_in_allof.recode.vcfplusuniquesort.txt

#28490215 /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_allof.recode.vcfplusuniquesort.txt


#53826686-28490215= 25,336,471 variants taht would overlap between teh two sets

#27051263-17638559 = 9.4 million fewer possible variants for not using known2

#grep "chr1 " $mydir/$thishalf'plussort.txt' > $mydir/$thishalf'plussort_chr1.txt'

grep "chr1 " $mydir/$thishalf'e.txt' > $mydir/$thishalf'e_chr1.txt'


###### try running STITCH for chr1

# could have used "downsampleFraction" in STITCh

#to install and run 
http://www.well.ox.ac.uk/~rwdavies/STITCH_examples_1.1.4.R

/seq/vgb/linda/R/STITCH
#get mean coverage of darwins dogs

awk 's+=$4{print s/NR}' /seq/vgb/jmcclure/scratch/depth.txt \
  | tail -1
#44.5584

#needed_coverage/this_coverage

5/44.56 = .11 (for 5x)


##### get two variant lists for each half of the dataset -- SKIPPING THIS, don't know variants

#prep the known sites
grep -v '#' /seq/vgb/jmcclure/resources/Known2.vcf > /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2.txt

awk '{print $1, $2 }' /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2e.txt

#there are 19million snps
19112081 /seq/vgb/linda/mutts/mendels_mutts/downsample/Known2e.txt




########## EACH TIME I WANT TO USE STITCH ###########

Type 'q()' to quit R.


use R-3.1
R
.libPaths( c( .libPaths(), "/seq/vgb/linda/R") )
library("STITCH")


/seq/vgb/linda/R/STITCH
grep "chr1"$'\t' /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2.recode.vcfe.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2_chr1.txt

grep "chr1"$'\t' /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1.recode.vcfe.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1_chr1.txt


grep "chr35"$'\t' /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1.recode.vcfe.txt > /seq/vgb/linda/mutts/mendels_mutts/downsample/mutts2_data/var_in_halfofMutts_1_chr35.txt



#put in data dirs
cp /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_2_bams.txt /seq/vgb/linda/mutts/mendels_mutts/downsample/mutts2_data/halfofMutts_2_bams.txt
cp /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_1_chr1.txt /seq/vgb/linda/mutts/mendels_mutts/downsample/mutts2_data/var_in_halfofMutts_1_chr1.txt


### RUN halfofmutts2!!!
# screen -dr 390
# Run whole chromosome
# variables #
mutts2_outputdir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/stitch_output/Muttshalf2/'
mutts2_datadir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/mutts2_data/'
mutts2_bamlist <- paste0(mutts2_datadir, "halfofMutts_2_bams.txt")
#genfile <- paste0(mutts2_datadir, "gen.txt")
mutts2_posfile <- paste0(mutts2_datadir, "var_in_halfofMutts_1_chr1.txt")
K <- 10
nGen <- 4500
chr = "chr1"
nCores <- 12
inputBundleBlockSize <- NA
downsampleFraction <- 0.11
mutts2_tmp <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/tmp/mutts2_tmp'


setwd(mutts2_datadir)
system(vcf_output_name = "Mutts2.vcf.gz", paste0("rm -r ", mutts2_outputdir), ignore.stderr = TRUE)
STITCH(method = "diploid", outputdir = mutts2_outputdir, chr = chr, posfile = mutts2_posfile, bamlist = mutts2_bamlist, K = 10, tempdir = mutts2_tmp, nCores = nCores, downsampleFraction=downsampleFraction, nGen = nGen)

[1] "Program start - Mon Mar  6 11:20:04 2017"
[1] "Generate inputs - Mon Mar  6 11:20:19 2017"
cp: cannot stat `/seq/vgb/linda/mutts/mendels_mutts/downsample/stitch_output/Muttshalf2/input/sample*.input.chr1.RData': No such file or directory
[1] "Downsample to fraction - Mon Mar  6 14:46:56 2017"
[1] "Generate allele count"
Error in out2[[i]][["alleleCount"]] : subscript out of bounds
In addition: Warning messages:
1: In mclapply(1:N, mc.cores = nCores, FUN = f, tempdir = tempdir,  :
  all scheduled cores encountered errors in user code
2: In mclapply(x3, mc.cores = nCores, FUN = f, T = T, tempdir = tempdir,  :
  all scheduled cores encountered errors in user code




### RUN halfofmutts2 --- chr35!!!
# screen -dr 390
# Run whole chromosome
# variables #
mutts2_outputdir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/stitch_output/Muttshalf2/'
mutts2_datadir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/mutts2_data/'
mutts2_bamlist <- paste0(mutts2_datadir, "halfofMutts_2_bams.txt")
#genfile <- paste0(mutts2_datadir, "gen.txt")
mutts2_posfile <- paste0(mutts2_datadir, "var_in_halfofMutts_1_chr35.txt")
K <- 10
nGen <- 4500
chr = "chr35"
nCores <- 12
inputBundleBlockSize <- NA
downsampleFraction <- 0.11
mutts2_tmp <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/tmp/mutts2_tmp'

setwd(mutts2_datadir)
system(paste0("rm -r ", mutts2_outputdir), ignore.stderr = TRUE)
STITCH(method = "diploid", outputdir = mutts2_outputdir, chr = chr, posfile = mutts2_posfile, bamlist = mutts2_bamlist, K = 10, tempdir = mutts2_tmp, nCores = nCores, downsampleFraction=downsampleFraction, nGen = nGen)


STITCH(method = "diploid", outputdir = mutts2_outputdir, chr = chr, posfile = mutts2_posfile, bamlist = mutts2_bamlist, K = 10, tempdir = mutts2_tmp, nCores = nCores, downsampleFraction=downsampleFraction, nGen = nGen)
[1] "Program start - Mon Mar  6 15:20:49 2017"
[1] "Generate inputs - Mon Mar  6 15:20:51 2017"

[1] "WARNING - downsample sample DX02 - 24 of 2356378 reads removed "
[1] "WARNING - downsample sample DX03 - 22 of 2411482 reads removed "
[1] "WARNING - downsample sample DX09 - 33 of 2363316 reads removed "
[1] "WARNING - downsample sample DX11 - 50 of 2473766 reads removed "
[1] "WARNING - downsample sample DX08 - 125 of 2600311 reads removed "
[1] "WARNING - downsample sample DX07 - 863 of 2912365 reads removed "
[1] "WARNING - downsample sample DX05 - 1826 of 3091207 reads removed "
[1] "WARNING - downsample sample DX04 - 4849 of 3282813 reads removed "
[1] "WARNING - downsample sample DX06 - 2084 of 3164923 reads removed "
[1] "WARNING - downsample sample DX10 - 28020 of 3759683 reads removed "
[1] "Downsample to fraction - Sat Mar 11 23:38:48 2017"
[1] "Generate allele count"
[1] "Done generating allele count"
[1] "Begin EM -  Sat Mar 11 23:41:07 2017"
[1] "Number of SNPs - 180337"
[1] "Start of iteration 1 - Sat Mar 11 23:41:07 2017"
[1] "Error in if (outputBlockRange[length(outputBlockRange)] == outputBlockRange[length(outputBlockRange) -  : \n  argument is of length zero\n"
attr(,"class")
[1] "try-error"
attr(,"condition")
<simpleError in if (outputBlockRange[length(outputBlockRange)] == outputBlockRange[length(outputBlockRange) -     1]) outputBlockRange <- outputBlockRange[-length(outputBlockRange)]: argument is of length zero>
[1] 1
Error in STITCH(method = "diploid", outputdir = mutts2_outputdir, chr = chr,  :
  ERROR in iterations - see file/seq/vgb/linda/mutts/mendels_mutts/downsample/stitch_output/Muttshalf2/RData/mainDebug.chr35.RData









## RUN halfofmutts1!!!
 screen -dr 606

#put in data dirs
cp /seq/vgb/linda/mutts/mendels_mutts/downsample/halfofMutts_1_bams.txt /seq/vgb/linda/mutts/mendels_mutts/downsample/mutts1_data/halfofMutts_1_bams.txt
cp /seq/vgb/linda/mutts/mendels_mutts/downsample/variants_to_use/var_in_halfofMutts_2_chr1.txt /seq/vgb/linda/mutts/mendels_mutts/downsample/mutts1_data/var_in_halfofMutts_2_chr1.txt

# Run whole chromosome
# variables #
mutts1_outputdir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/stitch_output/Muttshalf1'
mutts1_datadir <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/mutts1_data/'
mutts1_bamlist <- paste0(mutts1_datadir, "halfofMutts_1_bams.txt")
#genfile <- paste0(mutts1_datadir, "gen.txt")
mutts1_posfile <- paste0(mutts1_datadir, "var_in_halfofMutts_2_chr1.txt")
K <- 10
nGen <- 4500
chr = "chr1"
nCores <- 12
inputBundleBlockSize <- NA
downsampleFraction <- 0.11
mutts1_tmp <- '/seq/vgb/linda/mutts/mendels_mutts/downsample/tmp/mutts1_tmp'


setwd(mutts1_datadir)
system(paste0("rm -r ", mutts1_outputdir), ignore.stderr = TRUE)
STITCH(method = "diploid", outputdir = mutts1_outputdir, chr = chr, posfile = mutts1_posfile, bamlist = mutts1_bamlist, K = 10, tempdir = mutts1_tmp, nCores = nCores, downsampleFraction=downsampleFraction, nGen = nGen)




############### using VCFtools, look at the differences between the high and low coverage data ################

--diff
--diff-indv-discordance















## Start using T1 and T2 for bal sel

T1 and T2
http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004561


There is also this stat by ben voight's group:
http://www.biorxiv.org/content/early/2017/07/05/112870



http://www.personal.psu.edu/mxd60/Manual_BALLET_v1.0.pdf


tar -xzvf ballet_v1.0.tar.gz

use GSL
gcc ballet_v1_0.c –o BALLET –lm –lgsl -lgslcblas
gcc ballet_v1_0.c \342\200\223o BALLET \342\200\223lm \342\200\223lgsl -lgslcblas
gcc: –o: No such file or directory
gcc: BALLET: No such file or directory
gcc: –lm: No such file or directory
gcc: –lgsl: No such file or directory



gcc ballet_v1_0.c –o BALLET –lm –lgsl -lgslcblas


For creating polymorphism file:
http://popgen.dk/angsd/index.php/Allele_Frequencies
use -doMajorMinor 5 to use ancestral allele as major
“You can force the major allele according to your ancestral states if you have defined those -anc”

#get human ancestral sequence
wget http://popgen.dk/software/download/angsd/hg19ancNoChr.fa.gz
mv hg19ancNoChr.fa.gz chimpHg19.fa.gz
samtools faidx chimpHg19.fa.gz


### submit chr20 for YRI
# HAD TO CHANGE PATHS IN BAMFILE LIST!!!!
qsub -S /bin/bash -q vert -v chr=20 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N chr20angsd \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/make_combinedSNPfile_YRI.sh


##### get human genetic map this is for all populations, not just YRI ###
wget ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/working/20110106_recombination_hotspots/HapmapII_GRCh37_RecombinationHotspots.tar.gz


##create recombination file for chr20 for YRI ####

awk '{print $2, $3}' genetic_map_GRCh37_chr20.txt | sed "1s/.*/position rate/" > human_rec_chr20.recfile






######## use angsd hack to run all mutts on caninehd


qsub -S /bin/bash -v indiv=D184 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/Skyler_out \
   -e /seq/vgb/linda/abba_baba/err/Skyler_err \
   -N Skyler \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_CanineHD_SNPs.sh

##run all mutts
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Tango_CanineHD_SNPs.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt


######### Get new Github verstion #######
#make sure to have https version

 git clone https://github.com/ANGSD/angsd.git Feb2017_angsd

 GCC-5.1

cp -R /seq/vgb/linda/bin/Feb2_angsd/htslib /seq/vgb/linda/bin/Feb2017_angsd/htslib


boettger@vert02:/seq/vgb/linda/bin/Feb2017_angsd/angsd $ make
HTSSRC not defined, assuming systemwide installation -lhts
g++ -c  -O3 -D__WITH_POOL__  abc.cpp
In file included from abc.h:7:0,
                 from abc.cpp:2:
argStruct.h:5:24: fatal error: htslib/hts.h: No such file or directory
compilation terminated.
make: *** [abc.o] Error 1



###### run wiht new angsd version
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CVjan_out \
   -e /seq/vgb/linda/abba_baba/err/CVjan_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/Feb2017_abbababa_Tango_CanineHD.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt





################## consolidate the abba baba results (last line of every file in directory ###########

cd /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13
tail -q -n1 * | grep -P "\tal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_alabama_coyote.txt
tail -q -n1 * | grep "cal_coy" > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_california_coyote.txt
tail -q -n1 * | grep "mex_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_mexican_wolf.txt
tail -q -n1 * | grep "yellow_wolf" > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_yellow_wolf.txt

# remove the middle columns
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_alabama_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_alabama_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_california_coyote.txt > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_california_coyote_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_mexican_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_mexican_wolf_e1.txt
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_yellow_wolf.txt > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_yellow_wolf_e1.txt

# sort by the Z score 
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_alabama_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_alabama_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_california_coyote_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_california_coyote_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_mexican_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_mexican_wolf_e2.txt
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_yellow_wolf_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/CanineHD_SNPs_Feb13/summary/purebred_yellow_wolf_e2.txt



### replace with names I want
sed -i -E "s/Comet_out.sorted.bam/Golden_Retriever/" *.txt
sed -i -E "s/Husky_out.sorted.bam/Siberian_Husky/" *.txt
sed -i -E "s/LE_1306_control.bam/Leonberger/" *.txt
sed -i -E "s/Woody_out.sorted.bam/CorgiB/" *.txt
sed -i -E "s/Mavis_out.sorted.bam/CorgiC/" *.txt
sed -i -E "s/PortugalVill_out.sorted.bam/Portugal_Vill/" *.txt
sed -i -E "s/ChineseVill_out.sorted.bam/Chinese_Vill/" *.txt
sed -i -E "s/DX09/mutt_Rudy/" *.txt
sed -i -E "s/DX01/mutt_Skeeter/" *.txt
sed -i -E "s/DX05/mutt_Rhoda/" *.txt
sed -i -E "s/DX07/mutt_Finch/" *.txt
sed -i -E "s/D183/mutt_Esme/" *.txt
sed -i -E "s/D198/mutt_Sandy/" *.txt
sed -i -E "s/DX04/mutt_Tui/" *.txt
sed -i -E "s/D132/mutt_Clarence/" *.txt
sed -i -E "s/DX08/mutt_Jaime/" *.txt
sed -i -E "s/D131/mutt_Hopper/" *.txt
sed -i -E "s/D182/mutt_Skyler/" *.txt
sed -i -E "s/D184/mutt_Lucky/" *.txt
sed -i -E "s/DX06/mutt_Lily/" *.txt
sed -i -E "s/DX11/mutt_Vera-Lynn/" *.txt
sed -i -E "s/DX02/mutt_Hunter/" *.txt
sed -i -E "s/D157/mutt_Beskow/" *.txt
sed -i -E "s/DX03/mutt_Reily/" *.txt
sed -i -E "s/D158/mutt_Kaylee/" *.txt
sed -i -E "s/DX10/mutt_Jack/" *.txt
sed -i -E "s/D181/mutt_Gus/" *.txt




#### get Darwin's Dogs dataset ready to merge with Boyko, Feb 14 2017
vcftools --vcf /seq/vgb/linda/mutts/Darwins_Dogs/clusterA_nodup_natsort_loc.vcf \
    --plink \
    --out /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPs
After filtering, kept 99 out of 99 Individuals
After filtering, kept 439201 out of a possible 439201 Sites

#edited chrs by hand, still has X and Y and Mit
change X and Y to 41 so will get pseduoautosomal region of X when we combine

perl -pe 's/^chrY\tchrY:/chr41\tchr41:/' /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPs.map > /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPsY.map 
perl -pe 's/^chrX\tchrX:/chr41\tchr41:/' /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPsY.map > /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPsX.map 

#get list of snps to keep
awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed.bim \
> /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt

##Keep only snps in ref panal,a nd exclude DD SNPs with below 85% genotyping per indiv or snp
plink --ped /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPs.ped \
 --map /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPsX.map \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
 --mind 0.15 \
 --geno 0.15 \
 --allow-extra-chr \
 --out /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt

152365 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim (before added 41 back in)
152898 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim (with chr41) --> confirmed 533 snps on chr41

awk '{print $2}' /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim > /seq/vgb/linda/mutts/Darwins_Dogs/DDfilt.snps

--extract: 156886 variants remaining.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 99 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.985018.
4521 variants removed due to missing genotype data (--geno).
152365 variants and 99 dogs pass filters and QC.


--extract: 156886 variants remaining. I'M MISSING ABOUT 2K SNPS THAT ARE IN THE BOYKO DATASET
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 99 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.985018.

######## I decided to keep all SNPs, I don't think it will hurt--- changed Elinor wanted --geno 0.15
4521 variants removed due to missing genotype data (--geno 0.15).
2386 variants removed due to missing genotype data (--geno 0.20).
443 variants removed due to missing genotype data (--geno 0.30)
119 variants removed due to missing genotype data (--geno 0.40)
66 variants removed due to missing genotype data (--geno 0.50).
38 variants removed due to missing genotype data (--geno 0.60).
152365 variants and 99 dogs pass filters and QC.
Total genotyping rate is 0.985018.
156886 variants and 99 dogs pass filters and QC.
Note: No phenotypes present.
--make-bed to /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bed
+ /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim +
/seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.fam ... done.
Segmentation fault (core dumped)
#........ not sure why there is seg fault... the files look okay


#Mutt SNPs
/seq/vgb/jmcclure/scratch/needed_snps


Count    Description
--------------------
180116   wanted list from needed_snps.txt

158751   in /seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf extracted to needed_snps.vcf
20262    retreived from reference via `samtools faidx` in reference.txt converted to reference.vcf
179013   from needed_snps.vcf and reference.vcf sorted into full.vcf
1103     not present in canfam3 (897 of these on chr 40+41)

### remove chr 39 (hemizygous chrx)

vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/scratch/needed_snps/full.vcf \
    --plink \
    --out /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_complete

#get just the SNPs in the reference dataset
plink --file /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_complete \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
 --mind 0.15 \
 --out /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt

178270 variants loaded from .bim file.
20 dogs (0 males, 0 females, 20 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.nosex .


0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 20 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.999747.
157041 variants and 20 dogs pass filters and QC.
########### I"m still missing 1200 SNPS!!!

#try merging to get bad flipps
/seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt

/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/MM_Boyko_mergetest-merge.missnp





############ Curating boyko set and merging with DD ######## also in file Boyko_fromJEss_Feb2017filter.sh
########### I put jess' files and her snps to flip here:/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array

cd /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array

#gunzip geno_data_pre_updated*
#screen -dr 471

use PLINK2
use Python-2.7

## STEP 1 flip snps
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --flip /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/snps_to_flip.pfizer.txt \
  --make-bed \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped


# 180117 variants loaded from .bim file.
# 4339 dogs (2167 males, 2164 females, 8 ambiguous) loaded from .fam.
# Ambiguous sex IDs written to
# /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.nosex
# .
# 138 phenotype values loaded from .fam.
# --flip: 89891 SNPs flipped, 2911 SNP IDs not present.



#### STEP 2 replace SNP names with locations
awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bim \
 > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim

#make matching files
cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bed

cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.fam \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.fam


 ## STEP 3 remove fixed snps
 #4339*2*.0001
 #4339*2*.0002 must see at least twice
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
  --dog \
  --make-bed \
  --maf 0.0002 \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var

# 180117 variants loaded from .bim file.
# 4339 dogs (2167 males, 2164 females, 8 ambiguous) loaded from .fam.
# Total genotyping rate is 0.970139.
# 16187 variants removed due to minor allele threshold(s)
# (--maf/--max-maf/--mac/--max-mac).
# 163930 variants and 4339 dogs pass filters and QC.


## STEP 3 remove low genotyped snps
# WOW - REMOVING THOSE WITH --GENO 0.1 REMOVES 14K VARIANTS!!
# plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var \
#   --dog \
#   --make-bed \
#   --geno 0.10 \
#   --allow-no-sex \
#   --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt
  
# 13870 variants removed due to missing genotype data (--geno).
# 150060 variants and 4339 dogs pass filters and QC.


## STEP 3 remove low genotyped snps, DECIDED ON 0.15 CUTTOFF INSTEAD
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var \
  --dog \
  --make-bed \
  --geno 0.15 \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt

Total genotyping rate is 0.9805.
723 variants removed due to missing genotype data (--geno).
163207 variants and 4339 dogs pass filters and QC.


## STEP 4 Remove the sex chromosomes and mitochondria - hwe has to come after
### get snps to remove (chr39 hemizygous and no location/mit)
grep "^0\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim > no_loc_snps.txt
grep "^39\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim >> no_loc_snps.txt
grep "^40\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim >> no_loc_snps.txt
awk '{print $2}' no_loc_snps.txt > rm_snps.txt

#wc -l rm_snps.txt
#4882 rm_snps.txt
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt \
  --dog \
  --allow-no-sex \
  --exclude rm_snps.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex

#Total genotyping rate is 0.980991.
#163432 variants and 4339 dogs pass filters and QC.


## STEP 5 look at HWE
# We want to remove SNPs where the MAF > 0.2 and the O/E ratio for hets is > 1 or < 0.25.
# We wrote a python script to do this: /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex

python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps

#wc -l /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps
#35 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps

awk '{print $1}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/bad_hardy_rmsnps.txt


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex \
  --dog \
  --allow-no-sex \
  --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array//bad_hardy_rmsnps.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmhardy

#--exclude: 158290 variants remaining.


## STEP 6 Individual genotype filtering 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmhardy \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind

# 41 dogs removed due to missing genotype data (--mind 0.15)
# 377 dogs removed due to missing genotype data (--mind 0.01) 


## STEP 7 breed nearest neighbor??? 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
 --dog \
 --neighbour 1 2 \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind_neighbor


#/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind_neighbor.nearest
#analyzed in R
#/Users/boettger/postdoc/mutts/Cornell_from_Jess/Boyko_loc_flipped_mind_neighbor.nearest
# two nearest neighbors were all of the same breed for each dog

#Verify that we still have 75 breeds with 12 dogs per breed in R - YES, we do

## STEP 7 downsample to only the 12 dogs per breed that we sampled
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
 --dog \
 --allow-no-sex \
 --make-bed \
 --keep /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/mydogs.12eachFeb13.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed

 #add "chr" to the chromosome names -- plink won't keep this
 sed -i -E "s/^/chr/" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed.bim 

#158290 variants loaded from .bim file.
#--keep: 900 dogs remaining.

## STEP 8 try to merge with Darwin's Dogs, note snps that have bad flipping

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --bmerge /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.fam \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest

Error: 12 variants with 3+ alleles present.


#about 6k markers in boyko that aren't in DD, should I impute them?
158290 markers loaded from
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed.bim.
152898 markers to be merged from
/seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim.

 
 #missnp file -- rm, not sure if wrong position or flipped wrong
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest-merge.missnp


## STEP 9 merge with Mendell's Mutts, note snps that have bad flipping

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --bmerge /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.fam \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/MM_Boyko_mergetest

cat /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/MM_Boyko_mergetest-merge.missnp \
  /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest-merge.missnp \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/rm_badflippers.txt

## STEP 10 Remove all SNPs that were in bad orientation or had >3 alleles
# in either dataset
##### remove the SNPs that were on the wrong strand in either DD or MM
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --dog \
 --allow-no-sex \
 --make-bed \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/rm_badflippers.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed

 awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed.bim \
 > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed.snplist

158151 variants and 900 dogs pass filters and QC.

158290 variants loaded from .bim file.
900 dogs (422 males, 477 females, 1 ambiguous) loaded from .fam.
--exclude: 158151 variants remaining.

#STEP 11 - make reference dataset (need maf because beagle won't accept fixed variants)
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed \
 --dog \
 --allow-no-sex \
 --keep /seq/vgb/linda/mutts/mendels_mutts/breed_lists/Feb_13/mydogs.6of12eachFeb13.txt \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF

# --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \


Total genotyping rate in remaining samples is 0.983743.
158151 variants and 450 dogs pass filters and QC.
157945 variants and 450 dogs pass filters and QC. (with maf filter)

#when use varinboth
157849 variants and 450 dogs pass filters and QC.


awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF.bim \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF.snps.txt


#STEP 12 - make file for help population phasing
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed \
 --dog \
 --allow-no-sex \
 --remove /seq/vgb/linda/mutts/mendels_mutts/breed_lists/Feb_13/mydogs.6of12eachFeb13.txt \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE

(--maf/--max-maf/--mac/--max-mac).
157849 variants and 450 dogs pass filters and QC.


 #--extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \


awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE.bim \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt


#STEP 13 - merge with DD, make vcf to phase NOT DOING THIS NOW WITH STITCH2
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE \
 --bmerge /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.fam \
 --dog \
 --allow-no-sex \
 --recode vcf-iid \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko6forPHASE_merge

157849 variants and 549 dogs pass filters and QC.
Total genotyping rate is 0.981422.

#STEP 13 - INSTEAD JUST GET RIGHT SNPS FOR DARWINS DOGS
plink --bfile /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --out /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtVAR


Total genotyping rate is 0.991098.
152028 variants and 99 dogs pass filters and QC.
Note: No phenotypes present.
--extract: 152561 variants remaining. WITH CHR41


############################## PHASE ################################

#make mapfile
awk '{print $1,$2,$3,$4}' \
  /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF.bim \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_merge_mapfile.txt


screen -dr 442

beagle=/seq/vgb/software/beagle/beagle.16Jun16.7e4.jar
use Java-1.8

java -Xmx8048m -jar $beagle \
    window=8000 \
    overlap=3999 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_merge_mapfile.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko6forPHASE_merge.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/PHASED_DD_Boyko6forPHASE_merge

#"Exception in thread "main" java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: ERROR: missing REF or ALT allele at 1:2625749"
#still has to be polymorhpic


screen -dr 606  

beagle=/seq/vgb/software/beagle/beagle.16Jun16.7e4.jar
use Java-1.8

java -Xmx8048m -jar $beagle \
    window=8000 \
    overlap=3999 \
    nthreads=12 \
    niterations=25 \
    map=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_merge_mapfile.txt \
    gt=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF.vcf \
    out=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/PHASED_Boyko_12perbreed_6forREF


################## THIS IS MY LIST OF SNPS USED IN THE DD ANCESTRY ASCERTAINMENT######
# I SHOULD USE THESE FOR THE SIMULATIONS
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt




############# Download European wolves and more breeds WGS #################

English springer Spaniel

use SRAtoolkit
cd /seq/vgb/linda/abba_baba/sra

screen -dr 471
## Get SAMN04196857 (English Springer Spaniel)
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR274/SRR2747509/SRR2747509.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR274/SRR2747508/SRR2747508.sra

screen -dr 390
#chinese gray wolf
SAMN03366711
SRR2149881
SRR2149880
SRR2149879
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149881/SRR2149881.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149880/SRR2149880.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149879/SRR2149879.sra


screen -dr 273
# Croatian gray wolf (European)
SAMN03366712
SRR2149873
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149873/SRR2149873.sra

screen -dr 40142
#Israeli Gray Wolf
SAMN03366710
SRR2149870
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR214/SRR2149870/SRR2149870.sra


#Boxer
SAMN02921305
SRR1518495

screen -dr 44244
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518495/SRR1518495.sra



############# align these individuals ###############

## above sra all started
qsub -S /bin/bash -v myfile=SRR1518495.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_X.sra \
   -e /seq/vgb/linda/abba_baba/err/err_X.sra \
   -N SRR1518495.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh

###### make names by breed/species
mypath=/seq/vgb/linda/abba_baba
mv $mypath/bams/SRR2149881.sorted.bam $mypath/bams/ChineseWolf_1.sorted.bam
mv $mypath/bams/SRR2149880.sorted.bam $mypath/bams/ChineseWolf_2.sorted.bam
mv $mypath/bams/SRR2149879.sorted.bam $mypath/bams/ChineseWolf_3.sorted.bam


mv $mypath/bams/SRR2747509.sorted.bam $mypath/bams/EngSprSpan_1.sorted.bam
mv $mypath/bams/SRR2747508.sorted.bam $mypath/bams/EngSprSpan_2.sorted.bam

mv $mypath/bams/SRR2149873.sorted.bam $mypath/bams/CroatWolf.sorted.bam

mv $mypath/bams/SRR2149870.sorted.bam $mypath/bams/IsraelWolf.sorted.bam

mv $mypath/bams/SRR1518495.sorted.bam $mypath/bams/Boxer.sorted.bam


###### combine and filter
qsub -S /bin/bash -v indv=EngSprSpan -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N EngSprSpan \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh

#troubleshooting EngSprSpan
indv=EngSprSpan
last existing file: EngSprSpan_mergedRG.bam

"To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  2: 1:186403699
        at htsjdk.samtools.CoordinateSortedPairInfoMap.ensureSequenceLoaded(CoordinateSortedPairInfoMap.java:133)
"

samtools view EngSprSpan_1.sorted.bam | grep "186403699" 
186403699       161     chr1    12789211        60      12S87M  chr11   69035494        0       TAAGTATTAACTTTCTTTTTCTTTCCCTATAATTTAGCAAAAACAAAGTTAAAACTTAAGTTTCATGAGCAATTACCTTTCAACCATGACATGTTGTTT   (8;32@)2.1..@@@####################################################################################   NM:i:2  MD:Z:40T5T40    AS:i:77 XS:i:21

samtools view EngSprSpan_2.sorted.bam | grep "186403699"
186403699       145     chr1    23338685        24      94M6S   chr11   43808597        0       GAATGGAGCCTGCTTCTCCCTCTGCCTGTGTCTCTGCCTCTCTCTTTCTCTGTGTCTCTCGTGACTAAATAAATAAAATATTTTTAAAAAATAATTAGTG  EDC@@B@BBCC??BBB=DDDDDDDDEEEEFFFFHHHJIEIIJJJIJIHGFIJJJJJJJJJJJJJJJJJJJJJIGJJJJJJJJJJJJJHHHHHFFFFFCCC  NM:i:3  MD:Z:1C58A3A29  AS:i:82 XS:i:72


qsub -S /bin/bash -v myfile=SRR2747508.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR2747508.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR2747508.sra \
   -N SRR2747508.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed_EngSpSpan.sh


###### combine and filter
qsub -S /bin/bash -v indv=EngSprSpan -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N EngSprSpan \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh

#still a problem --- quits after read group step
#screen -dr 25  or 35?
WARNING 2017-03-21 16:24:29     AbstractOpticalDuplicateFinderCommandLineProgram        Default READ_NAME_REGEX '[a-zA-Z0-9]+:[0-9]:([0-9]+):([0-9]+):([0-9]+).*' did not match read name '129960123'.  You may need to specify a READ_NAME_REGEX in order to correctly identify optical duplicates.  Note that this message will not be emitted again even if other read names do not match the regex.


### still problem ###
[Tue Mar 21 16:48:50 EDT 2017] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 25.53 minutes.
Runtime.totalMemory()=16983785472
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  2: 1:186403699



######### align they greyhounds and rottweilers from ginger #####

/seq/vgb/rawData/dog/dog_wgs/uppsala_fastqs/rottweiler
/seq/vgb/rawData/dog/dog_wgs/uppsala_fastqs/greyhound

## test with one gziped rottweiler
qsub -S /bin/bash -v breed=rottweiler,sample=24713_GTCCGC_L001 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_24713_GTCCGC_L001 \
   -e /seq/vgb/linda/abba_baba/err/err_24713_GTCCGC_L001 \
   -N GTCCGC_L001 \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/align_uppsala_dogs.sh
### waiting for other rottweilers to gzip

###### greyhounds #########

qsub -S /bin/bash -v breed=greyhound,sample=15215_GAGTGG_L004 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out \
   -e /seq/vgb/linda/abba_baba/err/err \
   -N G15215_GAGTGG_L004 \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/align_uppsala_dogs.sh


running: 15012_ATCACG, G15215_GAGTGG

rott gzip *.fastq

## rename greyhound
mv $mypath/bams/15012_ATCACG_L005.sorted.bam $mypath/bams/Greyhound_1.sorted.bam
mv $mypath/bams/15012_ATCACG_L001.sorted.bam $mypath/bams/Greyhound_2.sorted.bam

qsub -S /bin/bash -v indv=Greyhound -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltgreyhound \
   -N Greyhound \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


#rename rottweiler

--- when it's done aligning

mv /seq/vgb/linda/abba_baba/bams/24713_GTCCGC_L001.sorted.bam /seq/vgb/linda/abba_baba/bams/Rottweiler_1.sorted.bam
mv /seq/vgb/linda/abba_baba/bams/24713_GTCCGC_L006.sorted.bam /seq/vgb/linda/abba_baba/bams/Rottweiler_2.sorted.bam


qsub -S /bin/bash -v indv=Rottweiler -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Greyhound \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


#### chinese shar pei
ERR031016
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/ERR/ERR031/ERR031016/ERR031016.sra

qsub -S /bin/bash -v myfile=ERR031016.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_ERR031016.sra \
   -e /seq/vgb/linda/abba_baba/err/err_ERR031016.sra \
   -N ERR031016.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


####### Labradores for WGS
https://www.ncbi.nlm.nih.gov/sra/SRX1360665[accn]

qsub -S /bin/bash -v myfile=SRR5161902.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_X.sra \
   -e /seq/vgb/linda/abba_baba/err/err_X.sra \
   -N SRR5161902.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


#Labrador Retriever
SAMN03580399
SRR2016158
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR201/SRR2016158/SRR2016158.sra

mv /seq/vgb/linda/abba_baba/bams/SRR2016158.sorted.bam /seq/vgb/linda/abba_baba/bams/Labrador.sorted.bam


qsub -S /bin/bash -v indv=Labrador -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltgreyhound \
   -N Labrador \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


## german shepherd
SAMN03580392
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR201/SRR2016144/SRR2016144.sra
SRR2016144

mv /seq/vgb/linda/abba_baba/bams/SRR2016144.sorted.bam /seq/vgb/linda/abba_baba/bams/German_Shepherd.sorted.bam



qsub -S /bin/bash -v indv=German_Shepherd -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N German_Shepherd \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh



#Beagle
SAMN03801644
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2094385/SRR2094385.sra
SRR2094385

mv /seq/vgb/linda/abba_baba/bams/SRR2094385.sorted.bam /seq/vgb/linda/abba_baba/bams/Beagle.sorted.bam

qsub -S /bin/bash -v indv=Beagle -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Beagle \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


#sheltie
SAMN03801689
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR209/SRR2095504/SRR2095504.sra
SRR2095504


mv /seq/vgb/linda/abba_baba/bams/SRR2095504.sorted.bam /seq/vgb/linda/abba_baba/bams/Sheltie.sorted.bam

qsub -S /bin/bash -v indv=Sheltie -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Sheltie \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


#Dalmatian
SAMN06214558
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR516/SRR5161902/SRR5161902.sra
SRR5161902

mv /seq/vgb/linda/abba_baba/bams/SRR5161902.sorted.bam /seq/vgb/linda/abba_baba/bams/Dalmatian.sorted.bam

qsub -S /bin/bash -v indv=Dalmatian -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Dalmatian \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh






##### Shih Tzu -- can't find

## staffordhsire bull terrier -- can't find


###### more wolves & coyotes!!!

qsub -S /bin/bash -v myfile=SRR4029416.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_X.sra \
   -e /seq/vgb/linda/abba_baba/err/err_X.sra \
   -N SRR4029416.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh

#AlaskanWolf -- problem !!!
SAMN05439956 
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR396/SRR3960582/SRR3960582.sra
SRR3960582


mv /seq/vgb/linda/abba_baba/bams/SRR3960582.sorted.bam /seq/vgb/linda/abba_baba/bams/Alaska_wolf.sorted.bam

qsub -S /bin/bash -v indv=Alaska_wolf -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Alaska_wolf \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


try agigning again
qsub -S /bin/bash -v myfile=SRR3960582.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_X.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR3960582.sra \
   -N SRR3960582.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh





# Algonquin wolf 13470 SE -- problem !!!
SAMN05791668
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR427/SRR4274944/SRR4274944.sra
SRR4274944

try aligning again:

qsub -S /bin/bash -v myfile=SRR4274944.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_X.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR4274944.sra \
   -N SRR4274944.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh



mv /seq/vgb/linda/abba_baba/bams/SRR4274944.sorted.bam /seq/vgb/linda/abba_baba/bams/Algon_wolf.sorted.bam

qsub -S /bin/bash -v indv=Algon_wolf -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltAlgon_wolf \
   -N Algon_wolf \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh




#Great lakes wolf from Minnesota
SAMN02921310
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR357/SRR3574640/SRR3574640.sra
SRR3574640


mv /seq/vgb/linda/abba_baba/bams/SRR3574640.sorted.bam /seq/vgb/linda/abba_baba/bams/Minn_wolf.sorted.bam

qsub -S /bin/bash -v indv=Minn_wolf -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Minn_wolf \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh




#QuebecWolf (called canis latrans on SRA, probably typo)
SAMN05736724
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR419/SRR4191781/SRR4191781.sra
SRR4191781

mv /seq/vgb/linda/abba_baba/bams/SRR4191781.sorted.bam /seq/vgb/linda/abba_baba/bams/Quebec_wolf.sorted.bam

qsub -S /bin/bash -v indv=Quebec_wolf -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Quebec_wolf \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh


## Redwolf -- captive breeding program
SAMN02921317
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518526/SRR1518526.sra
SRR1518526

mv /seq/vgb/linda/abba_baba/bams/SRR1518526.sorted.bam /seq/vgb/linda/abba_baba/bams/Redwolf.sorted.bam

qsub -S /bin/bash -v indv=Redwolf -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Redwolf \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh



### coyotes
#Canis latrans Coyote Midwest-mwc_1
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518489/SRR1518489.sra
SAMN02921303

mv /seq/vgb/linda/abba_baba/bams/SRR1518489.sorted.bam /seq/vgb/linda/abba_baba/bams/Midwest_coy.sorted.bam



qsub -S /bin/bash -v indv=Midwest_coy -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Midwest_coy \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh




#Florida Coyote
SAMN05439957
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR402/SRR4029416/SRR4029416.sra
SRR4029416



mv /seq/vgb/linda/abba_baba/bams/SRR4029416.sorted.bam /seq/vgb/linda/abba_baba/bams/Florida_coy.sorted.bam



qsub -S /bin/bash -v indv=Florida_coy -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfilt \
   -N Florida_coy \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh












##### for read depth -- this ran for weeks and projuced a 100 GB file, then killed
java -jar /home/unix/boettger/bin/GenomeAnalysisTK-1.6-7-g2be5704/GenomeAnalysisTK.jar 
  -T DepthOfCoverage    -R /seq/references/Canis_lupus_familiaris_assembly3/v1/Canis_lupus_familiaris_assembly3.fa
ta    -o /seq/vgb/linda/mutts/mendels_mutts/mutt_coverage    -I /seq/vgb/linda/mutts/mendels_mutts/mutt_bams.listast



######## Get mitochondrial DNA for 21 mutts ######
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/chrM.vcf \
   --keep /seq/vgb/linda/mutts/My_21_mutts.txt \
   --recode \
   --out /seq/vgb/linda/mutts/mendels_mutts/mito_genome/Mutts_mito





########### Start prepping files for Treemix ######
#1. Identify the bases that are variable in any of the canids or accross canids

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/majmin \
   -e /seq/vgb/linda/abba_baba/err/majmin \
   -N MajMin \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/scripts/MajorMinor_for_TreeMix.sh



qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/majmin \
   -e /seq/vgb/linda/abba_baba/err/majmin35 \
   -N chr35MajMin \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/scripts/MajorMinor_for_TreeMix_chr35.sh


#curate breeds that were phased
qsub -S /bin/bash -q vert -v thispop=yorkshire_terrier \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N yorkshire_terrier \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
/seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_Feb13.sh

## separate the breeds into files
while read c; do
qsub -S /bin/bash -q vert -v thispop=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N ${c} \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
/seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_Feb13.sh
done < /seq/vgb/linda/mutts/breed_tpeds/my_75_breeds.txt



#curate DD that were phased
qsub -S /bin/bash -q vert -v thispop=darwins_dogs \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N darwins_dogs \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
/seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_mutt_curation_Feb13.sh




screen -dr 298

## fixphase to alphanumeric sorting
# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' $datapath/Feb13_12perbreed_phase_fixed.tped)" > $datapath/Feb13_12perbreed_phase_fixed.tped


supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds/breed_tpeds_Feb13
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/Feb13_12perbreed_phasefixed \
    --window=80 \
    $datapath/bichon_frise.tped \
    $datapath/bernese_mountain_dog.tped \
    $datapath/boxer.tped \
    $datapath/boston_terrier.tped \
    $datapath/borzoi.tped \
    $datapath/border_terrier.tped \
    $datapath/border_collie.tped \
    $datapath/belgian_tervuren.tped \
    $datapath/beagle.tped \
    $datapath/basset_hound.tped \
    $datapath/basenji.tped \
    $datapath/australian_shepherd.tped \
    $datapath/akita.tped \
    $datapath/alaskan_malamute.tped \
    $datapath/brittany.tped \
    $datapath/leonberger.tped \
    $datapath/jack_russell_terrier.tped \
    $datapath/havanese.tped \
    $datapath/greyhound.tped \
    $datapath/fox_terrier_wire.tped \
    $datapath/great_dane.tped \
    $datapath/gordon_setter.tped \
    $datapath/golden_retriever.tped \
    $datapath/german_shorthaired_pointer.tped \
    $datapath/german_shepherd_dog.tped \
    $datapath/english_springer_spaniel.tped \
    $datapath/english_cocker_spaniel.tped \
    $datapath/doberman_pinscher.tped \
    $datapath/dalmatian.tped \
    $datapath/cocker_spaniel.tped \
    $datapath/chinese_shar-pei.tped \
    $datapath/chinese_crested.tped \
    $datapath/chesapeake_bay_retriever.tped \
    $datapath/cavalier_king_charles_spaniel.tped \
    $datapath/cairn_terrier.tped \
    $datapath/bulldog_english.tped \
    $datapath/bull_terrier.tped \
    $datapath/labrador_retriever.tped \
    $datapath/irish_wolfhound.tped \
    $datapath/finnish_spitz.tped \
    $datapath/english_setter.tped \
    $datapath/dachshund.tped \
    $datapath/chihuahua.tped \
    $datapath/bulldog_french.tped \
    $datapath/west_highland_white_terrier.tped \
    $datapath/tibetan_spaniel.tped \
    $datapath/staffordshire_bull_terrier.tped \
    $datapath/scottish_terrier.tped \
    $datapath/schipperke.tped \
    $datapath/yorkshire_terrier.tped \
    $datapath/wirehaired_pointing_griffon.tped \
    $datapath/weimaraner.tped \
    $datapath/vizsla.tped \
    $datapath/siberian_husky.tped \
    $datapath/saint_bernard.tped \
    $datapath/pug.tped \
    $datapath/shih_tzu.tped \
    $datapath/shetland_sheepdog.tped \
    $datapath/poodle_toy.tped \
    $datapath/pekingese.tped \
    $datapath/papillon.tped \
    $datapath/newfoundland.tped \
    $datapath/miniature_pinscher.tped \
    $datapath/maltese.tped \
    $datapath/rottweiler.tped \
    $datapath/poodle.tped \
    $datapath/pomeranian.tped \
    $datapath/pembroke_welsh_corgi.tped \
    $datapath/nova_scotia_duck_tolling_retriever.tped \
    $datapath/norwegian_elkhound.tped \
    $datapath/norfolk_terrier.tped \
    $datapath/miniature_schnauzer.tped \
    $datapath/mastiff.tped \
    $datapath/lhasa_apso.tped \
    $datapath/airedale_terrier.tped \
    $datapath/Feb13_12perbreed_phase_fixed.tped


ERROR: No SNPs found in specified chromosome



	
  

screen -dr 606
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds/breed_tpeds_Feb13
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/Feb13_12perbreed \
    --window=80 \
    $datapath/bichon_frise.tped \
    $datapath/bernese_mountain_dog.tped \
    $datapath/boxer.tped \
    $datapath/boston_terrier.tped \
    $datapath/borzoi.tped \
    $datapath/border_terrier.tped \
    $datapath/border_collie.tped \
    $datapath/belgian_tervuren.tped \
    $datapath/beagle.tped \
    $datapath/basset_hound.tped \
    $datapath/basenji.tped \
    $datapath/australian_shepherd.tped \
    $datapath/akita.tped \
    $datapath/alaskan_malamute.tped \
    $datapath/brittany.tped \
    $datapath/leonberger.tped \
    $datapath/jack_russell_terrier.tped \
    $datapath/havanese.tped \
    $datapath/greyhound.tped \
    $datapath/fox_terrier_wire.tped \
    $datapath/great_dane.tped \
    $datapath/gordon_setter.tped \
    $datapath/golden_retriever.tped \
    $datapath/german_shorthaired_pointer.tped \
    $datapath/german_shepherd_dog.tped \
    $datapath/english_springer_spaniel.tped \
    $datapath/english_cocker_spaniel.tped \
    $datapath/doberman_pinscher.tped \
    $datapath/dalmatian.tped \
    $datapath/cocker_spaniel.tped \
    $datapath/chinese_shar-pei.tped \
    $datapath/chinese_crested.tped \
    $datapath/chesapeake_bay_retriever.tped \
    $datapath/cavalier_king_charles_spaniel.tped \
    $datapath/cairn_terrier.tped \
    $datapath/bulldog_english.tped \
    $datapath/bull_terrier.tped \
    $datapath/labrador_retriever.tped \
    $datapath/irish_wolfhound.tped \
    $datapath/finnish_spitz.tped \
    $datapath/english_setter.tped \
    $datapath/dachshund.tped \
    $datapath/chihuahua.tped \
    $datapath/bulldog_french.tped \
    $datapath/west_highland_white_terrier.tped \
    $datapath/tibetan_spaniel.tped \
    $datapath/staffordshire_bull_terrier.tped \
    $datapath/scottish_terrier.tped \
    $datapath/schipperke.tped \
    $datapath/yorkshire_terrier.tped \
    $datapath/wirehaired_pointing_griffon.tped \
    $datapath/weimaraner.tped \
    $datapath/vizsla.tped \
    $datapath/siberian_husky.tped \
    $datapath/saint_bernard.tped \
    $datapath/pug.tped \
    $datapath/shih_tzu.tped \
    $datapath/shetland_sheepdog.tped \
    $datapath/poodle_toy.tped \
    $datapath/pekingese.tped \
    $datapath/papillon.tped \
    $datapath/newfoundland.tped \
    $datapath/miniature_pinscher.tped \
    $datapath/maltese.tped \
    $datapath/rottweiler.tped \
    $datapath/poodle.tped \
    $datapath/pomeranian.tped \
    $datapath/pembroke_welsh_corgi.tped \
    $datapath/nova_scotia_duck_tolling_retriever.tped \
    $datapath/norwegian_elkhound.tped \
    $datapath/norfolk_terrier.tped \
    $datapath/miniature_schnauzer.tped \
    $datapath/mastiff.tped \
    $datapath/lhasa_apso.tped \
    $datapath/airedale_terrier.tped \
    $datapath/darwins_dogs.tped





































#dog food allergy literature
http://www.sciencedirect.com/science/article/pii/S0091674902014768
https://www.ncbi.nlm.nih.gov/pubmed/12730012

http://europepmc.org/abstract/med/8407485
"The primary clinical sign of allergy detected and evaluated in all dogs was persistent and nonseasonally pruritic skin disease."

Cutaneous Adverse Reaction to Food (CARF) in dogs
https://www.zoetisus.com/Conditions/Pages/Dermatology/food-allergy-canine.aspx





######## percent of each breed SNPs matching coyote ##########

a550771-4306235-112317-918_F07.CEL	Coyote

merge with DD
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed \
 --bmerge /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.fam \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_all12_merge

#get hamming distance
--distance 


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_all12_merge \
 --dog \
 --allow-no-sex \
 --distance square \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist

#grep for line number

grep -n 'a550771-4306235-112317-918_F07.CEL' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist.dist.id

#72:a550771-4306235-112317-918_F07.CEL   a550771-4306235-112317-918_F07.CEL


awk ' NR == 72 ' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist.dist > coyote_vs_all.dist



## other coyote 

grep -n 'a550771-4306235-112317-918_F08.CEL' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist.dist.id

73:a550771-4306235-112317-918_F08.CEL	a550771-4306235-112317-918_F08.CEL

awk ' NR == 73 ' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist.dist > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/coyote2_vs_all.dist




####### Installing treemix
For treemix input:
I think I can generate randomly drawn read data using this:
http://www.popgen.dk/angsd/index.php/Haploid_calling


cd /seq/vgb/linda/bin/treemix-1.13
#reuse GCC-5.2
reuse .boost-build-2.0
with_boost_libdir=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/lib
./configure --with-boost-libdir /broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/lib


./configure --with-boost-libdir /broad/software/free/Linux/redhat_5_x86_64/pkgs/gcc_4.9.1/bin/

checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-g++... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-c++... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-gpp... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-aCC... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-CC... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-cxx... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-cc++... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-cl.exe... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-FCC... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-KCC... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-RCC... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-xlC_r... no
checking for /broad/software/build/source/libraries/boost/boost_1_52_0/boost-xlC... no

configure: WARNING: you should use --build, --host, --target
configure: WARNING: invalid host type: /broad/software/free/Linux/redhat_5_x86_64/pkgs/gcc_4.9.1/bin/


"If no path to the installed boost library is given the macro searchs
#   under /usr, /usr/local, /opt and /opt/local and evaluates the
#   $BOOST_ROOT environment variable. "


"./configure --with-boost-libdir=/usr/lib/x86_64-linux-gnu" online

cd /seq/vgb/linda/bin/treemix-1.13
#./configure --with-boost-libdir=/broad/software/free/Linux/redhat_5_x86_64/pkgs/gcc_4.9.1/x86_64-unknown-linux-gnu
./configure --with-boost-libdir=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/lib


########### OMFG!!!! THIS worked!!!!!!! ###########
./configure --with-boost=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/

 warning: variadic templates only available with -std=c++11 or -std=gnu++11
warning: variadic templates only available with -std=c++11 or -std=gnu++11



.boost-build-2.0 - .boost-build

##### LOCATION OF BROAD BOOST LIBRARIES 
/broad/software/build/source/libraries/boost/boost_1_52_0/boost 
/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0

# add boost to path --- none of these worked -- it still can't find boost ... :(
PATH=$PATH:/seq/vgb/linda/bin/boost_1_58_0/boost
BOOST_ROOT=/seq/vgb/linda/bin/boost_1_58_0/
BOOST_ROOT=/seq/vgb/linda/bin/boost_1_58_0/boost
BOOST_ROOT=/broad/software/build/source/libraries/boost/boost_1_52_0
BOOST_ROOT=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0
BOOST_ROOT=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/include/boost
BOOST_ROOT=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0/include
PATH=$PATH:/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0


"#define BOOST_LIB_VERSION "1_58""

checking for boostlib >= 1.42... configure: We could not detect the boost libraries (version 1.42 or higher). If you have a staged boost library (still not installed) please specify $BOOST_ROOT in your environment and do not give a PATH to --with-boost option.  If you are sure you have boost installed, then check your version number looking in <boost/version.hpp>. See http://randspringer.de/boost for more documentation.

Tried adding BOOST_ROOT=/seq/vgb/linda/bin/boost_1_58_0/ to the configure file, but now ./configure returns "Permission denied"




INSTALL_DIRECTORY=/seq/vgb/linda/bin/TreeMix
make install INSTALL_ROOT=$INSTALL_DIRECTORY  -> still trying to install in /usr/local/bin/

######## OMFG this worked and installed int eh correct location!!!!!!!!!!!!!!!!
./configure --prefix=/seq/vgb/linda/bin/TreeMix --with-boost=/broad/software/free/Linux/redhat_5_x86_64/pkgs/boost_1.52.0








##################### SHAPEIT phasing ####################### 
#Once you GWAS dataset is correctly aligned to the reference panel, we strongly recommend to phase each chromosome in a single run instead #of making chunks. It makes the procedure much easier and increase downstream imputation quality. To do so, use the following SHAPEIT #command line:


shapeit -B gwas \
        -M genetic_map.txt \
        -O gwas.phased



shapeit --input-bed gwas.bed gwas.bim gwas.fam \
        --input-map genetic_map.txt \
        --output-max gwas.phased.haps gwas.phased.sample \
        --thread 8

#wget https://mathgen.stats.ox.ac.uk/genetics_software/shapeit/shapeit.v2.r837.GLIBCv2.12.Linux.static.tgz

/seq/vgb/linda/bin/shapeit/bin/shapeit




######### start pre-phasing reference samples to phase ref/DD
/seq/vgb/linda/bin/shapeit/bin/shapeit --input-bed gwas.bed gwas.bim gwas.fam \
        --input-map genetic_map.txt \
        --output-max gwas.phased.haps gwas.phased.sample \
        --thread 8

#data from step 12 above
#set vars
phase_dat='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE'
my_map='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_merge_mapfile.txt'
shapeit='/seq/vgb/linda/bin/shapeit/bin/shapeit'
phase_dat_chr='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forPHASE'

$shapeit --input-bed $phase_dat'.bed' $phase_dat'.bim' $phase_dat'.fam' \
        --input-map $my_map \
        --output-max $phase_dat'.phased.haps' $phase_dat'.phased.sample' \
        --thread 8

#ERROR: Wrong ordering in physical positions curr_pos=30687 prev_pos=122670980
#this is the chr1/chr2 boundary

#why doesn't this work????
for chr in $($phase_dat'.bim'); do
	cat $chr
done
#cut -d , -f1 file | sort | uniq


autosomes='/seq/vgb/linda/mutts/dog_autosomes.txt'
use PLINK2

### first split by chr
for chr in `cat`; do 
plink --bfile $phase_dat \
           --chr $chr \
           --make-bed \
	   --dog \
           --out $phase_dat_chr$chr ;
done < $autosomes



#phase one chr to test for the phasing set
my_map='/seq/vgb/linda/mutts/genetic_maps/genetic_map_chr'$chr'_.txt'
phase_dat='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forPHASE'
chr='chr30'
$shapeit --input-bed $phase_dat$chr'.bed' $phase_dat$chr'.bim' $phase_dat$chr'.fam' \
        --input-map $my_map \
        --output-max $phase_dat$chr'.phased.haps' $phase_dat$chr'.phased.sample' \
        --effective-size 2000 \
        --thread 8

#convert to IMPUTE2 format --DON'T ACTUALLY NEED TO DO THIS!!!
$shapeit -convert \
        --input-haps $phase_dat$chr'.phased' \
        --output-ref $phase_dat$chr'phased.hap' $phase_dat$chr'phased.leg' $phase_dat$chr'.phased.sam'



$impute2 \
 -use_prephased_g \
 -m $my_map \
 -allow_large_regions \
 -Ne 2000 \
 -int 26102 40196606 \ 
 -o $phase_dat$chr'.impute2'\
 -phase



###################Oxford GEN/SAMPLE format:########## this is unphased- shouldn't use this format!!!!
The file format is described here. Use as follows the --input-gen or -G options to specify unphased genotypes in this format:
shapeit --input-gen gwas.gen


$shapeit -convert \
  --input-gen file.gen file.sample \
  --output-vcf file.vcf


# Impute with impute2
$impute2 -use_prephased_g \
        -known_haps_g $phase_dat$chr'.phased.haps' \
        -m $my_map \
        -allow_large_regions \
 	-Ne 2000 \
	-int 26102 40196606 \
	-phase \
 	-o $phase_dat$chr'.impute2'

#need to convert this to VCF and then to tped!!!
tried bcftools (didn't work), but likely expecting unphased format
tried gtool, but it goes through plink which scrambles phase
try Mega2??





If you want to print the merged, phased panel in IMPUTE2 reference format (one -l file and one -h file), you should add the -merge_ref_panels_output_ref flag.
If you want to print the merged, unphased panel in IMPUTE2 genotype format (one -g file), you should add the -merge_ref_panels_output_gen flag.


#make new sample file
cp $phase_dat$chr'.phased.sam' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forPHASEchr30.impute2.sample

#Convert to plink -- don't convert to plink - it scrambles phase!!
#gtool=/seq/vgb/linda/bin/GTOOL/gtool
#$gtool \
#  -G \
#  --g $phase_dat$chr'.impute2.haps' \
#  --s $phase_dat$chr'.impute2.sample' \
#  --ped $phase_dat$chr'.impute2.ped' \
#  --map $phase_dat$chr'.impute2.map' \
#  --log /dev/null

#Instead go VCF to tped
gen-file,sample-file
#gensample2vcf requires v1.3
#use Bcftools
#requires special snp name: Could not parse REF in CHROM:POS_REF_ALT id: chr30:26102 26102 
#edit snp name
awk '{$1 = "chr"$1; $2=$2"_"$4"_"$5; print}' Boyko_12perbreed_6forPHASEchr30.impute2.haps > Boyko_12perbreed_6forPHASEchr30.impute2edit.haps


awk '{$1 = $2; print}' Boyko_12perbreed_6forPHASEchr30.impute2edit.haps > Boyko_12perbreed_6forPHASEchr30.impute2edit2.haps
#edit sample info
awk '{print $1, $2, $3}' Boyko_12perbreed_6forPHASEchr30.impute2.sample > Boyko_12perbreed_6forPHASEchr30.impute2edit.sample

######### don't do this either!!! crashes, plus gen/sample format is unphased !!!!!
/seq/vgb/linda/bin/bcftools-1.3.1/bcftools convert \
  --gensample2vcf Boyko_12perbreed_6forPHASEchr30.impute2edit2.haps,Boyko_12perbreed_6forPHASEchr30.impute2edit.sample \
  -o $phase_dat$chr'.impute2.vcf'
"Could not parse: 0 0 1"

screen -dr 262
#re-introduce chromosome and genetic map


#pre-phase DD same chr
phase_dat='/seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtVAR'
phase_dat_chr='/seq/vgb/linda/mutts/Darwins_Dogs/by_chr/Darwins_Dogs_BoykoSNPs_filtVAR'

### first split by chr
for chr in `cat`; do 
plink --bfile $phase_dat \
           --chr $chr \
           --make-bed \
	   --dog \
           --out $phase_dat_chr$chr ;
done < $autosomes

## then phase
chr='chr30'
my_map='/seq/vgb/linda/mutts/genetic_maps/genetic_map_chr'$chr'_.txt'
prephased='/seq/vgb/linda/mutts/Darwins_Dogs/by_chr/prephased/Darwins_Dogs_BoykoSNPs_filtVAR'
$shapeit --input-bed $phase_dat_chr$chr'.bed' $phase_dat_chr$chr'.bim' $phase_dat_chr$chr'.fam' \
        --input-map $my_map \
        --output-max $prephased$chr'.phased.haps' $prephased$chr'.phased.sample' \
        --effective-size 2000 \
        --thread 8




#####make wgs genetic map

awk '{print FILENAME, $0}' gen* >  /seq/vgb/linda/mutts/genetic_map_wg/gen_map_canfam3.1




# I wonder what this means?
#Pruning graphs [450/450]
#  * 450 graphs / 42944 segments / ~30 SNPs per segment / 773790 transitions
#seems like it may not phase it all at once



#get Mito bams for Kelsey
this_mutt=D157

use Samtools
mitoDir=/seq/vgb/linda/mutts/mendels_mutts/mito_genome/bams
tmpdir=/seq/vgb/linda/mutts/mendels_mutts/mito_genome/tmp
inDir=/seq/vgb/linda/mutts/mendels_mutts/orig_bams


samtools view -b $inDir/$this_mutt.bam chrM > $mitoDir/$this_mutt'_chrM.bam'
samtools sort -T $tmpdir/$this_mutt.sorted -o $mitoDir/$this_mutt'_chrM.sorted.bam' $mitoDir/$this_mutt'_chrM.bam'
samtools index $mitoDir/$this_mutt'_chrM.sorted.bam'


while read c; do
qsub -S /bin/bash -v this_mutt=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/CV_out \
   -e /seq/vgb/linda/abba_baba/err/CV_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/mutts/mendels_mutts/mito_genome/get_mito.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_ids.txt





############## SHAPEIT PHASING ###########

get chr41 (previously left off)

autosomes='/seq/vgb/linda/mutts/dog_autosomes.txt'
use PLINK2

boettger@vert02:/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed $ wc -l Boyko_12perbreed_6forREF.bim
157849 Boyko_12perbreed_6forREF.bim
boettger@vert02:/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed $ wc -l Boyko_12perbreed_6forPHASE.bim
157849 Boyko_12perbreed_6forPHASE.bim


phase_dat='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE'
my_map='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko_merge_mapfile.txt'
shapeit='/seq/vgb/linda/bin/shapeit/bin/shapeit'
phase_dat_chr='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forPHASE'

phase_dat='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF'
phase_dat_chr='/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forREF'
chr=chr41
for chr in `cat`; do 
plink --bfile $phase_dat \
           --chr $chr \
           --make-bed \
	     --dog \
           --out $phase_dat_chr'_'$chr ;
done < $autosomes



qsub -S /bin/bash -v chr=chr41 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out41 \
   -e /seq/vgb/linda/mutts/err/mutt_err41 \
   -N chr41 \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_prep_ref.sh


Ddogs=/seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtVAR
DD_path=/seq/vgb/linda/mutts/Darwins_Dogs/by_chr
Q_SM_input=$DD_path/SM_input
autosomes='/seq/vgb/linda/mutts/dog_autosomes.txt'
chr='chr41'

plink --bfile $Ddogs \
           --chr $chr \
           --make-bed \
	  --dog \
           --out $DD_path/DDfilt_$chr



qsub -S /bin/bash -v chr=chr37 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out41 \
   -e /seq/vgb/linda/mutts/err/mutt_err41 \
   -N chr37 \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_align_to_ref.sh




####### prep reference panel for phasing
#was using default phasing, plus popsize of 200, changing it to 2000
#back to 200, 50 iterations, window of 5 mb
while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_prep_ref.sh
done < /seq/vgb/linda/mutts/dog_autosomes.txt

####### Darwins Dogs: align all chromosomes to ref #########
while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c}_DD \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_align_to_ref_DD.sh
done < /seq/vgb/linda/mutts/dog_autosomes.txt

####### Breed REF: align all chromosomes to ref #########
while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c}_REF \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_align_to_ref.sh
done < /seq/vgb/linda/mutts/dog_autosomes.txt


qsub -S /bin/bash -v chr=chr41 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_errchr41 \
   -N chr41_REF \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/SHAPEIT_align_to_ref.sh


#why are they different?
Reading SNPs in [/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forPHASEchr37.phased.leg]
  * 2245 reference panel sites included
Reading site list in [/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/Boyko_12perbreed_6forREF_chr37.bim]
  * 2323 sites included

2323 in both bims, the PHASE dataset is missing some variants??

#looks like it happened when separating the chromosomes??
wc -l Boyko_12perbreed_6forPHASEchr37.bim
2245 Boyko_12perbreed_6forPHASEchr37.bim


#concatinate VCFs
use VCFtools
#vcf-concat A.vcf.gz B.vcf.gz C.vcf.gz | gzip -c > out.vcf.gz


cd /seq/vgb/linda/mutts/Darwins_Dogs/by_chr/phased
vcf-concat DDfilt_chr1.phased.with.ref.vcf DDfilt_chr2.phased.with.ref.vcf DDfilt_chr3.phased.with.ref.vcf DDfilt_chr4.phased.with.ref.vcf DDfilt_chr5.phased.with.ref.vcf DDfilt_chr6.phased.with.ref.vcf DDfilt_chr7.phased.with.ref.vcf DDfilt_chr8.phased.with.ref.vcf DDfilt_chr9.phased.with.ref.vcf DDfilt_chr10.phased.with.ref.vcf DDfilt_chr11.phased.with.ref.vcf DDfilt_chr12.phased.with.ref.vcf DDfilt_chr13.phased.with.ref.vcf DDfilt_chr14.phased.with.ref.vcf DDfilt_chr15.phased.with.ref.vcf DDfilt_chr16.phased.with.ref.vcf DDfilt_chr17.phased.with.ref.vcf DDfilt_chr18.phased.with.ref.vcf DDfilt_chr19.phased.with.ref.vcf DDfilt_chr20.phased.with.ref.vcf DDfilt_chr21.phased.with.ref.vcf DDfilt_chr22.phased.with.ref.vcf DDfilt_chr23.phased.with.ref.vcf DDfilt_chr24.phased.with.ref.vcf DDfilt_chr25.phased.with.ref.vcf DDfilt_chr26.phased.with.ref.vcf DDfilt_chr27.phased.with.ref.vcf DDfilt_chr28.phased.with.ref.vcf DDfilt_chr29.phased.with.ref.vcf DDfilt_chr30.phased.with.ref.vcf DDfilt_chr31.phased.with.ref.vcf DDfilt_chr32.phased.with.ref.vcf DDfilt_chr33.phased.with.ref.vcf DDfilt_chr34.phased.with.ref.vcf DDfilt_chr35.phased.with.ref.vcf DDfilt_chr36.phased.with.ref.vcf DDfilt_chr37.phased.with.ref.vcf DDfilt_chr38.phased.with.ref.vcf DDfilt_chr41.phased.with.ref.vcf > DDfilt_allchr.phased.with.ref.vcf

#convert to tped
vcftools --vcf /seq/vgb/linda/mutts/Darwins_Dogs/by_chr/phased/DDfilt_allchr.phased.with.ref.vcf \
	 --plink-tped \
	 --out /seq/vgb/linda/mutts/Darwins_Dogs/by_chr/phased/DDfilt_allchr.phased.with.ref

Unrecognized values used for CHROM: 23 - Replacing with 0.
Unrecognized values used for CHROM: 24 - Replacing with 0......

#set vars
map=/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko6forPHASE_formap.bim
this_tped=DDfilt_allchr.phased.with.ref.tped

#add genetic map 
echo "$(awk 'FNR==NR{a[NR]=$3;next}{$3=a[FNR]}1' $map $this_tped)" > $this_tped

### fix chromosomes ############
perl -pe 's/^\d+ chr(\d+):/$1 chr$1:/' $this_tped > $this_tped.tmp 

# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' $this_tped.tmp)" > $this_tped

rm $this_tped.tmp 





####### concat ref #########
cd /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/by_chr/phased
#vcf_concat=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcf-concat


vcf-concat Boyko_12perbreed_6forREF_chr1.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr2.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr3.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr4.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr5.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr6.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr7.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr8.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr9.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr10.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr11.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr12.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr13.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr14.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr15.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr16.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr17.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr18.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr19.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr20.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr21.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr22.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr23.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr24.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr25.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr26.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr27.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr28.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr29.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr30.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr31.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr32.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr33.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr34.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr35.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr36.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr37.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr38.phased.with.ref.vcf Boyko_12perbreed_6forREF_chr41.phased.with.ref.vcf > Boyko_12perbreed_6forREF_allchr.phased.with.ref.vcf



### fix chromosomes ############
#perl -pe 's/^\d+\t(chr\d+):/$1\t$1:/' DDfilt_allchr.phased.with.ref.tped > DDfilt_allchr.phased.with.ref.tped
#perl -pe 's/^\d+\t(chr\d+):/$1\t$1:/' DDfilt_allchr.phased.with.ref.tped > DDfilt_allchr.phased.with.refFIX.tped 


### get just the snps in DD, subset the ref and make mapfile -- or impute them???
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forPHASE \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/mutts/breed_tpeds/breed_tpeds_March2/map_snps.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko6forPHASE_formap

#/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/DD_Boyko6forPHASE_formap.bim
After filtering, kept 149994 out of a possible 157849 Sites


markers.file <- paste(out.data.path, 'DD_Boyko6forPHASE_formap.bim',sep='')


#curate breeds that were phased
qsub -S /bin/bash -q vert -v thispop=yorkshire_terrier \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N yorkshire_terrier \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
/seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_March2.sh

## separate the breeds into files
while read c; do
qsub -S /bin/bash -q vert -v thispop=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N ${c} \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
/seq/vgb/linda/mutts/mendels_mutts/scripts/Dog_12breed_curation_March2.sh
done < /seq/vgb/linda/mutts/breed_tpeds/my_75_breeds.txt




######### start supportmix run March 2 -- first phased with SHAPEIT2 ###############

screen -dr 606
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds/breed_tpeds_March2
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/March2_12perbreed \
    --window=80 \
    $datapath/bichon_frise.tped \
    $datapath/bernese_mountain_dog.tped \
    $datapath/boxer.tped \
    $datapath/boston_terrier.tped \
    $datapath/borzoi.tped \
    $datapath/border_terrier.tped \
    $datapath/border_collie.tped \
    $datapath/belgian_tervuren.tped \
    $datapath/beagle.tped \
    $datapath/basset_hound.tped \
    $datapath/basenji.tped \
    $datapath/australian_shepherd.tped \
    $datapath/akita.tped \
    $datapath/alaskan_malamute.tped \
    $datapath/brittany.tped \
    $datapath/leonberger.tped \
    $datapath/jack_russell_terrier.tped \
    $datapath/havanese.tped \
    $datapath/greyhound.tped \
    $datapath/fox_terrier_wire.tped \
    $datapath/great_dane.tped \
    $datapath/gordon_setter.tped \
    $datapath/golden_retriever.tped \
    $datapath/german_shorthaired_pointer.tped \
    $datapath/german_shepherd_dog.tped \
    $datapath/english_springer_spaniel.tped \
    $datapath/english_cocker_spaniel.tped \
    $datapath/doberman_pinscher.tped \
    $datapath/dalmatian.tped \
    $datapath/cocker_spaniel.tped \
    $datapath/chinese_shar-pei.tped \
    $datapath/chinese_crested.tped \
    $datapath/chesapeake_bay_retriever.tped \
    $datapath/cavalier_king_charles_spaniel.tped \
    $datapath/cairn_terrier.tped \
    $datapath/bulldog_english.tped \
    $datapath/bull_terrier.tped \
    $datapath/labrador_retriever.tped \
    $datapath/irish_wolfhound.tped \
    $datapath/finnish_spitz.tped \
    $datapath/english_setter.tped \
    $datapath/dachshund.tped \
    $datapath/chihuahua.tped \
    $datapath/bulldog_french.tped \
    $datapath/west_highland_white_terrier.tped \
    $datapath/tibetan_spaniel.tped \
    $datapath/staffordshire_bull_terrier.tped \
    $datapath/scottish_terrier.tped \
    $datapath/schipperke.tped \
    $datapath/yorkshire_terrier.tped \
    $datapath/wirehaired_pointing_griffon.tped \
    $datapath/weimaraner.tped \
    $datapath/vizsla.tped \
    $datapath/siberian_husky.tped \
    $datapath/saint_bernard.tped \
    $datapath/pug.tped \
    $datapath/shih_tzu.tped \
    $datapath/shetland_sheepdog.tped \
    $datapath/poodle_toy.tped \
    $datapath/pekingese.tped \
    $datapath/papillon.tped \
    $datapath/newfoundland.tped \
    $datapath/miniature_pinscher.tped \
    $datapath/maltese.tped \
    $datapath/rottweiler.tped \
    $datapath/poodle.tped \
    $datapath/pomeranian.tped \
    $datapath/pembroke_welsh_corgi.tped \
    $datapath/nova_scotia_duck_tolling_retriever.tped \
    $datapath/norwegian_elkhound.tped \
    $datapath/norfolk_terrier.tped \
    $datapath/miniature_schnauzer.tped \
    $datapath/mastiff.tped \
    $datapath/lhasa_apso.tped \
    $datapath/airedale_terrier.tped \
    /seq/vgb/linda/mutts/Darwins_Dogs/by_chr/phased/DDfilt_allchr.phased.with.ref.tped




############### after Phase Fix looking at breeds ####################
screen -dr 606
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
datapath=/seq/vgb/linda/mutts/breed_tpeds/breed_tpeds_March2
  $supportmix \
    --save /seq/vgb/linda/mutts/SM_outputs/March2_12perbreed \
    --window=80 \
    $datapath/bichon_frise.tped \
    $datapath/bernese_mountain_dog.tped \
    $datapath/boxer.tped \
    $datapath/boston_terrier.tped \
    $datapath/borzoi.tped \
    $datapath/border_terrier.tped \
    $datapath/border_collie.tped \
    $datapath/belgian_tervuren.tped \
    $datapath/beagle.tped \
    $datapath/basset_hound.tped \
    $datapath/basenji.tped \
    $datapath/australian_shepherd.tped \
    $datapath/akita.tped \
    $datapath/alaskan_malamute.tped \
    $datapath/brittany.tped \
    $datapath/leonberger.tped \
    $datapath/jack_russell_terrier.tped \
    $datapath/havanese.tped \
    $datapath/greyhound.tped \
    $datapath/fox_terrier_wire.tped \
    $datapath/great_dane.tped \
    $datapath/gordon_setter.tped \
    $datapath/golden_retriever.tped \
    $datapath/german_shorthaired_pointer.tped \
    $datapath/german_shepherd_dog.tped \
    $datapath/english_springer_spaniel.tped \
    $datapath/english_cocker_spaniel.tped \
    $datapath/doberman_pinscher.tped \
    $datapath/dalmatian.tped \
    $datapath/cocker_spaniel.tped \
    $datapath/chinese_shar-pei.tped \
    $datapath/chinese_crested.tped \
    $datapath/chesapeake_bay_retriever.tped \
    $datapath/cavalier_king_charles_spaniel.tped \
    $datapath/cairn_terrier.tped \
    $datapath/bulldog_english.tped \
    $datapath/bull_terrier.tped \
    $datapath/labrador_retriever.tped \
    $datapath/irish_wolfhound.tped \
    $datapath/finnish_spitz.tped \
    $datapath/english_setter.tped \
    $datapath/dachshund.tped \
    $datapath/chihuahua.tped \
    $datapath/bulldog_french.tped \
    $datapath/west_highland_white_terrier.tped \
    $datapath/tibetan_spaniel.tped \
    $datapath/staffordshire_bull_terrier.tped \
    $datapath/scottish_terrier.tped \
    $datapath/schipperke.tped \
    $datapath/yorkshire_terrier.tped \
    $datapath/wirehaired_pointing_griffon.tped \
    $datapath/weimaraner.tped \
    $datapath/vizsla.tped \
    $datapath/siberian_husky.tped \
    $datapath/saint_bernard.tped \
    $datapath/pug.tped \
    $datapath/shih_tzu.tped \
    $datapath/shetland_sheepdog.tped \
    $datapath/poodle_toy.tped \
    $datapath/pekingese.tped \
    $datapath/papillon.tped \
    $datapath/newfoundland.tped \
    $datapath/miniature_pinscher.tped \
    $datapath/maltese.tped \
    $datapath/rottweiler.tped \
    $datapath/poodle.tped \
    $datapath/pomeranian.tped \
    $datapath/pembroke_welsh_corgi.tped \
    $datapath/nova_scotia_duck_tolling_retriever.tped \
    $datapath/norwegian_elkhound.tped \
    $datapath/norfolk_terrier.tped \
    $datapath/miniature_schnauzer.tped \
    $datapath/mastiff.tped \
    $datapath/lhasa_apso.tped \
    $datapath/airedale_terrier.tped \
    /seq/vgb/linda/mutts/Darwins_Dogs/by_chr/phased/DDfilt_allchr.phased.with.ref.tped















########## convert angsd output for drawing random reads into treemix input ##############

Output filenames:
                ->"/seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq.arg"
                ->"/seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq.haplo.gz"
        -> Tue Mar  7 15:56:18 2017
#only 2483 nsps
2483 /seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq.haplo

#modeled after this: http://stackoverflow.com/questions/6224869/how-to-conditionally-replace-values-in-columns-with-value-of-specific-column-in

thisdir=/seq/vgb/linda/TreeMix
thisfile=all_canid_var_haplocall_chr35wgfreq_march9.haplo
names=/seq/vgb/linda/TreeMix/scripts/Treemix_names.txt
treeout=chr35test_march9


#for no Ns
#thisdir=/seq/vgb/linda/TreeMix
#thisfile=all_canid_var_haplocall_chr35wgfreq.haplo
#treeout=chr35noN_march13

gunzip $thisdir/$thisfile.gz

awk 'BEGIN {
     IFS = "\t"
     OFS = " "
  }
  {
     for (NR>1 && column = 4; column <= NF; ++column) {
        if ($column == "N") {
            $column = "N,N"
        }
	else if ($column == $3) {
            $column = "1,0"
        }
	else if ($column != $3) {
            $column = "0,1"
        }

     }  
     print 
  }    
' $thisdir/$thisfile > $thisdir/$thisfile.PREtreeIntmp

## re-add first line as individual's names
### it doesn't like these names yet!!!! not sure why: $thisdir/scripts/Treemix_names.txt

sed -i "1i $(head -n 1 $thisdir/scripts/Treemix_names.txt)" $thisdir/$thisfile.PREtreeIntmp

#get rid of strange 2nd line of file 
sed '2d' $thisdir/$thisfile.PREtreeIntmp > $thisdir/$thisfile.PREtreeIn

#get rid of first three columns (location of snps and maj allele)
awk '{$1=$2=$3=""; print $0}' $thisdir/$thisfile.PREtreeIn > $thisdir/$thisfile.treeIn

rm $thisdir/$thisfile.treeIn.gz
gzip $thisdir/$thisfile.treeIn

#rm $thisdir/$thisfile.PREtreeIntmp
#rm $thisdir/$thisfile.PREtreeIn

 ## RUN TREEMIX #############
##check if it works with only a few N,N
#thisfile=all_canid_var_haplocall_chr35wgfreqaddNA
/seq/vgb/linda/bin/TreeMix/bin/treemix -i $thisdir/$thisfile.treeIn.gz \
  -root ind32 -o $thisdir/outputs/$treeout


reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/TM_outputs_q28/Skyler_allchr.treeIn_m20")

###### a few N,N are okay, but an individual can't be all N,N


########################### RUN TREEMIX #############
screen -dr 12699 25 mig
reuse GCC-5.2
#vul lag is 29

screen -dr 14588
2 mig

/seq/vgb/linda/bin/TreeMix/bin/treemix -i /seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq.haplo.treeIn.gz \
  -root ind29 -m 2 -o /seq/vgb/linda/TreeMix/outputs/chr35wgfreq_march9_m2

#need to run this in tcsh (it works in bash, but then the R plot is empty)
/seq/vgb/linda/bin/TreeMix/bin/treemix -i /seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq.haplo.treeIn.gz \
  -root ind29 -o /seq/vgb/linda/TreeMix/outputs/chr35wgfreq_march9



/seq/vgb/linda/bin/TreeMix/bin/treemix -i $thisdir/$thisfile.treeIn.gz \
  -root ind32 -o $thisdir/outputs/$treeout

thisdir=/seq/vgb/linda/TreeMix
thisfile=all_canid_var_haplocall_chr35wgfreq_march9.haplo
treeout=chr35test_march9

/seq/vgb/linda/bin/TreeMix/bin/treemix -i /seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreq_march9.haplo.treeIn.gz \
  -root ind32 -o /seq/vgb/linda/TreeMix/outputs/chr35test_march9




#NP 108928 population 21
WARNING: no counts at SNP 108929 population 19
WARNING: no counts at SNP 108929 population 21
WARNING: no counts at SNP 108930 population 19
WARNING: no counts at SNP 108930 population 21
WARNING: no counts at SNP 108931 population 19
WARNING: no counts at SNP 108931 population 21
WARNING: no counts at SNP 108932 population 19
WARNING: no counts at SNP 108932 population 21
WARNING: no counts at SNP 108933 population 19
WARNING: no counts at SNP 108933 population 21
WARNING: no counts at SNP 108934 population 19
WARNING: no counts at SNP 108934 population 21
WARNING: no counts at SNP 108935 population 19
WARNING: no counts at SNP 108935 population 21
WARNING: no counts at SNP 108936 population 19
WARNING: no counts at SNP 108936 population 21
WARNING: no counts at SNP 108937 population 19
WARNING: no counts at SNP 108937 population 21
WARN..............

#/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R

#from within R
#don't do this from bash or else the pdf is not readable!!!! --TURNS OUT IT ONLY PRINTS PDF AFTER YOU QUIT R
reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35wgfreq_march9_m2")


source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35wgfreq_march9")

....... not working!!!!!!

#Warnings when the plot worked ---
59  356 2372 0.000617629  1 NOT_MIG  0  1
60 2372  676 0.000000000  1 NOT_MIG  0  1
61 2372 2371 0.115826000  1 NOT_MIG  0  1
62 1504   32 0.070980000  1 NOT_MIG  0  1
63   32 1004 0.015602400  1 NOT_MIG  0  1
64 1616 1504 0.050375200  1 NOT_MIG  0  1
65 1004  304 0.032824600  1 NOT_MIG  0  1
66 2373 1615 0.053280600  1 NOT_MIG  0  1
67 2373 1616 0.053280600  1 NOT_MIG  0  1
68  304   76 0.004305470  1 NOT_MIG  0  1

Warning messages:
.......
........
1: In plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35test") :
  NAs introduced by coercion
2: In plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35test") :
  NAs introduced by coercion
3: In plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35test") :
  NAs introduced by coercion
4: In plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35test") :
  NAs introduced by coercion
5: In max(e[e[, 5] == "MIG", 4]) :
  no non-missing arguments to max; returning -Inf


######### check if is okay to have N values in treemix


/seq/vgb/linda/bin/TreeMix/bin/treemix -i /seq/vgb/linda/TreeMix/all_canid_var_haplocall_chr35wgfreqaddNA.treeIn.gz \
  -root ind29 -o /seq/vgb/linda/TreeMix/outputs/chr35testNA
"TreeMix v. 1.13
$Revision: 231 $

ERROR: N does not have two alleles (expecting SNP data)"


## trying N,N
"npop:35 nsnp:2482
WARNING: no counts at SNP 0 population 34
WARNING: no counts at SNP 2 population 14
WARNING: no counts at SNP 5 population 14
WARNING: no counts at SNP 6 population 14


reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/outputs/chr35testNA")



################## 
DX10 Jack 
D131 Hopper




########## trying BetaScan March 7, 2017 ############

### submit chr20 for YRI
# HAD TO CHANGE PATHS IN BAMFILE LIST!!!!
qsub -S /bin/bash -q vert -v chr=20 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/snpfile.out \
 -e /seq/vgb/linda/bal_sel/err/snpfile.er \
 -N chr20angsd \
 -wd /seq/vgb/linda/bal_sel/err \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/make_combinedSNPfile_YRI.sh







########## run Treemix per chromosome #######
qsub -S /bin/bash -v chr=chr7 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N chr7 \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix.sh


########## run Treemix per chromosome -- running again with qualites at 20 #######
qsub -S /bin/bash -v chr=chr1 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out1 \
   -e /seq/vgb/linda/mutts/err/mutt_err1 \
   -N chr1 \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix.sh


###### set qualities at 29 #####
while read c; do
qsub -S /bin/bash -v chr=$c,qual=29 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt









while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_q25.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt




### make new names file 
cp /seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_March14.txt /seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_March15.txt
sed -i -E "s/DX09/Rudy/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX01/Skeeter/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX05/Rhoda/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX07/Finch/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D183/Esme/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D198/Sandy/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX04/Tui/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D132/Clarence/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX08/Jaime/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D131/Hopper/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D182/Skyler/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D184/Lucky/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX06/Lily/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX11/Vera-Lynn/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX02/Hunter/" Treemix_names_my_canids_March15.txt
sed -i -E "s/D157/Beskow/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX03/Reily/" Treemix_names_my_canids_March15.txt
sed -i -E "s/DX10/Jack/" Treemix_names_my_canids_March15.txt
sed -i -E "s/ChowChowA/ChowA/" Treemix_names_my_canids_March15.txt
sed -i -E "s/ChowChowB/ChowB/" Treemix_names_my_canids_March15.txt



###### check diversity looking at dogs and coyotes -- treemix parameters ###
plink --bfile /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt \
 --keep /seq/vgb/linda/dogs_diversity_check.txt \
 --maf 0.134 \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_divtest

#110777 variants and 13 dogs pass filters and QC

similar parameters get us about 10x this number of variants with array snps, but we don't have the fox run on the array





###### calculate MAF of the snps in our reference dataset DD snps ######

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed \
	--dog \
	--freq \
	--out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/ddfreq


####### running new Treemix March 29th
### Florida coyote and Quebec Algon and Alaska wolf didn't align!!!!

###### set qualities at 28 #####
while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt

Major Histocompatibility Complex



######### are all the illumina snps on Affy array A?

/seq/vgb/linda/admixture/Illumina/


plink --ped /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPs.ped \
 --map /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_allSNPsX.map \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/admixture/Illumina/CanineHD_locplus.snplist \
 --make-bed \
 --noweb \
 --out /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_illum_overlap


YES!!!

####### I'm having trouble using the raw data because I don't have a sample sheet --!!!
it wants well numbers and replicates etc


#################### try to convert Elaine's data into plink files #######

WINDOWS PATHS FOR REMOTE DESKTOP:
\\aloe\seq_vgb\linda\mutts\ostrander_data\ostrander_illumina\GSE96736\
\\aloe\seq_vgb\linda\mutts\ostrander_data\ostrander_illumina\GSE90441\idat
\\krypton\Mammals\Dog\Canine_array\


########### try to get two of the three datasets by converting the genotyped format
#### just get genotype columns
http://www.unix.com/shell-programming-and-scripting/160404-need-awk-help-print-specific-columns-string-header.html
awk '
   FNR==1{
        for(i=1;i<=NF;i++) 
            if ($i ~ str) {
              h=(h)?h FS $i:$i
              f=(f)?f FS i:i
            }
        print h
        nf=split(f,fA,FS);next
   }
   {
       for(i=1;i<=nf;i++) 
           printf("%s%c",$fA[i], (i==nf)?ORS:FS)
   }' str='.GType' FS="\t" GSE96736_MPR_matrix.txt > test.txt



/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina
## print the column -- this doenst work!!  ### these dont work
awk -F"\t" '{for(i=1;i<=NF;i++){if ($i ~ /GType/){print}}}' GSE96736_MPR_matrix.txt > mycols.txt

awk -v col=GType 'NR==1{for(i=1;i<=NF;i++){if($i ~ col){c=i;break}} print $c} NR>1{print $c}' GSE90441_CanMap2_processed_data.txt > mycols.txt

awk 'NR==1{for(i=1;i<=NF;i++)if($i~/GType/)f[n++]=i}{for(i=0;i<n;i++)printf"%s%s",i?" ":"",$f[i];print""}' GSE90441_CanMap2_processed_data.txt > mycols.txt




#get column numbers for genotypes
awk -F"\t" '{for(i=1;i<=NF;i++){if ($i ~ /GType/){print i}}}' GSE96736_MPR_matrix.txt > mycols.txt


awk '{print $1,$2,$3,$4}'

1
7
13
19
25
31
37
43
49
55
61
67
73
79
85
91
97
103
109
115
121
127



####### I manually changed mycols.txt to put into an awk command
awk -F"\t" '{print $1,$7,$13,$19,$25,$31,$37,$43,$49,$55,$61,$67,$73,$79,$85,$91,$97,$103,$109,$115,$121,$127,$133,$139,$145,$151,$157,$163,$169,$175,$181,$187,$193,$199,$205,$211,$217,$223,$229,$235,$241,$247,$253,$259,$265,$271,$277,$283,$289,$295,$301,$307,$313,$319,$325,$331,$337,$343,$349,$355,$361,$367,$373,$379,$385,$391,$397,$403,$409,$415,$421,$427,$433,$439,$445,$451,$457,$463,$469,$475,$481,$487,$493,$499,$505,$511,$517,$523,$529,$535,$541,$547,$553,$559,$565,$571,$577,$583,$589,$595,$601,$607,$613,$619,$625,$631,$637,$643,$649,$655,$661,$667,$673,$679,$685,$691,$697,$703,$709,$715,$721,$727,$733,$739,$745,$751,$757,$763,$769,$775,$781,$787,$793,$799,$805,$811,$817,$823,$829,$835,$841,$847,$853,$859,$865,$871,$877,$883,$889,$895,$901,$907,$913,$919,$925,$931,$937,$943,$949,$955,$961,$967,$973,$979,$985,$991,$997,$1003,$1009,$1015,$1021,$1027,$1033,$1039,$1045,$1051,$1057,$1063,$1069,$1075,$1081,$1087,$1093,$1099,$1105,$1111,$1117,$1123,$1129,$1135,$1141,$1147,$1153,$1159,$1165,$1171,$1177,$1183,$1189,$1195,$1201,$1207,$1213,$1219,$1225,$1231,$1237,$1243,$1249,$1255,$1261,$1267,$1273,$1279,$1285,$1291,$1297,$1303,$1309,$1315,$1321,$1327,$1333,$1339,$1345,$1351,$1357,$1363,$1369,$1375,$1381,$1387,$1393,$1399,$1405,$1411,$1417,$1423,$1429,$1435,$1441,$1447,$1453,$1459,$1465,$1471,$1477,$1483,$1489,$1495,$1501,$1507,$1513,$1519,$1525,$1531,$1537,$1543,$1549,$1555,$1561,$1567,$1573,$1579,$1585,$1591,$1597,$1603,$1609,$1615,$1621,$1627,$1633,$1639,$1645,$1651,$1657,$1663,$1669,$1675,$1681,$1687,$1693,$1699,$1705,$1711,$1717,$1723,$1729,$1735,$1741,$1747,$1753,$1759,$1765,$1771,$1777,$1783,$1789,$1795,$1801,$1807,$1813,$1819,$1825,$1831,$1837,$1843,$1849,$1855,$1861,$1867,$1873,$1879,$1885,$1891,$1897,$1903,$1909,$1915,$1921,$1927,$1933,$1939,$1945,$1951,$1957,$1963,$1969,$1975,$1981,$1987,$1993,$1999,$2005,$2011,$2017,$2023,$2029,$2035,$2041,$2047,$2053,$2059,$2065,$2071,$2077,$2083,$2089,$2095,$2101,$2107,$2113,$2119,$2125,$2131,$2137,$2143,$2149,$2155,$2161,$2167,$2173,$2179,$2185,$2191,$2197,$2203,$2209,$2215,$2221,$2227,$2233,$2239,$2245,$2251,$2257,$2263,$2269,$2275,$2281,$2287,$2293,$2299,$2305,$2311,$2317,$2323,$2329,$2335,$2341,$2347,$2353,$2359,$2365,$2371,$2377,$2383,$2389,$2395,$2401,$2407,$2413,$2419,$2425,$2431,$2437,$2443,$2449,$2455,$2461,$2467,$2473,$2479,$2485,$2491,$2497,$2503,$2509,$2515,$2521,$2527,$2533,$2539,$2545,$2551,$2557,$2563,$2569,$2575,$2581,$2587,$2593,$2599,$2605,$2611,$2617,$2623,$2629,$2635,$2641,$2647,$2653,$2659,$2665,$2671,$2677,$2683,$2689,$2695,$2701,$2707,$2713,$2719,$2725,$2731,$2737,$2743,$2749,$2755,$2761,$2767,$2773,$2779,$2785,$2791,$2797,$2803,$2809,$2815,$2821,$2827,$2833,$2839,$2845,$2851,$2857,$2863,$2869,$2875,$2881,$2887,$2893,$2899,$2905,$2911,$2917,$2923,$2929,$2935,$2941,$2947,$2953,$2959,$2965,$2971,$2977,$2983,$2989,$2995,$3001,$3007,$3013,$3019,$3025,$3031,$3037,$3043,$3049,$3055,$3061,$3067,$3073,$3079,$3085,$3091,$3097,$3103,$3109,$3115,$3121,$3127,$3133,$3139,$3145,$3151,$3157,$3163,$3169,$3175,$3181,$3187,$3193,$3199,$3205,$3211,$3217,$3223,$3229,$3235,$3241,$3247,$3253,$3259,$3265,$3271,$3277,$3283,$3289,$3295,$3301,$3307,$3313,$3319,$3325,$3331,$3337,$3343,$3349,$3355,$3361,$3367,$3373,$3379,$3385,$3391,$3397,$3403,$3409,$3415,$3421,$3427,$3433,$3439,$3445,$3451,$3457,$3463,$3469,$3475,$3481,$3487,$3493,$3499,$3505,$3511,$3517,$3523,$3529,$3535,$3541,$3547,$3553,$3559,$3565,$3571,$3577,$3583,$3589,$3595,$3601,$3607,$3613,$3619,$3625,$3631,$3637,$3643,$3649,$3655,$3661,$3667,$3673,$3679,$3685,$3691,$3697,$3703,$3709,$3715,$3721,$3727,$3733,$3739,$3745,$3751,$3757,$3763,$3769,$3775,$3781,$3787,$3793,$3799,$3805,$3811,$3817,$3823,$3829,$3835,$3841,$3847,$3853,$3859,$3865,$3871,$3877,$3883,$3889,$3895,$3901,$3907,$3913,$3919,$3925,$3931,$3937,$3943,$3949,$3955,$3961,$3967,$3973,$3979,$3985,$3991,$3997,$4003,$4009,$4015,$4021,$4027,$4033,$4039,$4045,$4051,$4057,$4063,$4069,$4075,$4081,$4087,$4093,$4099,$4105,$4111,$4117,$4123,$4129,$4135,$4141,$4147,$4153,$4159,$4165,$4171,$4177,$4183,$4189,$4195,$4201,$4207,$4213,$4219,$4225,$4231,$4237,$4243,$4249,$4255,$4261,$4267,$4273,$4279,$4285,$4291,$4297,$4303,$4309,$4315,$4321,$4327,$4333,$4339,$4345,$4351,$4357,$4363,$4369,$4375,$4381,$4387,$4393,$4399,$4405,$4411,$4417,$4423,$4429,$4435,$4441,$4447,$4453,$4459,$4465,$4471,$4477,$4483,$4489,$4495,$4501,$4507,$4513,$4519,$4525,$4531,$4537,$4543,$4549,$4555,$4561,$4567,$4573,$4579,$4585,$4591,$4597,$4603,$4609,$4615,$4621,$4627,$4633,$4639,$4645,$4651,$4657,$4663,$4669,$4675,$4681,$4687,$4693,$4699,$4705,$4711,$4717,$4723,$4729,$4735,$4741,$4747,$4753,$4759,$4765,$4771}' GSE90441_CanMap2_processed_data.txt > GSE90441_gt.txt

#put first col into separate map file:
awk -F"\t" '{print $1}' GSE90441_CanMap2_processed_data.txt > GSE90441_map.txt


## this gives me 795 genotypes for each snp


### transpose the file
awk '
{ 
    for (i=1; i<=NF; i++)  {
        a[NR,i] = $i
    }
}
NF>p { p = NF }
END {    
    for(j=1; j<=p; j++) {
        str=a[1,j]
        for(i=2; i<=NR; i++){
            str=str" "a[i,j];
        }
        print str
    }
}' GSE90441_gt.txt > GSE90441_Tgt.txt


To do:
Replace first column with all 0s add cols 3-6 with 0s
add tabs between letters
get rid of first line
get rid of ".GType"
replace NC with 00


ICF2P590619 BICF2S23150265 BICF2P511214 BICF2P622326 BICF2S23349037 BICF2S23759452 BICF2P555827 BICF2P1222905 BICF2P212134 BICF2P1069723 BICF2P466525 BICF2S23538919 BICF2S23528242 BICF2P308643 BICF2P148965 BICF2P573833 BICF2P239784 BICF2P318141 BICF2S23222537 BICF2P330277 BICF2P1183079 BICF2P91667 BICF2P208824 BICF2P531942 BICF2P429673 BICF2S22955156 BICF2P216050 BICF2P833680 BICF2P553400 BICF2S2316852 BICF2P183837 BICF2G63048446
15628.GType BB AB AB BB AB AB AB AB AB AB AB AB AB AB AB AB AB BB AB AB AB AB AB BB BB AB BB BB AB AB AB AB AB AB AB AB NC NC NC NC NC AB AB AB AB AB BB NC BB AB BB BB BB BB BB BB AA AB AA BB AB AB AB AB AB BB BB AB AB BB AB BB AB BB BB AB AB BB NC AB BB AB AB AA BB AB AB BB AB AB BB BB AB AB BB AB AA AB BB BB BB BB NC AB BB BB BB AA AB AA AB AA AB AA AB AB AB BB AB BB AB AB AA BB AB BB BB AA BB BB BB AB AB AB BB AB AB AB AB AA AB AB AB BB AA BB AB BB AA BB BB AB AB NC BB AB AA BB AB BB AA BB BB AB BB AA AA AB AB AB BB AB AB AB BB BB BB AB AB AB BB AB AB AB AB AB AB AB AB AB AB BB BB AB AB BB BB AA AA AA AB AA BB BB BB AB AB AB BB BB BB AB BB BB BB AA BB AB BB BB AB AB AA AB AA AB AA NC AB AB AB AA AB AA BB AB AB AB AA AA AA AA AB AA AA


awk -F"\t" '{print '0',$0}' GSE90441_Tgt.txt > GSE90441_Tgt1.txt



####### make in python

screen -dr 298

use Python-2.7

python /seq/vgb/linda/mutts/scripts/gse2plink.py /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.txt /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv

python /seq/vgb/linda/mutts/scripts/gse2plink.py /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.txt /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv


############ flip snps ##############

## make snps of no location snps ot exclude
awk '/^0/' CanineHD.loc.snp.key | head -10
awk '$1 == "0" { print $0 }' CanineHD.loc.snp.key | awk '{print $2}' > no_loc_snps.txt
#remove first2 and last entry
sed -i '2d;$d' no_loc_snps.txt

###### convert to binary format
#get list of 0:0 snps to include --> --exclude these START HERE!!!!!!!!!!!!
USE PLINK2
plink --ped /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.ped \
 --map /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.map \
 --exclude /seq/vgb/linda/admixture/Illumina/no_loc_snps.txt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data


#### 
use Perl-5.20
perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHD.snptable \
 -intype ilmnab \
 -outtype dbsnp \
 -outfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped.bim


Error: invalid record found in SNP Table file /seq/vgb/linda/admixture/Illumina/CanineHD.snptable (at least 4 tab-delimited fields expected): <			>
 at /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl line 334, <SNPTABLE> line 173664.
	main::readSNPTableFile("/seq/vgb/linda/admixture/Illumina/CanineHD.snptable") called at /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl line 37

head -n -22 /seq/vgb/linda/admixture/Illumina/CanineHD.snptable > /seq/vgb/linda/admixture/Illumina/CanineHDfixed.snptable

use Perl-5.20
perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHDfixed.snptable \
 -intype ilmnab \
 -outtype dbsnp \
 -outfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped.bim

####### many bps are 0s
20802 of 17k snps

they seem to be there and look normal... may be variants that aren't called

# replace SNP names with locations
awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped.bim > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_loc.bim


plink --bed /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.bed \
 --bim /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_loc.bim \
 --fam /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.fam \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --noweb \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt

#when don't take snps from 
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 791 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate in remaining samples is 0.877882.
20885 variants removed due to missing genotype data (--geno).
151858 variants and 791 dogs pass filters and QC.


## not doing the extract here
--extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
--extract: 149332 variants remaining.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 795 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.975139.
3487 variants removed due to missing genotype data (--geno).
145845 variants and 795 dogs pass filters and QC.
Note: No phenotypes present.
--make-bed to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt.bed
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt.bim
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt.fam
... done.

# no  0 0 snps left awk '/\t0\t0/' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt.bim



#### 1 curate breeds and just get those I'm interestd in
plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_flipped_filt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --keep /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_needed_dogs.txt \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep


CollieBullmastiff
Bloodhound
Whippet
Chow Chow
SamoyedSheepdog, Old English
Schnauzer, GiantTerrier, Fox-Wire
Terrier, Norwich
Belgian Sheepdog


To get from GSE90441
COLL
BULM
BLDH
WHIP
CHOW
SAMO
OES
GSNZ
GSMD
NOWT
BELS



258315 MB RAM detected; reserving 129157 MB for main workspace.
Allocated 96867 MB successfully, after larger attempt(s) failed.
145845 variants loaded from .bim file.
795 dogs (0 males, 0 females, 795 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep.nosex
.
--keep: 102 dogs remaining.


######## check from HWE

plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep


use Python-2.7
python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep.hwe \
  > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep.hwe_rmsnps





##### 2 try merging ostrander with boyko

plink \
	--bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
	--bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
	--maf 0.0001 \
	--dog \
 	--allow-no-sex \
	--make-bed --out /seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged

158507 markers loaded from
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind.bim.
145845 markers to be merged from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep.bim.
Of these, 0 are new, while 145845 are present in the base dataset.
Performing single-pass merge (4400 dogs, 158507 variants).
Merged fileset written to                     
/seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged-merge.bed +
/seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged-merge.bim +
/seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged-merge.fam .
158507 variants loaded from .bim file.
4400 dogs (2147 males, 2143 females, 110 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged.nosex .
118 phenotype values loaded from .fam.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 4400 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.983683.
0 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
158507 variants and 4400 dogs pass filters and QC.
Among remaining phenotypes, 53 are cases and 65 are controls.  (4282 phenotypes
are missing.)



#################### AT THE END OF THE MERGING, I NEED TO SUBSET ON ONLY THE SNPS THAT PASSED IN ALL THREE DATASETS , I DON'T WANT TO IMPUTE ################




##### 3 for breeds I'm interested in  -- who are the nearest neighbors in the other dataset

plink --bfile /seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged \
 --dog \
 --neighbour 1 12 \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged_neighbor

YAY!!! NEAREST NEIGHBORS ARE OF THE SAME BREED ACROSS DATASETS!!


############### TOMORRW: DO THE SAME FOR THE OTHER DATASETS (3 OF THEM?) & WRITE AUTHORS WHO LISTED RAW DATA ################
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE96736

# the matrix files are the ones that I want
# What's the difference between MPR, PUL and SKU


### convert MPR
use Python-2.7
python /seq/vgb/linda/mutts/scripts/gse2plink.py /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_MPR_matrix.txt /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv
#has 98 individuals, the mapfile didn't write correctly

###convert PUL 
python /seq/vgb/linda/mutts/scripts/gse2plink.py /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_PUL_matrix.txt /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv
# 25 individuals map file also didn't work

###convert SKU 
python /seq/vgb/linda/mutts/scripts/gse2plink.py /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_SKU_matrix.txt /seq/vgb/linda/admixture/Illumina/CanineHD_B.csv
#### both ped and map failed!!!

### first two give me 123 of 158 individuals

all have 173663 lines
173663 also in previous data, I can use the same map file


Need:
bloodhound
BLDH
Keeshonden
KEES
Flat-coated Retriever	
FCR -- said there were 10, but only 2 in GSE96736 -  we only have 5 so will need to drop
Belian sheepdog BELS

######## different order from other snps, and map file didn't work 
Name PUL
BICF2G630100019
BICF2G630100032
BICF2G630100034
BICF2G630100043
BICF2G630100054
BICF2G630100063
BICF2G630100075
BICF2G63010009
BICF2G630100090
BICF2G630100094
BICF2G63010010
BICF2G630100114
BICF2G630100129
BICF2G63010014
BICF2G630100157
BICF2G63010018
BICF2G63010019
BICF2G630100197
BICF2G630100209
BICF2G630100251
BICF2G630100257
BICF2G630100260
BICF2G630100288
BICF2G630100310


Name
BICF2G630100019
BICF2G630100032
BICF2G630100034
BICF2G630100043
BICF2G630100054
BICF2G630100063
BICF2G630100075
BICF2G63010009
BICF2G630100090
BICF2G630100094
BICF2G63010010
BICF2G630100114
BICF2G630100129
BICF2G63010014
BICF2G630100157
BICF2G63010018
BICF2G63010019
BICF2G630100197
BICF2G630100209
BICF2G630100251
BICF2G630100257
BICF2G630100260


##### these have same orde as /seq/vgb/linda/admixture/Illumina/CanineHD.name.loc, I checked in R

## make mapfile for both
awk '{print "chr" $1,$2,'0',$3}' /seq/vgb/linda/admixture/Illumina/CanineHD.name.loc | head -n -23 > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736.map



#### combine MPR and PUL , then flip

USE PLINK2
plink --ped /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_MPR_matrix.ped \
 --map /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736.map \
 --exclude /seq/vgb/linda/admixture/Illumina/no_loc_snps.txt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix

--exclude: 172743 variants remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 98 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.951324.

plink --ped /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_PUL_matrix.ped \
 --map /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736.map \
 --exclude /seq/vgb/linda/admixture/Illumina/no_loc_snps.txt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_PUL_matrix

--exclude: 172743 variants remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 25 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.978145.


##### combine
plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_PUL_matrix \
 --bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix.bed \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix.bim \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix.fam \
 --dog \
 --make-bed \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined

25 dogs loaded from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_PUL_matrix.fam.
98 dogs to be merged from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix.fam.
Of these, 98 are new, while 0 are present in the base dataset.

172743 markers loaded from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_PUL_matrix.bim.
172743 markers to be merged from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736_MPR_matrix.bim.
Of these, 0 are new, while 172743 are present in the base dataset.
Performing single-pass merge (123 dogs, 172743 variants).
Merged fileset written to                     
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined-merge.bed
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined-merge.bim
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined-merge.fam
.
172743 variants loaded from .bim file.
123 dogs (0 males, 0 females, 123 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.nosex
.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 123 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.956776.
172743 variants and 123 dogs pass filters and QC.




#### FLIP #########
use Perl-5.20
perl /seq/vgb/linda/admixture/Illumina/convert_bim_allele.pl \
 /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.bim \
 /seq/vgb/linda/admixture/Illumina/CanineHDfixed.snptable \
 -intype ilmnab \
 -outtype dbsnp \
 -outfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped.bim


### There are some 0 0 values

awk '/\t0\t0/' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped.bim | wc -l
3618

#convert snp names to locations

awk '{print "chr" $1, "chr" $1 ":" $4, '0', $4, $5, $6}' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped.bim > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flippedloc.bim


####### Combine with other Ostrander dataset before filtering


#### filter

plink --bed /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.bed \
 --bim /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flippedloc.bim \
 --fam /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.fam \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --noweb \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped_filt

6 dogs removed due to missing genotype data (--mind).
IDs written to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped_filt.irem
.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 117 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate in remaining samples is 0.976213.
3656 variants removed due to missing genotype data (--geno).
169087 variants and 117 dogs pass filters and QC.



cat /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_needed_dogs.txt /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_needed_dogs.txt >> /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/Ostrander_needed_dogs.txt


###### combine with other ostrander
plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flipped_filt \
 --bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
 --make-bed \
 --dog  \
 --allow-no-sex \
 --keep /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/Ostrander_needed_dogs.txt \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps

## keep all snps
170112 variants loaded from .bim file.
219 dogs (0 males, 0 females, 219 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps.nosex
Total genotyping rate in remaining samples is 0.874953.

#get snps
#get list of snps in ostrander dataset to keep
awk '{print $2}' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps.bim> /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps.snps





#when extract just the boyko snps
--extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
--extract: 149860 variants remaining.
--keep: 118 dogs remaining.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 118 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate in remaining samples is 0.974908.
4559 variants removed due to missing genotype data (--geno).
145301 variants and 118 dogs pass filters and QC.



plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps


use Python-2.7
python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps.hwe \
  > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps.hwe_rmsnps


#get snps that passed filtering in both datasets

awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind.bim > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind.snps



### from R take snps that overlap in ostrander and boyko
dim(boyko[V1 %in% ost$V1,])
[1] 149963      1

############ last, combine boyko with Ostrander, keep only snps in ostrander set ###

### this has all the boyko dogs cuz some will be combinded with ostrander

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
	--bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/allOstrander_GSE96736_GSE90441_mydogs_mysnps \
	--extract /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/boyko_ost_snp_overlap.txt \
	--maf 0.0001 \
	--dog \
 	--allow-no-sex \
	--make-bed --out /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged


178656 variants loaded from .bim file.
4416 dogs (2147 males, 2143 females, 126 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged.nosex .
118 phenotype values loaded from .fam.
--extract: 149963 variants remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 4416 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.990873.
0 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
149963 variants and 4416 dogs pass filters and QC.





plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged \
 --dog \
 --neighbour 1 12 \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged

YAY!!! NEAREST NEIGHBORS ARE OF THE SAME BREED ACROSS DATASETS!!



######### get 12 dogs per breed ########

CollieBullmastiff
Bloodhound
Whippet
Chow Chow
SamoyedSheepdog, Old English
Schnauzer, Giantgreatwer swiss mountain dog
Terrier, Norwich
Belgian Sheepdog


To get from GSE90441
COLL
BULM
BLDH
WHIP
CHOW
SAMO
OES
GSNZ
GSMD
NOWT
BELS



Need:
bloodhound
BLDH
Keeshonden
KEES
Flat-coated Retriever	
FCR -- said there were 10, but only 2 in GSE96736 -  we only have 5 so will need to drop
Belian sheepdog BELS

########### keep only dogs we will use #######

plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged \
 --dog \
 --keep /seq/vgb/linda/mutts/breed_reference/my12perbreed_boyko_ostrander_May19.txt  \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed

149963 variants and 1044 dogs pass filters and QC.

######## separate phasing and breed calling data ########


################# REFERENCE DATA SET ###################
plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/mutts/breed_reference/ref_phase_snp_overlap.txt \
 --keep /seq/vgb/linda/mutts/breed_reference/mydogs.6of12eachMay19.txt \
 --maf 0.0001 \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forREF


--extract: 149569 variants remaining.
--keep: 522 dogs remaining.


################# Phasing DATA SET ###################
plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/mutts/breed_reference/ref_phase_snp_overlap.txt \
 --remove /seq/vgb/linda/mutts/breed_reference/mydogs.6of12eachMay19.txt \
 --maf 0.0001 \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forPHASE

149569 variants and 522 dogs pass filters and QC.

skyler!!!
new breeds:
CollieBullmastiff
Bloodhound
Whippet
Chow Chow
SamoyedSheepdog, Old English
Schnauzer, Giantgreatwer swiss mountain dog
Terrier, Norwich
Belgian Sheepdog
Keeshonden



################ phase both with eagle separately ########

Eagle_v2.3.2

#may want other genetic map later


/seq/vgb/linda/bin/Eagle_v2.3.2/eagle --vcf=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forREF.vcf \
 --geneticMapFile=/seq/vgb/linda/mutts/genetic_map_wg/gen_map_canfam3.1 \
 --chrom=41 \
 --chromX=41 \
 --outPrefix=phased


####### submit phasing to queue #########

qsub -S /bin/bash -v chr=41,ref=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forREF \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N chr41 \
   -p -10 \
   -wd /seq/vgb/linda/mutts/err \
   /seq/vgb/linda/mutts/scripts/phase_ref_eagle.sh




while read c; do
qsub -S /bin/bash -v chr=$c,ref=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forREF \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N 'chr_'${c} \
   -p -10 \
   -wd /seq/vgb/linda/mutts/err \
   /seq/vgb/linda/mutts/scripts/phase_ref_eagle.sh
done < /seq/vgb/linda/mutts/scripts/dog_chrs.txt

###### put file back together in one vcf

use VCFtools

cd /seq/vgb/linda/mutts/breed_reference/

use Tabix

vcf-concat \
 allOstrander_Boyko_merged_my12perbreed_6forREF_1.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_2.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_3.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_4.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_5.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_6.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_7.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_8.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_9.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_10.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_11.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_12.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_13.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_14.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_15.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_16.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_17.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_18.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_19.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_20.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_21.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_22.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_23.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_24.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_25.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_26.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_27.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_28.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_29.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_30.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_31.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_32.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_33.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_34.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_35.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_36.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_37.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_38.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forREF_41.phased.vcf.gz \
 | bgzip -c > allOstrander_Boyko_merged_my12perbreed_6forREF_allchr.phased.vcf.gz


tabix -p vcf allOstrander_Boyko_merged_my12perbreed_6forREF_allchr.phased.vcf.gz



while read c; do
qsub -S /bin/bash -v chr=$c,ref=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forPHASE \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N 'chr_'${c} \
   -p -10 \
   -wd /seq/vgb/linda/mutts/err \
   /seq/vgb/linda/mutts/scripts/phase_ref_eagle.sh
done < /seq/vgb/linda/mutts/scripts/dog_chrs.txt



 --maxMissingPerSnp=0.15 \
 --maxMissingPerIndiv=0.15

cd /seq/vgb/linda/mutts/breed_reference

vcf-concat \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_1.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_2.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_3.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_4.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_5.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_6.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_7.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_8.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_9.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_10.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_11.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_12.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_13.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_14.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_15.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_16.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_17.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_18.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_19.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_20.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_21.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_22.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_23.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_24.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_25.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_26.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_27.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_28.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_29.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_30.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_31.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_32.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_33.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_34.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_35.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_36.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_37.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_38.phased.vcf.gz \
 allOstrander_Boyko_merged_my12perbreed_6forPHASE_41.phased.vcf.gz \
 | bgzip > allOstrander_Boyko_merged_my12perbreed_6forPHASE_allchr.phased.vcf.gz




tabix -p vcf allOstrander_Boyko_merged_my12perbreed_6forPHASE_allchr.phased.vcf.gz







#### phase DD/MM/10x with reference panel  #########


qsub -S /bin/bash -v chr=41,ref=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forPHASE_allchr.phased,targ=/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N chr41 \
   -p -10 \
   -wd /seq/vgb/linda/mutts/err \
   /seq/vgb/linda/mutts/scripts/phase_using_ref_eagle.sh


while read c; do
qsub -S /bin/bash -v chr=$c,ref=/seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forPHASE_allchr.phased,targ=/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt \
   -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/mutt_out \
   -e /seq/vgb/linda/mutts/err/mutt_err \
   -N 'chr_'${c} \
   -p -10 \
   -wd /seq/vgb/linda/mutts/err \
   /seq/vgb/linda/mutts/scripts/phase_using_ref_eagle.sh
done < /seq/vgb/linda/mutts/scripts/dog_chrs.txt


vcf-concat \
 DD_MM_10xg_refsnps_filt_1.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_2.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_3.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_4.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_5.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_6.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_7.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_8.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_9.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_10.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_11.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_12.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_13.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_14.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_15.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_16.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_17.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_18.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_19.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_20.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_21.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_22.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_23.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_24.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_25.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_26.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_27.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_28.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_29.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_30.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_31.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_32.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_33.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_34.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_35.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_36.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_37.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_38.phased.vcf.gz \
 DD_MM_10xg_refsnps_filt_41.phased.vcf.gz \
 | bgzip > DD_MM_10xg_refsnps_filt_allchr.phased.vcf.gz





##################### separate REF into breeds #################



qsub -S /bin/bash -v thispop=boxer -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -p -10 \
 -wd /seq/vgb/linda/mutts/err \
 -N boxer \
 /seq/vgb/linda/mutts/scripts/Ref_breed_curation_May21.sh


yorkshire_terrier


qsub -S /bin/bash -v thispop=yorkshire_terrier -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_curyorkie.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_curyorkie.err \
 -p -10 \
 -wd /seq/vgb/linda/mutts/err \
 -N yorkshire_terrier \
 /seq/vgb/linda/mutts/scripts/Ref_breed_curation_May21.sh



#CURATE ALL 87 BREEDS!!! 
while read c; do
qsub -S /bin/bash -v thispop=$c -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb-HAL/linda/ancestry/out/breed_cur.out \
 -e /seq/vgb-HAL/linda/ancestry/err/breed_cur.err \
 -p -10 \
 -N ${c} \
 /seq/vgb/linda/mutts/scripts/Ref_breed_curation_May21.sh
done < /seq/vgb/linda/mutts/breed_reference/breed_list_May21.txt


######## check that all of them have 16 columns!!


/seq/vgb/linda/mutts/Breed_tpeds_May21 $ wc -l *.tfam



##### get query snps to make genetic map file ####

#get list of snps in query
awk '{print $2}' /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped > /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.snps

#extract snps in query
plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed_6forPHASE \
 --extract /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.snps \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_formap



############### curate mutt data ##############

parentpath=/seq/vgb/linda/mutts
poplist=$parentpath/mendels_mutts/breed_lists/breed_lists12_may22/$thispop.txt
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
map=$parentpath/all_ancestry_dogs/DD_MM_10xg_formap.bim


#convert to tped
$vcftools --gzvcf /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.vcf.gz \
	--plink-tped \
	--out /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased

#add genetic map (col 3 of DD_MM_10xg_formap.bim)
echo "$(awk 'FNR==NR{a[NR]=$3;next}{$3=a[FNR]}1' $map /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped)" > /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped

# supportmix uses alphanumeric chr sorting, so append 0s
echo "$(awk '{$1 = sprintf("%02d", $1); print}' /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped)" > /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped


#FUCK, IT DIDN'T IMPUTE ALL THE REF SNPS !!!!

## should I even be imputing this??? I should look at supportmix etc literature. ---> they don't impute in the supportmix paper... maybe this is the way to go anway


################### move these final datasets to a no Ostrander affy folder in case we want to go back to this #########
breeds from affy that we are missing here:
Terrier, Soft Coated Wheaten
Portuguese Water Dog
Sheepdog, Old English
Saluki

mkdir /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment
mkdir ref_tpeds
mkdir DD_MM_10x_query


## copy query dataset
cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tped

cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tfam /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tfam

# copy reference dataset
cp -r /seq/vgb/linda/mutts/Breed_tpeds_May21 /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/ref_tpeds/Breed_tpeds_May21



############################# Add in Affy Ostrander into Ref dataset #######################


############## format VCF
#awk '{print $1}' /seq/vgb/linda/mutts/ostrander_data/clusterA.vcf | sort | uniq > /seq/vgb/linda/mutts/ostrander_data/clusterAsorted.vcf

## let x an y are already 39 and 41 etc.


## THIS IS THE CODE TO FIX THE SHITTY VCF ISSUES WITH THE DUPLICATES AND DOTS:
cd /seq/vgb/linda/mutts/ostrander_data
reuse VCFtools
grep '#' clusterA.vcf > clusterA_nodup_natsort.vcf
#vcf-sort -c clusterA.vcf  | grep -v '#' >> clusterA_nodup_natsort.vcf
vcf-sort -c clusterA.vcf  | grep -v '#' \
	| awk 'BEGIN {last="NA"} {if ((last != $2) && ($2 != ".") ) {print $0;} last=$2;}' \
	>> clusterA_nodup_natsort.vcf

## make snp names the location
grep '#' clusterA_nodup_natsort.vcf > ostrander_loc.vcf
grep -v '#' clusterA_nodup_natsort.vcf | awk -F '\t' 'BEGIN {OFS = FS} {$3 = "chr"$1":"$2; print $0;}' >> ostrander_loc.vcf


## this 
/seq/vgb/linda/mutts/ostrander_data/clusterA.vcf

## convert to plink
vcftools --vcf /seq/vgb/linda/mutts/ostrander_data/ostrander_loc.vcf \
    --plink \
    --out /seq/vgb/linda/mutts/ostrander_data/ostrander_loc


Writing Index file.
File contains 439201 entries and 336 individuals.
Applying Required Filters.
After filtering, kept 336 out of 336 Individuals
After filtering, kept 439201 out of a possible 439201 Sites

Unrecognized values used for CHROM: 23 - Replacing with 0.
Unrecognized values used for CHROM: 24 - Replacing with 0.

### fix chromosomes ############
perl -pe 's/^0\tchr(\d+):/$1\tchr$1:/' /seq/vgb/linda/mutts/ostrander_data/ostrander_loc.map > /seq/vgb/linda/mutts/ostrander_data/ostrander_locfix.map


### this has chrs 38, 39 and 42... not sure what those all are

########## filter at 15% cutoff for missing
plink --ped /seq/vgb/linda/mutts/ostrander_data/ostrander_loc.ped \
 --map /seq/vgb/linda/mutts/ostrander_data/ostrander_locfix.map \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt


Total genotyping rate is 0.988135.
8004 variants removed due to missing genotype data (--geno).
431197 variants and 336 dogs pass filters and QC.


####### do HWE for DD ######
# We want to remove SNPs where the MAF > 0.2 and the O/E ratio for hets is > 1 or < 0.25.
# We wrote a python script to do this: /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py
plink --bfile /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt \
  --dog \
  --hardy \
  --nonfounders \
  --noweb \
  --out /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt

use Python-2.7
python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt.hwe \
  > /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt.hwe_rmsnps
### nothing to remove


breeds from affy to get:
Terrier, Soft Coated Wheaten
Portuguese Water Dog
Sheepdog, Old English
Saluki

wheaten: --> have 10 from boyko
a550771-4306855-112317-674_B01
a550771-4306855-112317-674_B02
a550771-4306855-112317-674_B03
a550771-4306855-112317-674_B04
a550771-4306855-112317-674_B05 **
a550771-4306855-112317-674_B06 **
a550771-4306855-112317-674_B07
a550771-4306855-112317-674_B08
a550771-4306855-112317-674_B09
a550771-4306855-112317-674_B10
a550771-4306855-112317-674_B11
a550771-4306855-112317-674_B12

port water dog:
a550771-4306235-112317-922_E01
a550771-4306235-112317-922_E02
a550771-4306235-112317-922_E03
a550771-4306235-112317-922_E04
a550771-4306235-112317-922_E05
a550771-4306235-112317-922_E06
a550771-4306235-112317-922_E07
a550771-4306235-112317-922_E08
a550771-4306235-112317-922_E09
a550771-4306235-112317-922_E10
a550771-4306235-112317-922_E11
a550771-4306235-112317-922_E12

old english sheepdog
a550771-4306235-112317-922_B01
a550771-4306235-112317-922_B02
a550771-4306235-112317-922_B03
a550771-4306235-112317-922_B04
a550771-4306235-112317-922_B05
a550771-4306235-112317-922_B06
a550771-4306235-112317-922_B07
a550771-4306235-112317-922_B08
a550771-4306235-112317-922_B09
a550771-4306235-112317-922_B10
a550771-4306235-112317-922_B11
a550771-4306235-112317-922_B12

saluki: --- have 7 from boyko
a550771-4306235-112317-922_G01
a550771-4306235-112317-922_G02
a550771-4306235-112317-922_G03
a550771-4306235-112317-922_G04
a550771-4306235-112317-922_G05
a550771-4306235-112317-922_G06
a550771-4306235-112317-922_G07
a550771-4306235-112317-922_G08
a550771-4306235-112317-922_G09
a550771-4306235-112317-922_G10
a550771-4306235-112317-922_G11 *** missing
a550771-4306235-112317-922_G12

chow chow:
a550771-4306855-112317-675_D01
a550771-4306855-112317-675_D02
a550771-4306855-112317-675_D03
a550771-4306855-112317-675_D04
a550771-4306855-112317-675_D05
a550771-4306855-112317-675_D06
a550771-4306855-112317-675_D07
a550771-4306855-112317-675_D08
a550771-4306855-112317-675_D09
a550771-4306855-112317-675_D10
a550771-4306855-112317-675_D11
a550771-4306855-112317-675_D12

Italian greyhound:
a550771-4306855-112317-675_H01
a550771-4306855-112317-675_H02
a550771-4306855-112317-675_H03
a550771-4306855-112317-675_H04
a550771-4306855-112317-675_H05
a550771-4306855-112317-675_H06
a550771-4306855-112317-675_H07
a550771-4306855-112317-675_H08
a550771-4306855-112317-675_H09
a550771-4306855-112317-675_H10
a550771-4306855-112317-675_H11
a550771-4306855-112317-675_H12








can get from affy?
old english sheepdog
chow chow
italian greyhound
portuguese water dog


### when do all 4 planned breeds
431197 variants and 45 dogs pass filters and QC. --> there was one saluki and 2 old english sheepdogs missing

#have old english sheepdog from illumina data 
## saluki is pretty rare - doesn't matter

## going ahead with just theport water dog

plink --bfile /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --keep /seq/vgb/linda/mutts/ostrander_data/OstranderAffy_dogs_noOES_noSaluki.txt \
 --out /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt_mybreeds

## we get one breed and lose 3,000 snps

## when taking into account query dataset
144554-143259 = 12k snps



####### JUne1 --- have enough when combined with boyko data!!!

plink --bfile /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --keep /seq/vgb/linda/mutts/ostrander_data/AffyOstranderDogs.txt \
 --out /seq/vgb/linda/mutts/ostrander_data/affy_loc_filt_mybreeds











############# start supportmix without Elaine's affy data ############


## copy query dataset
cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tped

cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tfam /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tfam

# copy reference dataset
cp -r /seq/vgb/linda/mutts/Breed_tpeds_May21 /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/ref_tpeds/Breed_tpeds_May21




screen -dr 298
supportmix=/seq/vgb/linda/bin/SupportMixDistribution/Application/SupportMix
refpath=/seq/vgb/linda/mutts/Breed_tpeds_May21
querypath=/seq/vgb/linda/mutts/all_ancestry_dogs

$supportmix \
 --save /seq/vgb/linda/mutts/SM_outputs/May_23 \
 --window=80 \
 $refpath/airedale_terrier.tped \
 $refpath/akita.tped \
 $refpath/alaskan_malamute.tped \
 $refpath/australian_shepherd.tped \
 $refpath/basenji.tped \
 $refpath/basset_hound.tped \
 $refpath/beagle.tped \
 $refpath/belgian_sheepdog.tped \
 $refpath/belgian_tervuren.tped \
 $refpath/bernese_mountain_dog.tped \
 $refpath/bichon_frise.tped \
 $refpath/bloodhound.tped \
 $refpath/border_collie.tped \
 $refpath/border_terrier.tped \
 $refpath/borzoi.tped \
 $refpath/boston_terrier.tped \
 $refpath/boxer.tped \
 $refpath/brittany.tped \
 $refpath/bull_terrier.tped \
 $refpath/bulldog_english.tped \
 $refpath/bulldog_french.tped \
 $refpath/bullmastiff.tped \
 $refpath/cairn_terrier.tped \
 $refpath/cavalier_king_charles_spaniel.tped \
 $refpath/chesapeake_bay_retriever.tped \
 $refpath/chihuahua.tped \
 $refpath/chinese_crested.tped \
 $refpath/chinese_shar-pei.tped \
 $refpath/chow_chow.tped \
 $refpath/cocker_spaniel.tped \
 $refpath/collie.tped \
 $refpath/dachshund.tped \
 $refpath/dalmatian.tped \
 $refpath/doberman_pinscher.tped \
 $refpath/english_cocker_spaniel.tped \
 $refpath/english_setter.tped \
 $refpath/english_springer_spaniel.tped \
 $refpath/finnish_spitz.tped \
 $refpath/fox_terrier_wire.tped \
 $refpath/german_shepherd_dog.tped \
 $refpath/german_shorthaired_pointer.tped \
 $refpath/giant_schnauzer.tped \
 $refpath/golden_retriever.tped \
 $refpath/gordon_setter.tped \
 $refpath/great_dane.tped \
 $refpath/greater_swiss_mountain_dog.tped \
 $refpath/greyhound.tped \
 $refpath/havanese.tped \
 $refpath/irish_wolfhound.tped \
 $refpath/jack_russell_terrier.tped \
 $refpath/keeshond.tped \
 $refpath/labrador_retriever.tped \
 $refpath/leonberger.tped \
 $refpath/lhasa_apso.tped \
 $refpath/maltese.tped \
 $refpath/mastiff.tped \
 $refpath/miniature_pinscher.tped \
 $refpath/miniature_schnauzer.tped \
 $refpath/newfoundland.tped \
 $refpath/norfolk_terrier.tped \
 $refpath/norwegian_elkhound.tped \
 $refpath/norwich_terrier.tped \
 $refpath/nova_scotia_duck_tolling_retriever.tped \
 $refpath/old_english_sheepdog.tped \
 $refpath/papillon.tped \
 $refpath/pekingese.tped \
 $refpath/pembroke_welsh_corgi.tped \
 $refpath/pomeranian.tped \
 $refpath/poodle_toy.tped \
 $refpath/poodle.tped \
 $refpath/pug.tped \
 $refpath/rottweiler.tped \
 $refpath/saint_bernard.tped \
 $refpath/samoyed.tped \
 $refpath/schipperke.tped \
 $refpath/scottish_terrier.tped \
 $refpath/shetland_sheepdog.tped \
 $refpath/shih_tzu.tped \
 $refpath/siberian_husky.tped \
 $refpath/staffordshire_bull_terrier.tped \
 $refpath/tibetan_spaniel.tped \
 $refpath/vizsla.tped \
 $refpath/weimaraner.tped \
 $refpath/west_highland_white_terrier.tped \
 $refpath/whippet.tped \
 $refpath/wirehaired_pointing_griffon.tped \
 $refpath/yorkshire_terrier.tped \
 $querypath/DD_MM_10xg_refsnps_filt_allchr.phased.tped


 
 
############### Issue with MM and DD correspondence ######### this was used to make dog_name_mismatch.xlsx
 

# do nearest neighbor analysis
plink --bfile /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt \
 --dog \
 --neighbour 1 5 \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_neighbor






































### filter on frequency and snps used in reference dataset, only dogs we need

 --mind 0.15 \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
 --geno 0.15 \

plink --bed /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.bed \
 --bim /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_flippedloc.bim \
 --fam /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined.fam \
 --dog \
 --keep /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_needed_dogs.txt \
 --mind 0.15 \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
 --geno 0.15 \
 --make-bed \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded


148641 variants and 16 dogs pass filters and QC.

######## check from HWE

plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded


use Python-2.7
python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded.hwe \
  > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded.hwe_rmsnps



###### combine with other ostrander dataset #######

plink --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
 --bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded \
 --dog \
 --allow-no-sex \
 --make-bed --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/Ostrander_GSE90441_GSE96736_merged





###### combine with other dataset #####

plink --bfile /seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged \
 --bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded \
 --maf 0.0001 \
 --dog \
 --allow-no-sex \
 --make-bed --out /seq/vgb/linda/mutts/breed_reference/GSE90441_GSE96736_Boyko_merged

### keeping all variants ##
158507 markers loaded from
/seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged.bim.
148641 markers to be merged from
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded.bim.
Of these, 0 are new, while 148641 are present in the base dataset.
Performing single-pass merge (4416 dogs, 158507 variants).

****145845 markers in other ostrander dataset ****

## Get markers from one ostrander dataset

plink \
  --bfile /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
  --extract /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE96736/GSE96736_combined_filtneeded.snpnames \
  --make-bed \
  --dog \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_GSE96736_overlap


Total genotyping rate is 0.999233.
144764 variants and 102 dogs pass filters and QC. ---> lost a few variants






### keeping just variants in all three #####


### this has all the boyko dogs cuz some will be combinded with ostrander
plink \
	--bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
	--bmerge /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_flipped_filt_keep \
	--maf 0.0001 \
	--dog \
 	--allow-no-sex \
	--make-bed --out /seq/vgb/linda/mutts/breed_reference/GSE90441_Boyko_merged


### only keep variants in all three datasets ########






############ clean up everything and phase it ############

########## clean up notes ############
######### make methods section for data #####


































######### convert SNP names to locations ######



awk '{print $1, $1 ":" $4, $3, $4}' /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.map > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_loc.map

### change chrX to chr41
sed "s/^chrX.*chrX:/chr41\tchr41:/" /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_loc.map > /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_locX.map


######## try extracting the snps we're using

/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt

USE PLINK2
plink --ped /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.ped \
 --map /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_locX.map \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed_snplist.txt \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps


258315 MB RAM detected; reserving 129157 MB for main workspace.
Allocated 72650 MB successfully, after larger attempt(s) failed.
.ped scan complete (for binary autoconversion).
Performing single-pass .bed write (173662 variants, 795 dogs).
--file:
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps-temporary.bed
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps-temporary.bim
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps-temporary.fam
written.
173662 variants loaded from .bim file.
795 dogs (0 males, 0 females, 795 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps.nosex
.
--extract: 149860 variants remaining.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 795 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.975176.
3494 variants removed due to missing genotype data (--geno).
146366 variants and 795 dogs pass filters and QC.
Note: No phenotypes present.
--make-bed to
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps.bed
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps.bim
+
/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data_mysnps.fam
... done.






#### figure out which dog we want ---> get them compare to dogs of the same breed from boyko dataset


############ test plink files --- the snps are not ordered by chromosome or position #########

/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.map

/seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/GSE90441_CanMap2_processed_data.ped




################ screens for making plots #############

phase_query_startSM.sh --> 

screen -dr 408 working on removing bad regions --> put up until the remove file state ---> re-running chr41 didn't work

screen -dr 225 working on fix phase  -- cat: /seq/vgb/linda/mutts/breed_calling_output/test_SM_phasefix_23.tped: No such file or directory




##cleaning house

What I think I can get rid of:

unsorted bams in YRI and chimp folders
for gorilla and brown rat only the sorted remain

/seq/vgb/linda/bal_sel/from_oracle/YRI_bams
/seq/vgb/linda/bal_sel/from_oracle/chimp_bams
/seq/vgb/linda/bal_sel/from_oracle/mus_bams

ls mus_bams_chr*/*[0-9].bam (only the non-sorted ones
rm mus_bams_chr*/*[0-9].bam

ls YRI_bams_chr*/*[0-9].bam
rm YRI_bams_chr*/*[0-9].bam

ls chimp_bams_chr*/*[0-9].bam
rm chimp_bams_chr*/*[0-9].bam



########### ancient dog abba baba ###################


## fox ancestral
###### run wiht new angsd version
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_out \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_err \
   -N ${c} \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



### croatian wolf ancestral

###### run wiht new angsd version
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_out \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_err \
   -N ${c}_cro \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow_wolfanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



### quebec wolf ancestral --> somthing weong with quebec bam

while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_qout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_qerr \
   -N ${c}_que \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow_Qwolfanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



/seq/vgb/linda/abba_baba/err/ab_DX09_qerr 


### Alaska wolf ancestral --> somthing weong with quebec bam

while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_akout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_akerr \
   -N ${c}_que \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow_AKwolfanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt


Difference in BAM headers: Problem with number of chromosomes in header
Difference in BAM headers for '/seq/vgb/linda/abba_baba/finished_bams/DX01_out.sorted.bam' and '/seq/vgb/linda/abba_baba/finished_bams/Alaska_wolf_out.sorted.
bam'




####### minn wolf ######
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_minout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_minerr \
   -N ${c}_min \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow_Minnwolfanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt




####### fox and chinese village dog ######
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_minout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_minerr \
   -N ${c}_min \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_ChinVil.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



####### chinese wolf ######
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_minout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_minerr \
   -N ${c}_min \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_AncAm_Chow_Chinwolfanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt


####### chow vs chinese village ######
while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_chchout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_chcherr \
   -N ${c}_chch \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Chow_Chinvil_foxanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_minout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_minerr \
   -N ${c}_min \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Chow_Minwolf_foxanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt


while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_alcoyout \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_alcoyerr \
   -N ${c}_min \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_Chow_Alcoy_foxanc.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt



######## get rid of X chr ######



while read c; do
qsub -S /bin/bash -v indiv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ab_${c}_rmx \
   -e /seq/vgb/linda/abba_baba/err/ab_${c}_rmx \
   -N ${c}_rmx \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/run_abba_baba_rmX.sh
done < /seq/vgb/linda/abba_baba/scripts/mutt_purebred_ids.txt




######## ancient dog treemix ###

#### you can't remove transitions in angsd wiht this command... for now they are left in




######## now removes transitions ############

while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_outn_${c} \
   -e /seq/vgb/linda/mutts/err/ancmutt_errn_${c} \
   -N ${c}_Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual_June2.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt











reuse GCC-5.1
reuse Tabix
reuse VCFtools

qual=28

thisfile=allVar_allchr_June2_0miss.treeIn
parentpath=/seq/vgb/linda/TreeMix
bamlists=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists
outpath=$parentpath'/angsd_outputs_AncAM_q'$qual
names=/seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_June2.txt
migration=2


/seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$thisfile.gz \
 -root VulLag -m $migration -o $parentpath/TM_outputs_AncAM_q28/allVar_allchr_June2_0miss.treeIn_m2







qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_out_tree \
   -e /seq/vgb/linda/mutts/err/ancmutt_err_treem7 \
   -N Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/submit_treemix.sh



var/spool/sge/vert04/job_scripts/617452: line 16: 33021 Segmentation fault      (core dumped) /seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$thisfile.gz -root VulLag
 -m $migration -o $parentpath/TM_outputs'_q'$qual/$thisfile'_m'$migration
12:18pm boettger@vert02 /seq/vgb/linda/TreeMix/angsd_outputs_q28 $ more /seq/vgb/linda/mutts/err/ancmutt_err_tree
/var/spool/sge/vert04/job_scripts/617452: line 16: 33021 Segmentation fault      (core dumped) /seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$t
hisfile.gz -root VulLag -m $migration -o $parentpath/TM_outputs'_q'$qual/$thisfile'_m'$migration


reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/TM_outputs_q28/allVar_allchr_June2_0miss.treeIn_m15")



check chr35

allVar_chr35_June2_0miss.haplo.gz


qual=28

thisfile=allVar_chr35_June2_0miss.treeIn
parentpath=/seq/vgb/linda/TreeMix
bamlists=/seq/vgb/linda/abba_baba/finished_bams/bamfilelists
outpath=$parentpath'/angsd_outputs_AncAM_q'$qual
names=/seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_June2.txt
migration=2


Adding Kaylee [50/50]
/seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$thisfile.gz \
 -root VulLag -m $migration -o $parentpath/TM_outputs_AncAM_q28/allVar_allchr_June2_0miss.treeIn_m0_chr35


Adding Lab [50/50]
Adding VulLag [50/50]
Segmentation fault (core dumped)


awk '{print $1,$2,$3,$4,$5,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$24,$25,$26,$30,$51}' allVar_chr35_June2_0miss.treeIn > allVar_chr35_June2_0miss_fewerindv.treeIn


#get the chinvil this is without transitions

awk '{print $1,$2,$3,$4,$5,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$23,$25,$26,$27,$30,$32,$42,$46,$48,$50,$52}' allVar_chr35_June2_0miss.treeIn > allVar_chr35_June2_0miss_fewerindv.treeIn


reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/TM_outputs_AncAM_q28/allVar_allchr_June2_0miss.treeIn_m7_chr35")




gzip allVar_chr35_June2_0miss_fewerindv.treeIn

/seq/vgb/linda/bin/TreeMix/bin/treemix -i allVar_chr35_June2_0miss_fewerindv.treeIn.gz \
 -root VulLag -m $migration -o $parentpath/TM_outputs_AncAM_q28/allVar_allchr_June2_0miss.treeIn_m7_chr35


awk '{print $1,$2,$3,$4,$5,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$30,$32,$42,$46,$48,$50,$52}' allVar_allchr_June2_0miss.treeIn > allVar_allchr_June2_0miss_fewerindv.treeIn




qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_out_tree \
   -e /seq/vgb/linda/mutts/err/ancmutt_err_treemfew10 \
   -N Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/submit_treemix.sh


allVar_chr35_June2_0miss_fewerindv.treeIn




reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/TM_outputs_AncAM_q28/allVar_allchr_June2_0miss_fewerindv.treeIn_m7_queue")






################## consolidate the abba baba results (last line of every file in directory ###########

cd /seq/vgb/linda/abba_baba/jackKnife_results/AncAm

tail -q -n1 * | grep "ChowA" > /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm.txt



# remove the middle columns
awk '{print $1, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm.txt > /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm_e1.txt


# sort by the Z score 
awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm_e1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm_e2.txt

### replace with names I want
sed -i -E "s/Comet_out.sorted.bam/Golden_Retriever/" *.txt
sed -i -E "s/Husky_out.sorted.bam/Siberian_Husky/" *.txt
sed -i -E "s/LE_1306_control.bam/Leonberger/" *.txt
sed -i -E "s/Woody_out.sorted.bam/CorgiB/" *.txt
sed -i -E "s/Mavis_out.sorted.bam/CorgiC/" *.txt
sed -i -E "s/PortugalVill_out.sorted.bam/Portugal_Vill/" *.txt
sed -i -E "s/ChineseVill_out.sorted.bam/Chinese_Vill/" *.txt
sed -i -E "s/DX09/mutt_Rudy/" *.txt
sed -i -E "s/DX01/mutt_Skeeter/" *.txt
sed -i -E "s/DX05/mutt_Rhoda/" *.txt
sed -i -E "s/DX07/mutt_Finch/" *.txt
sed -i -E "s/D183/mutt_Esme/" *.txt
sed -i -E "s/D198/mutt_Sandy/" *.txt
sed -i -E "s/DX04/mutt_Tui/" *.txt
sed -i -E "s/D132/mutt_Clarence/" *.txt
sed -i -E "s/DX08/mutt_Jaime/" *.txt
sed -i -E "s/D131/mutt_Hopper/" *.txt
sed -i -E "s/D182/mutt_Skyler/" *.txt
sed -i -E "s/D184/mutt_Lucky/" *.txt
sed -i -E "s/DX06/mutt_Lily/" *.txt
sed -i -E "s/DX11/mutt_Vera-Lynn/" *.txt
sed -i -E "s/DX02/mutt_Hunter/" *.txt
sed -i -E "s/D157/mutt_Beskow/" *.txt
sed -i -E "s/DX03/mutt_Reily/" *.txt
sed -i -E "s/D158/mutt_Kaylee/" *.txt
sed -i -E "s/DX10/mutt_Jack/" *.txt
sed -i -E "s/D181/mutt_Gus/" *.txt
sed -i -E "s/D199/mutt_Scotch/" *.txt


### print line for mutt closer to chow than to ancinet american

 sed '3q;d' * | grep "ChowA" > /seq/vgb/linda/abba_baba/jackKnife_results/Negcloser_to_chowA.txt

tail -q -n1 * | grep "ChowA" > /seq/vgb/linda/abba_baba/jackKnife_results/all_vs_AncAm.txt


awk 'FNR==2{print $0,FILENAME}' *.txt | grep "ChowA" | awk 'NF{NF--};1' > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowA.txt

awk '{print $3, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowA.txt > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowAe1.txt

awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowAe1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowAsort.txt


awk 'FNR==2{print $0,FILENAME}' *.txt | grep "ChowB" | awk 'NF{NF--};1' > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowB.txt

awk '{print $3, $NF}' /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowB.txt > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowBe1.txt

awk '{print $NF,$0}' /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowBe1.txt | sort | cut -f2- -d' ' > /seq/vgb/linda/abba_baba/jackKnife_results/AncAm/summary/Negcloser_to_chowBsort.txt









##################### New dataset percent of each breed SNPs matching coyote ##########

a550771-4306235-112317-918_F07.CEL	Coyote


## copy query dataset
cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tped /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tped

cp /seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt_allchr.phased.tfam /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/DD_MM_10x_query/DD_MM_10xg_refsnps_filt_allchr.phased.tfam

# copy reference dataset
cp -r /seq/vgb/linda/mutts/Breed_tpeds_May21 /seq/vgb/linda/mutts/no_Oaffy_ancestry_assignment/ref_tpeds/Breed_tpeds_May21




### remove missnps
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/allOstrander_Boyko_DD_merged-merge.missnp

plink --bfile /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/allOstrander_Boyko_DD_merged-merge.missnp \
 --out /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtrmmisnp



merge with DD
plink --bfile /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed \
 --bmerge /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtrmmisnp.bed \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtrmmisnp.bim \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filtrmmisnp.fam \
 --extract /seq/vgb/linda/mutts/ostrander_data/ostrander_illumina/boyko_ost_snp_overlap.txt \
 --maf 0.0001 \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/allOstrander_Boyko_DD_merged

#get hamming distance
--distance 


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/allOstrander_Boyko_DD_merged \
 --dog \
 --allow-no-sex \
 --distance square \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist_allost_boyko_dd

#grep for line number

grep -n 'a550771-4306235-112317-918_F07.CEL' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist_allost_boyko_dd.dist.id

#124:a550771-4306235-112317-918_F07.CEL	a550771-4306235-112317-918_F07.CEL


awk ' NR == 124 ' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/all_dist_allost_boyko_dd.dist > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/hamming_dist/coyote_vs_allnew.dist


149737 variants loaded from .bim file.



# kill all my jobs delete all jobs
qdel $(qstat | grep boettger | grep -Po '^\s+\d+' | perl -pe 's/\n/ /')







########### admix tools #######

git clone https://github.com/DReichLab/AdmixTools.git AdmixTools_v4.1


##### jesse's variant calling piepline

/seq/vgb/jmcclure/wgs


to add something
./queue add sheltie /seq/vgb/linda/abba_baba/finished_bams/Sheltie_out.sorted.bam


./queue add dalmatian /seq/vgb/linda/abba_baba/finished_bams/Dalmatian_out.sorted.bam
./queue add greyhound /seq/vgb/linda/abba_baba/finished_bams/Greyhound_out.sorted.bam
./queue add labrador /seq/vgb/linda/abba_baba/finished_bams/Labrador_out.sorted.bam
./queue add rottweiler /seq/vgb/linda/abba_baba/finished_bams/Rottweiler_out.sorted.bam
./queue add sheltie /seq/vgb/linda/abba_baba/finished_bams/Sheltie_out.sorted.bam
./queue add ancient_american /seq/vgb/linda/abba_baba/finished_bams/AL3194_rmdup.bam
./queue add chinese_village /seq/vgb/linda/abba_baba/finished_bams/ChineseVill_out.sorted.bam
./queue add chowA /seq/vgb/linda/abba_baba/finished_bams/ChowChowA_out.sorted.bam
./queue add chowB /seq/vgb/linda/abba_baba/finished_bams/ChowChowB_out.sorted.bam
./queue add GoldenR_comet /seq/vgb/linda/abba_baba/finished_bams/Comet_out.sorted.bam
./queue add portugal_village /seq/vgb/linda/abba_baba/finished_bams/PortugalVill_out.sorted.bam
./queue add chihuhuaA /seq/vgb/linda/abba_baba/finished_bams/ChihuahuaA_out.sorted.bam
./queue add chihuhuaB /seq/vgb/linda/abba_baba/finished_bams/ChihuahuaB_out.sorted.bam
./queue add AL_coyote /seq/vgb/linda/abba_baba/finished_bams/al_coy_out.sorted.bam
./queue add CA_coyote /seq/vgb/linda/abba_baba/finished_bams/cal_coy_out.sorted.bam
./queue add MEX_wolf /seq/vgb/linda/abba_baba/finished_bams/mex_wolf_out.sorted.bam
./queue add Yel_wolf /seq/vgb/linda/abba_baba/finished_bams/yellow_wolf_out.sorted.bam
./queue add husky /seq/vgb/linda/abba_baba/finished_bams/Husky_out.sorted.bam
./queue add Min_wolf /seq/vgb/linda/abba_baba/finished_bams/Minn_wolf_out.sorted.bam
./queue add german_shepherd /seq/vgb/linda/abba_baba/finished_bams/German_Shepherd_out.sorted.bam
./queue add Euro_wolf /seq/vgb/linda/abba_baba/finished_bams/CroatWolf_out.sorted.bam
./queue add China_wolf /seq/vgb/linda/abba_baba/finished_bams/ChineseWolf_out.sorted.bam


#### my calls from before live here:
/seq/vgb/jmcclure/wgs2/gvcfs


########### admix tools #######

git clone https://github.com/DReichLab/AdmixTools.git AdmixTools_v4.1



You will need to be able to link GNU Scientific library(gsl) , BLAS, gfortran, and prpbably lapack.  
This Makefile expects opeenblas but other versions of BLAS should be OK.  Edit the Makefile 
appropriately.

use OpenBLAS

cd src;  make clobber; make all; make install.  Eexcutables will be in ../bin

A Makefile that worked for a Mac (El Capitan) is in src/Makefile.mac

Nick Patterson


/broad/software/free/Linux/redhat_6_x86_64/pkgs/gcc_5.1.0/bin/ld: cannot find -lopenblas
/broad/software/free/Linux/redhat_6_x86_64/pkgs/gcc_5.1.0/bin/ld: cannot find -lopenblas
collect2: error: ld returned 1 exit status
make: *** [qpAdm] Error 1

solved with use OpenBLAS


/seq/vgb/linda/bin/AdmixTools_v4.1/src


/broad/software/free/Linux/redhat_6_x86_64/pkgs/openblas_0.2.8



Look at Eigenstrat files I've made before:
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.ind
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.snp
/seq/vgb/linda/admixture/boyko_2016/fixing_boyko/cornell_canine_EIGEN.eigenstratgeno


Steps to making my input:


1. Convert .haplo files to plink
2. Convert mutts to plink  /seq/vgb/jmcclure/wgs/vcfs/WGS-snps-filtered.vcf (keep only mutts)
3. merge breed dogs, ancient dog and mutts
4. convert to eighenstrat



D131	D132	D157	D158_2	D181_2	D182	D183	D184	D198	D199	DX01	DX02	DX03	DX04	DX05	DX06	DX07	DX08	DX09	DX10	DX11	GR_12340_OSA	GR_12341_OSA	GR_199_142_BLSA	GR_199_8_
TLSA	GR_199_94_TLSA	GR_3691_OSA	GR_382523_BLSA	GR_393049_BLSA	IW_05_47_A	IW_10_7_295_A	IW_10_7_66_A	IW_3543_A	IW_46941_A	IW_OS_19_A	L
AB_153818_1	LAB_153823_1	LAB_153829_1	LAB_162226_1	LAB_162347_1	LAB_166518_1	LAB_3704_1	LE0493_1	LE_0048_control	LE_0096_HSA	LE_0116_H
SA	LE_0316_control	LE_0454_HSA	LE_0734_OSA	LE_0812_HSA	LE_0823_OSA	LE_114725_OSA	LE_1160_control	LE_1306_control	MB140_Normal	MB2A11_Normal	M
B2C13_Normal	NEWMET_Normal	SHAKIT_Normal

vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/WGS-snps-filtered.vcf \
  --plink-tped \
  --keep /seq/vgb/linda/AdmixTools_data/mutts/my_mutts.txt \
  --out /seq/vgb/linda/AdmixTools_data/mutts/mutts21

boettger@vert02:/seq/vgb/linda/AdmixTools_data/mutts $ head -10 mutts21.tped
1	chr1:838	0	838	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
1	chr1:865	0	865	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
1	chr1:867	0	867	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
1	chr1:872	0	872	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
1	chr1:954	0	954	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
1	chr1:1064	0	1064	0	0	0	0	0	0	0	0	T	T	0	0	0	0	T	T	0
1	chr1:1123	0	1123	C	C	0	0	C	C	C	C	C	C	0	0	C	C	C	C	C
1	chr1:1208	0	1208	C	C	0	0	0	0	C	G	C	C	0	0	C	C	C	C	C
1	chr1:1209	0	1209	G	G	0	0	0	0	G	G	G	G	G	G	G	G	G	G	G
1	chr1:1214	0	1214	G	G	G	G	G	G	G	T	G	G	G	G	G	G	G	G	G
boettger@vert02:/seq/vgb/linda/AdmixTools_data/mutts $ head -10 mutts21.tfam
D131	D131	0	0	0	0
D132	D132	0	0	0	0
D157	D157	0	0	0	0
D158_2	D158_2	0	0	0	0
D181_2	D181_2	0	0	0	0
D182	D182	0	0	0	0
D183	D183	0	0	0	0
D184	D184	0	0	0	0
D198	D198	0	0	0	0
D199	D199	0	0	0	0



/seq/vgb/linda/TreeMix/angsd_outputs_AncAM_q28


awk -F'|' '{print NF; exit}' allVar_chr38_June2_0miss_tester.haplo



### make temp tpeds for each chr, combine later ########
while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/admix_${c} \
   -e /seq/vgb/linda/mutts/err/admixt_${c} \
   -N ${c}_maketped \
   -p -10 \
   /seq/vgb/linda/AdmixTools_data/scripts/haplo_to_tped.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt

################# put chromosomes together #########
cd /seq/vgb/linda/TreeMix/angsd_outputs_AncAM_q28

cat allVar_chr1_June2_0miss_tmp.tped \
allVar_chr2_June2_0miss_tmp.tped \
allVar_chr3_June2_0miss_tmp.tped \
allVar_chr4_June2_0miss_tmp.tped \
allVar_chr5_June2_0miss_tmp.tped \
allVar_chr6_June2_0miss_tmp.tped \
allVar_chr7_June2_0miss_tmp.tped \
allVar_chr8_June2_0miss_tmp.tped \
allVar_chr9_June2_0miss_tmp.tped \
allVar_chr10_June2_0miss_tmp.tped \
allVar_chr11_June2_0miss_tmp.tped \
allVar_chr12_June2_0miss_tmp.tped \
allVar_chr13_June2_0miss_tmp.tped \
allVar_chr14_June2_0miss_tmp.tped \
allVar_chr15_June2_0miss_tmp.tped \
allVar_chr16_June2_0miss_tmp.tped \
allVar_chr17_June2_0miss_tmp.tped \
allVar_chr18_June2_0miss_tmp.tped \
allVar_chr19_June2_0miss_tmp.tped \
allVar_chr20_June2_0miss_tmp.tped \
allVar_chr21_June2_0miss_tmp.tped \
allVar_chr22_June2_0miss_tmp.tped \
allVar_chr23_June2_0miss_tmp.tped \
allVar_chr24_June2_0miss_tmp.tped \
allVar_chr25_June2_0miss_tmp.tped \
allVar_chr26_June2_0miss_tmp.tped \
allVar_chr27_June2_0miss_tmp.tped \
allVar_chr28_June2_0miss_tmp.tped \
allVar_chr29_June2_0miss_tmp.tped \
allVar_chr30_June2_0miss_tmp.tped \
allVar_chr31_June2_0miss_tmp.tped \
allVar_chr32_June2_0miss_tmp.tped \
allVar_chr33_June2_0miss_tmp.tped \
allVar_chr34_June2_0miss_tmp.tped \
allVar_chr35_June2_0miss_tmp.tped \
allVar_chr36_June2_0miss_tmp.tped \
allVar_chr37_June2_0miss_tmp.tped \
allVar_chr38_June2_0miss_tmp.tped \
> /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss.tped

rm *_tmp.tped


### make tfam (done by hand using /seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_June2.txt) ###



#### convert both to binary #####

## some are triallelic, I think this is because of fox
1 chr1:167995 0 167995 G G G G G G C C G G G G G G G G G G G G G G G G G G G G C C G G G G G G G G G G G G A A G G G G G G G G G G G G G G C C G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G

### convert ancestrals ###
## extract snps in mutts that aren't triallelic on merge
plink --tfile /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss \
 --remove /seq/vgb/linda/AdmixTools_data/ancestrals/fox.txt \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/AdmixTools_data/mutts/muttsnps.txt \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss
1706680 variants and 51 dogs pass filters and QC.

##when kept everything
Total genotyping rate in remaining samples is 0.997498.
5969472 variants and 51 dogs pass filters and QC.


### convert mutts ### -- this only goes to chr24????!!!
plink --tfile /seq/vgb/linda/AdmixTools_data/mutts/mutts21 \
 --dog \
 --allow-no-sex \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged.missnp \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/mutts/mutts21



## merge into one file 
plink --bfile /seq/vgb/linda/AdmixTools_data/mutts/mutts21 \
 --bmerge /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss.bed \
 /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss.bim \
 /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_June2_0miss.fam \
 --dog \
 --allow-no-sex \
 --maf 0.001 \
 --recode \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged

## triallelic from first try
Error: 1749 variants with 3+ alleles present.
/seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged-merge.missnp

################ convert to eigenstrat ##########

/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb/linda/AdmixTools_data/eigenstrat/plink_to_eigen_param.txt


Tui ignored
VeraLynn ignored
Yellow_wolf ignored
all individuals set ignore.  Likely input problem (col 6)
resetting all individual...
genotype file processed
numvalidind:     72  maxmiss: 72001
eigenstrat output
##end of convertf run

worked!!!


### now run 3 pop test ###

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_chowb_ancam.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/test_output



/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_ancam_v_many.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/ancam_5breeds_mutts.txt


### replace with names I want
sed -i -E "s/DX09/mutt_Rudy/" ancam_5breeds_mutts.txt
sed -i -E "s/DX01/mutt_Skeeter/" ancam_5breeds_mutts.txt
sed -i -E "s/DX05/mutt_Rhoda/" ancam_5breeds_mutts.txt
sed -i -E "s/DX07/mutt_Finch/" ancam_5breeds_mutts.txt
sed -i -E "s/D183/mutt_Esme/" ancam_5breeds_mutts.txt
sed -i -E "s/D198/mutt_Sandy/" ancam_5breeds_mutts.txt
sed -i -E "s/DX04/mutt_Tui/" ancam_5breeds_mutts.txt
sed -i -E "s/D132/mutt_Clarence/" ancam_5breeds_mutts.txt
sed -i -E "s/DX08/mutt_Jaime/" ancam_5breeds_mutts.txt
sed -i -E "s/D131/mutt_Hopper/" ancam_5breeds_mutts.txt
sed -i -E "s/D182/mutt_Skyler/" ancam_5breeds_mutts.txt
sed -i -E "s/D184/mutt_Lucky/" ancam_5breeds_mutts.txt
sed -i -E "s/DX06/mutt_Lily/" ancam_5breeds_mutts.txt
sed -i -E "s/DX11/mutt_Vera-Lynn/" ancam_5breeds_mutts.txt
sed -i -E "s/DX02/mutt_Hunter/" ancam_5breeds_mutts.txt
sed -i -E "s/D157/mutt_Beskow/" ancam_5breeds_mutts.txt
sed -i -E "s/DX03/mutt_Reily/" ancam_5breeds_mutts.txt
sed -i -E "s/D181_2/mutt_Gus/" ancam_5breeds_mutts.txt
sed -i -E "s/D158_2/mutt_Kaylee/" ancam_5breeds_mutts.txt
sed -i -E "s/D199/mutt_Scotch/" ancam_5breeds_mutts.txt
sed -i -E "s/DX10/mutt_Jack/" ancam_5breeds_mutts.txt
sed -i -E "s/ChowB/ChowChow/" ancam_5breeds_mutts.txt
sed -i -E "s/GerShep/GermanShepherd/" ancam_5breeds_mutts.txt
sed -i -E "s/GoldenRet/GoldenRetriever/" ancam_5breeds_mutts.txt


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_ancAm_v_all.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/ancam_11breedssheltie_mutts.txt

sed -i -E "s/DX09/mutt_Rudy/" ancam_11breeds_mutts.txt
sed -i -E "s/DX01/mutt_Skeeter/" ancam_11breeds_mutts.txt
sed -i -E "s/DX05/mutt_Rhoda/" ancam_11breeds_mutts.txt
sed -i -E "s/DX07/mutt_Finch/" ancam_11breeds_mutts.txt
sed -i -E "s/D183/mutt_Esme/" ancam_11breeds_mutts.txt
sed -i -E "s/D198/mutt_Sandy/" ancam_11breeds_mutts.txt
sed -i -E "s/DX04/mutt_Tui/" ancam_11breeds_mutts.txt
sed -i -E "s/D132/mutt_Clarence/" ancam_11breeds_mutts.txt
sed -i -E "s/DX08/mutt_Jaime/" ancam_11breeds_mutts.txt
sed -i -E "s/D131/mutt_Hopper/" ancam_11breeds_mutts.txt
sed -i -E "s/D182/mutt_Skyler/" ancam_11breeds_mutts.txt
sed -i -E "s/D184/mutt_Lucky/" ancam_11breeds_mutts.txt
sed -i -E "s/DX06/mutt_Lily/" ancam_11breeds_mutts.txt
sed -i -E "s/DX11/mutt_Vera-Lynn/" ancam_11breeds_mutts.txt
sed -i -E "s/DX02/mutt_Hunter/" ancam_11breeds_mutts.txt
sed -i -E "s/D157/mutt_Beskow/" ancam_11breeds_mutts.txt
sed -i -E "s/DX03/mutt_Reily/" ancam_11breeds_mutts.txt
sed -i -E "s/D181_2/mutt_Gus/" ancam_11breeds_mutts.txt
sed -i -E "s/D158_2/mutt_Kaylee/" ancam_11breeds_mutts.txt
sed -i -E "s/D199/mutt_Scotch/" ancam_11breeds_mutts.txt
sed -i -E "s/DX10/mutt_Jack/" ancam_11breedssheltie_mutts.txt


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_ancAm_X_JackJaime.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/ancAm_X_JackJaime.txt




##################### my phylogeny with qp graph ###################

See examples/runit for some simple examples and sample output

Sample parameter file
DIR:   ../data
S1:              sim1           
indivname:       DIR/S1.ind  
snpname:         DIR/S1.snp       
genotypename:    DIR/S1.geno  
outpop:         Out     
blgsize:        0.05
## block size in Morgans for Jackknife
## see below 
lsqmode:       YES
diag:          .0001
hires:         YES
initmix:      1000 
precision:    .0001  
zthresh:      3.0
terse:        NO
useallsnps:   NO


-p parfile specifies input data (any Reich lab format) 

outpop:   zzz
f-stats normalized by heterozygosity in population zzz 
outpop:  NULL  has special meaning : no normalization 
blgsize: block size for Jackknife (Morgans)
lsqmode:   Default is NO;  Estimate of error covariance is used.  Unstable for large problems 
 and instead we fit f_3 stats with "base" population first label (see graph spec)
diag:   small fudge factor to add on diagonal of f3.  Improves stability
Given admixing weights the edge lengths (drifts) are set by minimizing 
a degree 2 function, subject to non-negativity of the lengths.  
Initially the program tries V initial tries of admixing weights 
defailt value for V is 10 . 2^n where there are n admixtures in the graph. 
To override this default

initmix:   V  
where V is the desired number of initial tries.  This may be useful 
if you are worried the program may not have found the global optimum. 

hires:   controls output sometimes more decimals are desired
precision:  controls accuracy of recovereed admixture weights.  Coefficients will be within "precision" of MLE estimate.
zthresh: controls outlier output.  All f-stats are calculated and those diverging more then "zthresh" from fitted values 
 printed.e all SNPs even if some populations hav e n data for a SNP (default NO) 

-g graph  
See examples.qpGraph/gr1x 
Note comments can be included in file. Begin a line with #

[-o outgraph]  This can be hand edited and input again.  Note format is different. 

[-d dotfile]  Graph output in "dot format";  dot -Tps < dotfile > dotfile.ps gives postscript
"dot" must be installed (part of Graphviz) 



##### questions
1. what is my output? outpop:   zzz, f-stats normalized by heterozygosity in population zzz 


reuse OpenBLAS
reuse GCC-5.1
reuse Tabix
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/par_qpgraph.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_qpgraph.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/stout_qpgraph

seed: -1500871692
bad open /seq/vgb/linda/AdmixTools_data/eigenstrat/graph
fatalx:
can't open file /seq/vgb/linda/AdmixTools_data/eigenstrat/graph of type r
 error info: No such file or directory
Aborted (core dumped)


nodata:       chr24:47689877
nodata:       chr24:47689879
outpop: Chinese_wolf
population:   0         Chinese_wolf    1
population:   1                 DX10    1
population:   2                 DX08    1
population:   3            AncAm_dog    1
before setwt numsnps: 6157737  outpop: Chinese_wolf
setwt numsnps: 0
fatalx:
no valid snps
Aborted (core dumped)

I think I need to order the populations Im looking at like the 3 pop test. I think I need to label the edges...

"f-stats normalized by heterozygosity in population zzz " --> I think I need to make it NULL


###### make the plot
use Graphviz
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/shitgraph1.ps




#### run qpGraph
reuse OpenBLAS
reuse GCC-5.1
reuse Tabix
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/par_qpgraph.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_qpgraph.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/stout_qpgraph


###### make the plot
use Graphviz
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/shitgraph1.ps

##### test new graph
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpreroot -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_qpgraph.dbg.txt -d junk.dot

#( makes a junk.ps, graph looks correct)

##### run qpGraph with new topology
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/par_qpgraph.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_qpgraph2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/stout_qpgraph

###### make the plot
use Graphviz
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/not_shitgraph1.ps



###### get fastq for ancient american dog from bam june 15, 2017 ######

/seq/vgb/linda/abba_baba/scripts/bam_to_fastq_ancAm.sh


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/fastqAA \
   -e /seq/vgb/linda/abba_baba/err/fastqAA \
   -N fastqAA \
   -wd /seq/vgb/linda/abba_baba/err \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/bam_to_fastq_ancAm.sh




qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/ancAm_align \
   -e /seq/vgb/linda/abba_baba/err/ancAm_align \
   -N ancAm_align \
   -wd /seq/vgb/linda/abba_baba/err \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/Ancam_align_filter.sh




########## try to make plot nick made #########

##### run qpGraph with new topology
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/par_qpgraph.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_nicktopo.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/stout_qpgraph


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpreroot -g /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_outgraph -o /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topor_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.toporeroot_dotfile -r R

###### make the plot
use Graphviz

##re-rooted
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_graph1.ps

##re-rooted
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.toporeroot_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_graph1reroot.ps



###################### add more purebred dogs #############

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/par_qpgraph.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/graph_onemore.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/onemore.topo_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/onemore_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/stout_qpgraph


dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/onemore_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/nick.topo_graph1more.ps



fatalx:
> 2 edges at X
Aborted (core dumped)

# when I try to put 3 into admixed dog
fatalx:
qpGraph: only binary admixture supported



next: only binary admixture supported
next: looping

### looks like no star pattern available in nick's paper:
http://www.genetics.org/content/192/3/1065.figures-only


DX08	JaimeDX10	Jack

Hi Nick,

I haven't gotten variant calls back yet, but I'm curious about your thoughts on the proper sequence of admixtures to create the mutts. Currently have dog breeds mixing prior to incorporating the coyote and then the ancient American dog, but the order could have been (likely was) different than this. How much does the admixture sequence matter for the final result? Is there a better way that I should be organizing this?

I'll also try to get variant calls on a golden jackal or a fox to use as the outgroup since we may decide to add intorgression from wolves and coyotes. 

Thanks,
Linda





############## make pseudohaploid individuals from vcf
https://www.biostars.org/p/236160/


1. copy one chromosome to my folder
cp 435.PASS.SNP.chr37.vcf.gz /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.chr37.vcf.gz

cp 435.PASS.SNP.chr37.vcf.gz.tbi /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.chr37.vcf.gz.tbi


2. test out pseudohaploid code on this chromosome
3. make pipeline for all chrs -- keep only individuals that I want
### wanted_ostrandervcf_indvs.txt has all clades in Parker et al.  except Pumi/puli purple clade (hungarian hurding dogs)


while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/happlink \
   -e /seq/vgb/linda/abba_baba/err/happlink \
   -N ${c}_pseudohap \
   -wd /seq/vgb/linda/abba_baba/err \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/vcf_to_plink_haploid.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt

#put the vcf files together  screen -dr 303
reuse VCFtools

vcf-concat \
 435.PASS.SNP_pseudohaploidfix.chr1.vcf \
 435.PASS.SNP_pseudohaploidfix.chr2.vcf \
 435.PASS.SNP_pseudohaploidfix.chr3.vcf \
 435.PASS.SNP_pseudohaploidfix.chr4.vcf \
 435.PASS.SNP_pseudohaploidfix.chr5.vcf \
 435.PASS.SNP_pseudohaploidfix.chr6.vcf \
 435.PASS.SNP_pseudohaploidfix.chr7.vcf \
 435.PASS.SNP_pseudohaploidfix.chr8.vcf \
 435.PASS.SNP_pseudohaploidfix.chr9.vcf \
 435.PASS.SNP_pseudohaploidfix.chr10.vcf \
 435.PASS.SNP_pseudohaploidfix.chr11.vcf \
 435.PASS.SNP_pseudohaploidfix.chr12.vcf \
 435.PASS.SNP_pseudohaploidfix.chr13.vcf \
 435.PASS.SNP_pseudohaploidfix.chr14.vcf \
 435.PASS.SNP_pseudohaploidfix.chr15.vcf \
 435.PASS.SNP_pseudohaploidfix.chr16.vcf \
 435.PASS.SNP_pseudohaploidfix.chr17.vcf \
 435.PASS.SNP_pseudohaploidfix.chr18.vcf \
 435.PASS.SNP_pseudohaploidfix.chr19.vcf \
 435.PASS.SNP_pseudohaploidfix.chr20.vcf \
 435.PASS.SNP_pseudohaploidfix.chr21.vcf \
 435.PASS.SNP_pseudohaploidfix.chr22.vcf \
 435.PASS.SNP_pseudohaploidfix.chr23.vcf \
 435.PASS.SNP_pseudohaploidfix.chr24.vcf \
 435.PASS.SNP_pseudohaploidfix.chr25.vcf \
 435.PASS.SNP_pseudohaploidfix.chr26.vcf \
 435.PASS.SNP_pseudohaploidfix.chr27.vcf \
 435.PASS.SNP_pseudohaploidfix.chr28.vcf \
 435.PASS.SNP_pseudohaploidfix.chr29.vcf \
 435.PASS.SNP_pseudohaploidfix.chr30.vcf \
 435.PASS.SNP_pseudohaploidfix.chr31.vcf \
 435.PASS.SNP_pseudohaploidfix.chr32.vcf \
 435.PASS.SNP_pseudohaploidfix.chr33.vcf \
 435.PASS.SNP_pseudohaploidfix.chr34.vcf \
 435.PASS.SNP_pseudohaploidfix.chr35.vcf \
 435.PASS.SNP_pseudohaploidfix.chr36.vcf \
 435.PASS.SNP_pseudohaploidfix.chr37.vcf \
 | bgzip > 435.PASS.SNP_pseudohaploidfix.allchr.vcf.gz



### correct individuals gotten already
vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP_pseudohaploidfix.allchr.vcf.gz \
 --plink \
 --positions /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals_loc.txt \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf






4. then merge these with /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged ---> get rid of haploid mutts.. Skyler etc (encoded

#### THIS IS MY DATA, NOT FROM OSTRANDER LAB #####

plink --bfile /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged \
 --keep /seq/vgb/linda/abba_baba/scripts/dipMutts_hapOthers.txt \
 --make-bed \
 --dog \
 --recode \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals

## change the names
sed -i -E "s/DX09/mutt_Rudy/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX01/mutt_Skeeter/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX05/mutt_Rhoda/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX07/mutt_Finch/" dipMutts_hapAncestrals.fam
sed -i -E "s/D183/mutt_Esme/" dipMutts_hapAncestrals.fam
sed -i -E "s/D198/mutt_Sandy/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX04/mutt_Tui/" dipMutts_hapAncestrals.fam
sed -i -E "s/D132/mutt_Clarence/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX08/mutt_Jaime/" dipMutts_hapAncestrals.fam
sed -i -E "s/D131/mutt_Hopper/" dipMutts_hapAncestrals.fam
sed -i -E "s/D182/mutt_Skyler/" dipMutts_hapAncestrals.fam
sed -i -E "s/D184/mutt_Lucky/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX06/mutt_Lily/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX11/mutt_Vera-Lynn/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX02/mutt_Hunter/" dipMutts_hapAncestrals.fam
sed -i -E "s/D157/mutt_Beskow/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX03/mutt_Reily/" dipMutts_hapAncestrals.fam
sed -i -E "s/D181_2/mutt_Gus/" dipMutts_hapAncestrals.fam
sed -i -E "s/D158_2/mutt_Kaylee/" dipMutts_hapAncestrals.fam
sed -i -E "s/D199/mutt_Scotch/" dipMutts_hapAncestrals.fam
sed -i -E "s/DX10/mutt_Jack/" dipMutts_hapAncestrals.fam
sed -i -E "s/ChihuB/Chihuahua/" dipMutts_hapAncestrals.fam
sed -i -E "s/ChowB/ChowChow/" dipMutts_hapAncestrals.fam
sed -i -E "s/Chin_wolf/Chinese_wolf/" dipMutts_hapAncestrals.fam
sed -i -E "s/Cal_coy/California_coyote/" dipMutts_hapAncestrals.fam
sed -i -E "s/GerShep/GermanShepherd/" dipMutts_hapAncestrals.fam
sed -i -E "s/Yellow_wolf/Yellowstone_wolf/" dipMutts_hapAncestrals.fam
sed -i -E "s/Midwst_coy/Midwest_coyote/" dipMutts_hapAncestrals.fam
sed -i -E "s/AncAm_dog/AncientAmerican_dog/" dipMutts_hapAncestrals.fam
sed -i -E "s/Mex_wolf/Mexican_wolf/" dipMutts_hapAncestrals.fam
sed -i -E "s/GoldenRet/GoldenRetriever/g" dipMutts_hapAncestrals.fam
sed -i -E "s/European_wolf/European_wolf/g" dipMutts_hapAncestrals.fam



 versions are diploid
5. also merge with diploid version of fox, golden wolf, wolf etc. 

### combine with ostrander vcf diploids ----REMEMBER CHR38 IS MISSING
cd /seq/vgb/rawData/435_dog_data 

'reuse VCFtools
vcf-concat \
 435.PASS.SNP.chr1.vcf.gz \
 435.PASS.SNP.chr2.vcf.gz \
 435.PASS.SNP.chr3.vcf.gz \
 435.PASS.SNP.chr4.vcf.gz \
 435.PASS.SNP.chr5.vcf.gz \
 435.PASS.SNP.chr6.vcf.gz \
 435.PASS.SNP.chr7.vcf.gz \
 435.PASS.SNP.chr8.vcf.gz \
 435.PASS.SNP.chr9.vcf.gz \
 435.PASS.SNP.chr10.vcf.gz \
 435.PASS.SNP.chr11.vcf.gz \
 435.PASS.SNP.chr12.vcf.gz \
 435.PASS.SNP.chr13.vcf.gz \
 435.PASS.SNP.chr14.vcf.gz \
 435.PASS.SNP.chr15.vcf.gz \
 435.PASS.SNP.chr16.vcf.gz \
 435.PASS.SNP.chr17.vcf.gz \
 435.PASS.SNP.chr18.vcf.gz \
 435.PASS.SNP.chr19.vcf.gz \
 435.PASS.SNP.chr20.vcf.gz \
 435.PASS.SNP.chr21.vcf.gz \
 435.PASS.SNP.chr22.vcf.gz \
 435.PASS.SNP.chr23.vcf.gz \
 435.PASS.SNP.chr24.vcf.gz \
 435.PASS.SNP.chr25.vcf.gz \
 435.PASS.SNP.chr26.vcf.gz \
 435.PASS.SNP.chr27.vcf.gz \
 435.PASS.SNP.chr28.vcf.gz \
 435.PASS.SNP.chr29.vcf.gz \
 435.PASS.SNP.chr30.vcf.gz \
 435.PASS.SNP.chr31.vcf.gz \
 435.PASS.SNP.chr32.vcf.gz \
 435.PASS.SNP.chr33.vcf.gz \
 435.PASS.SNP.chr34.vcf.gz \
 435.PASS.SNP.chr35.vcf.gz \
 435.PASS.SNP.chr36.vcf.gz \
 435.PASS.SNP.chr37.vcf.gz \
 435.PASS.SNP.chr38.vcf.gz \
 435.PASS.SNP.chrX.vcf.gz \
 | bgzip > MY_PATH/435.PASS.SNP.allchr.vcf.gz'

########## get chr38 ####

cd /seq/vgb/rawData/435_dog_data 

cp 435.PASS.SNP.chr38.vcf.gz /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.chr38.vcf.gz

cp 435.PASS.SNP.chr38.vcf.gz.tbi /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.chr38.vcf.gz.tbi


---> this is on screen -dr 298

## add snp names

vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchr.vcf.gz \
 --positions /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals_loc.txt \
 --keep /seq/vgb/linda/abba_baba/scripts/dipAncestrals_ostrandervcf.txt \
 --plink \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf

--positions /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals_loc.txt

chr1    439     .       A       G

in screen -dr 303


## convert to loc
awk '{print $1, "chr"$1":"$4, "0", $4}' /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf.map > /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfloc.map


## convert to plink binary and only keep snps we want
plink --ped /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf.ped \
 --map /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfloc.map \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.missnp \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf

## change names
cd /seq/vgb/linda/AdmixTools_data/eigenstrat
sed -i -E "s/Wolf01/Wolf01_diploid/g" dipAncestrals_fromostrandervcf.fam
sed -i -E "s/WolfTibetan03/WolfTibetan03_diploid/g" dipAncestrals_fromostrandervcf.fam
sed -i -E "s/GoldenJackal01/GoldenJackal01_diploid/g" dipAncestrals_fromostrandervcf.fam
sed -i -E "s/AndeanFox01/AndeanFox01_diploid/g" dipAncestrals_fromostrandervcf.fam


##################################### combeine the three files ############################################## June 23, 2017

A.   ### combine my data with ostrander breed haploids ####

#change mapfile for all locations
awk '{print $1, "chr"$1":"$4, "0", $4}' /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.map > /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcfloc.map



plink --map /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcfloc.map \
 --ped /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.ped \
 --dog \
 --make-bed \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_mergedboth.missnp \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf

#done above instead
## some have rsids, convert to position
#awk '{print $1, "chr"$1":"$4, "0", $4, $5, $6}' /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.bim > /#seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcfloc.bim

plink --bfile /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals \
 --bmerge /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.bed \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.bim \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploids_fromOstrandervcf.fam \
 --dog \
 --allow-no-sex \
 --make-bed \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_mergedboth.missnp \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_merged

### Total genotyping rate is 0.652283 --> I may want to filter at some cutoff ###

cat /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_mergednew.missnp /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_merged.missnp > /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_mergedboth.missnp

## remove the misssnps (done above) 
/seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_merged.missnp

B. merge with Ostrander diploids
plink --bfile /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_merged \
 --bmerge /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf.bed \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf.bim \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcf.fam \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/both.missnp \
 --dog \
 --allow-no-sex \
 --recode \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged


#combine both missnps (used above )
cat /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.missnp /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_merged.missnp > /seq/vgb/linda/AdmixTools_data/eigenstrat/both.missnp




6. convert to eigenstrat

############## REMEMEBER genetic distance set from physical distance !!! --- CAN I DO IT BETTER??!!

/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb/linda/AdmixTools_data/eigenstrat/plink_to_eigen_paramJune2.txt

all individuals set ignore.  Likely input problem (col 6)
resetting all individual...
genotype file processed
numvalidind:    157  maxmiss: 157001
eigenstrat output
##end of convertf run

genooutfilename:   /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.geno
snpoutfilename:    /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.snp
indoutfilename:    /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.ind


#### look at some dogs compared to a dog from each clade in ostrander paper

#add population names as individual names
awk '{print $1,$2,$1}' /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged.ind > /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_mergedPOP.ind

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_eachclade_ancam_2mutts.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3_par_eachclade_ancam_2mutts_OUT.txt

screen -dr 298
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_eachclade_calcoy_2mutts.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3_par_eachclade_calcoy_2mutts_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_eachclade_yellowwolf_2mutts.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3_par_eachclade_yellowstone_wolf_2mutts_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_par_eachclade_eurowolf_2mutts.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3_par_eachclade_eurowolf_2mutts_OUT.txt


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_GSD_allmutt_canids.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3par_GSD_allmutt_canids_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Chow_allmutt_canids.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/qp3par_Chow_allmutt_canids_OUT.txt


####### run qpGraph for Jack  on screen -dr 250
reuse OpenBLAS
reuse GCC-5.1

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile.ps


nodata:       chr24:47691005
nodata:       chr24:47691007
outpop: GoldenJackal01_diploid
population:   0      SiberianHusky01    1
population:   1  ancientAmerican_dog    1
population:   2           ChowChow01    1
population:   3            Minn_wolf    1
population:   4       Midwest_coyote    1
population:   5            mutt_Jack    1
population:   6 GoldenJackal01_diploid    0
fatalx:
zero popsize: GoldenJackal01_diploid
Aborted (core dumped)

#maybe the root and outpop are not supposed to be the same? --- yes, looks like it works now that outpop is set to null


## reroot it

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpreroot -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_outgraph \
  -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_outgraph_reroot \
  -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile_reroot \
  -r R 

## plot
use Graphviz
##re-rooted
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile_reroot -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile_reroot.ps





reuse OpenBLAS
reuse GCC-5.1

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Gus_1breed.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile.ps

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpreroot -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_outgraph \
  -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_outgraph_reroot \
  -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile_reroot \
  -r R 

##re-rooted
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile_reroot -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile_reroot.ps





###### run top mutts with all breeds vs canids

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Jack.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Jack_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_jaime.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Jaime_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Gus.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Gus_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Beskow.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Beskow_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Scotch.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Scotch_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Sandy.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Sandy_OUT.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qp3Pop -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_inputs/qp3par_Lily.txt > /seq/vgb/linda/AdmixTools_data/eigenstrat/qp3_outs/Lily_OUT.txt






Questions for NICK:
Could the results be explained through admixture from a breed that gives a positive z score (Elaine’s yellow clade)? 

how can we estimate the proportion of coyote, wolf, ancient American?

Genetic distance currently set from physical distance – how much does this matter for qpGraph?

How much does the admixture sequence matter? ‘only binary admixture supported’

How much do bam/vcf filters matter? Three datasets with potentially different filters were merged. (We would need Elaine’s bams to fix this)



/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/dog_wolf_coyote.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

It doesn't think fox is a good outgroup to coyote and wolf (minn)
And Min And Mid 0.000000 -0.543416 -0.543416 0.010224 -53.152

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/dog_wolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DW_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DW_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DW_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DW_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DW.ps

Yikes!! it doesn't believe that fox is ancestral to dog and wolf /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/dog_wolf.txt :: And Yel And Ger 0.000000 -0.536512 -0.536512 0.010470 -51.241


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_wolfoutpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/W_2D.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/W_2D_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/W_2D_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/W_2D_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/W_2D_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/W_2D.ps

##ugh!!!
/seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/W_2D.txt Wol Box Wol Ger 0.000000 -0.500000 -0.500000 0.003945 -126.740


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/fox_dogs.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/FD_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/FD_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/FD_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/FD_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/FD_dotfile.ps


#### use nick's topo, use actual samples
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_wolfoutpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/nick_topo.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/NT_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/NT_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/NT_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/NT_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/NT_dotfile.ps

Relates to putting the root as the outpop

with outpop=NULL
anc mut anc mut 0.616377 0.616481 0.000105 0.004824 0.022


########### try with outpop = NULL
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/dog_wolf_coyote.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Jack_dotfile.ps



/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Gus_1breed.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/Gus_dotfile


## admix both coyote and wolf
reuse OpenBLAS
reuse GCC-5.1

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/coy_wolf_both_admix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/jack_basic_wolf_to_coy_1cfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

North American wolves are closer to asian wolves
file:///Users/boettger/Downloads/fevo-04-00134.pdf

best graphs: 

jack_basic_wolf_to_coy_1c.pdf
Euro_domesticationfix.pdf


## try basic with out
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_domesticationfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt


## maybe I should be using inbreed?
inbreed: YES  Use if some populations are pseudo-diploid and all population sizes >= 2  
Without this single samples (like MA1) can bus used, but the edge-length leading to the leaf
is not meaningful.
#fatalx:
#(minpos) zero diag
# Aborted (core dumped)



### VERY basic ###
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

## Null root the sigma is 0
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

## fox root the sigma is 42

### add ancient american dog --NULL out 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt



## look at simple with mutt
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_mutt.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

## with fox as out -- -42  
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_mutt.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

### having the outpop be diploid -- wont it always look like intermediate freq to two haploid pops??


## more wolf

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_2wolf_coy_mutt.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt



####################### BUILD FROM VERY BASIC GRAPH ############

## NICK'S ORIGINAL -- NULL OUTPOP 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_nick.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## NICK'S ORIGINAL -- diploid wolf as OUTPOP 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_Tibwolf_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_nick.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt





## NICK'S ORIGINAL -- NULL OUTPOP -- Wolf01_diploid

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_wolf_GSD_AA_mutt.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


#### with wolf as outpop ###

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_wolf_outpop.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_wolf_GSD_AA_mutt.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



################## add in ancient american to fox thing
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt

perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


################## add in breed dogs

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa_BD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

##### add admixture to fix chow chow --- 204 z
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa_BDadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### asian dog into chow and ancinet american dog --- still bad -- 10 
basic_fox_wolf_coy_BDtoaa.txt
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_BDtoaa.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


#include urasian wolf --- still bad -- 10 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa_BD_Eurasianwolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## put coyote into AA -- 0% still bad -- 10 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coyAAadmix_BD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



#### make asian dogs monophyletic  --- no --worse 39
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_fox_wolf_coy_aa_BD_asianmono.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### check with asian wolf no coy or NA wolf  --- 39
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_asianwolf_aa_chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



#### asian wolf into asian breeds --- Yes!!! -.5
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_asianwolf_aa_chow_admix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### add in GSD --- bad 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/basic_asianwolf_aa_chow_admix_GSD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### add euro wolf -- asian domestication
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Asiandomest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

      Cho        Eur        Cho        Eur       1.033968     0.879059    -0.154909     0.003948   -39.238 


### add euro wolf -- Euro domestication
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Eurodomest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

      Eur        Ger        Eur        Ger       0.973494     0.789004    -0.184490     0.004729   -39.016

### add euro wolf -- admix domestication
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/admix_domsest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

      Cho        Eur        Cho        Eur       0.979559     0.879059    -0.100500     0.003948   -25.457
      Cho        Ger        Cho        Ger       0.980722     0.900605    -0.080117     0.003849   -20.817


### admix domestication without breeds -- 6
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/admix_domsest_nobreeds.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      anc        Eur        Wol        Eur       0.584527     0.574740    -0.009787     0.002689    -3.640 
      Wol        Eur        Wol        Eur       1.050440     1.040011    -0.010428     0.002707    -3.852 



### asian domestication without breeds -- 21
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Asian_domest_nobreeds.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### Euro domestication without breeds -- 6 ----> USING THIS ONE SINCE IT IS JUST AS GOOD AS ADMIXTURE !!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_domest_nobreeds.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
anc        Eur        Wol        Eur       0.583412     0.574740    -0.008673     0.002689    -3.226 
Wol        Eur        Wol        Eur       1.050622     1.040011    -0.010610     0.002707    -3.919 



## domesticate before wolf split -- 21
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/domest_first_nobreeds.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



### euro domestication -- use china wolf instead of tibetan  --- yikes -- 52!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_domest_nobreeds_chinwolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
anc        Eur        Chi        Eur       0.487632     0.386190    -0.101442     0.002656   -38.197 
Chi        Eur        Chi        Eur       0.971101     0.772116    -0.198985     0.004340   -45.844 


### our wolf samples are admixed?? -- it hates this 240!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_domest_nobreeds_wadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      anc        Wol        anc        Wol       1.228693     0.905632    -0.323061     0.002490  -129.759 
---> maybe needed nodes inbetween???
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_domest_nobreeds_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
YES!! worst f-stat:       And        anc        And        anc       0.932752     0.932215    -0.000537     0.001947    -0.276 



#### look at same wolf admixture -- asian domestication
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Asian_domest_nobreeds_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        anc        And        anc       0.932752     0.932215    -0.000537     0.001947    -0.276 



#### look at same wolf admixture -- dog is also admixed
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_nobreeds_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
worst f-stat:       And        anc        And        Wol       0.450869     0.450347    -0.000522     0.002044    -0.255 


###look at same wolf admixture  -- dog diverges first  -- very bad !!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/dogfirst_domest_nobreeds_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        anc        Wol        Eur       0.000000     0.053123     0.053123     0.002419    21.959 


#### woves and dog admixed -- add chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chow_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
anc        Eur        Cho        Eur       0.484172     0.449007    -0.035165     0.002558   -13.750 
      Wol        Cho        Wol        Cho       0.966604     0.977218     0.010614     0.002766     3.837 
      Wol        Cho        Wol        Eur       0.490545     0.561981     0.071436     0.003324    21.491 
      Wol        Cho        Cho        Eur      -0.476059    -0.415237     0.060822     0.002495    24.375 
      Wol        Eur        Wol        Eur       1.012692     1.029994     0.017303     0.002821     6.134 
      Wol        Eur        Cho        Eur       0.522146     0.468013    -0.054133     0.002685   -20.165 
      Cho        Eur        Cho        Eur       0.998205     0.883250    -0.114955     0.003927   -29.269 

### let euro wolf go into chow  -- yikes 40 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chowadmix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

      anc        Wol        Wol        Eur      -0.418769    -0.461127    -0.042357     0.002583   -16.397 
      anc        Wol        Cho        Eur       0.002275    -0.019006    -0.021282     0.002125   -10.013 
      anc        Eur        anc        Eur       1.049913     1.005475    -0.044437     0.002963   -14.999 
      anc        Eur        Wol        Eur       0.600143     0.568868    -0.031275     0.002664   -11.740 




#admixed wolf into chow  --- no asian wolf!!! 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chow2admix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
anc        Wol        anc        Eur       0.449997     0.436608    -0.013389     0.002178    -6.146 
      anc        Wol        Wol        Cho      -0.421264    -0.442120    -0.020857     0.002370    -8.801 
      anc        Wol        Wol        Eur      -0.419025    -0.461127    -0.042102     0.002583   -16.298 
      anc        Eur        anc        Eur       1.050029     1.005475    -0.044553     0.002963   -15.038 
      anc        Eur        Wol        Eur       0.600032     0.568868    -0.031164     0.002664   -11.699 
      anc        Eur        Cho        Eur       0.469107     0.449007    -0.020100     0.002558    -7.859 



####let euro wolf go into pre chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chowadmixfix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       anc        Wol        Cho        Eur       0.000107    -0.019006    -0.019113     0.002125    -8.992 




### let admixed go into prechow 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chow2admixfix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
worst f-stat:       anc        Wol        Cho        Eur       0.000107    -0.019006    -0.019113     0.002125    -8.992 

##pre-chow into AA???
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_2domest_prechow2AA.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
worst f-stat:       anc        Wol        Cho        Eur       0.000107    -0.019006    -0.019113     0.002125    -8.992 

### just 2 sep domestications
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_2domest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      And        Wol        Cho        Eur      -0.000092    -0.015050    -0.014958     0.001699    -8.803 
      anc        Wol        Cho        Eur       0.000107    -0.019006    -0.019113     0.002125    -8.992 
### WHAT I LEARNED -- CHOW AND EUROPEAN WOLF ARE VERY SIMILAR -- MAKE DOG COME FROM EURO WOLF THEN CHOW - ANCIENT AMERICAN IS SEPARETE

### chow and european wolf from same wolf population
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Eurodomestchow_2domest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      anc        Wol        Cho        Eur       0.000000    -0.019006    -0.019006     0.002125    -8.942 



#### One domestication ###
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/EuroDomest_chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      Cho        Eur        Cho        Eur       1.017575     0.883250    -0.134326     0.003927   -34.201 

## 1 domest with admix -- very bad
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_chowadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      anc        Cho        Cho        Eur       0.000000    -0.434243    -0.434243     0.002648  -164.013 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_chowadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      Cho        Eur        Cho        Eur       1.017542     0.883250    -0.134293     0.003927   -34.193
      anc        Eur        Cho        Eur       0.522196     0.449007    -0.073190     0.002558   -28.617 


### from z instead
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_chowZadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps
      anc        Eur        anc        Eur       1.046413     1.005475    -0.040937     0.002963   -13.818 
      anc        Wol        Cho        Eur       0.009722    -0.019006    -0.028728     0.002125   -13.516 
anc        Cho        Wol        Eur       0.141664     0.100855    -0.040809     0.003376   -12.090 

###### 2 domestications on different continents 22.209 tot
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/EurAs2dom_AA_chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      anc        Cho        Wol        Cho       0.562047     0.535097    -0.026950     0.002510   -10.738 
      anc        Cho        Wol        Eur       0.124441     0.100855    -0.023586     0.003376    -6.987 
      anc        Eur        anc        Eur       1.038756     1.005475    -0.033280     0.002963   -11.233 
      anc        Eur        Wol        Cho       0.136247     0.119861    -0.016386     0.003116    -5.258 
      anc        Eur        Wol        Eur       0.595931     0.568868    -0.027064     0.002664   -10.159 
 
###  2 domestications on different continents with admixture -- off z -- individual numbers worse 22.209 tot
      anc        Wol        Wol        Eur      -0.408040    -0.461127    -0.053087     0.002583   -20.550 
      anc        Cho        Wol        Cho       0.570591     0.535097    -0.035493     0.002510   -14.142 
      anc        Cho        Wol        Eur       0.137041     0.100855    -0.036186     0.003376   -10.720 
      anc        Eur        anc        Eur       1.040051     1.005475    -0.034576     0.002963   -11.670


### chow from euro wolf -- a bit of AA mixed in
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_Eurochow2admixfix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      And        Wol        Cho        Eur      -0.000081    -0.015050    -0.014969     0.001699    -8.809 
      And        Cho        anc        Wol      -0.031310    -0.022282     0.009028     0.002458     3.673 
      And        Eur        anc        Wol      -0.031216    -0.041288    -0.010072     0.002562    -3.932 
      And        Eur        Wol        Eur       0.615152     0.621978     0.006826     0.002240     3.048 
      anc        Wol        anc        Cho       0.446014     0.455614     0.009600     0.002177     4.411 
      anc        Wol        anc        Eur       0.446108     0.436608    -0.009500     0.002178    -4.361 
      anc        Wol        Wol        Cho      -0.449975    -0.442120     0.007854     0.002370     3.314 
      anc        Wol        Wol        Eur      -0.449881    -0.461127    -0.011246     0.002583    -4.353 
      anc        Wol        Cho        Eur       0.000094    -0.019006    -0.019100     0.002125    -8.986 
      anc        Cho        Wol        Eur       0.113155     0.100855    -0.012301     0.003376    -3.644 
      Wol        Cho        Wol        Cho       0.990850     0.977218    -0.013633     0.002766    -4.929 


## from zz not mix of as and euro -- worse
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_Eurochow2admixfixAD_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      anc        Wol        Wol        Eur      -0.413072    -0.461127    -0.048054     0.002583   -18.602 



#pre-chow into ancient asian dog?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_Eurochow2AAdmixfix_wadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



## 1 domestication in Europe -- aa admix with asian wolf -- -8.991
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

      And        Wol        Cho        Eur      -0.000091    -0.015050    -0.014959     0.001699    -8.804 
      And        Cho        anc        Wol      -0.031312    -0.022282     0.009030     0.002458     3.673 
      And        Eur        anc        Wol      -0.031207    -0.041288    -0.010082     0.002562    -3.935 
      And        Eur        Wol        Eur       0.615176     0.621978     0.006803     0.002240     3.037 
      anc        Wol        anc        Cho       0.446019     0.455614     0.009595     0.002177     4.408 
      anc        Wol        anc        Eur       0.446124     0.436608    -0.009516     0.002178    -4.368 
      anc        Wol        Wol        Cho      -0.449984    -0.442120     0.007864     0.002370     3.318 
      anc        Wol        Wol        Eur      -0.449879    -0.461127    -0.011248     0.002583    -4.354 
      anc        Wol        Cho        Eur       0.000105    -0.019006    -0.019111     0.002125    -8.991 
      anc        Cho        Wol        Eur       0.113195     0.100855    -0.012340     0.003376    -3.656 
      Wol        Cho        Wol        Cho       0.990863     0.977218    -0.013645     0.002766    -4.934 
      Wol        Cho        Cho        Eur      -0.427789    -0.415237     0.012553     0.002495     5.031 
      Wol        Eur        Wol        Eur       1.015147     1.029994     0.014847     0.002821     5.263 
      Wol        Eur        Cho        Eur       0.452074     0.468013     0.015939     0.002685     5.937

### asian wolf admixed with ancient dog?? meh, same 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Admix_domest_chowtowolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Wol        Cho        Eur      -0.000092    -0.015050    -0.014958     0.001699    -8.803 
      And        Cho        anc        Wol      -0.031307    -0.022282     0.009025     0.002458     3.672 
      And        Eur        anc        Wol      -0.031200    -0.041288    -0.010088     0.002562    -3.938 
      And        Eur        Wol        Eur       0.615160     0.621978     0.006818     0.002240     3.044 
      anc        Wol        anc        Cho       0.446008     0.455614     0.009606     0.002177     4.413 
      anc        Wol        anc        Eur       0.446115     0.436608    -0.009507     0.002178    -4.364 
      anc        Wol        Wol        Cho      -0.449971    -0.442120     0.007851     0.002370     3.313 
      anc        Wol        Wol        Eur      -0.449865    -0.461127    -0.011262     0.002583    -4.360 
      anc        Wol        Cho        Eur       0.000106    -0.019006    -0.019113     0.002125    -8.992 
      anc        Cho        Wol        Eur       0.113192     0.100855    -0.012337     0.003376    -3.655 
      Wol        Cho        Wol        Cho       0.990850     0.977218    -0.013633     0.002766    -4.929 
      Wol        Cho        Cho        Eur      -0.427794    -0.415237     0.012557     0.002495     5.032 
      Wol        Eur        Wol        Eur       1.015136     1.029994     0.014858     0.002821     5.267 
      Wol        Eur        Cho        Eur       0.452080     0.468013     0.015933     0.002685     5.935


## unadmixed croatian wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      And        Wol        Cho        Eur       0.000000    -0.015050    -0.015050     0.001699    -8.857 
      And        Cho        anc        Wol      -0.031348    -0.022282     0.009066     0.002458     3.688 
      And        Eur        anc        Wol      -0.031348    -0.041288    -0.009941     0.002562    -3.880 
      And        Eur        Wol        Eur       0.615187     0.621978     0.006791     0.002240     3.032 
      anc        Wol        anc        Cho       0.446001     0.455614     0.009613     0.002177     4.417 
      anc        Wol        anc        Eur       0.446001     0.436608    -0.009393     0.002178    -4.312 
      anc        Wol        Wol        Cho      -0.449974    -0.442120     0.007853     0.002370     3.314 
      anc        Wol        Wol        Eur      -0.449974    -0.461127    -0.011153     0.002583    -4.317 
      anc        Wol        Cho        Eur       0.000000    -0.019006    -0.019006     0.002125    -8.942 
      anc        Cho        Wol        Eur       0.113141     0.100855    -0.012287     0.003376    -3.640 
      Wol        Cho        Wol        Cho       0.990968     0.977218    -0.013750     0.002766    -4.971 
      Wol        Cho        Cho        Eur      -0.427853    -0.415237     0.012616     0.002495     5.056 
      Wol        Eur        Wol        Eur       1.015132     1.029994     0.014862     0.002821     5.269 
      Wol        Eur        Cho        Eur       0.452017     0.468013     0.015996     0.002685     5.958 


############ adding North American stuff on current best ###########
current best: Euro1Domest_AAadmixfix_ewnoadmix.txt  (-8.942)

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_NAadd.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
       And        Yel        Cho        Yel       0.440832     0.424853    -0.015979     0.001578   -10.126
      And        Yel        anc        Wol       0.000000    -0.016954    -0.016954     0.002086    -8.129 
      And        Eur        anc        Wol      -0.019427    -0.043030    -0.023602     0.002676    -8.821 
      And        Wol        And        Eur       0.496364     0.478071    -0.018293     0.002286    -8.002 
      Cho        Yel        Cho        Yel       1.053490     1.028121    -0.025369     0.002856    -8.884 



#### connect chow and ancinet wolf -- better! 12 -- this was without GSD (bad label)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_NAaddsimp.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      And        Wol        Cho        Eur       0.003522    -0.015672    -0.019193     0.001766   -10.871 
      And        Wol        Cho        Yel      -0.013059    -0.031733    -0.018675     0.002081    -8.973 
      And        Wol        Cho        Mid      -0.038998    -0.054850    -0.015851     0.002013    -7.874 
      And        Yel        anc        Wol       0.000000    -0.016954    -0.016954     0.002086    -8.129 

## with GSD 11.482 ************* best with all *******************
      anc        Wol        Wol        Yel      -0.429749    -0.448499    -0.018750     0.002319    -8.086 
      And        Wol        Cho        Eur       0.003613    -0.015376    -0.018989     0.001737   -10.935 
      And        Wol        Cho        Yel      -0.009667    -0.031297    -0.021631     0.002037   -10.620
      And        Wol        Cho        Ger       0.003613    -0.014158    -0.017772     0.001827    -9.725 


 




## #### connect chow and ancinet wolf -- Ancient and Eurasian wolf make Asian wolf -14.594 -- Asian wolf and Yellowstone wolf not monophyletic!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/ancient_eurasian_toAsian.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
worst f-stat:       And        Wol        Cho        Yel      -0.001571    -0.031297    -0.029727     0.002037   -14.594 



### dog mix of euro and asian wolf (again) -- 50 hate!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_NAaddsimp.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



## mix chow with breeds and asian wolf -- 17
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_chowAsbreed.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

      And        Yel        Cho        Yel       0.434873     0.418951    -0.015922     0.001580   -10.077 

###admix to make ancient asian wolf that mixes to make chow chow -- no still 11.42 0% asian wolf contributing
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_chowAsAnbreed.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## admix Yellowstone wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_NAaddw.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

### ancinent vs american wolf into yellowstone -- same 11 --- very few negatives --- strange
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_NAaddNAw.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Mid        Wol        Eur       0.000000     0.022983     0.022983     0.002002    11.482 
      And        Mid        anc        Wol       0.000000    -0.013184    -0.013184     0.001795    -7.345 


### earlier split ancient_asian_wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_AAw.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Mid        Wol        Eur       0.000000     0.022983     0.022983     0.002002    11.482 
anc        Wol        Wol        Eur      -0.456568    -0.474210    -0.017642     0.002697    -6.541 
anc        Wol        Wol        Yel      -0.428225    -0.448499    -0.020274     0.002319    -8.743 
### wtf they coyote is only 15% coyote



#Ancinent wolf into Asian wolf -- try asian + ancient asian to make tibetan wolf? -- worse 14.031
#Asian is not admixed with ancient wolf!!!!! 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_AAadmixfix_ewnoadmix_AAwad.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
anc        Cho        Wol        Cho       0.573571     0.550374    -0.023198     0.002687    -8.632 
      anc        Cho        Wol        Yel       0.013397    -0.007036    -0.020433     0.002464    -8.292 
      anc        Cho        Wol        Mid       0.011153    -0.010002    -0.021155     0.002228    -9.496 
anc        Wol        Wol        Yel      -0.422985    -0.448499    -0.025514     0.002319   -11.003 
      anc        Wol        Wol        Mid      -0.422985    -0.445050    -0.022065     0.002171   -10.164 


... but I checked this.. they aren't monophyletic... ? and european comes off after???

#### put asian node first 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro1Domest_rmnode.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      anc        Wol        Wol        Yel      -0.428248    -0.448499    -0.020251     0.002319    -8.733 
      anc        Wol        Wol        Mid      -0.428248    -0.445050    -0.016802     0.002171    -7.740 
      And        Mid        anc        Wol       0.000000    -0.013184    -0.013184     0.001795    -7.345 
      And        Yel        anc        Wol       0.000000    -0.016633    -0.016633     0.002052    -8.107 



### move asian no -- 51
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/move_asian_wolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

      anc        Eur        Cho        Yel       0.000000    -0.126647    -0.126647     0.003196   -39.626 
      anc        Eur        Cho        Mid       0.000000    -0.125893    -0.125893     0.003076   -40.932 



#### add admixture to asian move -- 17
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/move_asian_wolf_AAadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Yel        Wol        Cho       0.000000     0.037253     0.037253     0.002184    17.058 
      anc        Wol        Wol        Yel      -0.424516    -0.448499    -0.023983     0.002319   -10.342 
      anc        Wol        Wol        Mid      -0.424516    -0.445050    -0.020534     0.002171    -9.459 
      And        Yel        Cho        Yel       0.434909     0.418951    -0.015959     0.001580   -10.100 



 
### rm ancinet asian  -- 17
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/move_asian_wolf_Ancient.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      anc        Wol        Wol        Yel      -0.424516    -0.448499    -0.023983     0.002319   -10.342 
     And        Yel        Cho        Yel       0.434915     0.418951    -0.015964     0.001580   -10.103 
      And        Yel        Cho        Mid       0.009554    -0.005866    -0.015420     0.002227    -6.924 
      And        Yel        Cho        Ger       0.000000    -0.011384    -0.011384     0.001721    -6.617
      And        Yel        anc        Wol       0.000000    -0.016633    -0.016633     0.002052    -8.107 
      And        Yel        Wol        Cho       0.000000     0.037253     0.037253     0.002184    17.058 


#### no american wolf ancient to admix yellowstone  -- 17
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/move_asian_wolf_Ancient_toadmixYel.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
worst f-stat:       And        Yel        Wol        Cho       0.000000     0.037253     0.037253     0.002184    17.058 
      anc        Wol        Wol        Yel      -0.424516    -0.448499    -0.023983     0.002319   -10.342 
      And        Yel        anc        Wol       0.000000    -0.016633    -0.016633     0.002052    -8.107 




##### move asian off first then american then eurpean -- 14 -- coyote messed up still
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/move_Asianw_first.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

worst f-stat:       And        Wol        anc        Cho       0.000000     0.027655     0.027655     0.001971    14.031 
      And        Mid        Cho        Ger       0.004515    -0.010787    -0.015302     0.001516   -10.096 
      anc        Wol        Wol        Yel      -0.425929    -0.448499    -0.022570     0.002319    -9.733 
      anc        Wol        Wol        Mid      -0.425363    -0.445050    -0.019686     0.002171    -9.068 
      And        Mid        Cho        Eur       0.004515    -0.007855    -0.012370     0.001541    -8.029 
      And        Wol        Cho        Eur       0.000000    -0.015376    -0.015376     0.001737    -8.854 
      And        Wol        Cho        Yel      -0.009687    -0.031297    -0.021610     0.002037   -10.609 
      And        Wol        Cho        Mid      -0.034365    -0.054169    -0.019804     0.001977   -10.016 


### asian wolf and coyote are clade??
worst f-stat:       And        Wol        Cho        Mid      -0.002365    -0.054169    -0.051803     0.001977   -26.199 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/asianW_coy_clade.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      Wol        Yel        Mid        Ger      -0.014199    -0.045529    -0.031329     0.002729   -11.482 
      Wol        Mid        Mid        Ger      -0.411501    -0.443866    -0.032365     0.002276   -14.220 
      anc        Ger        Wol        Yel       0.025267    -0.004262    -0.029529     0.002545   -11.601 


#### BACK TO BASICS -- EUROWOLF,  COYOTE,  ASIAN WOLF, YELLOWSTONE WOLF ###

### coy and asian -- 26.127
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/coy_As_Am_Eu.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      Yel        Mid        Yel        Mid       0.866052     0.814823    -0.051229     0.002950   -17.367 
      And        Mid        Yel        Mid       0.414742     0.379076    -0.035666     0.001776   -20.082 
      And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 
      And        Wol        Yel        Mid       0.000000    -0.023641    -0.023641     0.001757   -13.453 


## coy and american -- -13.453
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/coy_Am_As_Eu.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Eur        Yel        Mid       0.000000    -0.026201    -0.026201     0.002101   -12.474 
      And        Wol        Yel        Mid       0.000000    -0.023641    -0.023641     0.001757   -13.453 


reuse OpenBLAS
reuse GCC-5.1
###Coy and European -- 26.127 ---> out 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/coy_EU_Am_As.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphb -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_outb.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCb.ps
      And        Mid        Yel        Mid       0.415998     0.379076    -0.036922     0.001776   -20.789 
      And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 
      And        Wol        And        Mid       0.475908     0.443831    -0.032077     0.002027   -15.828 



### asian then coy --  19.661 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/asian_thencoy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphb -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_outb.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCb.ps
      And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 
      And        Eur        Wol        Mid       0.028711    -0.016222    -0.044934     0.002572   -17.472 
      And        Mid        Yel        Mid       0.407704     0.379076    -0.028628     0.001776   -16.119 


### did that relate to the asian wolf --> trying european off first!
worst f-stat:       And        Mid        Wol        Yel       0.000000     0.055745     0.055745     0.002134    26.127 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Euro_thencoy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphb -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_outb.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfileb > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixb -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCb.ps


 
### did that relate to the asian wolf --> trying Yellow off first!
worst f-stat:       And        Mid        Wol        Yel       0.000000     0.055745     0.055745     0.002134    26.127 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/yellow_thencoy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## coy off first
worst f-stat:       And        Mid        Wol        Yel       0.000000     0.055745     0.055745     0.002134    26.127 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/coy_off_first.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Mid        Wol        Yel       0.000000     0.055745     0.055745     0.002134    26.127 
      And        Mid        Yel        Mid       0.409579     0.379076    -0.030503     0.001776   -17.175 
      Yel        Mid        Yel        Mid       0.868061     0.814823    -0.053238     0.002950   -18.048 


### asian first with admixture 
worst f-stat:       And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/AsianFirst_admix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 
      And        Wol        Yel        Mid       0.000000    -0.023641    -0.023641     0.001757   -13.453

## coy admix with c0 (pre-wolftib)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/AsianFirst_admix_coy.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
 And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 


### asian wolf then euro -- -18.207
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/asian_theneuro.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Eur        Mid       0.000000    -0.039284    -0.039284     0.002158   -18.207 

   And        Wol        Yel        Mid       0.000000    -0.023641    -0.023641     0.001757   -13.453


## try asian wolf off first in previous best   -- -26
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch_Euro1Domest_AAadmixfix_ewnoadmix_AAw.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Mid      -0.002365    -0.054169    -0.051804     0.001977   -26.199 
      And        Wol        Cho        Yel      -0.002365    -0.031297    -0.028933     0.002037   -14.204 
      And        Wol        Cho        Mid      -0.002365    -0.054169    -0.051804     0.001977   -26.199


### ASIAN WOLF IS NOT IN COYOTE!!!! 0% PREDICTED-- PLEASE REMEMBER THIS
## admix coyote with asian wolf -- 26
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch_coyadmix_AAw.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
And        Wol        Cho        Mid      -0.002369    -0.054169    -0.051799     0.001977   -26.197 


#################### moving around clades from the 11 score ##################
############ remember A -> B of length 0 suggests that maybe B should be ancestral to A

1#### asian is most ancestral -13 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch1_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
 And        Wol        Cho        Mid      -0.026939    -0.054169    -0.027230     0.001977   -13.771 
### there was a 0 above canid below asian wolf -- coyote leaves first


2### coyote then asian wolf ## -11
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch2_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
And        Wol        Cho        Eur       0.004463    -0.015376    -0.019839     0.001737   -11.424 

3##### asian directly to European -11.424
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch3_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Eur       0.004463    -0.015376    -0.019838     0.001737   -11.424 


4### dog comes off of Eurasian wolf -11.423 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch4_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
And        Wol        Cho        Eur       0.004461    -0.015376    -0.019837     0.001737   -11.423 

5 ## eliminate extra eurowolf clades  -11.423 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch5_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Eur       0.004461    -0.015376    -0.019837     0.001737   -11.423 
!!!! notice that the ancient dog shares no length with the breed domestications !!! I should remove the dog thing next

6 ### move asian between ancient and Eurpean clades####  11.482 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch6_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
And        Mid        Wol        Eur       0.000000     0.022983     0.022983     0.002002    11.482 

7 ##### GO BACK TO 5 AND ADD ADMIXTURE ###

asian wolf into chow instead of ancient asian?? YES, CHOW COULD BE MIXED WITH ASIAN WOLF, NOT QUITE AS GOOD AS ANCINET ASIAN
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch7_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
And        Wol        Cho        Eur       0.004824    -0.015376    -0.020199     0.001737   -11.632 
And        Wol        Cho        Ger       0.004824    -0.014158    -0.018982     0.001827   -10.387 
And        Yel        Cho        Eur       0.005910    -0.011575    -0.017485     0.001709   -10.230 
And        Yel        Cho        Ger       0.005910    -0.011384    -0.017294     0.001721   -10.052 
And        Mid        Cho        Ger       0.005017    -0.010787    -0.015804     0.001516   -10.427 
And        Wol        Cho        Yel      -0.013969    -0.031297    -0.017328     0.002037    -8.507 

8 ## asian bifurcates into euro and ancient/european?


##test dog /wolf thing
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch8_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

worst f-stat:       And        Wol        Cho        Mid      -0.029905    -0.054169    -0.024264     0.001977   -12.271


9#### other euro breed
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch9_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


10 ###wolf to breedsto eurpean wolf
## worst f-stat:       And        Ger        anc        Eur       0.000000     0.188696     0.188696     0.003646    51.750 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch10_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


11 ### rm wolf node -- 51.750
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch11_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       Cho        Eur        Yel        Ger       0.000000     0.080676     0.080676     0.003199    25.219 
      Eur        Mid        Eur        Ger       0.449712     0.407340    -0.042372     0.002857   -14.830 
      Eur        Mid        Yel        Ger      -0.190416    -0.253355    -0.062940     0.003809   -16.526 
      Eur        Mid        Mid        Ger      -0.591675    -0.648569    -0.056894     0.003754   -15.156 
      Eur        Ger        Eur        Ger       0.896474     0.814654    -0.081820     0.005008   -16.338 
      Eur        Ger        Yel        Ger       0.446762     0.404191    -0.042572     0.002935   -14.507 
      Eur        Ger        Mid        Ger       0.446762     0.407314    -0.039448     0.002856   -13.812


12 ### admix european wolf ##
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch12_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


13 ### admix european wolf better ##
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch13_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Eur       0.004457    -0.015376    -0.019833     0.001737   -11.421 
      And        Wol        Cho        Eur       0.004457    -0.015376    -0.019833     0.001737   -11.421 
      And        Wol        Cho        Yel      -0.014581    -0.031297    -0.016716     0.002037    -8.207 
      And        Wol        Cho        Mid      -0.038680    -0.054169    -0.015489     0.001977    -7.833 
      And        Wol        Cho        Ger       0.004457    -0.014158    -0.018615     0.001827   -10.186 


#14 dog right of euro wolf ####
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch14_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Eur       0.004461    -0.015376    -0.019836     0.001737   -11.423 


15 ### ancient dog off first from asian wolf ### 22
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch15_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        anc        Wol        Eur       0.000000     0.054624     0.054624     0.002479    22.037 
### this got rid of dog 0s but worse score!!!


### something in chow didn't go through asian wolf bottleneck ### 14
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/cladeswitch16_around11score.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Wol        Cho        Eur       0.004846    -0.015376    -0.020221     0.001737   -11.645 
 And        Wol        Cho        Mid      -0.029912    -0.054169    -0.024256     0.001977   -12.267  -- with changes










###################### July 13, 2017 TRY RUNNING ANCESTRY ASSIGNMENT PIPELINE (THIS VERSION DOESN'T INCLUDE SIMULATION DATA YET ###################

mkdir /seq/vgb/linda/mutts/breed_outs


## having trouble putting variables on separate lines
qsub -S /bin/bash -v \
  win=80,fix_phase=T,query_dogs_plink='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt',query_dog_names='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10x_DogIDs_Fixed.txt',outfile='/seq/vgb/linda/mutts/breed_outs/testpipe',min_seg=1,min_pct=0.01,min_hap_len=1e6,min_prob=0.5,fix_phase=T \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/testAA_out \
  -e /seq/vgb/linda/mutts/err/testAA_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline/assign_ancestry.sh


### 30 crashes when doing phasefix, checking on screen -dr 25 -- works fine


############ TEST SIMULATION PIPELINE ################

########################### I was doing this ##################

### simulate admixture
###### run admixture code on server 
screen -dr 487
 use R-3.3
Rscript /seq/vgb/linda/mutts/simu_crosses/Rscripts/recomb_run_phase.R /seq/vgb/linda/mutts/simu_crosses 15 500 5

##args are:
1. data.path
2. number of crosses we are doing for each admixed individual (n gen)
3. the number of admixed individuals we are generating
4. number of subdirectories to make with trials


### move this stuff to seq/vgb/linda
rsync -va /seq/vgb-HAL/linda/mutts/simu_crosses /seq/vgb/linda/mutts

## I changed the paths in the scripts so they would just be /seq/vgb/linda

### try to run on small set ###



### I think the order goes like this....?
screen -dr 303
### 1. Partition ref and test individuals:
## recomb_phasing_partitions.R calls grid_run_phase.sh, which calls phase_sim_vcf.sh, which calls phase by chr eagle thingy (this touches a file when done)
use R-3.3

grid_run_phase.sh can be left
edit phase_sim_vcf.sh

#reference data must be in folder right outside the script directory called ref_data
Rscript /seq/vgb/linda/mutts/simu_crosses/Rscripts/recomb_phasing_partitions.R \
 /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/simu_crosses 2
# It must have 
Boyko_someflipped_12each.bim  
Boyko_someflipped_12each.vcf  
breed_codes.txt  
dogs_breed_key.txt  
my12dogperbreed.txt

cp /seq/vgb/linda/mutts/breed_calling_output/test_SM_41.population_legend.txt /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/breed_codes.txt

### 2. run the recombination simulations
 use R-3.3
#this calls recomb_fxn_phase.R and recomb_loaddata_phase.R
Rscript /seq/vgb/linda/mutts/simu_crosses/Rscripts/recomb_run_phase.R /seq/vgb/linda/mutts/simu_crosses 10 50 2


### 3. Run Supportmix
## this literally just runs supportmix on the simulation data you tell it 
## running on sim1-5
qsub -S /bin/bash -v sim=sim_005,win_size=80 \
 -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/mutts/mendels_mutts/out/out12map \
 -e /seq/vgb/linda/mutts/mendels_mutts/err/err12map \
 -wd /seq/vgb/linda/mutts/mendels_mutts/err \
 -p -10 \
 -N sim5_breed \
 /seq/vgb-HAL/linda/mutts/simu_crosses/run_supportmix_12perbreed.sh


### 4. Analyze the output with recomb_combineSM_output_analysis_phase.R
This is a fairly messy document that makes various plots about accuracy. I'll want to actually get 
# pct correct or r^2 correlations with acuracy based on these posterior probabilities with the filters I used
# like length and nsegments etc


### Next I will want to ...
 1. change the ref data
 2. change phasing from beagle to eagle 
 both of these in ..... MM_phase_sim_vcf.sh and phase_sim_vcf.sh

 phasing should be done separately for ref and test

# remove all sim jobs
qdel $(qstat | grep sim | grep -Po '^\d+' | perl -pe 's/\n/ /')



### I'm running sims 1 and 2 and assign_ancestry



################ try running with new dataset and phasing with eagle ########
cp /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed.bed /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed.bed
cp /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed.bim /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed.bim
cp /seq/vgb/linda/mutts/breed_reference/allOstrander_Boyko_merged_my12perbreed.fam /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed.fam
cp /seq/vgb/linda/mutts/all_ancestry_dogs/Ref_Query_SNPs.txt /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/Ref_Query_SNPs.txt

## make FID and IID be the sample name for everyone
awk '{print $2, $2, $3, $4, $5, $6}'  /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed.fam > /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/test_my12perbreed.fam


awk '{print $2}' /seq/vgb/linda/mutts/all_ancestry_dogs/PhasedRef_DD_MM_10xg_refsnps_filt.bim > /seq/vgb/linda/mutts/all_ancestry_dogs/Ref_Query_SNPs.txt

#### test recomb_phasing_partitions.R line by line ###########



need to make indiv.list --> wtf where did this come from ???
It may be /seq/vgb/linda/mutts/simu_crosses/ref_data/dogs_breed_key.txt but that file has no spaces or newlines...?

/seq/vgb/linda/mutts/breed_reference/my12perbreed_boyko_ostrander_May19.txt 

######## 1. to make dogs_breed_key.txt
I need to concatinate the files in this folder: breed_lists_12_boyko_ostrander_May19 to make something that looks like this
FID	IID	BREED30	30	labrador_retriever38	38	labrador_retriever63	63	labrador_retriever83	83	labrador_retriever345	345	labrador_retriever435	435	labrador_retriever437	437	labrador_retriever449	449	labrador_retriever528	528	labrador_retriever614	614	labrador_retriever


2. 
my12dogperbreed.txt
awk '{print $2}' /seq/vgb/linda/mutts/breed_reference/my12perbreed_boyko_ostrander_May19.txt \
  > /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/my12dogperbreed.txt





use R-3.3
R

args <- c('/seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/simu_crosses', 2)


script.dir <- '/seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts'
ref.data.path <- normalizePath(file.path(script.dir,'..','ref_data'))

stopifnot(file.exists(ref.data.path))

# Make sure the other R files are the same directory.
stopifnot(file.exists(file.path(script.dir, 'recomb_fxn_phase.R')))
stopifnot(file.exists(file.path(script.dir, 'recomb_loaddata_phase.R')))



### notes on phasing
in-sample imputation similar to reference panel based for eagle 
file:///Users/boettger/Downloads/NIHMS781268-supplement-1.pdf
### priya's good description of simulations and separate phasing
http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1001373#s4

#To include many samples in phasing but still not phase population reference panel with samples
#we would need to do many large phasings wiht each iteration... this seems like too much


use in sample phasing for both (no reference panel)
### for simulations
1. phase ref and query separately with each iteration
2. 


### for ancestry assignment ###
phase query with half of my panel (6)
phase ref by itself

########## testing ###########

### 1 - chose individuals and phase #####
Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_phasing_partitions.R \
 /seq/vgb/linda/mutts/testing_simu_crosses 2

This doesn't work well - something keeps running
rm: cannot remove `sim_001/.nfs00000000004276330007d47c': Device or resource busy

## starting in another directory
Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_phasing_partitions.R \
 /seq/vgb/linda/mutts/testing2_simu_crosses 2

Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_phasing_partitions.R \
 /seq/vgb/linda/mutts/testing3_simu_crosses 2


### 2 - run the simulations ###
use R-3.3
Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_run_phase.R \
 /seq/vgb/linda/mutts/testing2_simu_crosses 10 50 2

Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,  : 
  line 143148 did not have 1048 elements
ref tped in sim1 has problem

Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,  : 
  line 143148 did not have 1048 elements
seems to be missing ref and alt? 
1	chr1:212740	0	212740	G	G	G	A	G
36	chr36:3465210	0	3465210			G	G	G
Calls: simulate_one_trial -> load_melt_tped -> data.table -> read.table -> scan

I removed this SNP from ref_query_snps.txt

Error in scan(file = file, what = what, sep = sep, quote = quote, dec = dec,  : 
  line 143442 did not have 1048 elements
36      chr36:7642621   0       7642621 .. looks like 6 individ data missing... 
Both of the problem snps have a high % of no-calls ---> for now I'm going to impose a new cutoff 
## need to be more carful with filtering on next dataset
#I think it is a filt problem

/seq/vgb/linda/bin/Eagle_v2.3.2/eagle --vcf=/seq/vgb/linda/mutts/testing2_simu_crosses/sim_001/test.vcf \
 --geneticMapFile=/seq/vgb/linda/mutts/genetic_map_wg/gen_map_canfam3.1 \
 --chrom=36 \
 --chromX=42 \
 --outPrefix=/seq/vgb/linda/mutts/testing2_simu_crosses/sim_001/test_again

#### EAGLE MESSES UP WITH SNPS THAT ARE NOT VARIABLE
boettger@vert02:/seq/vgb/linda/mutts/testing2_simu_crosses/sim_001 $ zcat test.phased.vcf.gz | grep chr36:7642621
36      7642621 chr36:7642621   G       .       .       .       PR      GT      1|1     0|0     0|0     0|0     0|0     0|0     0|0     0|0     1|1     0|0     0|0     0|0     0|0     0|0     0|0     0|0       0|0     0|0     0|0     0|0     0|0     0|0     0|0     0|0     0|0     0|0     0|0  
IT RESULTS IN BLANK SPACES IN THE TPED FILE... 

########### for now I am going to filter on 0.01 freq threshold so we don't get held up... I will need to adjust the calling file later

plink --bfile /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed \
 --dog \
 --allow-no-sex \
 --maf 0.01 \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed_1filt

149963 variants loaded from .bim file.
1044 dogs (476 males, 515 females, 53 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/ref_data/allOstrander_Boyko_merged_my12perbreed_1filt.nosex
.
28 phenotype values loaded from .fam.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 1044 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.990625.
1946 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
148017 variants and 1044 dogs pass filters and QC.


## running again
Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_run_phase.R \
 /seq/vgb/linda/mutts/testing3_simu_crosses 10 50 2


ran okay this time
Warning messages:
1: In dir.create(sim.subdir) :
  '/seq/vgb/linda/mutts/testing3_simu_crosses/sim_001' already exists
2: In `[.data.table`(recomb.indiv.sample.hap, , `:=`("chr", NULL),  :
  with=FALSE ignored, it isn't needed when using :=. See ?':=' for examples.
3: In dir.create(sim.subdir) :
  '/seq/vgb/linda/mutts/testing3_simu_crosses/sim_002' already exists
4: In `[.data.table`(recomb.indiv.sample.hap, , `:=`("chr", NULL),  :
  with=FALSE ignored, it isn't needed when using :=. See ?':=' for examples.



### Start Supportmix run by chromosome #### ---> will eventually need to put this in another loop through all sims

##submit all SM runs

#!/bin/bash

## variables for input
nsim=2
win=80
#write sims vector
sims=$(seq -s " " -f %03g 1 $nsim)

for this_sim in $sims
do
#call prep_combine_SMcalls
echo $this_sim
sim=sim_"$this_sim"
qsub -S /bin/bash -v win=$win,sim=$sim,refpath=/seq/vgb/linda/mutts/testing3_simu_crosses/$sim \
       -o /seq/vgb/linda/mutts/out/mutt_outSMn \
       -e /seq/vgb/linda/mutts/err/'sim_'$this_sim \
       -N 'SM_'$this_sim \
       -p -10 \
       -wd /seq/vgb/linda/mutts/err \
       /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/prep_combine_SMcalls.sh
done


######## check to see that they are done

### fix up output to go into R
use R-3.3
Rscript /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/scripts/recomb_combineSM_output_analysis_phase.R \
 /seq/vgb/linda/mutts/testing3_simu_crosses 2 80


########### put simulation pipeline into one script #################
## having trouble putting variables on separate lines
qsub -S /bin/bash -v \
  win=80,num_trials=3,outdir='/seq/vgb/linda/mutts/testing4_simu_crosses' \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/testAA_out \
  -e /seq/vgb/linda/mutts/err/testAA_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_simulation_pipeline/simulate_ancestry.sh






















##### July 20 admixture graphs

#no asian wolf, just eurowolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July20_1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## Try without anc american
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July20_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#no chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July20_3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

## add chinese wolf and chow back
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_4.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

## add fake ancient asian wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_5.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### how is z score with chinese wolf and euro wolf monophyletic??
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_6.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

# ancient asian in american too --5.8!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_7.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#Eurasian wolf back into chow ancestor - 0.279
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_8.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#add in ancient american dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_9.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


#Ancient American as Asian dog and American wolf

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_10.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

Asian dog AAW -- run twice 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_11.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

Ancient Eurasian wolf and AAW
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_12.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#Just Asian dog?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_14.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 




# Dog and Andient Asian wolf ##
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_13.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#Asian dog comes from dog and American wolf?

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_15.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#AA comes from Dog and DWAA

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_16.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

### AA dog then AA wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_17.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

###
AA wolf then AA dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_18.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## get rid of american wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_19.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## american comes from ancient asian
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_20.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### add Jack into plot 18
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_21.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

### add Jack with more spacer pops
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_22.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#less admixed chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_23.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## Ancient American off before Ancient asian (right after coyote) -- NO
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_24.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### chow as Ancient Asian wolf and euro dog? -- oh, I tried this before with July2_7
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_25.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#ancient asian wolf splits into asian dog and american wolf -- 5.797 without chinese wolf -5.791 with it
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_26.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
outliers:
      And        Cho        And        Eur       0.625183     0.635289     0.010106     0.003067     3.295 
      And        Cho        anc        Eur       0.122465     0.133490     0.011025     0.003040     3.626 
      And        Cho        Cho        Eur      -0.443423    -0.435446     0.007977     0.002165     3.685 
      And        Cho        Eur        Ger       0.000000    -0.013852    -0.013852     0.002393    -5.790 
      And        Eur        anc        Cho       0.119733     0.129429     0.009696     0.003231     3.001 
      And        Eur        Cho        Eur       0.465164     0.458006    -0.007158     0.002200    -3.253 
      And        Yel        anc        Cho       0.013567     0.020218     0.006651     0.001942     3.424 
      And        Yel        anc        Eur       0.000000     0.008821     0.008821     0.002033     4.340 
      And        Yel        anc        Yel       0.426919     0.432637     0.005718     0.001671     3.422 
      And        Yel        anc        Ger       0.000000     0.008993     0.008993     0.002044     4.400 
      anc        Cho        Eur        Ger       0.000000    -0.011743    -0.011743     0.002588    -4.538 
      anc        Eur        Cho        Eur       0.462432     0.453945    -0.008487     0.002614    -3.246 
      anc        Eur        Yel        Cal       0.000000    -0.006925    -0.006925     0.002109    -3.284 
      anc        Yel        anc        Ger       0.432475     0.440965     0.008490     0.002326     3.650 
      anc        Ger        Cho        Yel      -0.122465    -0.110645     0.011820     0.003149     3.753 
      anc        Ger        Yel        Cal       0.000000    -0.006819    -0.006819     0.002109    -3.233 
      Cho        Eur        Cho        Eur       0.908587     0.893452    -0.015135     0.004064    -3.725 
      Cho        Eur        Cho        Cal       0.436989     0.429393    -0.007595     0.002303    -3.298 
      Cho        Eur        Eur        Yel      -0.478731    -0.469403     0.009328     0.002726     3.422 
      Cho        Eur        Eur        Cal      -0.471598    -0.464059     0.007540     0.002363     3.191 
      Cho        Eur        Eur        Ger      -0.402475    -0.389988     0.012487     0.003203     3.898 
      Cho        Yel        Cho        Ger       0.429856     0.438073     0.008217     0.002489     3.302 
      Cho        Yel        Eur        Ger      -0.000000     0.014024     0.014024     0.002472     5.672 
      Cho        Yel        Cal        Ger      -0.158725    -0.149357     0.009368     0.003056     3.066 
      Cho        Cal        Eur        Ger      -0.000000     0.014130     0.014130     0.002438     5.797 
      Cho        Ger        Eur        Yel      -0.076256    -0.065391     0.010865     0.003325     3.268 
      Cho        Ger        Eur        Ger       0.398719     0.411811     0.013092     0.003423     3.825 

## 26 again with shar pei too 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_26.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


..... it just really wants eurpean wolf in the chow

### european wolf and ancient asian wolf make asian breeds
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_27.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### pre-yellowstone wolf into asian dog ---> no it hates that (30)

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_28.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#!!!!!!!!!!!! something comes off between DDWA and DWA, it goes into AAW and into Asian dog!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


#branch length often is 0 between american wolf and dog
#what happens if I just say dog is in american wolf?


#what happens if I use different chow or asian dog, what about other euro breed?



##### make extra node for chow and gsd

## still need to upload and run this!!  -6.502 everything included!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_29.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## add more spacer pops -6.491
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_30.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
EurmutGer mut 0.003721-0.019335 -0.023055 0.003552 -6.491
outliers:
      And        Eur        Eur        mut      -0.420998    -0.413769     0.007229     0.002309     3.130 
      And        Eur        Ger        mut      -0.021657    -0.008467     0.013190     0.003045     4.332 
      And        mut        Cho        mut       0.013976     0.002631    -0.011345     0.003338    -3.399 
      And        mut        Eur        mut      -0.018632    -0.036718    -0.018086     0.003062    -5.906 
      anc        Eur        Eur        mut      -0.418173    -0.409897     0.008276     0.002624     3.154 
      anc        Eur        Ger        mut      -0.018832    -0.006711     0.012120     0.003136     3.865 
      anc        mut        Cho        mut       0.013978     0.002420    -0.011557     0.003476    -3.325 
      anc        mut        Eur        mut      -0.015807    -0.032846    -0.017039     0.003267    -5.215 
      anc        mut        Ger        mut      -0.015111    -0.026046    -0.010935     0.003341    -3.273 
      Cho        Eur        Ger        mut      -0.038997    -0.028916     0.010081     0.003263     3.090 
      Cho        mut        Eur        mut      -0.024958    -0.043271    -0.018313     0.003391    -5.401 
      Cho        mut        Yel        mut       0.024881     0.012695    -0.012186     0.003524    -3.458 
      Cho        mut        Cal        mut       0.018133     0.007609    -0.010524     0.003373    -3.121 
      Cho        mut        Ger        mut      -0.035276    -0.048250    -0.012974     0.003496    -3.711 
      Eur        Yel        Ger        mut       0.022726     0.009675    -0.013052     0.003172    -4.115 
      Eur        Cal        Ger        mut       0.022635     0.009268    -0.013367     0.003070    -4.354 
      Eur        Ger        Ger        mut      -0.395090    -0.408318    -0.013228     0.003716    -3.560 
      Eur        mut        Eur        mut       0.402366     0.377051    -0.025315     0.004267    -5.933 
      Eur        mut        Yel        mut      -0.019702    -0.038103    -0.018401     0.003187    -5.775 
      Eur        mut        Cal        mut      -0.019610    -0.037807    -0.018197     0.003107    -5.857 
      Eur        mut        Ger        mut       0.003721    -0.019335    -0.023055     0.003552    -6.491 

# ################### It wants European wolf in the mutt  YAY!!! 1.3!!!! ###############
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_31.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


# pre-breed Euro dog instead of more wolf admixture -- -6.087 (need wolf)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_32.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



## Add other breed dogs to #31
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_33.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


###pre-colonial

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_34.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

## Take 33 get rid of shar pei and GSD
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_35.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## 34 with mod euro dog GSD and GR

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_36.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### like 36 no GR -- cant include both because then mutt will be more closely related to one!
##THIS WORKS BUT GIVES US 30% MODERN AND 70% COLONIAL 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_37.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



##just ancient euro mixing with euro wolf -- ugh, -6.430
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/july2_38.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#lab instead of GSD
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_39.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Eur        Cal        Lab        mut       0.026931     0.012939    -0.013992     0.003227    -4.336 
      Eur        Lab        Yel        mut      -0.000498    -0.016418    -0.015920     0.002850    -5.586 
      Eur        Lab        Cal        mut      -0.000498    -0.014943    -0.014444     0.002773    -5.209 
      Eur        Lab        Lab        mut      -0.394445    -0.413148    -0.018704     0.003753    -4.984 
      Eur        mut        Eur        mut       0.401402     0.376957    -0.024445     0.004283    -5.707 


## try another mutt dog -- skyler doesn't have coydog, but does have Euro wolf -6.78
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_40.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps




# try breed dog in place of mutt - irish setter - doesn't seem to need euro wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_41.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## put back GSD as out with irish setter admix YAY!!! -1 (Irish setter is clean!!!)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## Try shar pei as mutt ### --- ugh some AA and some euro dog -- complicated
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_43.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


#try shiba inu --- ugh even worse!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_44.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## remove mod asian keep shar pei -- ugh, -27 won't work
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_45.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## put shar pei as out breed with skyler -- ugh -7
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_46.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## finch
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_47.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## lily
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_48.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## hopper
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July2_49.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

##### try Jaime and Beskow with 42 base


#Beskow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Beskow_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps





## Jaime
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jaime_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



################################ Letting Eurasian wolf into these two makes them both look like they have Ancient American dog #######
## 37 as base for finch
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Finch_37.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
## 37 as base for Irish setter
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Setter_37.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps



### Try 35 as base with setter?? -- better -2 and only1% AA dog

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Setter_35.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## try extra buffer euro pop 35 as base --- omg no, it hates that it looks like AA dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Setter_35a.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


#run jaime with 35f -- fucked--- euro wolf thing
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jaime_35f.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#run jack with 35f 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_35f.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## Beagle 35f  -- looks like AA dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Beagle_35f.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps

#dalmatian
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Dalmatian_35f.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


## try 30 with golden instead of GSD
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_30GR.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#### 35 with GSD as outpop #### -- needs tons of European wolf in order for AA to be true
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_35GSD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps







Jack_30GR -- looks like american wolf when GR is outpop


## Try with Saint Kits dog?

######################## Things to Show #############

1. Map without any admixed dog

2. Jack 



### show with no wolf admixture... say we havne't expalined the whole story yet for the mutts


#### run several mutts with run 




Things I know:
37 will make anything look like it has AA dog
GR as euro out makes most breed dogs look like AA





### jack 42 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Jack_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## lily 42
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Lily_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### hopper 42 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Hopper_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## Finch 42
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Finch_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps


### Clarence 42 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Clarence_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



NoAdmix_42.txt
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nullOut.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/NoAdmix_42.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps








############## Things to download ############

## wolves with less admixture -- SRP044399
http://genome.cshlp.org/content/26/2/163.full -- it's this paper, spainish wolf, etc
zhang bob wayne paper -- which is this??
spain port iran india mexican wolves from 


## Asian village dogs --- may not be wgs??
Are these from the wang paper???
viet nam village dogs less admixture with european their paper from last year, get a non-admixed one lee zhjun village dogs not the same




####### get wolves from the SRA #######

#Mexican wolf --"SAMN02921314” screen -dr 548
 screen -dr 958
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518521/SRR1518521.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518520/SRR1518520.sra

SRR1518528

### Spanish wolf -- SAMN02921319
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518528/SRR1518528.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518529/SRR1518529.sra

qsub -S /bin/bash -v myfile=SRR1518528.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR1518528.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR1518528.sra \
   -N SRR1518528.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh

qsub -S /bin/bash -v myfile=SRR1518529.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR1518529.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR1518529.sra \
   -N SRR1518529.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh



### portuguese wolf -- SAMN02921316 ### /seq/vgb/linda/abba_baba/sra
SRR1518524
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518523/SRR1518523.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518524/SRR1518524.sra


qsub -S /bin/bash -v myfile=SRR1518523.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR1518523.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR1518523.sra \
   -N SRR1518523.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


qsub -S /bin/bash -v myfile=SRR1518524.sra -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/out_SRR1518524.sra \
   -e /seq/vgb/linda/abba_baba/err/err_SRR1518524.sra \
   -N SRR1518524.sra \
   -p -10 \
   /seq/vgb/linda/abba_baba/scripts/sra_align_canids_fixed.sh


######## rename teh sra files

## spain
mv /seq/vgb/linda/abba_baba/bams/SRR1518528.sorted.bam /seq/vgb/linda/abba_baba/bams/wolf_Spain1.sorted.bam
mv /seq/vgb/linda/abba_baba/bams/SRR1518529.sorted.bam /seq/vgb/linda/abba_baba/bams/wolf_Spain2.sorted.bam


#Portugal
mv /seq/vgb/linda/abba_baba/bams/SRR1518523.sorted.bam /seq/vgb/linda/abba_baba/bams/wolf_Portugal1.sorted.bam
mv /seq/vgb/linda/abba_baba/bams/SRR1518524.sorted.bam /seq/vgb/linda/abba_baba/bams/wolf_Portugal2.sorted.bam




qsub -S /bin/bash -v indv=wolf_Spain -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltwolf_Spain \
   -N wolf_Spain \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh

qsub -S /bin/bash -v indv=wolf_Portugal -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltwolf_Port \
   -N wolf_Portugal \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh

To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMException: Value was put into PairInfoMap more than once.  6: 1:58746936

## from past issuepaired reads have different names: "SRR1518532.1.1", "SRR1518532.1.2"

Issue with forward and reverse read names being the same:
boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR1518523_1.fastq.gz | head -10 
@1
TAAANAAAAAAAATAATAAAAAAAAGACAAAGTCAATTATAAAACATTGGTATAAANCCCAAACCCTAGGGACTTTGTTAATGTAATATTGGATTCCTGA
+1
@@@F#2=DFHHHGIHGHGHCGHIIJIGIJJJIA;EHIGGHIHFHHFFFFFDFDEED#,;?@DDDDDDCCDDCDDD:@:CCDDDDEDDDEEEDDCDDEDD>
@2
CTATTTATCTTTACTTCCTCACAGGATCAGATAGAGCTGTTTTATTTTTTTTTTTCCATATTTATTTCTGTTTCTAACCAGCTAAAATCACTTTAATCCA
+2
CCCFFFFFHHHHHJJJJJJJJJJHJFGJHIIIIJGHICHHIJJGIJJJJJJJJH##############################################
@3
GGGTTTTTCCCTCTTTTTCTCTCTCTTGATATTTTTTCTATCTTCTTGTTCCTCTTTTTAGCCTCCTGATAGTAAGTAAGTGCTTTAAGGTTTTCTTTAT
boettger@vert02:/seq/vgb/linda/abba_baba/fastq $ zcat SRR1518523_2.fastq.gz | head -10 
@1
NTNGANNNNNNNNTTTTTCATTGGTGCCTCAGTTATAATATAAAGAGCCATGGTACCTAGTTGTAGAGAACGCTGACTAAGCTTATGTAGTACGTCCAGN
+1
#1#44########22AEG+AFHGIHHCHIJHBFGFFEIGFGIF>DCFGBFBFG8/.=BFC8BGGIHEH;DGGECEDFDD>AA>CECACDEC;@BC@DDD#
@2
TTTTCNNNNNNNNTGTAACATTTGACCACCTTACTAGAATGTTGACAACTTAAGACTTTTTTCCTTGAACATTACATGACATCCTTTTCCACCATATAGN
+2
CCCFF########43>EHIJJJJJJJJJJJJJJJJIJJIGIIIIJIIIIIFGHIJHJJJJJJJJJJHHHHHHFFBCDFCEDEEDDDDDDCDCDDDDDED#
@3
ACAGGGNNNNNNNNNNNNNNNNNNNNNNNNAGCAAATAGTAATTTTCCTAGTGCAGAAAATAATTATGAGTCAAGAGGATTCCTTTATGCTTCAGGGAAN


### need to change the read names


##################### SRR1518528
screen -dr 300
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518528/'
sra_id=SRR1518528
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'

screen -dr 382
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518528/'
sra_id=SRR1518528
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'

##################### SRR1518529
screen -dr 293
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518529/'
sra_id=SRR1518529
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'

screen -dr 285
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518529/'
sra_id=SRR1518529
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'


#####################  SRR1518523
screen -dr 283
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518523/'
sra_id=SRR1518523
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'


mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518523/'
sra_id=SRR1518523
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'


#####################  SRR1518524
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518524/'
sra_id=SRR1518524
zcat $mypath/fastq/$sra_id'_1.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_1.fastq.gz'


## screen -dr 250
mypath=/seq/vgb/linda/abba_baba
add_readname='s/^(@\d{1,15})$/$1_SRR1518524/'
sra_id=SRR1518524
zcat $mypath/fastq/$sra_id'_2.fastq.gz' | perl -pe $add_readname | gzip > $mypath/fastq/$sra_id'_edit_2.fastq.gz'


######## re-run alignment - then start filter
before alignment
## next time before I start aligning something:
1. check fastq to see if the read names in F and reverse are different e.g read1.1 and read1.2 (they need to be the same in F and Reverse
2. Check to see that the name is specific to that sequencing run. When combining across runs (2 runs for same sample) mark duplicates hates it if the read names are the same (liek when read names are @1 @2 etc
	You need to make them more complex like by appending the sra id to the end





qsub -S /bin/bash -v indv=wolf_Portugal -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/outfilt \
   -e /seq/vgb/linda/abba_baba/err/errfiltwolf_Portugal \
   -N wolf_Portugal \
   /seq/vgb/linda/abba_baba/scripts/Canids_combine_filter.sh







######## 
10. Mak PCA??
1. Make Phylogeny with 2 coyotes, 2 NA wolves, 2 Euro wolves, chow chows, chinese shar pei, vietnam village dogs, a couple european dogs
2. Treemix with these dogs
3. Try f stats and qp graph again





######################## Get vietnam dogs and chr38 for haploid individuals ###################

while read c; do
qsub -S /bin/bash -v chr=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/abba_baba/out/happlink \
   -e /seq/vgb/linda/abba_baba/err/happlink \
   -N ${c}_pseudohap \
   -wd /seq/vgb/linda/abba_baba/err \
   -p -10 \
   /seq/vgb/linda/mutts/scripts/vcf_to_plink_haploid.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt

#put the vcf files together  screen -dr 303
reuse VCFtools


## combine all except chrx which we don't want for this analysis
vcf-concat \
 435.PASS.SNP_pseudohaploidfix.chr1.vcf \
 435.PASS.SNP_pseudohaploidfix.chr2.vcf \
 435.PASS.SNP_pseudohaploidfix.chr3.vcf \
 435.PASS.SNP_pseudohaploidfix.chr4.vcf \
 435.PASS.SNP_pseudohaploidfix.chr5.vcf \
 435.PASS.SNP_pseudohaploidfix.chr6.vcf \
 435.PASS.SNP_pseudohaploidfix.chr7.vcf \
 435.PASS.SNP_pseudohaploidfix.chr8.vcf \
 435.PASS.SNP_pseudohaploidfix.chr9.vcf \
 435.PASS.SNP_pseudohaploidfix.chr10.vcf \
 435.PASS.SNP_pseudohaploidfix.chr11.vcf \
 435.PASS.SNP_pseudohaploidfix.chr12.vcf \
 435.PASS.SNP_pseudohaploidfix.chr13.vcf \
 435.PASS.SNP_pseudohaploidfix.chr14.vcf \
 435.PASS.SNP_pseudohaploidfix.chr15.vcf \
 435.PASS.SNP_pseudohaploidfix.chr16.vcf \
 435.PASS.SNP_pseudohaploidfix.chr17.vcf \
 435.PASS.SNP_pseudohaploidfix.chr18.vcf \
 435.PASS.SNP_pseudohaploidfix.chr19.vcf \
 435.PASS.SNP_pseudohaploidfix.chr20.vcf \
 435.PASS.SNP_pseudohaploidfix.chr21.vcf \
 435.PASS.SNP_pseudohaploidfix.chr22.vcf \
 435.PASS.SNP_pseudohaploidfix.chr23.vcf \
 435.PASS.SNP_pseudohaploidfix.chr24.vcf \
 435.PASS.SNP_pseudohaploidfix.chr25.vcf \
 435.PASS.SNP_pseudohaploidfix.chr26.vcf \
 435.PASS.SNP_pseudohaploidfix.chr27.vcf \
 435.PASS.SNP_pseudohaploidfix.chr28.vcf \
 435.PASS.SNP_pseudohaploidfix.chr29.vcf \
 435.PASS.SNP_pseudohaploidfix.chr30.vcf \
 435.PASS.SNP_pseudohaploidfix.chr31.vcf \
 435.PASS.SNP_pseudohaploidfix.chr32.vcf \
 435.PASS.SNP_pseudohaploidfix.chr33.vcf \
 435.PASS.SNP_pseudohaploidfix.chr34.vcf \
 435.PASS.SNP_pseudohaploidfix.chr35.vcf \
 435.PASS.SNP_pseudohaploidfix.chr36.vcf \
 435.PASS.SNP_pseudohaploidfix.chr37.vcf \
 435.PASS.SNP_pseudohaploidfix.chr38.vcf \
 | bgzip > 435.PASS.SNP_pseudohaploidfix.allchr.vcf.gz



##### get original dipliod ancestrals with chr38 #####
screen -dr 35

reuse VCFtools
vcf-concat \
435.PASS.SNP.allchr.vcf.gz \
435.PASS.SNP.chr38.vcf.gz \
 | bgzip > 435.PASS.SNP.allchrinc38.vcf.gz


-----> this didn't work doing it the long way

cd /seq/vgb/rawData/435_dog_data 

reuse VCFtools
vcf-concat \
 435.PASS.SNP.chr1.vcf.gz \
 435.PASS.SNP.chr2.vcf.gz \
 435.PASS.SNP.chr3.vcf.gz \
 435.PASS.SNP.chr4.vcf.gz \
 435.PASS.SNP.chr5.vcf.gz \
 435.PASS.SNP.chr6.vcf.gz \
 435.PASS.SNP.chr7.vcf.gz \
 435.PASS.SNP.chr8.vcf.gz \
 435.PASS.SNP.chr9.vcf.gz \
 435.PASS.SNP.chr10.vcf.gz \
 435.PASS.SNP.chr11.vcf.gz \
 435.PASS.SNP.chr12.vcf.gz \
 435.PASS.SNP.chr13.vcf.gz \
 435.PASS.SNP.chr14.vcf.gz \
 435.PASS.SNP.chr15.vcf.gz \
 435.PASS.SNP.chr16.vcf.gz \
 435.PASS.SNP.chr17.vcf.gz \
 435.PASS.SNP.chr18.vcf.gz \
 435.PASS.SNP.chr19.vcf.gz \
 435.PASS.SNP.chr20.vcf.gz \
 435.PASS.SNP.chr21.vcf.gz \
 435.PASS.SNP.chr22.vcf.gz \
 435.PASS.SNP.chr23.vcf.gz \
 435.PASS.SNP.chr24.vcf.gz \
 435.PASS.SNP.chr25.vcf.gz \
 435.PASS.SNP.chr26.vcf.gz \
 435.PASS.SNP.chr27.vcf.gz \
 435.PASS.SNP.chr28.vcf.gz \
 435.PASS.SNP.chr29.vcf.gz \
 435.PASS.SNP.chr30.vcf.gz \
 435.PASS.SNP.chr31.vcf.gz \
 435.PASS.SNP.chr32.vcf.gz \
 435.PASS.SNP.chr33.vcf.gz \
 435.PASS.SNP.chr34.vcf.gz \
 435.PASS.SNP.chr35.vcf.gz \
 435.PASS.SNP.chr36.vcf.gz \
 435.PASS.SNP.chr37.vcf.gz \
 435.PASS.SNP.chr38.vcf.gz \
 435.PASS.SNP.chrX.vcf.gz \
 | bgzip > /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchrinc38.vcf.gz



vcf-merge may be for the same variants across different individuals

vcf-concat is for combinding different sections across the same individuals





###################### July 27, 2017 TRY RUNNING ANCESTRY ASSIGNMENT PIPELINE (THIS VERSION DOESN'T INCLUDE SIMULATION DATA YET ###################

qsub -S /bin/bash \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/testAA2_out \
  -e /seq/vgb/linda/mutts/err/testAA2_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline/assign_ancestry.sh \
  win=80 \
  fix_phase=T \
  query_dogs_plink='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt' \
  query_dog_names='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10x_DogIDs_Fixed.txt' \
  outfile='/seq/vgb/linda/mutts/breed_outs/testpipe2' \
  min_seg=1 \
  min_pct=0.01 \
  min_hap_len=1e6 \
  min_prob=0.5 \
  fix_phase=T 


######################### above it didn't work ########

Though, it would be good to discuss exactly what you want the figures to look like for the August meeting so I can add these to the pipeline. If I recall, you thought simplified versions with less gray would be better. 

## testgin again
qsub -S /bin/bash -v \
  win=80,fix_phase=T,query_dogs_plink='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt',query_dog_names='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10x_DogIDs_Fixed.txt',outfile='/seq/vgb/linda/mutts/breed_outs/testpipe2',min_seg=1,min_pct=0.01,min_hap_len=1e6,min_prob=0.5,fix_phase=T \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/testAA2_out \
  -e /seq/vgb/linda/mutts/err/testAA2_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline/assign_ancestry.sh


qdel $(qstat | grep SM_ | grep -Po '^\d+' | perl -pe 's/\n/ /')







############# running new wolves


while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_outjuly30_${c} \
   -e /seq/vgb/linda/mutts/err/ancmutt_errjuly30_${c} \
   -N ${c}_Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual_July30.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt



######### then make tpeds #########
### make temp tpeds for each chr, combine later ########

## should I be using the other one?
$outpath/$thisfile'_notrans'.haplo this has transitions removed??? YES!!! change this a bit!!

qsub -S /bin/bash -v chr=chr33,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/admix_chr33 \
   -e /seq/vgb/linda/mutts/err/admixt_chr33 \
   -N chr33_maketped \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/haplo_to_tped_July30.sh


while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/admix_${c} \
   -e /seq/vgb/linda/mutts/err/admixt_${c} \
   -N ${c}_maketped \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/haplo_to_tped_July30.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt


################# put chromosomes together #########
cd /seq/vgb/linda/TreeMixJuly30/angsd_outputs_AncAM_q28

cat allVar_chr1_July30_0miss_notrans_tmp.tped \
allVar_chr2_July30_0miss_notrans_tmp.tped \
allVar_chr3_July30_0miss_notrans_tmp.tped \
allVar_chr4_July30_0miss_notrans_tmp.tped \
allVar_chr5_July30_0miss_notrans_tmp.tped \
allVar_chr6_July30_0miss_notrans_tmp.tped \
allVar_chr7_July30_0miss_notrans_tmp.tped \
allVar_chr8_July30_0miss_notrans_tmp.tped \
allVar_chr9_July30_0miss_notrans_tmp.tped \
allVar_chr10_July30_0miss_notrans_tmp.tped \
allVar_chr11_July30_0miss_notrans_tmp.tped \
allVar_chr12_July30_0miss_notrans_tmp.tped \
allVar_chr13_July30_0miss_notrans_tmp.tped \
allVar_chr14_July30_0miss_notrans_tmp.tped \
allVar_chr15_July30_0miss_notrans_tmp.tped \
allVar_chr16_July30_0miss_notrans_tmp.tped \
allVar_chr17_July30_0miss_notrans_tmp.tped \
allVar_chr18_July30_0miss_notrans_tmp.tped \
allVar_chr19_July30_0miss_notrans_tmp.tped \
allVar_chr20_July30_0miss_notrans_tmp.tped \
allVar_chr21_July30_0miss_notrans_tmp.tped \
allVar_chr22_July30_0miss_notrans_tmp.tped \
allVar_chr23_July30_0miss_notrans_tmp.tped \
allVar_chr24_July30_0miss_notrans_tmp.tped \
allVar_chr25_July30_0miss_notrans_tmp.tped \
allVar_chr26_July30_0miss_notrans_tmp.tped \
allVar_chr27_July30_0miss_notrans_tmp.tped \
allVar_chr28_July30_0miss_notrans_tmp.tped \
allVar_chr29_July30_0miss_notrans_tmp.tped \
allVar_chr30_July30_0miss_notrans_tmp.tped \
allVar_chr31_July30_0miss_notrans_tmp.tped \
allVar_chr32_July30_0miss_notrans_tmp.tped \
allVar_chr33_July30_0miss_notrans_tmp.tped \
allVar_chr34_July30_0miss_notrans_tmp.tped \
allVar_chr35_July30_0miss_notrans_tmp.tped \
allVar_chr36_July30_0miss_notrans_tmp.tped \
allVar_chr37_July30_0miss_notrans_tmp.tped \
allVar_chr38_July30_0miss_notrans_tmp.tped \
> /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_July30_0miss_notrans.tped

rm *_tmp.tped


## 1.7 million variants 1703809 /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_July30_0miss_notrans.tped



####### make new mutts file
1. Convert .haplo files to plink
2. Convert mutts to plink  /seq/vgb/jmcclure/wgs/vcfs/WGS-snps-filtered.vcf (keep only mutts)
3. merge breed dogs, ancient dog and mutts
4. convert to eighenstrat



D131	D132	D157	D158_2	D181_2	D182	D183	D184	D198	D199	DX01	DX02	DX03	DX04	DX05	DX06	DX07	DX08	DX09	DX10	DX11	GR_12340_OSA	GR_12341_OSA	GR_199_142_BLSA	GR_199_8_
TLSA	GR_199_94_TLSA	GR_3691_OSA	GR_382523_BLSA	GR_393049_BLSA	IW_05_47_A	IW_10_7_295_A	IW_10_7_66_A	IW_3543_A	IW_46941_A	IW_OS_19_A	L
AB_153818_1	LAB_153823_1	LAB_153829_1	LAB_162226_1	LAB_162347_1	LAB_166518_1	LAB_3704_1	LE0493_1	LE_0048_control	LE_0096_HSA	LE_0116_H
SA	LE_0316_control	LE_0454_HSA	LE_0734_OSA	LE_0812_HSA	LE_0823_OSA	LE_114725_OSA	LE_1160_control	LE_1306_control	MB140_Normal	MB2A11_Normal	M
B2C13_Normal	NEWMET_Normal	SHAKIT_Normal


############### get all variants ############
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf  \
  --plink-tped \
  --remove-indels \
  --keep /seq/vgb/linda/AdmixTools_data/mutts/my_mutts.txt \
  --out /seq/vgb/linda/AdmixTools_data/mutts/mutts21

issue with replacing chromosome names with 0

### the names are in the snp name
1       chr1:838        0       838     0       0     0 0      0        0       0       0       0       0       0       0       0     0
        0       0       T       T  0    0       0     0 0      0        0       0       0       0       0       0       0       0     0
        0       0       0       0  0    0       0     0 0
1       chr1:865        0    


fix chromosome names
perl -pe 's/^\d+ chr(\d+):/$1 chr$1:/' /seq/vgb/linda/AdmixTools_data/mutts/mutts21.tped > /seq/vgb/linda/AdmixTools_data/mutts/mutts21chrfix.tped 

### this fixed numeric chrs -- fine cuz we are't using M anyway

cp /seq/vgb/linda/AdmixTools_data/mutts/mutts21.tfam > /seq/vgb/linda/AdmixTools_data/mutts/mutts21chrfix.tfam 






### make tfam (done by hand using /seq/vgb/linda/TreeMix/scripts/Treemix_names_my_canids_June2.txt) ###




## some are triallelic, I think this is because of fox
1 chr1:167995 0 167995 G G G G G G C C G G G G G G G G G G G G G G G G G G G G C C G G G G G G G G G G G G A A G G G G G G G G G G G G G G C C G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G G

### convert ancestrals ###
## exclude snps in mutts that aren't triallelic on merge
plink --tfile /seq/vgb/linda/AdmixTools_data/ancestrals/allVar_allchr_July30_0miss_notrans \
 --dog \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged_July.missnp \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss

1703809 variants loaded from .bim file.
54 dogs (0 males, 0 females, 54 ambiguous) loaded from .fam.



##when kept everything -- this is old before rmtransitions
Total genotyping rate in remaining samples is 0.997498.
5969472 variants and 51 dogs pass filters and QC.


### convert mutts ###
plink --tfile /seq/vgb/linda/AdmixTools_data/mutts/mutts21chrfix \
 --dog \
 --allow-no-sex \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged_July.missnp \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/mutts/mutts21chrfix



## merge into one file -- only keep snps in ancestrals file
plink --bfile /seq/vgb/linda/AdmixTools_data/mutts/mutts21chrfix \
 --bmerge /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.bed \
 /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.bim \
 /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.fam \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.snps \
 --maf 0.001 \
 --recode \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged_July

--extract: 1703581 variants remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 75 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.952986.
0 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
1703581 variants and 75 dogs pass filters and QC.

Error: 228 variants with 3+ alleles present.
* If you believe this is due to strand inconsistency, try --flip with
  /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged_July.missnp.

## triallelic from first try
Error: 1749 variants with 3+ alleles present.
/seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged-merge.missnp



######### get elaine's pseudohaploid data

vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP_pseudohaploidfix.allchr.vcf.gz \
 --plink \
 --positions /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.pos \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf

435.PASS.SNP_pseudohaploidfix.allchr.vcf.gz
After filtering, kept 1122334 out of a possible 32438672 Sites


awk '{print $1, "chr"$1":"$4, "0", $4}' /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf.map > /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcfloc.map

### make ostrander pseudohaps as bfile  -- get rid of those that are triallelic
plink --map /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcfloc.map \
 --ped /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf.ped \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_38merged-merge.missnp \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf



plink --bfile /seq/vgb/linda/AdmixTools_data/eigenstrat/mutts_ancestrals_merged_July \
 --bmerge /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf.bed \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf.bim \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/pseudohaploidsinc38_fromOstrandervcf.fam \
 --dog \
 --allow-no-sex \
 --make-bed \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_38merged












Elaine's diploid data:

/seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchrinc38.vcf.gz

## get positions from snp names
/seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.snps 

sed "s/:/\t/" /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.snps > /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.pos

 --positions /seq/vgb/linda/AdmixTools_data/eigenstrat/dipMutts_hapAncestrals_loc.txt \

chr1    564

### need to keep more than that!!! I need a chihuahua and other purebreds as testers
vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchrinc38.vcf.gz \
 --positions /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.pos  \
 --keep /seq/vgb/linda/abba_baba/scripts/dipAncestrals_ostrandervcf.txt \
 --plink \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf

## convert to loc
awk '{print $1, "chr"$1":"$4, "0", $4}' /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf.map > /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcfloc.map


## convert to plink binary and only keep snps we want
plink --ped /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf.ped \
 --map /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcfloc.map \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38.missnp \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfinc38

--exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38.missnp \

## change names
cd /seq/vgb/linda/AdmixTools_data/eigenstrat
sed -i -E "s/Wolf01/Wolf01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/WolfTibetan03/WolfTibetan03_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/GoldenJackal01/GoldenJackal01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/AndeanFox01/AndeanFox01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/Dalmatian01/Dalmatian01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/LabradorRetriever02/LabradorRetriever02_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/MexicanHairless01/MexicanHairless01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/ChineseCrested05/ChineseCrested05_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/Chihuahua01/Chihuahua01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/Chihuahua03/Chihuahua03_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/GoldenRetriever03/GoldenRetriever03_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/GoldenRetriever02/GoldenRetriever02_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/Saluki02/Saluki02_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/TibetanMastiff02/TibetanMastiff02_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/ChowChow03/ChowChow03_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/IrishSetter01/IrishSetter01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/SharPei01/SharPei01_diploid/g" dipAncestrals_fromostrandervcfinc38.fam
sed -i -E "s/StandardPoodle03/StandardPoodle03_diploid/g" dipAncestrals_fromostrandervcfinc38.fam


### combine with rest of dataset!!!
## get rid of snps not on anchered chromosomes
plink --bfile /seq/vgb/linda/AdmixTools_data/eigenstrat/dipmutts_hapancestrals_mine_andOst_38merged \
 --bmerge /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfinc38.bed \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfinc38.bim \
 /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfinc38.fam \
 --dog \
 --allow-no-sex \
 --chr 1-38 \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38.missnp \
 --extract /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.snps \
 --recode \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38

Total genotyping rate is 0.754961.
1702996 variants and 220 dogs pass filters and QC.


################ convert to eigenstrat ##########


/seq/vgb/linda/bin/EIG-6.1.4/bin/convertf -p /seq/vgb/linda/admixture/Eigensoft/plink_to_eigen_Julyinc38.txt


## replace ??? with individual name (this is population

awk '{print $1,$2,$1}' /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_Julyinc38.ind > /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_Julyinc38fix.ind


######### now look at qp graph!!!

#no asian wolf no chow, just spainwolf -- 16
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_1croat.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_1port.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



### making ancam dog outside of dogs -- -48 worse
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_2_Croat.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



## admix NA dog very bad
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


#Like July20_3
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_4span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_4croat.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

## like July2_20  -- -53.807 -- wow different (was 4)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_5span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## wow -62.273  this is supposed to be the same wolf -- I guess I was missing chr24+ before
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_5croat.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

### better -15
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_6span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_7span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_8span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_9span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

 -13 -- actually looks like GSD is the problem
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_10span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

## switch out GSD for GR gets me to 12
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_11span.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      Cho        Gol        Spa        Yel       0.000000    -0.016335    -0.016335     0.001441   -11.336 
      Cho        Gol        Spa        Cal      -0.000000    -0.014067    -0.014067     0.001409    -9.985 
      Spa        Yel        Spa        Gol       0.454115     0.441991    -0.012124     0.001703    -7.120 
      Spa        Yel        Yel        Gol      -0.467765    -0.479135    -0.011370     0.001907    -5.961 
      Spa        Yel        Cal        Gol      -0.036083    -0.049542    -0.013459     0.001863    -7.223 
      Spa        Cal        Spa        Gol       0.454115     0.446076    -0.008039     0.001519    -5.291
      Anc        Gol        Cho        Spa      -0.005133     0.015829     0.020962     0.002086    10.051 


##
 European dogs causing problem?
it HATES INTROGRESSION FROM EUROPEAN WOLF INTO EURO DOGS 200+
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_12.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## remove european dog (-1.2) -- it wants ancient asian dog in chow?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_13.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
worst f-stat:       Cho        Spa        Yel        Cal       0.000000    -0.001849    -0.001849     0.001446    -1.278 


## rm chow  -- (-3.3) also wants ancient asian wolf in GSD?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_14.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
worst f-stat:       And        Yel        Spa        Ger       0.000000    -0.004870    -0.004870     0.001447    -3.365 

### admix breeds with ancient asian wolf --> still -13
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_15.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

### asia euro dog divide then admix chow -- Still -13 with everything
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_16.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## as above with GR still -11
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_17.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Cho        Gol        Spa        Yel      -0.000000    -0.016335    -0.016335     0.001441   -11.336 
      Cho        Gol        Spa        Cal       0.000000    -0.014067    -0.014067     0.001409    -9.985 
      Spa        Gol        Spa        Gol       0.994512     0.979303    -0.015209     0.002470    -6.158 
      Spa        Gol        Cal        Gol       0.541127     0.533227    -0.007901     0.001744    -4.531 

### ancient asian into asia dogs
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_18.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

      Cho        Gol        Spa        Yel      -0.000714    -0.016335    -0.015621     0.001441   -10.841 
      Anc        Gol        Spa        Cal      -0.002404    -0.021339    -0.018935     0.001598   -11.847 
      Spa        Yel        Spa        Gol       0.455086     0.441991    -0.013094     0.001703    -7.690 
      Spa        Yel        Yel        Gol      -0.467780    -0.479135    -0.011355     0.001907    -5.953 
      Spa        Yel        Cal        Gol      -0.035721    -0.049542    -0.013822     0.001863    -7.418 
      And        Gol        Spa        Cal      -0.163249    -0.175936    -0.012686     0.002144    -5.918 
      And        Gol        Spa        Gol       0.544539     0.532748    -0.011791     0.001647    -7.159 

## put in spacer pops ---> omg -3!!!
      And        Yel        Cho        Spa      -0.003645     0.000849     0.004494     0.001429     3.145 
      And        Yel        Spa        Gol       0.000000    -0.004564    -0.004564     0.001419    -3.217 
      Spa        Yel  f2:     0.925565     0.921126    -0.004439     0.002145    -2.069 

### try port wolf and get rid of WWW
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_19.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Yel        Por        Gol       0.000000    -0.004959    -0.004959     0.001508    -3.288 
      Por        Yel  f2:     0.907589     0.903015    -0.004573     0.002204    -2.075 
      Anc        Cal  f2:     1.053356     1.050905    -0.002452     0.002208    -1.110 


## with gsd 3.397 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_20.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

      Por        Yel  f2:     0.908421     0.903769    -0.004652     0.002209    -2.105 
      And        Yel        Por        Ger       0.000000    -0.004928    -0.004928     0.001542    -3.196 
      Anc        Cho        Por        Cal      -0.000989    -0.005589    -0.004600     0.001438    -3.199 

todo:
### FLAT file of dog breed pct!!!
New reference panel first -- then fix phase


## rm extra chow admix  8.31 -- worse
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_21.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



## separate admixtures for chow and AA -6.59 (worse)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_22.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Anc        Anc        Gol      -0.405502    -0.412599    -0.007098     0.001696    -4.186 
      And        Anc        Cho        Por      -0.117446    -0.123888    -0.006442     0.002064    -3.121 
      And        Anc        Cho        Gol       0.000000    -0.012113    -0.012113     0.001838    -6.590 
      And        Anc        Yel        Gol       0.120223     0.113613    -0.006610     0.002181    -3.031 
      And        Anc        Cal        Gol       0.261820     0.252177    -0.009642     0.002536    -3.803 


##DWAA admixture instead of Ancient Asian ### -4.77 (worse)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_23.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## rm extra nodes still -3.22
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_24.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## add spain wolf (2 euro wolves)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_25.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Por        Gol        Spa        Yel       0.087643     0.062833    -0.024810     0.002430   -10.210 
      Por        Gol        Spa        Cal       0.087643     0.066769    -0.020874     0.002369    -8.812 
      And        Gol        Por        Spa       0.000000     0.027535     0.027535     0.001585    17.370
      Spa        Gol        Spa        Gol       1.012127     0.985840    -0.026287     0.002531   -10.385 
      Spa        Gol        Yel        Gol       0.553868     0.540898    -0.012969     0.001974    -6.571 
      Spa        Gol        Cal        Gol       0.553868     0.536786    -0.017082     0.001779    -9.602 

## looks like spanish wolf into golden retriever? -3.288 with port maybe the ratios make more sense? 3.217 with span wolf
#July31_26 3.156 with germain shepherd and spain wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_26.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Spa        Yel  f2:     0.926074     0.921952    -0.004122     0.002147    -1.920 
      And        Yel        Spa        Ger       0.000000    -0.004543    -0.004543     0.001457    -3.119 
      Anc        Cho        Spa        Cal      -0.002726    -0.007338    -0.004612     0.001461    -3.156 


## ugh ancient asian wolf into eurasian wolf (slightly better -2.881)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_27.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Anc        Cal  f2:     1.054162     1.050905    -0.003257     0.002208    -1.475 
worst f-stat:       Anc        Cho        Por        Cal      -0.001571    -0.005721    -0.004150     0.001440    -2.881 


## rm ancinet asian wolf in span wolf, add coyote admixture into AA dog 3.288 not enough
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_28.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Por        Yel  f2:     0.907216     0.903015    -0.004201     0.002204    -1.906 

## add coyote admixture to 27 ugh (-1.56, but lots of admixture)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_29.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### rm european wolves, changes %s but -0.12
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_30.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### try Jack admixture (keep eurowolf in for now) -- strang answer -- I need to add branch length sharing with each canid not just admixture
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_31.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## add branch length sharing (-2 z score 62 dog 38 coydog)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_32.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try with GR -- z score of 1 reverse %s


### more spacesrs and GR -- messed up it finds chow as 100% asian dog, finds jack as 100% asian dog.... with GSD is like half coyote
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_33.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## remove some minor ancestral admixture so the model is easier to resolve -3.1 meh
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_34.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try 34 with irish setter


## 35 , euro dog into asian (I messed up this node above) but coyote called 72% wolf... likely problem Asia dog only 56% dog...
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_35.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## irish setter instead 6% and 3.521, 3.547 inc ancient euro wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_35setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

Dalmatian01_diploid
LabradorRetriever02_diploid
GoldenRetriever02_diploid
## try golden retriever

### 6% other 3.3 score , rm Eurodog admixture into asian -> puts us at z7 and 7%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_35GR.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

### put asian wolf back into euro wolf setter plot -- doesn't really help (7% and z score the same magnitude)
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_36.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



### Go back to July31_35setter, try adding other breed off eurobreed or substituting (shepherd may be part wolf)
## BETTER!!! only1% non-breed is called
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_37setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try with mutt jack 9%, but the z score goes up because of shared ancestry with specific breeds
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_37Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### try as admixture line leaving European_dog -- better! low z score (3) and 1% 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try a more basal breed as second choice Pomeranian01 OMFG!!! 0% for setter and z=-3
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38PomSetter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try a more basal breed as second choice Pomeranian01 with Jack YAY 8% non-breed!!! z is -5 since he is closer to the GSD than pom
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#try with just pom setter at 1% z score 3.3
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_39setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

### jack with just pom z=-4 jack with 17% non-breed
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_39Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## ugh 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_39PoodJack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


###ugh 6% for setter --- I think I do really need two euro breeds for this
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_39PoodSetter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### go back to 38, try asian breed as mutt --- ugh, sahr pei is 31% other
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38shar.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
ChineseCrested05_diploid
SharPei01_diploid
Saluki02_diploid
ShibaInu01
SiberianHusky01

### 40 add two asiana and 2 european July31_40crest 3% other
---> this was messed up
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_40crest.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

###41  Pekingese01 and chow are ancestral -- 1% for shar pei!!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_41Shar.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

###41 with jack -- puts jack at 0%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_41Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## shar pei and pekingese are ancestral -- check chow is 35% other.... :(
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_42chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


Variation in breeds was represented with two breeds each from Europe and Asia. Though we cannot exclude the possiblity that the introgression could be explained though admixture with a breed that we have not modeled here. 

### jack
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_42Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



Other dogs from the breeds modeled here as well as dogs from breeds >1% frequency in the US
ostrander_axiom_screen


## try with chow ancestral and use husky? SiberianHusky01 -- should really be diploid though -- 27% other :(
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38huskhap.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### run 38 with another chow -- ugh 35% 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38Chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


The signal is not explained by chow or shar pei? or a common european breed...
We cannot exclude the possibility that the signal derives from multiple Asian breeds have risen to high frequency in the mutts


## try chowchow2 ugh 36%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38Chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## try chowA with 03dip ---> only 3%!!!!

## try chowA and ChowB


## try no branch off of asian breeds -- not helpful
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_43chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## try chowA vs CHowb --5%

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38chowAB.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


cp /seq/vgb/rawData/Illumina_Axiom/ostrander_axiom_screen



### test Lab
LabradorRetriever01
Lab
Rottweiler
Rottweiler01
Dalmatian01_diploid
LabradorRetriever02_diploid
StandardPoodle03_diploid


#lab
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38PomLab.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### dalmatian
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38PomDal.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try 2 chows 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_413chow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps




## rerun July31_38Jack.txt
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



### add extra dmixture event before AA breaks off
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_38admixchow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


July31_38admixchow



#check heterozygosity of breeds in dataset -- some of these are haploid so will be 0
plink --file /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38 \
 --dog \
 --het \
 --out /seq/vgb-HAL/linda/mutts/boyko_allSNPs/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38het
## huh looks strange


### try to make treemix plot ###



### run through to treemix in###

while read c; do
qsub -S /bin/bash -v chr=$c,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_outjuly30_${c} \
   -e /seq/vgb/linda/mutts/err/ancmutt_errjuly30_${c} \
   -N ${c}_Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual_July30.sh
done < /seq/vgb/linda/mutts/dog_autosomes_pluschrX.txt



qsub -S /bin/bash -v chr=chr1,qual=28 -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/mutts/out/ancmutt_outjuly301 \
   -e /seq/vgb/linda/mutts/err/ancmutt_errjuly301 \
   -N chr1_Treemix \
   -p -10 \
   /seq/vgb/linda/TreeMix/scripts/bam_to_treemix_varqual_July30.sh


#screen -dr 298
migration=10
thisfile=allVar_allchr_July30_0miss.treeIn
parentpath=/seq/vgb/linda/TreeMix
qual=28
outpath=$parentpath'July30/angsd_outputs_AncAM_q'$qual

/seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$thisfile.gz \
 -root VulLag -m $migration -o $parentpath/TM_outputs'_q'$qual/$thisfile'_m'$migration


### just get specific individuals
awk '{print $9, $4, $14, $19, $30, $32, $33, $35, $38, $39, $24, $25, $42, $43, $50, $54, $53}' allVar_allchr_July30_0miss_sel.treeIn > allVar_allchr_July30_0miss_selind.treeIn

screen -dr 303
parentpath=/seq/vgb/linda/TreeMix
migration=10
thisfile=allVar_allchr_July30_0miss_selind.treeIn
parentpath=/seq/vgb/linda/TreeMix
qual=28
outpath=$parentpath'July30/angsd_outputs_AncAM_q'$qual

/seq/vgb/linda/bin/TreeMix/bin/treemix -i $outpath/$thisfile.gz \
 -root VulLag -m $migration -o $parentpath/TM_outputs'_q'$qual/$thisfile'_m'$migration

reuse R-3.1
R

source("/seq/vgb/linda/bin/treemix-1.13/src/plotting_funcs.R")
plot_tree("/seq/vgb/linda/TreeMix/TM_outputs_q28/allVar_allchr_July30_0miss_selind.treeIn_m10")





################ start breed calling for Jesse's stitch dogs ####################

#make plink

vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --vcf /seq/vgb/jmcclure/stitch740K.vcf \
 --plink \
 --out /seq/vgb/linda/mutts/dogs_to_breed_call/stitch740K


plink --file /seq/vgb/linda/mutts/dogs_to_breed_call/stitch740K \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/dogs_to_breed_call/plink_bfiles/stitch740K

## make names file
/seq/vgb/linda/mutts/dogs_to_breed_call/dog_names/JesseStitchNamesAug4.txt

### run assign_ancestry
qsub -S /bin/bash -v \
  win=80,fix_phase=T,query_dogs_plink='/seq/vgb/linda/mutts/dogs_to_breed_call/plink_bfiles/stitch740K',query_dog_names='/seq/vgb/linda/mutts/dogs_to_breed_call/dog_names/JesseStitchNamesAug4.txt',outfile='/seq/vgb/linda/mutts/breed_outs/Jesse08042017/stitch740K',min_seg=1,min_pct=0.01,min_hap_len=1e6,min_prob=0.5,fix_phase=T \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/testjess_out \
  -e /seq/vgb/linda/mutts/err/testjess_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline/assign_ancestry.sh


.... it made phased.unphased.vcf.gz for chr41...? how strange  stitch740K_filt_41.phased.unphased.vcf.gz

########### THERE IS NO CHR41!!!!!!! I SHOULD MODIFY SO IT GETS THE CHROMOSOMES FROM THE INPUT PLINK FILE #################


################ start breed calling for symposium dogs once jesse had made vcf ####################




###### back to qpgraph #######




## rerun July31_38Jack.txt --- -59 wants it closer to euro dog and wolves
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


IndigenousDogVietnam01 U IndigenousDogVietnam01
IndigenousDogVietnam02 U IndigenousDogVietnam02
IndigenousDogVietnam03 U IndigenousDogVietnam03
IndigenousDogVietnam04 U IndigenousDogVietnam04
IndigenousDogVietnam05 U IndigenousDogVietnam05


VillDog_Vietnam01 U VillDog_Vietnam01
VillDog_Vietnam02 U VillDog_Vietnam02
VillDog_Vietnam03 U VillDog_Vietnam03
VillDog_Vietnam04 U VillDog_Vietnam04
VillDog_Vietnam05 U VillDog_Vietnam05
VillDog_Vietnam06 U VillDog_Vietnam06

### 2 -- making it admixed iii  it wants it closer to chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      Vil        Yel        Anc        Cho       0.000597    -0.042978    -0.043575     0.002033   -21.430 
      Vil        Cal        Anc        Cho       0.000627    -0.043799    -0.044426     0.001994   -22.275 
      Vil        Cho  f2:     0.769885     0.732872    -0.037012     0.002799   -13.222 



### trying village dog in place of chow -- 27% coydog instead of 41% with other chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
V1 27% other
I1 64% other
V2 71%
V3 20%
V4 12%

chow 1 and 2 as outgroups leave only 2% for chow3
July31_413chow.

### try to fix wolf  -- calcoy still 65% wolf -- hates it
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_4.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#extra wolf node to fix Awolf -- only small help
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_6.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### have vil and chow as outgroups for asian --- closer!!! 1% other with chow1 and chow2 (vil4) 4% with vil6) at -22.054 though!!
ID2 9%
ID3 8%
V5 46% other
ID4 2%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_5.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## add another coyote -- still both minority coy
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_7.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
Al_coy U Al_coy
Coyote01 U Coyote01
Coyote02 U Coyote02
Coyote03 U Coyote03
Midwst_coy U Midwst_coy
Minn_wolf U Minn_wolf

### both coyote off same admxiture -- still 40% coyote


### extra dog node to help chow -- worse!! 4%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_8.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



### rm admixture for asia dogs -- worse 4%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_9.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## try only Asia breed -- rm node -- no -30.400 says chow looks like chow!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_10.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### itarate using 8 -- jack at 2% with this -7 z but is GSD thing
ID1 0% z of -5.6 wow!
ID5 1% Z=4.9 --- this is the best!!!!
VD1 3%
VD2 4%
VD3 5%
VD4 4%
VD5 4%
VD6 3%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_11.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



### try jack with best graph --- 2% z of 7 cuz closer to GSD
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_12.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

## 13 rm shepherd --- no is 6% with just pom 7% with portwater
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_13.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### should I get VillDog_Portugual??


### 14 try having pom be ancestral -- no still 6% try with portvil dog 12 with pot\rtvil
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_14.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


# 15 Euro mix -- oesn't like of euro dog... one off each breed --- still 6% admixture between breeds doesn't work!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_15.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



### 16 check many with best
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_16Lab.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

with shar pei
StandardPoodle03_diploid
TibetanMastiff02_diploid
ChineseCrested05_diploid
Chihuahua01_diploid
ChowChow03_diploid
MexicanHairless01_diploid
IrishSetter01_diploid
GoldenRetriever02_diploid
LabradorRetriever02_diploid


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_16Pood.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_16Lily.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_16Setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### finch/lily st kits

DX08	Jaime
D131	HopperD182	Skyler

DX07	FinchDX06	Lily


probelm not in mutts:
ChoInd CalPom -0.000000-0.009299-0.0092990.001646-5.650

Ind Sha CalGer 0.009886 0.0196190.0097340.0016985.731

ChoInd LabCal 0.000599 0.010813 0.010214 0.001607 6.355


worst f-stat:       Cho        Ind        Cal        Iri      -0.001099    -0.010262    -0.009163     0.001602    -5.719 



Cho Ind StaCal 0.000187 0.0103150.0101280.0015966.345


#try Asian into european  -5.650
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_17Setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### admixed pop into both


## later admixture 
Anc Ind Yel Iri 0.000000 0.012238 0.0122380.0020695.914
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_18.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


# 19 -- basic  -5.6
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_19.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Por        Yel  f2:     0.913895     0.909065    -0.004829     0.002270    -2.127 

      Cho        Ind        Cal        Ger       0.000000    -0.009195    -0.009195     0.001682    -5.466 
      Cho        Ind        Cal        Pom       0.000000    -0.009276    -0.009276     0.001635    -5.675 
      Ind        Cal  f2:     1.066340     1.063054    -0.003286     0.002150    -1.529 
      Ind        Ger  f2:     0.849829     0.856187     0.006358     0.002847     2.233 
      Ind        Pom  f2:     0.846509     0.853233     0.006724     0.002733     2.460 


### coyote in indiginous dog?? -3.88 -- helps a little
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_20.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Ind        Por  f2:     0.996117     0.990932    -0.005185     0.002284    -2.270 
worst f-stat:       Anc        Ind        Por        Cal       0.003093    -0.002480    -0.005573     0.001437    -3.880 
      And        Yel        Por        Ger       0.000000    -0.004824    -0.004824     0.001559    -3.094 
      And        Yel        Por        Pom       0.000000    -0.004842    -0.004842     0.001554    -3.117 
      And        Cal        Anc        Ger      -0.002514    -0.005733    -0.003219     0.000972    -3.311 
      Anc        Cho        Por        Cal      -0.000616    -0.005494    -0.004878     0.001452    -3.359 
      Anc        Ind        Por        Yel      -0.000970    -0.005739    -0.004769     0.001444    -3.304 
      Anc        Ind        Por        Cal       0.003093    -0.002480    -0.005573     0.001437    -3.880 
      Anc        Ind        Por        Ger       0.009168     0.002658    -0.006510     0.002030    -3.207 
      Anc        Por        Yel        Cal       0.002887    -0.002426    -0.005312     0.001749    -3.038 
      Anc        Yel        Por        Cal       0.015709     0.009735    -0.005974     0.001810    -3.300 
      Anc        Ger        Por        Cal      -0.004258    -0.009409    -0.005151     0.001573    -3.275 


### try near port wolf into village dog instead 4.59 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_21.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

And        Yel        Ind        Por      -0.003505     0.003481     0.006986     0.001519     4.598 

      Ind        Por        Yel        Cal       0.000922    -0.005685    -0.006607     0.001537    -4.299 
      And        Yel        Por        Ger       0.000000    -0.004824    -0.004824     0.001559    -3.094 
      And        Yel        Por        Pom       0.000000    -0.004842    -0.004842     0.001554    -3.117 
      Anc        Cho        Por        Cal      -0.000988    -0.005494    -0.004506     0.001452    -3.103 
      Por        Yel  f2:     0.914324     0.909065    -0.005259     0.002270    -2.316 


### from ancient asian wolf 4.7
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_22.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Ind        Por        Yel        Cal       0.000989    -0.005685    -0.006674     0.001537    -4.343 
      Anc        Cho        Por        Cal      -0.000949    -0.005494    -0.004545     0.001452    -3.129 
      Anc        Ind        Por        Yel      -0.000585    -0.005739    -0.005154     0.001444    -3.570 
      And        Ind  f2:     1.065026     1.063166    -0.001860     0.001664    -1.117 

## landbridge wolf have them share branchlength? 4.76
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_23.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Ind        Por        Yel        Cal       0.000989    -0.005685    -0.006673     0.001537    -4.342 
      Por        Yel  f2:     0.914247     0.909065    -0.005182     0.002270    -2.282 

## ancient dog?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_24.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Yel        Por        Ger       0.000000    -0.004824    -0.004824     0.001559    -3.094 
      And        Yel        Por        Pom       0.000000    -0.004842    -0.004842     0.001554    -3.117 
      Anc        Cho        Por        Cal      -0.000974    -0.005494    -0.004520     0.001452    -3.112 
      Anc        Ind        Por        Yel      -0.001138    -0.005739    -0.004601     0.001444    -3.187 


      Ind        Por        Yel        Cal       0.000925    -0.005685    -0.006610     0.001537    -4.301 


## 25 -4.1
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_25.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### old wolf off coyote?? 3.86 best stat with village dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_26.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      Por        Yel  f2:     0.913753     0.909065    -0.004687     0.002270    -2.065 

      Anc        Cho        Por        Cal      -0.000620    -0.005494    -0.004875     0.001452    -3.356 
      Anc        Ind        Por        Yel      -0.000966    -0.005739    -0.004773     0.001444    -3.306 
      Anc        Ind        Por        Cal       0.003069    -0.002480    -0.005549     0.001437    -3.863 
worst f-stat:       Anc        Ind        Por        Cal       0.003069    -0.002480    -0.005549     0.001437    -3.863 


DWA into vill dog? 4.7
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug7_27.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps
      And        Yel        Por        Ger       0.000000    -0.004824    -0.004824     0.001559    -3.094 
      And        Yel        Por        Pom       0.000000    -0.004842    -0.004842     0.001554    -3.117 
      Anc        Cho        Por        Cal      -0.000993    -0.005494    -0.004501     0.001452    -3.099 
      Cho        Ind        Yel        Cal       0.000047     0.003960     0.003913     0.001127     3.471 

meh??


### does indiginous even share branch length with chow chow??? I don't let them share abranch after

### get rid of the portuguese wolf --- it was better z score without it... see July31_30


## hopper was the one we thoght was acutally chow!!


## Aug8 1  basic no eurowolf -- -5.67 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



### aug 8 2 -- spain wolf -5.6 

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### does indiginous even share branch length with chow chow??? I don't let them share abranch after

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 




### dog into chow? 4.92

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_4.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## vil dog admixed with ancient asian wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_5.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#off DWAA?
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug8_6.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
      Ind        Por        Yel        Cal       0.000988    -0.005685    -0.006673     0.001537    -4.342 
      Ind        Por        Yel        Cal       0.000988    -0.005685    -0.006673     0.001537    -4.342 

Mix american wolf and DWA to mix into vil dog

is indiginous external to chow and american?

Go back to July31_30!!!




#### for explaining the process ###
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_1wolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



## switch GSD for lab + values (H1 closer to H3) so GSD closer to 
Pomeranian01

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
## 9 with spain wolf

## no Eurowolf stil 2.9 -- some branch lengths are 0!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_4.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

## add wolf 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_4wolf.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## have yellowstone wolf come off last
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_5.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_29GSD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July31_30GSD.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_7.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#### try spanish wolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2spain.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#### try GR
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2GR.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## both GR and spain 11.2
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2spain.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### two Euro breeds --- meh changes a bunch of stuff, dog and wolf no branch length now
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2GSDPom.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


Aug9_2 feels trueish.... still 3.9 z score

### try Aug9_2 with Irish Setter
Aug9_2_admixtosetter.txt

/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2_admixtosetter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### chow
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2_admixtochow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 





## add lengths between admixtures
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_8.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#only 1 spacer -- shows as 1% asian and 1% non-breed
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_2_1spacer_admixSetter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## chow wiht 1 spacer
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug2_1spaceradmixChow.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

### neither spacer helps!! -- but we also can't see branch length shared with American dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_9.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_9CC.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
ChineseCrested05_diploid
SharPei01_diploid
Saluki02_diploid
ShibaInu01
SiberianHusky01


### check shar pei 2%, but no branch length shared with american dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_9SP.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## try pomerianian as euro out
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_9PomSetter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### try Jack
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_9Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## show admixture after american dog with JACK
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_10.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## with chow -- pushes it all back into no branch length with aa dog
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_10CC.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 



#### Aug9 with 10 -- blank - no admixture
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_10NOadmix.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


#try 10 with setter
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug10_10sett.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## jack 11 0% other
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11Jack.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


Chihuahua01_diploid U Chihuahua01_diploid
Chihuahua03_diploid U Chihuahua03_diploid
Dalmatian01_diploid
MexicanHairless01_diploid
SharPei01_diploid
TibetanMastiff02_diploid
StandardPoodle03_diploid

TibetanMastiff02_diploid

### chow chow in 12 -- less option for wolf admixture -- still 1% coyote
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_12CC.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### setter 11 called as 1% coywolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11setter.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


## try no mixing nodes for wolf and coy --- yellow wolf not mixed at all
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_12.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


# try 11 with chihuahua 1% non-breed mostly amirican-- branch length shared!
 /seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11chi.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


### chow chow -- gets called 1% coywolf
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11CC.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### shar pei -- 0% other!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11SP.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


### dalmaitan 0% other!!!
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11Dal.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

# try 11 with chihuahua3 1% non-breed mostly amirican-- branch length shared!
 /seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11chi3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


# 11 with poodle 0%
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11Pood.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


## mexican hairless 0%
 /seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11Mex.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 
D131 U D131
D132 U D132
D157 U D157
D158_2 U D158_2
D181_2 U D181_2
D182 U D182
D183 U D183
D184 U D184
D198 U D198
D199 U D199
DX01 U DX01
DX02 U DX02
DX03 U DX03
DX04 U DX04
DX05 U DX05
DX06 U DX06
DX07 U DX07
DX08 U DX08
DX09 U DX09
DX10 U DX10
DX11 U DX11

#D131
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11D131.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


##DX01
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11DX01.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#D132
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11D132.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

##D157
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_11D157.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#158_2
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_11D158_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



#181_2
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D181_2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#D182
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D182.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#D183
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D183.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 

#D184
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D184.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

#D198
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D198.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


#D199
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/D199.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


#DX01
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX01.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


#dx02
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX02.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

DX03
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX03.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX04
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX04.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX05
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX05.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX06
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX06.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX07
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX07.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


DX08
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX08.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX09
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX09.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps




DX10
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX10.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraph -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_out.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfile > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefix -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC.ps 


DX11
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DX11.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

Tibetan Mastiff
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/July9_11TM.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


August 9_13 
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_13.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps

August 9_14
/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_14.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/Aug9_15.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/show1.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps


/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/show2.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



/seq/vgb/linda/bin/AdmixTools_v4.1/bin/qpGraph -p /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/par_qpgraph_nulloutJuly.txt -g /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/show3.txt -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_outgraphe -d /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_inputs/DWC_oute.txt
perl -pe 's/^(label = .+)\n/$1/m' /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilee > /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe
dot -Tps /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWC_dotfilefixe -o /seq/vgb/linda/AdmixTools_data/eigenstrat/qpGraph_outs/DWCe.ps



GoldenRetriever02_diploid U GoldenRetriever02_diploid
GoldenRetriever03_diploid U GoldenRetriever03_diploid
DX09	Rudy   --- stuffDX01	SkeeterDX05	RhodaDX07	FinchD183	EsmeD198	SandyD199	Scotch -- coyDX04	TuiD132	ClarenceDX08	JaimeD131	HopperD181	Gus *** twice!!D158	Kaylee *** twice !!D182	SkylerDX10	JackD184	LuckyDX06	LilyDX11	Vera-LynnDX02	HunterD157	BeskowDX03	Reily




############### Get August Symposium Samples running in pipeline ############

vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/Affymetrix/PRO100039_DD101_SAX/clusterA_rec.vcf \
 --plink \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec


vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools
$vcftools --vcf /seq/vgb/jmcclure/Affymetrix/PRO100039_DD101_SAX/clusterB_rec.vcf \
 --plink \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec



##FIlter for more than 15% missing for a snp or individual for each version and convert to binary
### getting rid of NSps athat are duplicated on the 
plink --file /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec \
 --dog \
 --allow-no-sex \
 --make-bed \
 --exclude /seq/vgb/linda/mutts/Aug_symposium/Rm_dupsnps.txt \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt


--exclude: 475059 variants remaining.

--extract: 483612 variants remaining.
--exclude: 483602 variants remaining.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 87 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.997222.
0 variants removed due to missing genotype data (--geno).
483602 variants and 87 dogs pass filters and QC.


plink --file /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec \
 --dog \
 --allow-no-sex \
 --exclude /seq/vgb/linda/mutts/Aug_symposium/Rm_dupsnps.txt \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt


/seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.nosex .
--extract: 209146 variants remaining.
--exclude: 209136 variants remaining.
Warning: At least 7 duplicate IDs in --exclude file.
0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 81 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.997528.
61 variants removed due to missing genotype data (--geno).
209075 variants and 81 dogs pass filters and QC.


0 dogs removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 81 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate is 0.997528.
61 variants removed due to missing genotype data (--geno).
209075 variants and 81 dogs pass filters and QC.





### they have different names for the same dog based on the array they are using A/B

31001602111898	Customer	Genomic DNA	Canine	0.13	A	a550771-4346285-121118-906_F06
31001602111898	Customer	Genomic DNA	Canine	0.13	B	a550772-4346286-121118-915_F06


########## CHANGE NAMES IN A #########
sed -i -E "s/a550771-4346285-121118-906_E08.CEL/31001701032170/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F06.CEL/31001602111898/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B05.CEL/31001602111198/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G08.CEL/31001602110018/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F03.CEL/31001602031080/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D06.CEL/31001701032533/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D11.CEL/31001602031250/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C09.CEL/31001609031900/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D09.CEL/31001602111118/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D07.CEL/31001701032149/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B03.CEL/31001602031166/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G01.CEL/31001602111564/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C07.CEL/31001609032026/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A01.CEL/31001609032883/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C10.CEL/31001602111403/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D10.CEL/31001602031030/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H02.CEL/31001602031136/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E10.CEL/31001609032041/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D12.CEL/31001602111365/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H01.CEL/31001602030088/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B04.CEL/31001602111334/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C01.CEL/31001609031386/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F12.CEL/31001701032524/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D02.CEL/31001602111852/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D01.CEL/31001602110520/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E07.CEL/31001602111996/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C02.CEL/31001602111535/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H07.CEL/31001602111753/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A02.CEL/31001602031004/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F04.CEL/31001609032062/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G06.CEL/31001602111344/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G10.CEL/31001602110674/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D05.CEL/31001602111210/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G03.CEL/31001602031183/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G02.CEL/31001602030049/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D04.CEL/31001602111447/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B02.CEL/31001602030534/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E03.CEL/31001602030128/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C06.CEL/31001602111330/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G12.CEL/31001609032093/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A05.CEL/31001701032162/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E02.CEL/31001602031821/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H04.CEL/31001602111716/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A03.CEL/31001602031685/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H08.CEL/31001602111338/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F05.CEL/31001609032357/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A07.CEL/31001602110752/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H11.CEL/Sunny/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C05.CEL/31001602111477/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H12.CEL/3100160203008270/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B07.CEL/31001701032506/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H03.CEL/31001602111128/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E12.CEL/31001609032362/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A10.CEL/31001701032760/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C03.CEL/31001602111902/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A09.CEL/31001701032781/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C08.CEL/31001609032107/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F11.CEL/31001602111104/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F08.CEL/31001609032090/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D03.CEL/31001602111407/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G07.CEL/31001609032063/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B11.CEL/31001609032163/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G09.CEL/31001609031972/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A12.CEL/31001602111914/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E05.CEL/31001701032113/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B06.CEL/31001602111161/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_D08.CEL/31001701032438/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H05.CEL/31001602030992/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G04.CEL/31001602031759/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E06.CEL/31001602111249/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F10.CEL/31001602111487/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H10.CEL/Corneliuz/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A11.CEL/31001602111865/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E04.CEL/31001602030280/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F09.CEL/31001602030999/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A06.CEL/31001602031221/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B08.CEL/31001609031960/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H06.CEL/31001609032109/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_H09.CEL/Dash/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B09.CEL/31001609032015/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_E11.CEL/31001602111253/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B10.CEL/31001609031953/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_C04.CEL/31001602111426/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_B12.CEL/31001609031913/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_F07.CEL/31001602111412/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_A08.CEL/31001602030762/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 
sed -i -E "s/a550771-4346285-121118-906_G05.CEL/31001609033180/g" /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam 




###### replace B ############
sed -i -E "s/a550772-4346286-121118-915_F06.CEL/31001602111898/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H07.CEL/31001602111753/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B05.CEL/31001602111198/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G08.CEL/31001602110018/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F03.CEL/31001602031080/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H06.CEL/31001609032109/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D06.CEL/31001701032533/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E08.CEL/31001701032170/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D11.CEL/31001602031250/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C09.CEL/31001609031900/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D09.CEL/31001602111118/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D07.CEL/31001701032149/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B03.CEL/31001602031166/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G01.CEL/31001602111564/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C07.CEL/31001609032026/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A01.CEL/31001609032883/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C10.CEL/31001602111403/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D10.CEL/31001602031030/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H02.CEL/31001602031136/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E10.CEL/31001609032041/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D12.CEL/31001602111365/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H01.CEL/31001602030088/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B04.CEL/31001602111334/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C01.CEL/31001609031386/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F12.CEL/31001701032524/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D02.CEL/31001602111852/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D01.CEL/31001602110520/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E07.CEL/31001602111996/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C02.CEL/31001602111535/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A02.CEL/31001602031004/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C11.CEL/31001602111470/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F04.CEL/31001609032062/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F01.CEL/31001602110587/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G06.CEL/31001602111344/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G10.CEL/31001602110674/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D05.CEL/31001602111210/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G03.CEL/31001602031183/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G02.CEL/31001602030049/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D04.CEL/31001602111447/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B02.CEL/31001602030534/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E03.CEL/31001602030128/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C06.CEL/31001602111330/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G12.CEL/31001609032093/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A05.CEL/31001701032162/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E02.CEL/31001602031821/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H04.CEL/31001602111716/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A03.CEL/31001602031685/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H08.CEL/31001602111338/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F05.CEL/31001609032357/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A07.CEL/31001602110752/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H11.CEL/Sunny/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F02.CEL/31001602111310/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C05.CEL/31001602111477/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H12.CEL/3100160203008270/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B07.CEL/31001701032506/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H03.CEL/31001602111128/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E12.CEL/31001609032362/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A10.CEL/31001701032760/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C03.CEL/31001602111902/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A09.CEL/31001701032781/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C08.CEL/31001609032107/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A04.CEL/31001602110620/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F11.CEL/31001602111104/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C12.CEL/31001602111345/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F08.CEL/31001609032090/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D03.CEL/31001602111407/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G07.CEL/31001609032063/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B11.CEL/31001609032163/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G09.CEL/31001609031972/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A12.CEL/31001602111914/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E05.CEL/31001701032113/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B06.CEL/31001602111161/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_D08.CEL/31001701032438/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H05.CEL/31001602030992/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G04.CEL/31001602031759/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E06.CEL/31001602111249/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F10.CEL/31001602111487/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H10.CEL/Corneliuz/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A11.CEL/31001602111865/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E04.CEL/31001602030280/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F09.CEL/31001602030999/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A06.CEL/31001602031221/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B08.CEL/31001609031960/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_H09.CEL/Dash/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B09.CEL/31001609032015/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E11.CEL/31001602111253/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B10.CEL/31001609031953/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_E09.CEL/31001701032218/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_C04.CEL/31001602111426/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_B12.CEL/31001609031913/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_F07.CEL/31001602111412/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G11.CEL/31001609032114/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_A08.CEL/31001602030762/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 
sed -i -E "s/a550772-4346286-121118-915_G05.CEL/31001609033180/g" /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam 

### filter and only keep best/recommended snps (from below)




### merge the bfiles , even run my breed dogs
plink --bfile /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt \
 --bmerge /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.bed \
 /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.bim \
 /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam \
 --dog \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged

awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' /seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged.bim > /seq/vgb/linda/mutts/Aug_symposium/Aug_sym_mergedpos.bim


2525 more same-position warnings: see log file wtf

Warning: Multiple positions seen for variant 'AX-167464995'.
Warning: Multiple positions seen for variant 'AX-167688882'.
Warning: Multiple positions seen for variant 'AX-167455773'.
Error: 9 variants with 3+ alleles present.
Warning: Multiple positions seen for variant 'AX-167464995'.
Warning: Multiple positions seen for variant 'AX-167688882'.
Warning: Multiple positions seen for variant 'AX-167455773'.
Warning: Multiple positions seen for variant 'AX-167953454'.
Warning: Multiple positions seen for variant 'AX-167487750'.
Warning: Multiple positions seen for variant 'AX-168029717'.
Warning: Multiple positions seen for variant 'AX-167434385'.
Warning: Multiple positions seen for variant 'AX-167482824'.

Warning: Variants 'AX-168133172' and 'AX-167260615' have the same position.
10823 more same-position warnings: see log file

I added all the problem snps to missnp file (will remove them above)
/seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged-merge.missnp


81 dogs loaded from /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_filt.fam.
87 dogs to be merged from
/seq/vgb/linda/mutts/Aug_symposium/clusterB_rec_filt.fam.
Of these, 8 are new, while 79 are present in the base dataset.


Total genotyping rate is 0.956647.
673282 variants and 89 dogs pass filters and QC.

Warning: Variants 'AX-168184819' and 'AX-167219695' have the same position.
Warning: Variants 'AX-167489621' and 'AX-167164612' have the same position.
Warning: Variants 'AX-168133172' and 'AX-167260615' have the same position.
10823 more same-position warnings: see log file.

Of these, 464207 are new, while 19395 are present in the base dataset.
Warning: Variants 'AX-168184819' and 'AX-167219695' have the same position.
Warning: Variants 'AX-167489621' and 'AX-167164612' have the same position.
Warning: Variants 'AX-168133172' and 'AX-167260615' have the same position.



/seq/vgb/linda/mutts/Aug_symposium/clusterA_rec_pos

#check  keep only snps that are in our reference file
plink --bfile /seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged \
  --extract /seq/vgb/linda/mutts/breed_reference/may222017_references/Ref_SNPs.txt \
  --dog \
  --make-bed \
  --recode vcf-iid \
  --out /seq/vgb/linda/mutts/Aug_symposium/test_mergewithref

######tht's not very many...
--extract: 128489 variants remaining.

--extract: 126590 variants remaining. still only these still eventhough I have both..... will just move forward

--extract: 127073 variants remaining. --- I changed all chr39 snps to 41 when it merges it will only get the snps on that chr


## run assignment
qsub -S /bin/bash -v \
  win=80,fix_phase=T,query_dogs_plink='/seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged',query_dog_names='/seq/vgb/linda/mutts/Aug_symposium/Aug_names.txt',outfile='/seq/vgb/linda/mutts/breed_outs/Aug_symposium/Aug_dogs',min_seg=1,min_pct=0.01,min_hap_len=1e6,min_prob=0.5,fix_phase=T \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/Aug_out \
  -e /seq/vgb/linda/mutts/err/Aug_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline/assign_ancestry.sh


/seq/vgb/linda/mutts/breed_outs/Aug_sym/Aug_dogs


qdel $(qstat | grep Phase | grep -Po '^\d+' | perl -pe 's/\n/ /')



#### copy it to another directory ##
cp /seq/vgb/rawData/Illumina_Axiom/PRO100039_DD101_SAX.zip /seq/vgb/linda/affy/PRO100039_DD101_SAX.zip


#eagle parameters
--expectIBDcM has you put in the expected haplotype length for transition probs.. this will vary a lot whether is purebred or mutt
--Kpbwt arg (=10000)             number of conditioning haplotypes  (already more than I have)
--pbwtIters arg (=0)             number of PBWT phasing iterations (0=auto)


### try running eagle with more iterations
ancestry_assignment_pipeline_Eagle10it


####### this new version isn't working at all yet!!!!  more testpipe_eagle10it_allchr.phased.tped >> just has '00' writen in it

qsub -S /bin/bash -v \
  win=80,fix_phase=T,query_dogs_plink='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10xg_refsnps_filt',query_dog_names='/seq/vgb/linda/mutts/all_ancestry_dogs/DD_MM_10x_DogIDs_Fixed.txt',outfile='/seq/vgb/linda/mutts/breed_outs/eagle10it/testpipe_eagle10it',min_seg=1,min_pct=0.01,min_hap_len=1e6,min_prob=0.5,fix_phase=T,script_dir='/seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline_Eagle10it_v2' \
  -q vert -M boettger@broadinstitute.org \
  -o /seq/vgb/linda/mutts/out/Aug_out \
  -e /seq/vgb/linda/mutts/err/Aug_err \
  -N assign_ancestry \
  -p -10 \
  -wd /seq/vgb/linda/mutts/err \
  /seq/vgb/linda/mutts/scripts/ancestry_assignment_pipeline_Eagle10it_v2/assign_ancestry.sh



outfile='/seq/vgb/linda/mutts/breed_outs/bleh'


####### get recomended SNPs from affy array ######


### Culster A ### 
643642 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_A/SNPolisher/Ps.performance.txt

awk '{print $1, $21}' /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_A/SNPolisher/Ps.performance.txt > /seq/vgb/linda/affy/culsterA_BestandRecommended01.txt
awk '$2==1 {print $1}' /seq/vgb/linda/affy/culsterA_BestandRecommended01.txt > /seq/vgb/linda/affy/culsterA_BestandRecommended_SNPs.txt
209653 /seq/vgb/linda/affy/culsterA_BestandRecommended_SNPs.txt

### Cluster B ###
625278 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B/SNPolisher/Ps.performance.txt

awk '{print $1, $21}' /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B/SNPolisher/Ps.performance.txt > /seq/vgb/linda/affy/culsterB_BestandRecommended01.txt
awk '$2==1 {print $1}' /seq/vgb/linda/affy/culsterB_BestandRecommended01.txt > /seq/vgb/linda/affy/culsterB_BestandRecommended_SNPs.txt
483612 /seq/vgb/linda/affy/culsterB_BestandRecommended_SNPs.txt

`
###### get best and recomended --extract: 209146 variants remaining
plink --file /seq/vgb/linda/mutts/Aug_symposium/clusterA_rec \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/affy/culsterA_BestandRecommended_SNPs.txt \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterA_BestandRecommended_filt



plink --file /seq/vgb/linda/mutts/Aug_symposium/clusterB_rec \
 --dog \
 --allow-no-sex \
 --extract /seq/vgb/linda/affy/culsterB_BestandRecommended_SNPs.txt \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt
--extract: 483612 variants remaining




### merge the bfiles 
plink --bfile /seq/vgb/linda/mutts/Aug_symposium/clusterA_BestandRecommended_filt \
 --bmerge /seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt.bed \
 /seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt.bim \
 /seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt.fam \
 --dog \
 --make-bed \
 --mind 0.15 \
 --geno 0.15 \
 --out /seq/vgb/linda/mutts/Aug_symposium/Aug_sym_merged_BestandRecommended

##### ugh #######
Warning: Multiple positions seen for variant 'AX-167464995'.
Warning: Multiple positions seen for variant 'AX-167688882'.
Warning: Multiple positions seen for variant 'AX-167455773'.
209085 markers loaded from
/seq/vgb/linda/mutts/Aug_symposium/clusterA_BestandRecommended_filt.bim.
483612 markers to be merged from
/seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt.bim.
Of these, 464207 are new, while 19405 are present in the base dataset.
5 more multiple-position warnings: see log file.
Error: 9 variants with 3+ alleles present.


5:10pm boettger@vert02 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B $ grep AX-167464995 /seq/vgb/linda/mutts/Aug_symposium/clusterA_BestandRecommended_filt.bim
2	AX-167464995	0	64420184	C	T
5:10pm boettger@vert02 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B $ grep AX-167464995 /seq/vgb/linda/mutts/Aug_symposium/clusterB_BestandRecommended_filt.bim
2	AX-167464995	0	64420183	C	T


################## JESSE GAVE ME PROBE IDS NOT SNP NAMES ################
5:10pm boettger@vert02 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B $ grep AX-167464995 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_A/SNPolisher/Ps.performance.txt
AX-167464995	Affx-206235889	100	7.4751	15.3712	0.2654	2.7754	17	3	66	13	2	0	0	0.1981	0.1049	1	0	PolyHighResolution	1	1
5:11pm boettger@vert02 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B $ grep AX-167464995 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_B/SNPolisher/Ps.performance.txt
AX-167464995	Affx-206815852	100	7.8702	16.0433	0.171	2.6087	19	3	71	13	3	0	0	0.0565	0.1092	1	0	PolyHighResolution	1	1




probeset_id	affy_snp_id	CR	FLD	HomFLD	HetSO	HomRO	nMinorAllele	Nclus	n_AA	n_AB	n_BB	n_NC	hemizygous	H.W.p-Value	MinorAlleleFrequency	H.W.statistic	HomHet	ConversionType	BestProbeset	BestandRecommended
AX-103120661	Affx-206567770	100	NA	NA	NA	1.667	0	1	81	0	0	0	0	1	0	1	0	MonoHighResolution	1	0



grep AX-167464995 /seq/vgb/jmcclure/Affymetrix/PRO100039_DD101_SAX/clusterA_rec.vcf
grep AX-167464995 /seq/vgb/jmcclure/Affymetrix/PRO100039_DD101_SAX/clusterB_rec.vcf


grep AX-167464995 /seq/vgb/linda/affy/PRO100039_DD101_SAX/cluster_A/SNPolisher/Ps.performance.txt


## calls also give probesetid
probeset_id     a550772-4346286-121118-915_A01.CEL      a550772-4346286-121118-915_A02.CEL      a550772-4346286-121118-915_A03.CEL      a550772-4346286-121118-915_A04.CEL      AX-103499552    2       1       2       2       2       2       2       2       2       2       2       2       2       2       2       2       1       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       1       1       2       2       2       1       2       2       2       2       2       2       2       2       2       2       2       1       2       2       2       2       1       1       2       2       2       2       2       2       2       1       2       2       2       2       2       2       2       2       2       2       2       2       2       1       2       2       2       2       2



	Ruby_Bailey and Ruby_NogeloKerr


### missing molly a550772-4346286-121118-915_G11.CEL


a550771-4346285-121118-906_H07.CEL


grep a550772-4346286-121118-915_G11.CEL /seq/vgb/jmcclure/Affymetrix/PRO100039_DD101_SAX/clusterA_rec.vcf

T
Molly Anderson (31001609032114) (a550772-4346286-121118-915_G11.CEL) didn't go through the pipeline because she doens't have calls for clusterA. Jesse, did this sample not pass certain thresholds in the vcf conversion process?  The Molly that was uploaded to google drive is Molly Gillette.



###### hershey

Columns correspond to simulations of balanced alleles
at equilibrium frequencies .25, .50 and .75

while read c; do
qsub -S /bin/bash -q vert -v chr=$c,species_param=/seq/vgb/linda/bal_sel/scripts_2017/mus_param.sh,win=4000,wd=/seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_mus_out \
 -e /seq/vgb/linda/bal_sel/out/beta_mus_err \
 -N musbeta16  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_to_betascan_byChr.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/mus_chr.txt



######################### TRY with 2kb #######################

##### concatinates after all chrs are done


while read c; do
qsub -S /bin/bash -q vert -v chr=$c,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_chimp_out \
 -e /seq/vgb/linda/bal_sel/out/beta_chimp_err \
 -N 'chimp_'${c}  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_byChr.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/chimp_chr.txt



######## one submission per species
qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_chimp_out \
 -e /seq/vgb/linda/bal_sel/out/beta_chimp_err \
 -N 'chimp_'${c}  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_byChr.sh


qdel $(qstat | grep chimp | grep -Po '^\d+' | perl -pe 's/\n/ /')





qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_chimp_out \
 -e /seq/vgb/linda/bal_sel/out/beta_chimp_err \
 -N chimp_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh


qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_YRI_out \
 -e /seq/vgb/linda/bal_sel/out/beta_YRI_err \
 -N YRI_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh


qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/mus_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_mus_out \
 -e /seq/vgb/linda/bal_sel/out/beta_mus_err \
 -N mus_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh


qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/gorilla_param.sh,win=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_gorilla_out \
 -e /seq/vgb/linda/bal_sel/out/beta_gorilla_err \
 -N gorilla_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh


qdel $(qstat | grep gorilla | grep -Po '^\d+' | perl -pe 's/\n/ /')


python /Users/boettger/Desktop/py_mcmc/mcmc_4species.py > /Users/boettger/Desktop/py_mcmc/mcmc_4species_output_smoothed.txt





### add smooth window to bam_betasan_liftover.sh
python smooth_win.py /Users/boettger/Documents/postdoc/bal_sel/betas/Betas_mus_BetaIn_chr18_win4000.txt 4000 2000



qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,win=2000,smwin=4000,smstep=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_chimp_out \
 -e /seq/vgb/linda/bal_sel/out/beta_chimp_err \
 -N chimp_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh




qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param.sh,win=2000,smwin=4000,smstep=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_YRI_out \
 -e /seq/vgb/linda/bal_sel/out/beta_YRI_err \
 -N YRI_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh

qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/mus_param.sh,win=2000,smwin=4000,smstep=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_mus_out \
 -e /seq/vgb/linda/bal_sel/out/beta_mus_err \
 -N mus_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh



qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/gorilla_param.sh,win=2000,smwin=4000,smstep=2000,wd=/seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_gorilla_out \
 -e /seq/vgb/linda/bal_sel/out/beta_gorilla_err \
 -N gorilla_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh




############## try with longer win more steps 09212017

smstep=1000
smwin=4000
win=4000


qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_chimp_out \
 -e /seq/vgb/linda/bal_sel/out/beta_chimp_err \
 -N chimp_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh




qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_YRI_out \
 -e /seq/vgb/linda/bal_sel/out/beta_YRI_err \
 -N YRI_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh

qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/mus_param.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_mus_out \
 -e /seq/vgb/linda/bal_sel/out/beta_mus_err \
 -N mus_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/mus_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh



qsub -S /bin/bash -q vert -v new_species=F,species_param=/seq/vgb/linda/bal_sel/scripts_2017/gorilla_param.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_gorilla_out \
 -e /seq/vgb/linda/bal_sel/out/beta_gorilla_err \
 -N gorilla_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/gorilla_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr.sh




 


#Get rid of underscores

awk '{sub(/_/," ",$5)};1' mus_to_hg19_all_win4000_smoothed.bed > mus_to_hg19_all_win2000_smoothed.bed.tmp
awk '{sub(/_/," ",$6)};1' mus_to_hg19_all_win2000_smoothed.bed.tmp > mus_to_hg19_all_win4000_smoothed.bed
rm mus_to_hg19_all_win2000_smoothed.bed.tmp

awk '{sub(/_/," ",$5)};1' YRI_all_win4000_smoothed_rmcnv.bed > YRI_all_win2000_smoothed_rmcnv.bed.tmp
awk '{sub(/_/," ",$6)};1' YRI_all_win2000_smoothed_rmcnv.bed.tmp > YRI_all_win4000_smoothed_rmcnv.bed
rm YRI_all_win2000_smoothed_rmcnv.bed.tmp

awk '{sub(/_/," ",$5)};1' chimp_to_hg19_all_win4000_smoothed.bed > chimp_to_hg19_all_win2000_smoothed.bed.tmp
awk '{sub(/_/," ",$6)};1' chimp_to_hg19_all_win2000_smoothed.bed.tmp > chimp_to_hg19_all_win4000_smoothed.bed
rm chimp_to_hg19_all_win2000_smoothed.bed.tmp


awk '{sub(/_/," ",$5)};1' gorilla_to_hg19_all_win4000_smoothed.bed > gorilla_to_hg19_all_win2000_smoothed.bed.tmp
awk '{sub(/_/," ",$6)};1' gorilla_to_hg19_all_win2000_smoothed.bed.tmp > gorilla_to_hg19_all_win4000_smoothed.bed
rm gorilla_to_hg19_all_win2000_smoothed.bed.tmp

rm chimp_to_hg19_all_win2000_smoothed.bed.tmp
rm mus_to_hg19_all_win2000_smoothed.bed.tmp
rm YRI_all_win2000_smoothed_rmcnv.bed.tmp
rm gorilla_to_hg19_all_win2000_smoothed.bed.tmp

sed -i '1d' YRI_all_win2000_smoothed_rmcnv.bed



python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Desktop/py_mcmc/mcmc_4species_output_smoothed.txt

python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top2pct_output_smoothed.txt

python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top5pct_output_smoothed.txt



/Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts


#get orangutan sequence

#example
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR151/SRR1518532/SRR1518532.sra

## whole blood or cell line???

#Buschi PongoAbelii
SRR748050
SRR748049
SRR748048
SRR748047
SRR748046

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748050/SRR748050.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748049/SRR748049.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748048/SRR748048.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748047/SRR748047.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748046/SRR748046.sra


#Babu PongoAbelii
SRR748043
SRR748044
SRR748045
SRR748041
SRR748042

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748043/SRR748043.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748044/SRR748044.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748045/SRR748045.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748041/SRR748041.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748042/SRR748042.sra


#Dunja PongoAbelii
SRR748038
SRR748039
SRR748040
SRR748035
SRR748036
SRR748037

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748040/SRR748040.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748035/SRR748035.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748036/SRR748036.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748037/SRR748037.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748038/SRR748038.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748039/SRR748039.sra

#Kiki PongoAbelii
SRR748032
SRR748033
SRR748034
SRR748031
SRR748030

wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748030/SRR748030.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748031/SRR748031.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748032/SRR748032.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748033/SRR748033.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748034/SRR748034.sra





#Elsi PongoAbelii
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748024/SRR748024.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748025/SRR748025.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748026/SRR748026.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748027/SRR748027.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748028/SRR748028.sra
wget ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByRun/sra/SRR/SRR748/SRR748029/SRR748029.sra


SRR748026
SRR748027
SRR748028
SRR748029
SRR748024
SRR748025






################## combine and filter rats  ############

qsub -S /bin/bash -q vert -v indv=rat_59 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/sample_59.out \
 -e /seq/vgb/linda/bal_sel/err/sample_59.er \
 -N rat_59 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/Rat_combine_filter.sh


### need for 47-58, 59 already run
qsub -S /bin/bash -q vert -v indv=rat_58 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/sample_58.out \
 -e /seq/vgb/linda/bal_sel/err/sample_58.er \
 -N rat_58 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/Rat_combine_filter.sh





############### download the orangutan reference ########

downloaded ponAbe2.2bit
wget http://hgdownload.cse.ucsc.edu/goldenPath/ponAbe2/bigZips/ponAbe2.2bit


get fasta from 2bit file

http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/twoBitToFa
usage info: https://genome.ucsc.edu/goldenpath/help/blatSpec.html#twoBitToFaUsage

/seq/vgb/linda/bin/twoBitToFa /seq/vgb/references/orangutan/ponAbe2.2bit /seq/vgb/references/orangutan/ponAbe2.fa

Downloaded from http://hgdownload.cse.ucsc.edu/goldenPath/ponAbe2/bigZips/ponAbe2.2bit
on 09/20/2017

#dictionary file created
java -jar $picard/picard.jar CreateSequenceDictionary \
	R= /seq/vgb/references/orangutan/ponAbe2.fa \
	O= /seq/vgb/references/orangutan/ponAbe2.dict

#index files created
bwa index -a bwtsw /seq/vgb/references/orangutan/ponAbe2.fa 
samtools faidx /seq/vgb/references/orangutan/ponAbe2.fa




######## 

python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_4species_top5pctnoMHC_4kb1kbstep_output_smoothed.txt
python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_4species_top5pctnoMHC_4kb1kbstep_output_smoothedtry2.txt


python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top3pct_4kb1kbstep_output_smoothed.txt



####### I fixed the issue where gorilla was read in as chimp !!!
python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_4species_top5pctnoMHC_4kb1kbstep_output_smoothedFIXED.txt

python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top3pct_4kb1kbstep_output_smoothedFIXED.txt


####### Include MHC #########
python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_4species_top5pct_INCMHC_4kb1kbstep_output_smoothedFIXED.txt

python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top5pct_incMHC_4kb1kbstep_output_smoothedFIXED.txt


python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_3species.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_3species_top5pct_NOMHC_4kb1kbstep_output_smoothedFIXED.txt


python /Users/boettger/Documents/postdoc/bal_sel/mcmc_scripts/mcmc_general.py > /Users/boettger/Documents/postdoc/bal_sel/mcmc_outputs/mcmc_4species_top3pct_NOMHC_4kb1kbstep_output_smoothedFIXED.txt

## running above again with correct cutoffs!!


######### test fastqdump for one orangutan , Sept 25, 2017 ############

qsub -S /bin/bash -q vert -v myfile=SRR748026.sra -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/orang_sra.out \
 -e /seq/vgb/linda/bal_sel/err/orang_sra.er \
 -N SRR748026 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/sra_align_orangutans.sh


SRR748027
SRR748028
SRR748029
SRR748024
SRR748025



########## find trans-species polymorphisms ################
### run for region around saps
while read c; do
qsub -S /bin/bash -q vert -v chr=$c,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,type=region \
-M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_$c \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/find_trans_poly.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/chimp_chr.txt


### running again to get SNP positions
while read c; do
qsub -S /bin/bash -q vert -v chr=$c,species_param=/seq/vgb/linda/bal_sel/scripts_2017/chimp_param.sh,type=snp \
-M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_$c \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/find_trans_poly.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/chimp_chr.txt


Cd /seq/vgb/linda/bal_sel/from_oracle/trans_poly/chimp_maf_liftout cat *


qsub -S /bin/bash -q vert -v chr=22,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param.sh,type=region \
-M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_22 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/find_trans_poly.sh

qsub -S /bin/bash -q vert -v chr=22,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param.sh,type=snp \
-M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_22 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/find_trans_poly.sh


#### why snaps won’t lift over ###
10220 chimp_to_hg19_chr22_random_SNPUnmapped.bed

10220 chimp_to_hg19_chr22_random_SNPUnmapped.bed
8:43pm boettger@vert02 /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta/chimp_lift $ cd /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta
8:44pm boettger@vert02 /seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta $ cd /seq/vgb/linda/bal_sel/from_oracle/trans_poly/chimp_maf_tolift
8:45pm boettger@vert02 /seq/vgb/linda/bal_sel/from_oracle/trans_poly/chimp_maf_tolift $ wc -l chimp_SNP_chr22.bed
105744 chimp_SNP_chr22.bed

/seq/vgb/linda/bal_sel/from_oracle/chimp_out_beta/chimp_lift/chimp_to_hg19_chr22_SNPUnmapped.bed has 211488 lines (2x input since a line says no map for each)
/seq/vgb/linda/bal_sel/from_oracle/trans_poly/chimp_maf_tolift/chimp_SNP_chr22.bed. has 105744 lines





##### get YRI Mafs to look at trans species poly #########

# Get species-specific variables #
source $species_param

tolift=$parentpath/trans_poly/$species'_maf'


mkdir -p $tolift

################ MAF to lift input ################
maf=$outs'filtered_'$chr'.mafs'


## get 100bp on either side
# ## they aren't whole numbers because genotype probs used to calculate freq
#chr
#snp - 100bp
#snp + 100 bp
#MAF
#snp pos, major, minor, n indivs
#awk '{if (NR!=1) print $1, $2-100, $2+100, $6, $2"_"$3"_"$4"_"$8}' $maf > $tolift/$species'_'$chr'.bed'


for chr in `seq 1 22`;
        do
                echo $chr
                maf=$outs'filtered_'$chr'.mafs'
                awk '{if (NR!=1) print $1, $2, $2+1, $6, $3"_"$4"_"$8}' $maf > $tolift/$species'_SNP_'$chr'.bed'

        done   

cat *_SNP_* > YRI_allSNPs.txt




################## getting ancestral human/chimp bases ############# October 4th, after Skyler’s death :(
Sequence from here ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/phase1/analysis_results/supporting/ancestral_alignments/

/seq/vgb/linda/ancestral_bases/human_chimp/human_ancestor_GRCh37_e59

###### fix chromosome names
var=">22"
sed -i "1s/.*/$var/" human_ancestor_22.fa


Need to write script to get base at each position in ancestral sequence 
These snaps:
/seq/vgb/linda/bal_sel/from_oracle/trans_poly/trans_snps_unfiltered.txt


qsub -S /bin/bash -q vert -v chr=20 \
-M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_20 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/submit_ancestral_base_byChr.sh

while read c; do
qsub -S /bin/bash -q vert -v chr=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/trans.out \
 -e /seq/vgb/linda/bal_sel/err/trans.er \
 -N trans_{$c} \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/submit_ancestral_base_byChr.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/YRI_chr.txt





## I keep trying “doPost” in angst to get posterior probabilities but nothing comes out







######### Download YRI in hg38 ######## doing 3 as testers first — take through to betas to see if it works

/seq/vgb/linda/bal_sel/lists/YRI_indivs.txt
These are the YRI parents I was using before

samtools view -bh ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/data/YRI/NA18487/alignment/NA18487.alt_bwamem_GRCh38DH.20150718.YRI.low_coverage.cram -T /seq/references/Homo_sapiens_assembly38/v0/Homo_sapiens_assembly38.fasta -o /seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/NA18487.bam

NA18486

samtools view -bh ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/data/YRI/NA18486/alignment/NA18486.alt_bwamem_GRCh38DH.20150718.YRI.low_coverage.cram -T /seq/references/Homo_sapiens_assembly38/v0/Homo_sapiens_assembly38.fasta -o /seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/NA18486.bam


NA18489

samtools view -bh ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/data/YRI/NA18489/alignment/NA18489.alt_bwamem_GRCh38DH.20150718.YRI.low_coverage.cram -T /seq/references/Homo_sapiens_assembly38/v0/Homo_sapiens_assembly38.fasta -o /seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/NA18489.bam




#Make bamfile list
ls -d /seq/vgb/linda/bal_sel/population_data/bams/YRI/*.bam -1 > /seq/vgb/linda/bal_sel/population_data/bams/YRI/YRI.bamfilelist



ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/data/YRI/NA18487/alignment/NA18487.alt_bwamem_GRCh38DH.20150718.YRI.low_coverage.cram

/seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/





######## Run betas with new genome build ########

rm /seq/vgb/linda/bal_sel/out/beta_YRI_err
rm /seq/vgb/linda/bal_sel/out/beta_YRI_out
qsub -S /bin/bash -q vert -v new_species=T,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param_hg38.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/population_data/betas/YRI \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_YRI_out \
 -e /seq/vgb/linda/bal_sel/out/beta_YRI_err \
 -N YRI_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr_mod.sh

#WTF, WHEN I GREP FOR THEM I GET JOBS, BUT THE SCRIPT MOVES ON!!!



qdel $(qstat | grep YRI | grep -Po '^\d+' | perl -pe 's/\n/ /')




##### download rest of YRI parents #####

while read c; do
qsub -S /bin/bash -q vert -v indiv=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/down.out \
 -e /seq/vgb/linda/bal_sel/err/down.er \
 -N trans_{$c} \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/download_hg38_YRI.sh
done < /seq/vgb/linda/bal_sel/lists/YRI_indivs.txt


qsub -S /bin/bash -q vert -v indiv=NA18867 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/down.out \
 -e /seq/vgb/linda/bal_sel/err/down.er \
 -N my_$indiv} \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/download_hg38_YRI.sh




samtools view -bh ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/data/YRI/NA18489/alignment/NA18867.alt_bwamem_GRCh38DH.20150718.YRI.low_coverage.cram -T /seq/references/Homo_sapiens_assembly38/v0/Homo_sapiens_assembly38.fasta -o /seq/vgb/linda/bal_sel/new_ref_align/bams/YRI/NA18867.bam



#Make bamfile list
ls -d /seq/vgb/linda/bal_sel/population_data/bams/YRI/*.bam -1 > /seq/vgb/linda/bal_sel/population_data/bams/YRI/YRI.bamfilelist



##### get chimp fast#

while read c; do
qsub -S /bin/bash -q vert -v ERRid=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/cdown.out \
 -e /seq/vgb/linda/bal_sel/err/cdown.er \
 -N chimp_{$c} \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/chimp_down_to_fastq.sh
done < /seq/vgb/linda/bal_sel/lists/chimp_ERRids.txt

### 29 and 30 didn’t run…?

ERR225029
ERR225030
qsub -S /bin/bash -q vert -v ERRid=ERR225029 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/cERR225029.out \
 -e /seq/vgb/linda/bal_sel/err/cERR225029.er \
 -N ERR225029 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/chimp_down_to_fastq.sh

qsub -S /bin/bash -q vert -v ERRid=ERR225030 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/cERR225030.out \
 -e /seq/vgb/linda/bal_sel/err/cERR225030.er \
 -N ERR225030 \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/chimp_down_to_fastq.sh



###### make chimp reference ### Oct 12 2017

wget http://hgdownload-test.cse.ucsc.edu/goldenPath/panTro5/bigZips/panTro5.fa.gz

I downloaded EBV genome from http://www.ncbi.nlm.nih.gov/nuccore/82503188



cat /seq/vgb/references/chimp/pantro5/panTro5.fa /seq/vgb/linda/bal_sel/from_oracle/references/EBV_g.fa > /seq/vgb/references/chimp/pantro5/panTro5_EBV.fa


#### align chimps once fasts are done
rm /seq/vgb/linda/bal_sel/out/calign.out
rm /seq/vgb/linda/bal_sel/err/calign.er
while read c; do
qsub -S /bin/bash -q vert -v sra_id=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/calign.out \
 -e /seq/vgb/linda/bal_sel/err/calign.er \
 -N chimp_{$c} \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/align_chimp.sh
done < /seq/vgb/linda/bal_sel/lists/chimp_ERRids.txt







################### Get Boyko data from scratch #####################

/seq/vgb/linda/mutts/Boyko_genotypes sips above 1% freq

http://datadryad.org/resource/doi:10.5061/dryad.266k4



######## flip SNPs #######


cd /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array

#gunzip geno_data_pre_updated*
#screen -dr 471

use PLINK2
use Python-2.7

## STEP 1 flip snps
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated \
  --dog \
  --flip /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/snps_to_flip.pfizer.txt \
  --make-bed \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped


# 180117 variants loaded from .bim file.
# 4339 dogs (2167 males, 2164 females, 8 ambiguous) loaded from .fam.
# Ambiguous sex IDs written to
# /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.nosex
# .
# 138 phenotype values loaded from .fam.
# --flip: 89891 SNPs flipped, 2911 SNP IDs not present.



#### STEP 2 replace SNP names with locations
awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bim \
 > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bim

#make matching files
cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.bed \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.bed

cp /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/geno_data_pre_updated_flipped.fam \
 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped.fam


 ## STEP 3 remove fixed snps
 #4339*2*.0001
 #4339*2*.0002 must see at least twice
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped \
  --dog \
  --make-bed \
  --maf 0.0002 \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var

# 180117 variants loaded from .bim file.
# 4339 dogs (2167 males, 2164 females, 8 ambiguous) loaded from .fam.
# Total genotyping rate is 0.970139.
# 16187 variants removed due to minor allele threshold(s)
# (--maf/--max-maf/--mac/--max-mac).
# 163930 variants and 4339 dogs pass filters and QC.


## STEP 3 remove low genotyped snps
# WOW - REMOVING THOSE WITH --GENO 0.1 REMOVES 14K VARIANTS!!
# plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var \
#   --dog \
#   --make-bed \
#   --geno 0.10 \
#   --allow-no-sex \
#   --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt
  
# 13870 variants removed due to missing genotype data (--geno).
# 150060 variants and 4339 dogs pass filters and QC.


## STEP 3 remove low genotyped snps, DECIDED ON 0.15 CUTTOFF INSTEAD
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_var \
  --dog \
  --make-bed \
  --geno 0.15 \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt

Total genotyping rate is 0.9805.
723 variants removed due to missing genotype data (--geno).
163207 variants and 4339 dogs pass filters and QC.


## STEP 4 Remove the sex chromosomes and mitochondria - hwe has to come after
### get snps to remove (chr39 hemizygous and no location/mit)
grep "^0\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim > no_loc_snps.txt
grep "^39\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim >> no_loc_snps.txt
grep "^40\s" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt.bim >> no_loc_snps.txt
awk '{print $2}' no_loc_snps.txt > rm_snps.txt

#wc -l rm_snps.txt
#4882 rm_snps.txt
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_gfilt \
  --dog \
  --allow-no-sex \
  --exclude rm_snps.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex

#Total genotyping rate is 0.980991.
#163432 variants and 4339 dogs pass filters and QC.


## STEP 5 look at HWE
# We want to remove SNPs where the MAF > 0.2 and the O/E ratio for hets is > 1 or < 0.25.
# We wrote a python script to do this: /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex

python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps

#wc -l /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps
#35 /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps

awk '{print $1}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex.hwe_rmsnps \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/bad_hardy_rmsnps.txt


plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmsex \
  --dog \
  --allow-no-sex \
  --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array//bad_hardy_rmsnps.txt \
  --make-bed \
  --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmhardy

#--exclude: 158290 variants remaining.


## STEP 6 Individual genotype filtering 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_rmhardy \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind

# 41 dogs removed due to missing genotype data (--mind 0.15)
# 377 dogs removed due to missing genotype data (--mind 0.01) 


## STEP 7 breed nearest neighbor??? 
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
 --dog \
 --neighbour 1 2 \
 --allow-no-sex \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind_neighbor


#/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind_neighbor.nearest
#analyzed in R
#/Users/boettger/postdoc/mutts/Cornell_from_Jess/Boyko_loc_flipped_mind_neighbor.nearest
# two nearest neighbors were all of the same breed for each dog

#Verify that we still have 75 breeds with 12 dogs per breed in R - YES, we do

## STEP 7 downsample to only the 12 dogs per breed that we sampled
#plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
 #—dog \
# --allow-no-sex \
# --make-bed \
# --keep /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/mydogs.12eachFeb13.txt \
# --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed

 #add "chr" to the chromosome names -- plink won't keep this
 #sed -i -E "s/^/chr/" /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed.bim 

#158290 variants loaded from .bim file.
#--keep: 900 dogs remaining.

#  STEP7 — this time also get dogs that will be part of other breed pop ###### should be 95 breeds
10 collie
11 bullmastiff
3 dogues de bordeaux
7 bloodhound
10 Rhodesian ridgeback
10 soft coated wheaten
6 Italian greyhounds
10 great Pyrenees
6 whippet
9 Portuguese water dog
8 shiva inu
6 chow chow
9 Australian cattle dog
11 Irish setter
10 samoyed
9 old English sheepdog
10 GSMD
11 Afghan hound
6 Tibetan Terrier
7 Saluki

cat /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/indvs_partial_breeds.txt /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/mydogs.12eachFeb13.txt \
	> /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/mydogs.12each_and_partials.txt

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Boyko_loc_flipped_mind \
 —-dog \
 --allow-no-sex \
 --make-bed \
 --keep /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/mydogs.12each_and_partials.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE

118 phenotype values loaded from .fam.
--keep: 1069 dogs remaining.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 1069 founders and 0 nonfounders present.
Calculating allele frequencies... done.
Total genotyping rate in remaining samples is 0.985208.
158507 variants and 1069 dogs pass filters and QC.
Among remaining phenotypes, 15 are cases and 13 are controls.  (1041 phenotypes
are missing.)
--make-bed to
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE.bed
+
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE.bim
+
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE.fam
... done.

################### MERGE BOYKO DATA WITH OUR AFFY DATA ####################
## check for repeated locations of snaps ###

sort -k3n /seq/vgb/linda/mutts/genotypes_merge/affy_full_loc.bim |  uniq  -f2 -D
…. yes many repeats

############ keep best and recommended saps from both arrays ############

cat /seq/vgb/linda/affy/culsterA_BestandRecommended_SNPs.txt /seq/vgb/linda/affy/culsterA_BestandRecommended_SNPs.txt > /seq/vgb/linda/affy/all_BestandRecommended_SNPs.txt

#There are 419306 of these and they are all unique

plink --bfile /seq/vgb/jmcclure/Affymetrix/affy_full \
 --dog \
 --allow-no-sex \
 --make-bed \
 --extract /seq/vgb/linda/affy/all_BestandRecommended_SNPs.txt \
 --out /seq/vgb/linda/mutts/genotypes_merge/affy_best

/seq/vgb/linda/mutts/genotypes_merge/affy_best.nosex .
--extract: 209268 variants remaining.
Warning: At least 209268 duplicate IDs in --extract file
Total genotyping rate is 0.798161.

##### update names of Jesse’s snps

awk '{print $1, "chr" $1 ":" $4, $3, $4, $5, $6}' \
 /seq/vgb/linda/mutts/genotypes_merge/affy_best.bim \
 > /seq/vgb/linda/mutts/genotypes_merge/affy_best_loc.bim





plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE \
 --bmerge /seq/vgb/linda/mutts/genotypes_merge/affy_best.bed \
 /seq/vgb/linda/mutts/genotypes_merge/affy_best_loc.bim \
 /seq/vgb/linda/mutts/genotypes_merge/affy_best.fam \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/genotypes_merge/Affy_Boyko_mergetest

158507 markers loaded from
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_TOMERGE.bim.
209268 markers to be merged from
/seq/vgb/linda/mutts/genotypes_merge/affy_best_loc.bim.
Of these, 74719 are new, while 134549 are present in the base dataset.
Error: 49 variants with 3+ alleles present.
/seq/vgb/linda/mutts/genotypes_merge/Affy_Boyko_mergetest-merge.missnp



######## filter Affy data ################

#get homozygous sips to remove
grep "^39\s" /seq/vgb/linda/mutts/genotypes_merge/affy_best_loc.bim | awk '{print $2}' > /seq/vgb/linda/mutts/genotypes_merge/rm_snps.txt 

## STEP 1 remove low genotyped snps, DECIDED ON 0.15 CUTTOFF INSTEAD
plink --bed /seq/vgb/linda/mutts/genotypes_merge/affy_best.bed \
  --bim /seq/vgb/linda/mutts/genotypes_merge/affy_best_loc.bim \
  --fam /seq/vgb/linda/mutts/genotypes_merge/affy_best.fam \
  --dog \
  --make-bed \
  —exclude /seq/vgb/linda/mutts/genotypes_merge/rm_snps.txt \
  --maf 0.0002 \
  --geno 0.15 \
  --allow-no-sex \
  --out /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt

841 dogs (0 males, 0 females, 841 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt.nosex .
--exclude: 203308 variants remaining.
Warning: At least 57 duplicate IDs in --exclude file.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 841 founders and 0 nonfounders present.
Calculating allele frequencies... 20%                                                                                                      done.
Total genotyping rate is 0.800054.
65431 variants removed due to missing genotype data (--geno).
0 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
137877 variants and 841 dogs pass filters and QC.


## STEP 2 look at HWE
# want to remove SNPs where the MAF > 0.2 and the O/E ratio for hets is > 1 or < 0.25.
#  wrote a python script to do this: /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py
plink --bfile /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt \
  --dog \
  --hardy \
  --nonfounders \
  --out /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_forhardy


Use Python-2.7

#screen -dr 965
python /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/find_hwe_snps.py \
  /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_forhardy.hwe \
  > /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_forhardy.hwe_rmsnps ### none to remove!!!


## STEP 6 Individual genotype filtering 
plink --bfile /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt \
 --dog \
 --allow-no-sex \
 --make-bed \
 --mind 0.15 \
 --out /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_ifilt

/seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_ifilt.nosex .
5 dogs removed due to missing genotype data (--mind).
IDs written to /seq/vgb/linda/mutts/genotypes_merge/affy_best_gfilt_ifilt.irem
31001602030008  31001602030008
31001602030823  31001602030823
31001701032170  31001701032170
a550772-4305542-111917-563_F08  a550772-4305542-111917-563_F08
StaffordBullTerrier_2902        StaffordBullTerrier_2902


.
Using 1 thread (no multithreaded calculations invoked.
Before main variant filters, 836 founders and 0 nonfounders present.
Calculating allele frequencies... 4%                                                                                                        done.
Total genotyping rate in remaining samples is 0.983953.
137877 variants and 836 dogs pass filters and QC.











###### Get Elaine’s seuqenced dogs that we need ############

################# BELOW IS SAMPLE CODE — I’LL WANT TO MODIFY INDIVIDUALS AND SNPS NEEDED #########################
### need to keep more than that!!! I need a chihuahua and other purebreds as testers
vcftools='/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools'
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchrinc38.vcf.gz \
 --positions /seq/vgb/linda/AdmixTools_data/ancestrals/muttVar_allchr_July30_0miss.pos  \
 --keep /seq/vgb/linda/abba_baba/scripts/dipAncestrals_ostrandervcf.txt \
 --plink \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf

## convert to loc
awk '{print $1, "chr"$1":"$4, "0", $4}' /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf.map > /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcfloc.map


## convert to plink binary and only keep snps we want
plink --ped /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcf.ped \
 --map /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestralsinc38_fromostrandervcfloc.map \
 --exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38.missnp \
 --make-bed \
 --dog \
 --out /seq/vgb/linda/AdmixTools_data/eigenstrat/dipAncestrals_fromostrandervcfinc38

--exclude /seq/vgb/linda/AdmixTools_data/eigenstrat/DipMutts_OstDipAnc_HapAncestrals_mine_andOst_merged_inc38.missnp \

########## Make table of what everyone is ###############
Barcode CallName	breed/mutt	Type
3100… 	Skyler	mutt		query
3100…	Sandy	golden_retriever	reference

############ Merge 10x genomics dogs and mendel’s mutts ############ HAVE THESE BEEN FILTERED TOGETHER ALREADY??






######### Merge EMBARK dogs #################### filter them first
/seq/vgb/EMBARK/






########## Merge all 3 together rm bad strand sips #############








######## Make lots of plots and rm dogs that are the same #########



## STEP 8 try to merge with Darwin's Dogs, note snps that have bad flipping

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --bmerge /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.fam \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest

Error: 12 variants with 3+ alleles present.


#about 6k markers in boyko that aren't in DD, should I impute them?
158290 markers loaded from
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed.bim.
152898 markers to be merged from
/seq/vgb/linda/mutts/Darwins_Dogs/Darwins_Dogs_BoykoSNPs_filt.bim.

 
 #missnp file -- rm, not sure if wrong position or flipped wrong
/seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest-merge.missnp


## STEP 9 merge with Mendell's Mutts, note snps that have bad flipping

plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --bmerge /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.bed \
 /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.bim \
 /seq/vgb/linda/mutts/mendels_mutts/vcf/MendellsMutts_BoykoSNPs_filt.fam \
 --dog \
 --make-bed \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/MM_Boyko_mergetest

cat /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/MM_Boyko_mergetest-merge.missnp \
  /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/DD_Boyko_mergetest-merge.missnp \
  > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/rm_badflippers.txt

## STEP 10 Remove all SNPs that were in bad orientation or had >3 alleles
# in either dataset
##### remove the SNPs that were on the wrong strand in either DD or MM
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_flipped_12perbreed \
 --dog \
 --allow-no-sex \
 --make-bed \
 --exclude /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/rm_badflippers.txt \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed

 awk '{print $2}' /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed.bim \
 > /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed.snplist

158151 variants and 900 dogs pass filters and QC.

158290 variants loaded from .bim file.
900 dogs (422 males, 477 females, 1 ambiguous) loaded from .fam.
--exclude: 158151 variants remaining.

#STEP 11 - make reference dataset (need maf because beagle won't accept fixed variants)
plink --bfile /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_rmbadflip_12perbreed \
 --dog \
 --allow-no-sex \
 --keep /seq/vgb/linda/mutts/mendels_mutts/breed_lists/Feb_13/mydogs.6of12eachFeb13.txt \
 --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \
 --make-bed \
 --recode vcf-iid \
 --out /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_6forREF

# --extract /seq/vgb/linda/mutts/boyko_allSNPs/pfizer_array/Feb_12perbreed/Boyko_12perbreed_varinboth.txt \





######## Run betas with new genome build ########

rm /seq/vgb/linda/bal_sel/out/beta_YRI_err
rm /seq/vgb/linda/bal_sel/out/beta_YRI_out
qsub -S /bin/bash -q vert -v new_species=T,species_param=/seq/vgb/linda/bal_sel/scripts_2017/YRI_param_hg38.sh,win=4000,smwin=4000,smstep=1000,wd=/seq/vgb/linda/bal_sel/population_data/betas/YRI \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/beta_YRI_out \
 -e /seq/vgb/linda/bal_sel/out/beta_YRI_err \
 -N YRI_beta  \
 -wd /seq/vgb/linda/bal_sel/from_oracle/YRI_out_beta \
 /seq/vgb/linda/bal_sel/scripts_2017/bam_betascan_liftover_allchr_mod.sh

#WTF, WHEN I GREP FOR THEM I GET JOBS, BUT THE SCRIPT MOVES ON!!!



qdel $(qstat | grep YRI | grep -Po '^\d+' | perl -pe 's/\n/ /')



##### get gorillas 3#####


qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/gorilla.out \
 -e /seq/vgb/linda/bal_sel/out/gorilla.er \
 -N gorilla \
 /seq/vgb/linda/bal_sel/scripts_2017/Western_lowland_gorillas_download.sh


##### get gorilla genome gorgor5 
http://hgdownload-test.cse.ucsc.edu/goldenPath/currentGenomes/Gorilla_gorilla_gorilla/bigZips/gorGor5.fa.gz
Use BWA
bwa index /seq/vgb/references/gorilla/gorGor5/gorGor5.fa



#mm10 already is here:
/seq/references/Mus_musculus_assembly10/v0/Mus_musculus_assembly10.fasta



#### getting bus fastqs again — 2 years later!!
### get wild mus musculus individuals from http://genome.cshlp.org/content/early/2015/07/02/gr.187187.114.full.pdf
# I’ve chosen the Iranian ancestral population because it is the most diverse ~22x average coverage
AH15
AH23
JR11
JR15
JR2-F1C
JR5-F1C 
JR7-F1C
JR8-F1A  

# I’m downloading these fastq files to the cheaper shortage folder and will later align them to the mus musculus genome
# This is going to take a very long time — may want to do it a different way
/seq/vgb/linda/bal_sel/population_data/fastq/mus
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2766_AH15_1_sequence.fq.gz 31.3 Gb — should check, but maybe okay
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2766_AH15_2_sequence.fq.gz screen -dr 587
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2765_AH23_1_sequence.fq.gz screen -dr 965
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2765_AH23_2_sequence.fq.gz screen -dr 989
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2763_JR11_1_1_sequence.fq.gz screen -dr 229 x
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2763_JR11_1_2_sequence.fq.gz screen -dr 255 x
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2764_JR15_1_1_sequence.fq.gz screen -dr 2959 x
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640093_2764_JR15_1_2_sequence.fq.gz screen -dr 587 x
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640089_2759_JR2-F1C_1_2_sequence.fq.gz screen -dr 587
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640089_2759_JR2-F1C_1_1_sequence.fq.gz screen -dr 965
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2760_JR5-F1C_1_2_sequence.fq.gz screen -dr 989
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2760_JR5-F1C_1_1_sequence.fq.gz screen -dr 229
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2761_JR7-F1C_1_2_sequence.fq.gz screen -dr 255
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2761_JR7-F1C_1_1_sequence.fq.gz screen -dr 2959
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2762_JR8-F1A_1_1_sequence.fq.gz
wget ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2762_JR8-F1A_1_2_sequence.fq.gz

#I guess I can only do 6 at once?
HTTP request sent, awaiting response... Read error (Connection reset by peer) in headers.
Retrying.

rm /seq/vgb/linda/bal_sel/out/mouse.out
rm /seq/vgb/linda/bal_sel/err/mouse.er
while read c; do
qsub -S /bin/bash -q vert -v mouse=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/mouse.out \
 -e /seq/vgb/linda/bal_sel/err/mouse.er \
 -N mouse_$c \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/download_mus.sh
done < /seq/vgb/linda/bal_sel/scripts_2017/mice_names.txt


qdel $(qstat | grep mouse | grep -Po '^\d+' | perl -pe 's/\n/ /')

### it is giving me problems downloading it……..
2017-10-17 07:13:23 (1006 KB/s) - Connection closed at byte 28673675264. Retrying.

--2017-10-17 07:13:28--  (try: 6)  http://ftp.sra.ebi.ac.uk/vol1/ERA441/ERA441366/fastq/SN7640090_2762_JR8-F1A_1_2_sequence.fq.gz
Connecting to ftp.sra.ebi.ac.uk|193.62.192.7|:80... connected.
HTTP request sent, awaiting response... 403 Forbidden
2017-10-17 07:13:28 ERROR 403: Forbidden.


##### download fast 1-19

qsub -S /bin/bash -q vert -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/browndown.out \
 -e /seq/vgb/linda/bal_sel/err/browndown.er \
 -N rat19down \
 -p -10 \
 /seq/vgb/linda/bal_sel/scripts_2017/rat/fastbrowndown_19.sh



############# Where are my species in the pipelines ?? ########

Human - Betas are done!! Have genome, have hg38ToPanTro5.over.chain — should look at read depth, may have changed in new genome build

Chimp — /seq/vgb/references/chimp/pantro5/panTro5.fa, They are aligning,  have panTro5ToHg38.over.chain, Code updates: alignment code done, 

Gorilla - /seq/vgb/references/gorilla/gorGor5/gorGor5.fa done, test 2 gor in bwa and gorillas2 running, have gorGor5ToHg38.over.chain

Mouse - ref done: /seq/references/Mus_musculus_assembly10/v0/Mus_musculus_assembly10.fasta, have mm10ToHg38.over.chain  Fastqs are being downloaded in screen —HARD, keeps having up, but bars are sorted by chr

Rat - /seq/vgb/references/brown_rat/rn6.fa being indexed, have rn6ToHg38.over.chain, Fastqs are being downloaded — didn’t work (trying bam2fastq, testing on 1)


###### test bam2fastq on one rat
ERR316560_rat_55.sorted.bam

 qsub -S /bin/bash -q vert -v ERRrat=ERR316560_rat_55 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/ratbam.out \
 -e /seq/vgb/linda/bal_sel/err/ratbam.out \
 -N ERR316560_rat_55 \
 /seq/vgb/linda/bal_sel/scripts_2017/rat_bam2fastq.sh



qsub -S /bin/bash -q vert -v indv=Kowali1.sra -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/gortest.out \
 -e /seq/vgb/linda/bal_sel/err/gortest.er \
 -N gor1 \
 /seq/vgb/linda/bal_sel/scripts_2017/Gorilla_bwa.sh

qsub -S /bin/bash -q vert -v indv=Kowali2.sra -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/gortest.out \
 -e /seq/vgb/linda/bal_sel/err/gortest.er \
 -p -10 \
 -N gor2 \
 /seq/vgb/linda/bal_sel/scripts_2017/Gorilla_bwa.sh

####### I think server crashed when I did all of them before
while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /seq/vgb/linda/bal_sel/out/gortest.out \
   -e /seq/vgb/linda/bal_sel/err/gortest.er \
   -N ${c} \
   -p -10 \
   -pe smp 2 \
   /seq/vgb/linda/bal_sel/scripts_2017/Gorilla_bwa.sh
done < /seq/vgb/linda/bal_sel/from_oracle/lists/gorilla_indvs2.txt

#####do above for requesting multiple cores!!!







qsub -S /bin/bash -q vert -v indv=Kowali3.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor3 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh

qsub -S /bin/bash -q vert -v indv=Kowali4.sra -M boettger@broadinstitute.org \
 -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/gortest.out \
 -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/gortest.er \
 -N gor4 \
 /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh


### run gorillas in groups so not to overwhelm server
## gorilla_indvs2-5
while read c; do
  qsub -S /bin/bash -v indv=$c -q vert -M boettger@broadinstitute.org \
   -o /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/out/${c}_out \
   -e /wga/scr4/vgbgrp/linda/bal_sel/gorilla_bams/err/${c}_err \
   -N ${c} \
   /wga/scr4/vgbgrp/linda/bal_sel/Gorilla_bwanew.sh
done < /wga/scr4/vgbgrp/linda/bal_sel/gorilla_indvs5.txt




### rat is hard to download — get it from the bam
while read c; do
qsub -S /bin/bash -q vert -v ERRrat=$c \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/ratbam.out \
 -e /seq/vgb/linda/bal_sel/err/ratbam.er \
 -N r$c \
 -p -10 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/rat_bam2fastq.sh
done < /seq/vgb/linda/bal_sel/scripts_2017/mice_names.txt





qsub -S /bin/bash -q vert -v ERRrat=ERR316550_rat_59 \
 -M boettger@broadinstitute.org \
 -o /seq/vgb/linda/bal_sel/out/ratbam.out \
 -e /seq/vgb/linda/bal_sel/err/ratbam.er \
 -N rERR316550_rat_59 \
 -wd /seq/vgb/linda/bal_sel/from_oracle \
 /seq/vgb/linda/bal_sel/scripts_2017/rat_bam2fastq.sh








######## combine dog sequencing data ######
vcftools=/home/unix/boettger/bin/vcftools_0.1.12b/bin/vcftools

# 10x Genomics
$vcftools --vcf /seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/mutts_10xg.vcf \
    --remove-indels \
    --recode \
    --remove-filtered-all \
    --out /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/10xg_noindel

### my mutts
$vcftools --vcf /seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf  \
  --remove-indels \
  --recode \
  --remove-filtered-all \
  --keep /seq/vgb/linda/AdmixTools_data/mutts/my_mutts.txt \
  --out /seq/vgb/linda/AdmixTools_data/mutts/mutts21_noindel


##Elaine’s sequenced vcf for a few ref breeds ##
$vcftools --gzvcf /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf/435.PASS.SNP.allchrinc38.vcf.gz  \
  --remove-indels \
  --recode \
  --remove-filtered-all \
  --keep /seq/vgb/linda/mutts/sequence_vcf_merge/Elaine_seqVCF_samples.txt \
  --out /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf_refdogs_noindel

VCF sequence data to merge
/seq/vgb/jmcclure/wgs/vcfs/WGS-filtered.vcf —> get only the mutts I want
/seq/vgb/linda/mutts/ostrander_data/ostrander_vcf  —> get only the reference breeds that I want
/seq/vgb/linda/admixture/10xg/vcfs/Dog_VCFs/mutts_10xg.vcf



######## combine these 3 when above is done #######

vcf-merge /seq/vgb/linda/mutts/boyko_allSNPs/data_curation/10xg_noindel.vcf \
  /seq/vgb/linda/AdmixTools_data/mutts/mutts21_noindel \
  /seq/vgb/linda/mutts/ostrander_data/ostrander_vcf_refdogs_noindel | bgzip -c > /seq/vgb/linda/mutts/sequence_vcf_merge/mutts_10xg_elainevcf



--remove-filtered-all (removes with filter other than pass)


######## write general script for looking at read depth ##########
/seq/vgb/linda/bin/angsd/angsd -bam $bampath/chimp$chr.bamfilelist \
    -doDepth 1 \
    -doCounts 1 \
    -doQsDist 1 \
    -minMapQ 30 -minQ 20 \
    -remove_bads 1 \
    -only_proper_pairs 1 -minInd 7 \
    -uniqueOnly 1 \
    -maxDepth 250 \
    -GL 2 \
    -baq 1 \
    -ref /seq/vgb/references/chimp/panTro2.fasta \
    -out $outpath/chimpfilternew_$chr

